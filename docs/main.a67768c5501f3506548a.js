(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},"50bv":function(t,e,n){var r;!function(n){"use strict";var i=function(t){return.5*(Math.exp(t)+Math.exp(-t))},o=function(t){return.5*(Math.exp(t)-Math.exp(-t))},a=function(){throw SyntaxError("Invalid Param")};function s(t,e){var n=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(n):n<3e3&&r<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function u(t,e){if(!(this instanceof u))return new u(t,e);var n=function(t,e){var n={re:0,im:0};if(null==t)n.re=n.im=0;else if(void 0!==e)n.re=t,n.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)n.re=t.re,n.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return u.INFINITY;n.re=t.abs*Math.cos(t.arg),n.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return u.INFINITY;n.re=t.r*Math.cos(t.phi),n.im=t.r*Math.sin(t.phi)}else 2===t.length?(n.re=t[0],n.im=t[1]):a();break;case"string":n.im=n.re=0;var r=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),i=1,o=0;null===r&&a();for(var s=0;s<r.length;s++){var c=r[s];" "===c||"\t"===c||"\n"===c||("+"===c?i++:"-"===c?o++:"i"===c||"I"===c?(i+o===0&&a()," "===r[s+1]||isNaN(r[s+1])?n.im+=parseFloat((o%2?"-":"")+"1"):(n.im+=parseFloat((o%2?"-":"")+r[s+1]),s++),i=o=0):((i+o===0||isNaN(c))&&a(),"i"===r[s+1]||"I"===r[s+1]?(n.im+=parseFloat((o%2?"-":"")+c),s++):n.re+=parseFloat((o%2?"-":"")+c),i=o=0))}i+o>0&&a();break;case"number":n.im=0,n.re=t;break;default:a()}return isNaN(n.re)||isNaN(n.im),n}(t,e);this.re=n.re,this.im=n.im}u.prototype={re:0,im:0,sign:function(){var t=this.abs();return new u(this.re/t,this.im/t)},add:function(t,e){var n=new u(t,e);return this.isInfinite()&&n.isInfinite()?u.NAN:this.isInfinite()||n.isInfinite()?u.INFINITY:new u(this.re+n.re,this.im+n.im)},sub:function(t,e){var n=new u(t,e);return this.isInfinite()&&n.isInfinite()?u.NAN:this.isInfinite()||n.isInfinite()?u.INFINITY:new u(this.re-n.re,this.im-n.im)},mul:function(t,e){var n=new u(t,e);return this.isInfinite()&&n.isZero()||this.isZero()&&n.isInfinite()?u.NAN:this.isInfinite()||n.isInfinite()?u.INFINITY:0===n.im&&0===this.im?new u(this.re*n.re,0):new u(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(t,e){var n=new u(t,e);if(this.isZero()&&n.isZero()||this.isInfinite()&&n.isInfinite())return u.NAN;if(this.isInfinite()||n.isZero())return u.INFINITY;if(this.isZero()||n.isInfinite())return u.ZERO;t=this.re,e=this.im;var r,i,o=n.re,a=n.im;return 0===a?new u(t/o,e/o):Math.abs(o)<Math.abs(a)?new u((t*(i=o/a)+e)/(r=o*i+a),(e*i-t)/r):new u((t+e*(i=a/o))/(r=a*i+o),(e-t*i)/r)},pow:function(t,e){var n=new u(t,e);if(t=this.re,e=this.im,n.isZero())return u.ONE;if(0===n.im){if(0===e&&t>=0)return new u(Math.pow(t,n.re),0);if(0===t)switch((n.re%4+4)%4){case 0:return new u(Math.pow(e,n.re),0);case 1:return new u(0,Math.pow(e,n.re));case 2:return new u(-Math.pow(e,n.re),0);case 3:return new u(0,-Math.pow(e,n.re))}}if(0===t&&0===e&&n.re>0&&n.im>=0)return u.ZERO;var r=Math.atan2(e,t),i=s(t,e);return t=Math.exp(n.re*i-n.im*r),e=n.im*i+n.re*r,new u(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,n=this.re,r=this.im,i=this.abs();if(n>=0){if(0===r)return new u(Math.sqrt(n),0);t=.5*Math.sqrt(2*(i+n))}else t=Math.abs(r)/Math.sqrt(2*(i-n));return e=n<=0?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new u(t,r<0?-e:e)},exp:function(){var t=Math.exp(this.re);return new u(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new u(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(t<-e||t>e)return Math.cos(t)-1;var n=t*t;return n*(n*(1/24+n*(-1/720+n*(1/40320+n*(-1/3628800+n*(1/4790014600+n*(-1/87178291200+n*(1/20922789888e3)))))))-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new u(s(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,n=Math.abs(t),r=Math.abs(e),n<3e3&&r<3e3?Math.sqrt(n*n+r*r):(n<r?(n=r,r=t/e):r=e/t,n*Math.sqrt(1+r*r));var t,e,n,r},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new u(Math.sin(t)*i(e),Math.cos(t)*o(e))},cos:function(){var t=this.re,e=this.im;return new u(Math.cos(t)*i(e),-Math.sin(t)*o(e))},tan:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)+i(e);return new u(Math.sin(t)/n,o(e)/n)},cot:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)-i(e);return new u(-Math.sin(t)/n,o(e)/n)},sec:function(){var t=this.re,e=this.im,n=.5*i(2*e)+.5*Math.cos(2*t);return new u(Math.cos(t)*i(e)/n,Math.sin(t)*o(e)/n)},csc:function(){var t=this.re,e=this.im,n=.5*i(2*e)-.5*Math.cos(2*t);return new u(Math.sin(t)*i(e)/n,-Math.cos(t)*o(e)/n)},asin:function(){var t=this.re,e=this.im,n=new u(e*e-t*t+1,-2*t*e).sqrt(),r=new u(n.re-e,n.im+t).log();return new u(r.im,-r.re)},acos:function(){var t=this.re,e=this.im,n=new u(e*e-t*t+1,-2*t*e).sqrt(),r=new u(n.re-e,n.im+t).log();return new u(Math.PI/2-r.im,r.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new u(0,1/0);if(-1===e)return new u(0,-1/0)}var n=t*t+(1-e)*(1-e),r=new u((1-e*e-t*t)/n,-2*t/n).log();return new u(-.5*r.im,.5*r.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new u(Math.atan2(1,t),0);var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).atan():new u(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(0,1/0);var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).acos():new u(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(Math.PI/2,1/0);var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).asin():new u(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new u(o(t)*Math.cos(e),i(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new u(i(t)*Math.cos(e),o(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,n=i(t)+Math.cos(e);return new u(o(t)/n,Math.sin(e)/n)},coth:function(){var t=2*this.re,e=2*this.im,n=i(t)-Math.cos(e);return new u(o(t)/n,-Math.sin(e)/n)},csch:function(){var t=this.re,e=this.im,n=Math.cos(2*e)-i(2*t);return new u(-2*o(t)*Math.cos(e)/n,2*i(t)*Math.sin(e)/n)},sech:function(){var t=this.re,e=this.im,n=Math.cos(2*e)+i(2*t);return new u(2*i(t)*Math.cos(e)/n,-2*o(t)*Math.sin(e)/n)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else e=t.im,t.im=-t.re,t.re=e;return t},atanh:function(){var t=this.re,e=this.im,n=t>1&&0===e,r=1-t,i=1+t,o=r*r+e*e,a=0!==o?new u((i*r-e*e)/o,(e*r+i*e)/o):new u(-1!==t?t/0:0,0!==e?e/0:0),c=a.re;return a.re=s(a.re,a.im)/2,a.im=Math.atan2(a.im,c)/2,n&&(a.im=-a.im),a},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new u(0,Math.PI/2);var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).atanh():new u(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new u(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).asinh():new u(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return u.INFINITY;var n=t*t+e*e;return 0!==n?new u(t/n,-e/n).acosh():new u(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return u.INFINITY;if(this.isInfinite())return u.ZERO;var t=this.re,e=this.im,n=t*t+e*e;return new u(t/n,-e/n)},conjugate:function(){return new u(this.re,-this.im)},neg:function(){return new u(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new u(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new u(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new u(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var n=new u(t,e);return Math.abs(n.re-this.re)<=u.EPSILON&&Math.abs(n.im-this.im)<=u.EPSILON},clone:function(){return new u(this.re,this.im)},toString:function(){var t=this.re,e=this.im,n="";return this.isNaN()?"NaN":this.isZero()?"0":this.isInfinite()?"Infinity":(0!==t&&(n+=t),0!==e&&(0!==t?n+=e<0?" - ":" + ":e<0&&(n+="-"),1!==(e=Math.abs(e))&&(n+=e),n+="i"),n||"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return!(0!==this.re&&-0!==this.re||0!==this.im&&-0!==this.im)},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},u.ZERO=new u(0,0),u.ONE=new u(1,0),u.I=new u(0,1),u.PI=new u(Math.PI,0),u.E=new u(Math.E,0),u.INFINITY=new u(1/0,1/0),u.NAN=new u(NaN,NaN),u.EPSILON=1e-16,void 0===(r=(function(){return u}).apply(e,[]))||(t.exports=r)}()},AbXl:function(t,e,n){var r;t.exports=((r=function(){function t(t){return i.appendChild(t.dom),t}function e(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";n=t}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),e(++n%i.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,u=t(new r.Panel("FPS","#0ff","#002")),c=t(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new r.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:t,showPanel:e,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(c.update(t-o,200),t>a+1e3&&(u.update(1e3*s/(t-a),100),a=t,s=0,l)){var e=performance.memory;l.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:i,setMode:e}}).Panel=function(t,e,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,u=48*a,c=3*a,l=2*a,h=3*a,p=15*a,f=74*a,d=30*a,m=document.createElement("canvas");m.width=s,m.height=u,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,u),g.fillStyle=e,g.fillText(t,c,l),g.fillRect(h,p,f,d),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,p,f,d),{dom:m,update:function(u,y){r=Math.min(r,u),i=Math.max(i,u),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,p),g.fillStyle=e,g.fillText(o(u)+" "+t+" ("+o(r)+"-"+o(i)+")",c,l),g.drawImage(m,h+a,p,f-a,d,h,p,f-a,d),g.fillRect(h+f-a,p,a,d),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+f-a,p,a,o((1-u/y)*d))}}},r)},P2RJ:function(t,e){t.exports=function t(e,n){"use strict";var r,i,o=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,a=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,c=/^0/,l=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},h=l(e).replace(a,"")||"",p=l(n).replace(a,"")||"",f=h.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=p.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(h.match(u),16)||1!==f.length&&h.match(s)&&Date.parse(h),g=parseInt(p.match(u),16)||m&&p.match(s)&&Date.parse(p)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var y=0,v=Math.max(f.length,d.length);y<v;y++){if(r=!(f[y]||"").match(c)&&parseFloat(f[y])||f[y]||0,i=!(d[y]||"").match(c)&&parseFloat(d[y])||d[y]||0,isNaN(r)!==isNaN(i))return isNaN(r)?1:-1;if(typeof r!=typeof i&&(r+="",i+=""),r<i)return-1;if(r>i)return 1}return 0}},QNpd:function(t,e,n){"use strict";var r=[],i="undefined"==typeof global?window:global,o=Math.pow(256,6),a=Math.pow(2,52),s=2*a,u=Math.random;function c(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<256;)a[i]=i++;for(i=0;i<256;i++)a[i]=a[o=255&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=255&i+1],n=256*n+a[255&(a[i]=a[o=255&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(256)}function l(t,e){var n,r=[],i=(typeof t)[0];if(e&&"o"==i)for(n in t)try{r.push(l(t[n],e-1))}catch(o){}return r.length?r:"s"==i?t:t+"\0"}function h(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return f(e)}function p(t){try{return i.crypto.getRandomValues(t=new Uint8Array(256)),f(t)}catch(e){return[+new Date,i,i.navigator&&i.navigator.plugins,i.screen,f(r)]}}function f(t){return String.fromCharCode.apply(0,t)}t.exports=function(e,n){if(n&&!0===n.global)return n.global=!1,Math.random=t.exports(e,n),n.global=!0,Math.random;var i=n&&n.entropy||!1,u=[],d=(h(l(i?[e,f(r)]:0 in arguments?e:p(),3),u),new c(u));return h(f(d.S),r),function(){for(var t=d.g(6),e=o,n=0;t<a;)t=256*(t+n),e*=256,n=d.g(1);for(;t>=s;)t/=2,e/=2,n>>>=1;return(t+n)/e}},t.exports.resetGlobal=function(){Math.random=u},h(Math.random(),r)},QPvx:function(t,e,n){var r;!function(n){"use strict";var i={s:1,n:0,d:1};function o(t){function e(){var e=Error.apply(this,arguments);e.name=this.name=t,this.stack=e.stack,this.message=e.message}function n(){}return n.prototype=Error.prototype,e.prototype=new n,e}var a=p.DivisionByZero=o("DivisionByZero"),s=p.InvalidParameter=o("InvalidParameter");function u(t,e){return isNaN(t=parseInt(t,10))&&c(),t*e}function c(){throw new s}var l=function(t,e){var n,r=0,o=1,s=1,l=0,h=0,p=0,f=1,d=1,m=0,g=1,y=1,v=1,x=1e7;if(null==t);else if(void 0!==e)s=(r=t)*(o=e);else switch(typeof t){case"object":"d"in t&&"n"in t?(r=t.n,o=t.d,"s"in t&&(r*=t.s)):0 in t?(r=t[0],1 in t&&(o=t[1])):c(),s=r*o;break;case"number":if(t<0&&(s=t,t=-t),t%1==0)r=t;else if(t>0){for(t>=1&&(t/=d=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));g<=x&&v<=x;){if(t===(n=(m+y)/(g+v))){g+v<=x?(r=m+y,o=g+v):v>g?(r=y,o=v):(r=m,o=g);break}t>n?(m+=y,g+=v):(y+=m,v+=g),g>x?(r=y,o=v):(r=m,o=g)}r*=d}else(isNaN(t)||isNaN(e))&&(o=r=NaN);break;case"string":if(null===(g=t.match(/\d+|./g))&&c(),"-"===g[m]?(s=-1,m++):"+"===g[m]&&m++,g.length===m+1?h=u(g[m++],s):"."===g[m+1]||"."===g[m]?("."!==g[m]&&(l=u(g[m++],s)),(1+ ++m===g.length||"("===g[m+1]&&")"===g[m+3]||"'"===g[m+1]&&"'"===g[m+3])&&(h=u(g[m],s),f=Math.pow(10,g[m].length),m++),("("===g[m]&&")"===g[m+2]||"'"===g[m]&&"'"===g[m+2])&&(p=u(g[m+1],s),d=Math.pow(10,g[m+1].length)-1,m+=3)):"/"===g[m+1]||":"===g[m+1]?(h=u(g[m],s),f=u(g[m+2],1),m+=3):"/"===g[m+3]&&" "===g[m+1]&&(l=u(g[m],s),h=u(g[m+2],s),f=u(g[m+4],1),m+=5),g.length<=m){s=r=p+(o=f*d)*l+d*h;break}default:c()}if(0===o)throw new a;i.s=s<0?-1:1,i.n=Math.abs(r),i.d=Math.abs(o)};function h(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function p(t,e){if(!(this instanceof p))return new p(t,e);l(t,e),t=p.REDUCE?h(i.d,i.n):1,this.s=i.s,this.n=i.n/t,this.d=i.d/t}p.REDUCE=1,p.prototype={s:1,n:0,d:1,abs:function(){return new p(this.n,this.d)},neg:function(){return new p(-this.s*this.n,this.d)},add:function(t,e){return l(t,e),new p(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(t,e){return l(t,e),new p(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(t,e){return l(t,e),new p(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(t,e){return l(t,e),new p(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return new p(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new p(NaN):void 0===t?new p(this.s*this.n%this.d,1):(l(t,e),0===i.n&&0===this.d&&p(0,0),new p(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d))},gcd:function(t,e){return l(t,e),new p(h(i.n,this.n)*h(i.d,this.d),i.d*this.d)},lcm:function(t,e){return l(t,e),0===i.n&&0===this.n?new p:new p(i.n*this.n,h(i.n,this.n)*h(i.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):new p(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):new p(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new p(NaN):new p(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new p(this.s*this.d,this.n)},pow:function(t){return t<0?new p(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new p(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return l(t,e),this.s*this.n*i.d==i.s*i.n*this.d},compare:function(t,e){l(t,e);var n=this.s*this.n*i.d-i.s*i.n*this.d;return(0<n)-(n<0)},simplify:function(t){if(isNaN(this.n)||isNaN(this.d))return this;var e=this.abs().toContinued();function n(t){return 1===t.length?new p(t[0]):n(t.slice(1)).inverse().add(t[0])}t=t||.001;for(var r=0;r<e.length;r++){var i=n(e.slice(0,r+1));if(i.sub(this.abs()).abs().valueOf()<t)return i.mul(this.s)}return this},divisible:function(t,e){return l(t,e),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,n+=" ",r%=i),n+=r,n+="/",n+=i),n},toLatex:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,r%=i),n+="\\frac{",n+=r,n+="}{",n+=i,n+="}"),n},toContinued:function(){var t,e=this.n,n=this.d,r=[];if(isNaN(this.n)||isNaN(this.d))return r;do{r.push(Math.floor(e/n)),t=e%n,e=n,n=t}while(1!==e);return r},toString:function(t){var e,n=this.n,r=this.d;if(isNaN(n)||isNaN(r))return"NaN";p.REDUCE||(n/=e=h(n,r),r/=e),t=t||15;var i=function(t,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var n=10%e,r=1;1!==n;r++)if(n=10*n%e,r>2e3)return 0;return r}(0,r),o=function(t,e,n){for(var r=1,i=function(t,e,n){for(var r=1;e>0;t=t*t%n,e>>=1)1&e&&(r=r*t%n);return r}(10,n,e),o=0;o<300;o++){if(r===i)return o;r=10*r%e,i=10*i%e}return 0}(0,r,i),a=-1===this.s?"-":"";if(a+=n/r|0,n%=r,(n*=10)&&(a+="."),i){for(var s=o;s--;)a+=n/r|0,n%=r,n*=10;for(a+="(",s=i;s--;)a+=n/r|0,n%=r,n*=10;a+=")"}else for(s=t;n&&s--;)a+=n/r|0,n%=r,n*=10;return a}},void 0===(r=(function(){return p}).apply(e,[]))||(t.exports=r)}()},VRvs:function(t,e,n){"use strict";var r,i;void 0===(i="function"==typeof(r=function(){function t(){return!0}function e(){return!1}function n(){}return function r(){var i=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t&&null!==t&&t.constructor===Object}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],o={name:"any",test:t},a=[],s=[],u={types:i,conversions:s,ignore:a};function c(t){var e=z(u.types,(function(e){return e.name===t}));if(e)return e;if("any"===t)return o;var n=z(u.types,(function(e){return e.name.toLowerCase()===t.toLowerCase()}));throw new TypeError('Unknown type "'+t+'"'+(n?'. Did you mean "'+n.name+'"?':""))}function l(t){return t===o?999:u.types.indexOf(t)}function h(t){var e=z(u.types,(function(e){return e.test(t)}));if(e)return e.name;throw new TypeError("Value has unknown type. Value: "+t)}function p(t){return t.map((function(t){var e=t.types.map(v);return(t.restParam?"...":"")+e.join("|")})).join(",")}function f(t){var e=I(t);return!!e&&e.restParam}function d(t){return t.types.some((function(t){return null!=t.conversion}))}function m(e){if(e&&0!==e.types.length){if(1===e.types.length)return c(e.types[0].name).test;if(2===e.types.length){var n=c(e.types[0].name).test,r=c(e.types[1].name).test;return function(t){return n(t)||r(t)}}var i=e.types.map((function(t){return c(t.name).test}));return function(t){for(var e=0;e<i.length;e++)if(i[e](t))return!0;return!1}}return t}function g(t,e){return e<t.params.length?t.params[e]:f(t.params)?I(t.params):null}function y(t,e,n){var r=g(t,e);return(r?n?r.types.filter(x):r.types:[]).map(v)}function v(t){return t.name}function x(t){return null==t.conversion}function b(t,e){var n=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)}(B(t,(function(t){return y(t,e,!1)})));return-1!==n.indexOf("any")?["any"]:n}function w(t,e,n){var r,i,o,a=t||"unnamed",s=n;for(o=0;o<e.length;o++){var u=s.filter((function(t){var n=m(g(t,o));return(o<t.params.length||f(t.params))&&n(e[o])}));if(0===u.length){if((i=b(s,o)).length>0){var c=h(e[o]);return(r=new TypeError("Unexpected type of argument in function "+a+" (expected: "+i.join(" or ")+", actual: "+c+", index: "+o+")")).data={category:"wrongType",fn:a,index:o,actual:c,expected:i},r}}else s=u}var l=s.map((function(t){return f(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,l))return i=b(s,o),(r=new TypeError("Too few arguments in function "+a+" (expected: "+i.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:a,index:e.length,expected:i},r;var p=Math.max.apply(null,l);return e.length>p?((r=new TypeError("Too many arguments in function "+a+" (expected: "+p+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:a,index:e.length,expectedLength:p},r):((r=new TypeError('Arguments of type "'+e.join(", ")+'" do not match any of the defined signatures of function '+a+".")).data={category:"mismatch",actual:e.map(h)},r)}function _(t){for(var e=999,n=0;n<t.types.length;n++)x(t.types[n])&&(e=Math.min(e,t.types[n].typeIndex));return e}function M(t){for(var e=999,n=0;n<t.types.length;n++)x(t.types[n])||(e=Math.min(e,t.types[n].conversionIndex));return e}function S(t,e){var n;return 0!=(n=t.restParam-e.restParam)||0!=(n=d(t)-d(e))||0!=(n=_(t)-_(e))?n:M(t)-M(e)}function E(t,e){var n,r,i=Math.min(t.params.length,e.params.length);if(0!=(r=t.params.some(d)-e.params.some(d)))return r;for(n=0;n<i;n++)if(0!=(r=d(t.params[n])-d(e.params[n])))return r;for(n=0;n<i;n++)if(0!==(r=S(t.params[n],e.params[n])))return r;return t.params.length-e.params.length}function N(t){var e,n,r,i,o=[],a=[];switch(t.types.forEach((function(t){t.conversion&&(o.push(c(t.conversion.from).test),a.push(t.conversion.convert))})),a.length){case 0:return function(t){return t};case 1:return e=o[0],r=a[0],function(t){return e(t)?r(t):t};case 2:return e=o[0],n=o[1],r=a[0],i=a[1],function(t){return e(t)?r(t):n(t)?i(t):t};default:return function(t){for(var e=0;e<a.length;e++)if(o[e](t))return a[e](t);return t}}}function T(t,e){return function t(n,r,i){if(r<n.length){var o,a=n[r],s=e?a.types.filter(x):a.types;if(a.restParam){var u=s.filter(x);o=u.length<s.length?[u,s]:[s]}else o=s.map((function(t){return[t]}));return B(o,(function(e){return t(n,r+1,i.concat([e]))}))}return[i.map((function(t,e){return{types:t,restParam:e===n.length-1&&f(n)}}))]}(t,0,[])}function A(t,r){if(0===Object.keys(r).length)throw new SyntaxError("No signatures provided");var i=[];Object.keys(r).map((function(t){return function(t,e,n){var r=[];return""!==t.trim()&&(r=t.split(",").map(O).map((function(t,e,r){var i=function(t,e){var n=0===t.indexOf("..."),r=(n?t.length>3?t.slice(3):"any":t).split("|").map(O).filter(R).filter(C),i=function(t,e){var n={};return t.forEach((function(t){-1!==e.indexOf(t.from)||-1===e.indexOf(t.to)||n[t.from]||(n[t.from]=t)})),Object.keys(n).map((function(t){return n[t]}))}(e,r),o=r.map((function(t){var e=c(t);return{name:t,typeIndex:l(e),test:e.test,conversion:null,conversionIndex:-1}})),a=i.map((function(t){var n=c(t.from);return{name:t.from,typeIndex:l(n),test:n.test,conversion:t,conversionIndex:e.indexOf(t)}}));return{types:o.concat(a),restParam:n}}(t,n);if(i.restParam&&e!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+t+'": only allowed for the last parameter');return i}))),r.some(L)?null:{params:r,fn:e}}(t,r[t],u.conversions)})).filter(P).forEach((function(t){var e=z(i,(function(e){return function(t,e){for(var n=Math.max(t.params.length,e.params.length),r=0;r<n;r++)if(!k(y(t,r,!0),y(e,r,!0)))return!1;var i=t.params.length,o=e.params.length,a=f(t.params),s=f(e.params);return a?s?i===o:o>=i:s?i>=o:i===o}(e,t)}));if(e)throw new TypeError('Conflicting signatures "'+p(e.params)+'" and "'+p(t.params)+'".');i.push(t)}));var o=B(i,(function(t){return(t?T(t.params,!1):[]).map((function(e){return{params:e,fn:t.fn}}))})).filter(P);o.sort(E);var a=o[0]&&o[0].params.length<=2&&!f(o[0].params),s=o[1]&&o[1].params.length<=2&&!f(o[1].params),h=o[2]&&o[2].params.length<=2&&!f(o[2].params),g=o[3]&&o[3].params.length<=2&&!f(o[3].params),v=o[4]&&o[4].params.length<=2&&!f(o[4].params),x=o[5]&&o[5].params.length<=2&&!f(o[5].params),b=a&&s&&h&&g&&v&&x,_=o.map((function(t){return function(t){var e,n,r,i;if(f(t)){var o=(e=(i=t,i.slice(0,i.length-1)).map(m)).length,a=m(I(t));return function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return function(t){for(var e=o;e<t.length;e++)if(!a(t[e]))return!1;return!0}(t)&&t.length>=o+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(n=m(t[0]),function(t){return n(t[0])&&1===t.length}):2===t.length?(n=m(t[0]),r=m(t[1]),function(t){return n(t[0])&&r(t[1])&&2===t.length}):(e=t.map(m),function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return t.length===e.length})}(t.params)})),M=a?m(o[0].params[0]):e,S=s?m(o[1].params[0]):e,A=h?m(o[2].params[0]):e,U=g?m(o[3].params[0]):e,F=v?m(o[4].params[0]):e,j=x?m(o[5].params[0]):e,H=a?m(o[0].params[1]):e,V=s?m(o[1].params[1]):e,G=h?m(o[2].params[1]):e,q=g?m(o[3].params[1]):e,W=v?m(o[4].params[1]):e,Z=x?m(o[5].params[1]):e,$=o.map((function(t){return function(t,e){var n=e;if(t.some(d)){var r=f(t),i=t.map(N);n=function(){for(var t=[],n=r?arguments.length-1:arguments.length,o=0;o<n;o++)t[o]=i[o](arguments[o]);return r&&(t[n]=arguments[n].map(i[n])),e.apply(this,t)}}var o=n;if(f(t)){var a=t.length-1;o=function(){return n.apply(this,D(arguments,0,a).concat([D(arguments,a)]))}}return o}(t.params,t.fn)})),Y=a?$[0]:n,X=s?$[1]:n,J=h?$[2]:n,Q=g?$[3]:n,K=v?$[4]:n,tt=x?$[5]:n,et=a?o[0].params.length:-1,nt=s?o[1].params.length:-1,rt=h?o[2].params.length:-1,it=g?o[3].params.length:-1,ot=v?o[4].params.length:-1,at=x?o[5].params.length:-1,st=b?6:0,ut=o.length,ct=function(){for(var e=st;e<ut;e++)if(_[e](arguments))return $[e].apply(this,arguments);throw w(t,arguments,o)},lt=function t(e,n){return arguments.length===et&&M(e)&&H(n)?Y.apply(t,arguments):arguments.length===nt&&S(e)&&V(n)?X.apply(t,arguments):arguments.length===rt&&A(e)&&G(n)?J.apply(t,arguments):arguments.length===it&&U(e)&&q(n)?Q.apply(t,arguments):arguments.length===ot&&F(e)&&W(n)?K.apply(t,arguments):arguments.length===at&&j(e)&&Z(n)?tt.apply(t,arguments):ct.apply(t,arguments)};try{Object.defineProperty(lt,"name",{value:t})}catch(ht){}return lt.signatures=function(t){var e={};return t.forEach((function(t){t.params.some(d)||T(t.params,!0).forEach((function(n){e[p(n)]=t.fn}))})),e}(o),lt}function C(t){return-1===u.ignore.indexOf(t)}function O(t){return t.trim()}function R(t){return!!t}function P(t){return null!==t}function L(t){return 0===t.types.length}function I(t){return t[t.length-1]}function D(t,e,n){return Array.prototype.slice.call(t,e,n)}function k(t,e){for(var n=0;n<t.length;n++)if(-1!==e.indexOf(t[n]))return!0;return!1}function z(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function B(t,e){return Array.prototype.concat.apply([],t.map(e))}function U(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(("object"==typeof r.signatures||"string"==typeof r.signature)&&""!==r.name)if(""===e)e=r.name;else if(e!==r.name){var i=new Error("Function names do not match (expected: "+e+", actual: "+r.name+")");throw i.data={actual:r.name,expected:e},i}}return e}function F(t){var e,n={};function r(t,r){if(n.hasOwnProperty(t)&&r!==n[t])throw(e=new Error('Signature "'+t+'" is defined twice')).data={signature:t},e}for(var i=0;i<t.length;i++){var o=t[i];if("object"==typeof o.signatures)for(var a in o.signatures)o.signatures.hasOwnProperty(a)&&(r(a,o.signatures[a]),n[a]=o.signatures[a]);else{if("string"!=typeof o.signature)throw(e=new TypeError("Function is no typed-function (index: "+i+")")).data={index:i},e;r(o.signature,o),n[o.signature]=o}}return n}return(u=A("typed",{"string, Object":A,Object:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return A(U(e),t)},"...Function":function(t){return A(U(t),F(t))},"string, ...Function":function(t,e){return A(t,F(e))}})).create=r,u.types=i,u.conversions=s,u.ignore=a,u.convert=function(t,e){var n=h(t);if(e===n)return t;for(var r=0;r<u.conversions.length;r++){var i=u.conversions[r];if(i.from===n&&i.to===e)return i.convert(t)}throw new Error("Cannot convert from "+n+" to "+e)},u.find=function(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof e){n=e.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");n=e}var i=n.join(","),o=t.signatures[i];if(o)return o;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+n.join(", ")+"))")},u.addType=function(t,e){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==e)for(var n=0;n<u.types.length;n++)if("Object"===u.types[n].name)return void u.types.splice(n,0,t);u.types.push(t)},u.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");u.conversions.push(t)},u}()})?r.apply(e,[]):r)||(t.exports=i)},oeuD:function(t,e,n){var r;!function(i){"use strict";var o,a,s,u=9e15,c="0123456789abcdef",l="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",h="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",p={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-u,maxE:u,crypto:!1},f=!0,d="[DecimalError] Invalid argument: ",m=Math.floor,g=Math.pow,y=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,v=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,b=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,w=1e7,_=l.length-1,M=h.length-1,S={name:"[object Decimal]"};function E(t){var e,n,r,i=t.length-1,o="",a=t[0];if(i>0){for(o+=a,e=1;e<i;e++)(n=7-(r=t[e]+"").length)&&(o+=k(n)),o+=r;(n=7-(r=(a=t[e])+"").length)&&(o+=k(n))}else if(0===a)return"0";for(;a%10==0;)a/=10;return o+a}function N(t,e,n){if(t!==~~t||t<e||t>n)throw Error(d+t)}function T(t,e,n,r){var i,o,a,s;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=7,i=0):(i=Math.ceil((e+1)/7),e%=7),o=g(10,7-e),s=t[i]%o|0,null==r?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),a=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):a=(n<4&&s+1==o||n>3&&s+1==o/2)&&(t[i+1]/o/100|0)==g(10,e-2)-1||(s==o/2||0==s)&&0==(t[i+1]/o/100|0):e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),a=(r||n<4)&&9999==s||!r&&n>3&&4999==s):a=((r||n<4)&&s+1==o||!r&&n>3&&s+1==o/2)&&(t[i+1]/o/1e3|0)==g(10,e-3)-1,a}function A(t,e,n){for(var r,i,o=[0],a=0,s=t.length;a<s;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=c.indexOf(t.charAt(a++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}S.absoluteValue=S.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),O(t)},S.ceil=function(){return O(new this.constructor(this),this.e+1,2)},S.comparedTo=S.cmp=function(t){var e,n,r,i,o=this,a=o.d,s=(t=new o.constructor(t)).d,u=o.s,c=t.s;if(!a||!s)return u&&c?u!==c?u:a===s?0:!a^u<0?1:-1:NaN;if(!a[0]||!s[0])return a[0]?u:s[0]?-c:0;if(u!==c)return u;if(o.e!==t.e)return o.e>t.e^u<0?1:-1;for(e=0,n=(r=a.length)<(i=s.length)?r:i;e<n;++e)if(a[e]!==s[e])return a[e]>s[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1},S.cosine=S.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.rounding,r.precision=(t=r.precision)+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r,i=e.d.length;i<32?r=(1/W(4,n=Math.ceil(i/3))).toString():(n=16,r="2.3283064365386962890625e-10"),t.precision+=n,e=q(t,1,e.times(r),new t(1));for(var o=n;o--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=n,e}(r,Z(r,n)),r.precision=t,r.rounding=e,O(2==s||3==s?n.neg():n,t,e,!0)):new r(1):new r(NaN)},S.cubeRoot=S.cbrt=function(){var t,e,n,r,i,o,a,s,u,c,l=this,h=l.constructor;if(!l.isFinite()||l.isZero())return new h(l);for(f=!1,(o=l.s*g(l.s*l,1/3))&&Math.abs(o)!=1/0?r=new h(o.toString()):(n=E(l.d),(o=((t=l.e)-n.length+1)%3)&&(n+=1==o||-2==o?"0":"00"),o=g(n,1/3),t=m((t+1)/3)-(t%3==(t<0?-1:2)),(r=new h(n=o==1/0?"5e"+t:(n=o.toExponential()).slice(0,n.indexOf("e")+1)+t)).s=l.s),a=(t=h.precision)+3;;)if(c=(u=(s=r).times(s).times(s)).plus(l),r=C(c.plus(l).times(s),c.plus(u),a+2,1),E(s.d).slice(0,a)===(n=E(r.d)).slice(0,a)){if("9999"!=(n=n.slice(a-3,a+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(O(r,t+1,1),e=!r.times(r).times(r).eq(l));break}if(!i&&(O(s,t+1,0),s.times(s).times(s).eq(l))){r=s;break}a+=4,i=1}return f=!0,O(r,t,h.rounding,e)},S.decimalPlaces=S.dp=function(){var t,e=this.d,n=NaN;if(e){if(n=7*((t=e.length-1)-m(this.e/7)),t=e[t])for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n},S.dividedBy=S.div=function(t){return C(this,new this.constructor(t))},S.dividedToIntegerBy=S.divToInt=function(t){var e=this.constructor;return O(C(this,new e(t),0,1,1),e.precision,e.rounding)},S.equals=S.eq=function(t){return 0===this.cmp(t)},S.floor=function(){return O(new this.constructor(this),this.e+1,3)},S.greaterThan=S.gt=function(t){return this.cmp(t)>0},S.greaterThanOrEqualTo=S.gte=function(t){var e=this.cmp(t);return 1==e||0===e},S.hyperbolicCosine=S.cosh=function(){var t,e,n,r,i,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;r=a.rounding,a.precision=(n=a.precision)+Math.max(o.e,o.sd())+4,a.rounding=1,(i=o.d.length)<32?e=(1/W(4,t=Math.ceil(i/3))).toString():(t=16,e="2.3283064365386962890625e-10"),o=q(a,1,o.times(e),new a(1),!0);for(var u,c=t,l=new a(8);c--;)u=o.times(o),o=s.minus(u.times(l.minus(u.times(l))));return O(o,a.precision=n,a.rounding=r,!0)},S.hyperbolicSine=S.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(n=o.rounding,o.precision=(e=o.precision)+Math.max(i.e,i.sd())+4,o.rounding=1,(r=i.d.length)<3)i=q(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),i=q(o,2,i=i.times(1/W(5,t=t>16?16:0|t)),i,!0);for(var a,s=new o(5),u=new o(16),c=new o(20);t--;)a=i.times(i),i=i.times(s.plus(a.times(u.times(a).plus(c))))}return o.precision=e,o.rounding=n,O(i,e,n,!0)},S.hyperbolicTangent=S.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.rounding,r.precision=(t=r.precision)+7,r.rounding=1,C(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)},S.inverseCosine=S.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,o=n.rounding;return-1!==r?0===r?e.isNeg()?I(n,i,o):new n(0):new n(NaN):e.isZero()?I(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=I(n,i+4,o).times(.5),n.precision=i,n.rounding=o,t.minus(e))},S.inverseHyperbolicCosine=S.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.rounding,r.precision=(t=r.precision)+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,f=!1,n=n.times(n).minus(1).sqrt().plus(n),f=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)},S.inverseHyperbolicSine=S.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.rounding,r.precision=(t=r.precision)+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,f=!1,n=n.times(n).plus(1).sqrt().plus(n),f=!0,r.precision=t,r.rounding=e,n.ln())},S.inverseHyperbolicTangent=S.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?O(new o(i),t,e,!0):(o.precision=n=r-i.e,i=C(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)},S.inverseSine=S.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,-1!==e?0===e?((t=I(o,n+4,r).times(.5)).s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},S.inverseTangent=S.atan=function(){var t,e,n,r,i,o,a,s,u,c=this,l=c.constructor,h=l.precision,p=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&h+4<=M)return(a=I(l,h+4,p).times(.25)).s=c.s,a}else{if(!c.s)return new l(NaN);if(h+4<=M)return(a=I(l,h+4,p).times(.5)).s=c.s,a}for(l.precision=s=h+10,l.rounding=1,t=n=Math.min(28,s/7+2|0);t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(f=!1,e=Math.ceil(s/7),r=1,u=c.times(c),a=new l(c),i=c;-1!==t;)if(i=i.times(u),o=a.minus(i.div(r+=2)),i=i.times(u),void 0!==(a=o.plus(i.div(r+=2))).d[e])for(t=e;a.d[t]===o.d[t]&&t--;);return n&&(a=a.times(2<<n-1)),f=!0,O(a,l.precision=h,l.rounding=p,!0)},S.isFinite=function(){return!!this.d},S.isInteger=S.isInt=function(){return!!this.d&&m(this.e/7)>this.d.length-2},S.isNaN=function(){return!this.s},S.isNegative=S.isNeg=function(){return this.s<0},S.isPositive=S.isPos=function(){return this.s>0},S.isZero=function(){return!!this.d&&0===this.d[0]},S.lessThan=S.lt=function(t){return this.cmp(t)<0},S.lessThanOrEqualTo=S.lte=function(t){return this.cmp(t)<1},S.logarithm=S.log=function(t){var e,n,r,i,o,a,s,u,c=this.constructor,l=c.precision,h=c.rounding;if(null==t)t=new c(10),e=!0;else{if(n=(t=new c(t)).d,t.s<0||!n||!n[0]||t.eq(1))return new c(NaN);e=t.eq(10)}if(n=this.d,this.s<0||!n||!n[0]||this.eq(1))return new c(n&&!n[0]?-1/0:1!=this.s?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(i=n[0];i%10==0;)i/=10;o=1!==i}if(f=!1,a=j(this,s=l+5),r=e?L(c,s+10):j(t,s),T((u=C(a,r,s,1)).d,i=l,h))do{if(a=j(this,s+=10),r=e?L(c,s+10):j(t,s),u=C(a,r,s,1),!o){+E(u.d).slice(i+1,i+15)+1==1e14&&(u=O(u,l+1,0));break}}while(T(u.d,i+=10,h));return f=!0,O(u,l,h)},S.minus=S.sub=function(t){var e,n,r,i,o,a,s,u,c,l,h,p,d=this,g=d.constructor;if(t=new g(t),!d.d||!t.d)return d.s&&t.s?d.d?t.s=-t.s:t=new g(t.d||d.s!==t.s?d:NaN):t=new g(NaN),t;if(d.s!=t.s)return t.s=-t.s,d.plus(t);if(p=t.d,s=g.precision,u=g.rounding,!(c=d.d)[0]||!p[0]){if(p[0])t.s=-t.s;else{if(!c[0])return new g(3===u?-0:0);t=new g(d)}return f?O(t,s,u):t}if(n=m(t.e/7),l=m(d.e/7),c=c.slice(),o=l-n){for((h=o<0)?(e=c,o=-o,a=p.length):(e=p,n=l,a=c.length),o>(r=Math.max(Math.ceil(s/7),a)+2)&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for((h=(r=c.length)<(a=p.length))&&(a=r),r=0;r<a;r++)if(c[r]!=p[r]){h=c[r]<p[r];break}o=0}for(h&&(e=c,c=p,p=e,t.s=-t.s),r=p.length-(a=c.length);r>0;--r)c[a++]=0;for(r=p.length;r>o;){if(c[--r]<p[r]){for(i=r;i&&0===c[--i];)c[i]=w-1;--c[i],c[r]+=w}c[r]-=p[r]}for(;0===c[--a];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(t.d=c,t.e=P(c,n),f?O(t,s,u):t):new g(3===u?-0:0)},S.modulo=S.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?O(new r(n),r.precision,r.rounding):(f=!1,9==r.modulo?(e=C(n,t.abs(),0,3,1)).s*=t.s:e=C(n,t,0,r.modulo,1),e=e.times(t),f=!0,n.minus(e))},S.naturalExponential=S.exp=function(){return F(this)},S.naturalLogarithm=S.ln=function(){return j(this)},S.negated=S.neg=function(){var t=new this.constructor(this);return t.s=-t.s,O(t)},S.plus=S.add=function(t){var e,n,r,i,o,a,s,u,c,l,h=this,p=h.constructor;if(t=new p(t),!h.d||!t.d)return h.s&&t.s?h.d||(t=new p(t.d||h.s===t.s?h:NaN)):t=new p(NaN),t;if(h.s!=t.s)return t.s=-t.s,h.minus(t);if(l=t.d,s=p.precision,u=p.rounding,!(c=h.d)[0]||!l[0])return l[0]||(t=new p(h)),f?O(t,s,u):t;if(o=m(h.e/7),r=m(t.e/7),c=c.slice(),i=o-r){for(i<0?(n=c,i=-i,a=l.length):(n=l,r=o,a=c.length),i>(a=(o=Math.ceil(s/7))>a?o+1:a+1)&&(i=a,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((a=c.length)-(i=l.length)<0&&(i=a,n=l,l=c,c=n),e=0;i;)e=(c[--i]=c[i]+l[i]+e)/w|0,c[i]%=w;for(e&&(c.unshift(e),++r),a=c.length;0==c[--a];)c.pop();return t.d=c,t.e=P(c,r),f?O(t,s,u):t},S.precision=S.sd=function(t){var e,n=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(d+t);return n.d?(e=D(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e},S.round=function(){var t=this,e=t.constructor;return O(new e(t),t.e+1,e.rounding)},S.sine=S.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.rounding,r.precision=(t=r.precision)+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(t,e){var n,r=e.d.length;if(r<3)return q(t,2,e,e);n=1.4*Math.sqrt(r),e=q(t,2,e=e.times(1/W(5,n=n>16?16:0|n)),e);for(var i,o=new t(5),a=new t(16),s=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(a.times(i).minus(s))));return e}(r,Z(r,n)),r.precision=t,r.rounding=e,O(s>2?n.neg():n,t,e,!0)):new r(NaN)},S.squareRoot=S.sqrt=function(){var t,e,n,r,i,o,a=this,s=a.d,u=a.e,c=a.s,l=a.constructor;if(1!==c||!s||!s[0])return new l(!c||c<0&&(!s||s[0])?NaN:s?a:1/0);for(f=!1,0==(c=Math.sqrt(+a))||c==1/0?(((e=E(s)).length+u)%2==0&&(e+="0"),c=Math.sqrt(e),u=m((u+1)/2)-(u<0||u%2),r=new l(e=c==1/0?"1e"+u:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+u)):r=new l(c.toString()),n=(u=l.precision)+3;;)if(r=(o=r).plus(C(a,o,n+2,1)).times(.5),E(o.d).slice(0,n)===(e=E(r.d)).slice(0,n)){if("9999"!=(e=e.slice(n-3,n+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(O(r,u+1,1),t=!r.times(r).eq(a));break}if(!i&&(O(o,u+1,0),o.times(o).eq(a))){r=o;break}n+=4,i=1}return f=!0,O(r,u,l.rounding,t)},S.tangent=S.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.rounding,r.precision=(t=r.precision)+10,r.rounding=1,(n=n.sin()).s=1,n=C(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,O(2==s||4==s?n.neg():n,t,e,!0)):new r(NaN)},S.times=S.mul=function(t){var e,n,r,i,o,a,s,u,c,l=this,h=l.constructor,p=l.d,d=(t=new h(t)).d;if(t.s*=l.s,!(p&&p[0]&&d&&d[0]))return new h(!t.s||p&&!p[0]&&!d||d&&!d[0]&&!p?NaN:p&&d?0*t.s:t.s/0);for(n=m(l.e/7)+m(t.e/7),(u=p.length)<(c=d.length)&&(o=p,p=d,d=o,a=u,u=c,c=a),o=[],r=a=u+c;r--;)o.push(0);for(r=c;--r>=0;){for(e=0,i=u+r;i>r;)s=o[i]+d[r]*p[i-r-1]+e,o[i--]=s%w|0,e=s/w|0;o[i]=(o[i]+e)%w|0}for(;!o[--a];)o.pop();return e?++n:o.shift(),t.d=o,t.e=P(o,n),f?O(t,h.precision,h.rounding):t},S.toBinary=function(t,e){return $(this,2,t,e)},S.toDecimalPlaces=S.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),void 0===t?n:(N(t,0,1e9),void 0===e?e=r.rounding:N(e,0,8),O(n,t+n.e+1,e))},S.toExponential=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=R(r,!0):(N(t,0,1e9),void 0===e?e=i.rounding:N(e,0,8),n=R(r=O(new i(r),t+1,e),!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n},S.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return void 0===t?n=R(i):(N(t,0,1e9),void 0===e?e=o.rounding:N(e,0,8),n=R(r=O(new o(i),t+i.e+1,e),!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},S.toFraction=function(t){var e,n,r,i,o,a,s,u,c,l,h,p,m=this,y=m.d,v=m.constructor;if(!y)return new v(m);if(c=n=new v(1),r=u=new v(0),o=(e=new v(r)).e=D(y)-m.e-1,e.d[0]=g(10,(a=o%7)<0?7+a:a),null==t)t=o>0?e:c;else{if(!(s=new v(t)).isInt()||s.lt(c))throw Error(d+s);t=s.gt(e)?o>0?e:c:s}for(f=!1,s=new v(E(y)),l=v.precision,v.precision=o=7*y.length*2;h=C(s,e,0,1,1),1!=(i=n.plus(h.times(r))).cmp(t);)n=r,r=i,c=u.plus(h.times(i=c)),u=i,e=s.minus(h.times(i=e)),s=i;return i=C(t.minus(n),r,0,1,1),u=u.plus(i.times(c)),n=n.plus(i.times(r)),u.s=c.s=m.s,p=C(c,r,o,1).minus(m).abs().cmp(C(u,n,o,1).minus(m).abs())<1?[c,r]:[u,n],v.precision=l,f=!0,p},S.toHexadecimal=S.toHex=function(t,e){return $(this,16,t,e)},S.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),null==t){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),void 0===e?e=r.rounding:N(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(f=!1,n=C(n,t,0,e,1).times(t),f=!0,O(n)):(t.s=n.s,n=t),n},S.toNumber=function(){return+this},S.toOctal=function(t,e){return $(this,8,t,e)},S.toPower=S.pow=function(t){var e,n,r,i,o,a,s=this,u=s.constructor,c=+(t=new u(t));if(!(s.d&&t.d&&s.d[0]&&t.d[0]))return new u(g(+s,c));if((s=new u(s)).eq(1))return s;if(r=u.precision,o=u.rounding,t.eq(1))return O(s,r,o);if((e=m(t.e/7))>=t.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=z(u,s,n,r),t.s<0?new u(1).div(i):O(i,r,o);if((a=s.s)<0){if(e<t.d.length-1)return new u(NaN);if(0==(1&t.d[e])&&(a=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=a,s}return(e=0!=(n=g(+s,c))&&isFinite(n)?new u(n+"").e:m(c*(Math.log("0."+E(s.d))/Math.LN10+s.e+1)))>u.maxE+1||e<u.minE-1?new u(e>0?a/0:0):(f=!1,u.rounding=s.s=1,n=Math.min(12,(e+"").length),(i=F(t.times(j(s,r+n)),r)).d&&T((i=O(i,r+5,1)).d,r,o)&&+E((i=O(F(t.times(j(s,(e=r+10)+n)),e),e+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=O(i,r+1,0)),i.s=a,f=!0,u.rounding=o,O(i,r,o))},S.toPrecision=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=R(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(N(t,1,1e9),void 0===e?e=i.rounding:N(e,0,8),n=R(r=O(new i(r),t,e),t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n},S.toSignificantDigits=S.toSD=function(t,e){var n=this.constructor;return void 0===t?(t=n.precision,e=n.rounding):(N(t,1,1e9),void 0===e?e=n.rounding:N(e,0,8)),O(new n(this),t,e)},S.toString=function(){var t=this,e=t.constructor,n=R(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n},S.truncated=S.trunc=function(){return O(new this.constructor(this),this.e+1,1)},S.valueOf=S.toJSON=function(){var t=this,e=t.constructor,n=R(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};var C=function(){function t(t,e,n){var r,i=0,o=t.length;for(t=t.slice();o--;)t[o]=(r=t[o]*e+i)%n|0,i=r/n|0;return i&&t.unshift(i),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,t[n]=(i=t[n]<e[n]?1:0)*r+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(r,i,o,s,u,c){var l,h,p,f,d,g,y,v,x,b,_,M,S,E,N,T,A,C,R,P,L=r.constructor,I=r.s==i.s?1:-1,D=r.d,k=i.d;if(!(D&&D[0]&&k&&k[0]))return new L(r.s&&i.s&&(D?!k||D[0]!=k[0]:k)?D&&0==D[0]||!k?0*I:I/0:NaN);for(c?(d=1,h=r.e-i.e):(c=w,h=m(r.e/(d=7))-m(i.e/d)),R=k.length,A=D.length,b=(x=new L(I)).d=[],p=0;k[p]==(D[p]||0);p++);if(k[p]>(D[p]||0)&&h--,null==o?(E=o=L.precision,s=L.rounding):E=u?o+(r.e-i.e)+1:o,E<0)b.push(1),g=!0;else{if(E=E/d+2|0,p=0,1==R){for(f=0,k=k[0],E++;(p<A||f)&&E--;p++)b[p]=(N=f*c+(D[p]||0))/k|0,f=N%k|0;g=f||p<A}else{for((f=c/(k[0]+1)|0)>1&&(k=t(k,f,c),D=t(D,f,c),R=k.length,A=D.length),T=R,M=(_=D.slice(0,R)).length;M<R;)_[M++]=0;(P=k.slice()).unshift(0),C=k[0],k[1]>=c/2&&++C;do{f=0,(l=e(k,_,R,M))<0?(S=_[0],R!=M&&(S=S*c+(_[1]||0)),(f=S/C|0)>1?(f>=c&&(f=c-1),1==(l=e(y=t(k,f,c),_,v=y.length,M=_.length))&&(f--,n(y,R<v?P:k,v,c))):(0==f&&(l=f=1),y=k.slice()),(v=y.length)<M&&y.unshift(0),n(_,y,M,c),-1==l&&(l=e(k,_,R,M=_.length))<1&&(f++,n(_,R<M?P:k,M,c)),M=_.length):0===l&&(f++,_=[0]),b[p++]=f,l&&_[0]?_[M++]=D[T]||0:(_=[D[T]],M=1)}while((T++<A||void 0!==_[0])&&E--);g=void 0!==_[0]}b[0]||b.shift()}if(1==d)x.e=h,a=g;else{for(p=1,f=b[0];f>=10;f/=10)p++;x.e=p+h*d-1,O(x,u?o+x.e+1:o,s,g)}return x}}();function O(t,e,n,r){var i,o,a,s,u,c,l,h,p,d=t.constructor;t:if(null!=e){if(!(h=t.d))return t;for(i=1,s=h[0];s>=10;s/=10)i++;if((o=e-i)<0)o+=7,u=(l=h[p=0])/g(10,i-(a=e)-1)%10|0;else if((p=Math.ceil((o+1)/7))>=(s=h.length)){if(!r)break t;for(;s++<=p;)h.push(0);l=u=0,i=1,a=(o%=7)-7+1}else{for(l=s=h[p],i=1;s>=10;s/=10)i++;u=(a=(o%=7)-7+i)<0?0:l/g(10,i-a-1)%10|0}if(r=r||e<0||void 0!==h[p+1]||(a<0?l:l%g(10,i-a-1)),c=n<4?(u||r)&&(0==n||n==(t.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(o>0?a>0?l/g(10,i-a):0:h[p-1])%10&1||n==(t.s<0?8:7)),e<1||!h[0])return h.length=0,c?(h[0]=g(10,(7-(e-=t.e+1)%7)%7),t.e=-e||0):h[0]=t.e=0,t;if(0==o?(h.length=p,s=1,p--):(h.length=p+1,s=g(10,7-o),h[p]=a>0?(l/g(10,i-a)%g(10,a)|0)*s:0),c)for(;;){if(0==p){for(o=1,a=h[0];a>=10;a/=10)o++;for(a=h[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(t.e++,h[0]==w&&(h[0]=1));break}if(h[p]+=s,h[p]!=w)break;h[p--]=0,s=1}for(o=h.length;0===h[--o];)h.pop()}return f&&(t.e>d.maxE?(t.d=null,t.e=NaN):t.e<d.minE&&(t.e=0,t.d=[0])),t}function R(t,e,n){if(!t.isFinite())return H(t);var r,i=t.e,o=E(t.d),a=o.length;return e?(n&&(r=n-a)>0?o=o.charAt(0)+"."+o.slice(1)+k(r):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+k(-i-1)+o,n&&(r=n-a)>0&&(o+=k(r))):i>=a?(o+=k(i+1-a),n&&(r=n-i-1)>0&&(o=o+"."+k(r))):((r=i+1)<a&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(o+="."),o+=k(r))),o}function P(t,e){var n=t[0];for(e*=7;n>=10;n/=10)e++;return e}function L(t,e,n){if(e>_)throw f=!0,n&&(t.precision=n),Error("[DecimalError] Precision limit exceeded");return O(new t(l),e,1,!0)}function I(t,e,n){if(e>M)throw Error("[DecimalError] Precision limit exceeded");return O(new t(h),e,n,!0)}function D(t){var e=t.length-1,n=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function k(t){for(var e="";t--;)e+="0";return e}function z(t,e,n,r){var i,o=new t(1),a=Math.ceil(r/7+4);for(f=!1;;){if(n%2&&Y((o=o.times(e)).d,a)&&(i=!0),0===(n=m(n/2))){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}Y((e=e.times(e)).d,a)}return f=!0,o}function B(t){return 1&t.d[t.d.length-1]}function U(t,e,n){for(var r,i=new t(e[0]),o=0;++o<e.length;){if(!(r=new t(e[o])).s){i=r;break}i[n](r)&&(i=r)}return i}function F(t,e){var n,r,i,o,a,s,u,c=0,l=0,h=0,p=t.constructor,d=p.rounding,m=p.precision;if(!t.d||!t.d[0]||t.e>17)return new p(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(f=!1,u=m):u=e,s=new p(.03125);t.e>-2;)t=t.times(s),h+=5;for(u+=r=Math.log(g(2,h))/Math.LN10*2+5|0,n=o=a=new p(1),p.precision=u;;){if(o=O(o.times(t),u,1),n=n.times(++l),E((s=a.plus(C(o,n,u,1))).d).slice(0,u)===E(a.d).slice(0,u)){for(i=h;i--;)a=O(a.times(a),u,1);if(null!=e)return p.precision=m,a;if(!(c<3&&T(a.d,u-r,d,c)))return O(a,p.precision=m,d,f=!0);p.precision=u+=10,n=o=s=new p(1),l=0,c++}a=s}}function j(t,e){var n,r,i,o,a,s,u,c,l,h,p,d=1,m=t,g=m.d,y=m.constructor,v=y.rounding,x=y.precision;if(m.s<0||!g||!g[0]||!m.e&&1==g[0]&&1==g.length)return new y(g&&!g[0]?-1/0:1!=m.s?NaN:g?0:m);if(null==e?(f=!1,l=x):l=e,y.precision=l+=10,r=(n=E(g)).charAt(0),!(Math.abs(o=m.e)<15e14))return c=L(y,l+2,x).times(o+""),m=j(new y(r+"."+n.slice(1)),l-10).plus(c),y.precision=x,null==e?O(m,x,v,f=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=E((m=m.times(t)).d)).charAt(0),d++;for(o=m.e,r>1?(m=new y("0."+n),o++):m=new y(r+"."+n.slice(1)),h=m,u=a=m=C(m.minus(1),m.plus(1),l,1),p=O(m.times(m),l,1),i=3;;){if(a=O(a.times(p),l,1),E((c=u.plus(C(a,new y(i),l,1))).d).slice(0,l)===E(u.d).slice(0,l)){if(u=u.times(2),0!==o&&(u=u.plus(L(y,l+2,x).times(o+""))),u=C(u,new y(d),l,1),null!=e)return y.precision=x,u;if(!T(u.d,l-10,v,s))return O(u,y.precision=x,v,f=!0);y.precision=l+=10,c=a=m=C(h.minus(1),h.plus(1),l,1),p=O(m.times(m),l,1),i=s=1}u=c,i+=2}}function H(t){return String(t.s*t.s/0)}function V(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;48===e.charCodeAt(r);r++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(r,i)){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=7;r<i;)t.d.push(+e.slice(r,r+=7));r=7-(e=e.slice(r)).length}else r-=i;for(;r--;)e+="0";t.d.push(+e),f&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function G(t,e){var n,r,i,a,s,u,c,l,h;if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(v.test(e))n=16,e=e.toLowerCase();else if(y.test(e))n=2;else{if(!x.test(e))throw Error(d+e);n=8}for((a=e.search(/p/i))>0?(c=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),r=t.constructor,(s=a>=0)&&(a=(u=(e=e.replace(".","")).length)-a,i=z(r,new r(n),a,2*a)),a=h=(l=A(e,n,w)).length-1;0===l[a];--a)l.pop();return a<0?new r(0*t.s):(t.e=P(l,h),t.d=l,f=!1,s&&(t=C(t,i,4*u)),c&&(t=t.times(Math.abs(c)<54?g(2,c):o.pow(2,c))),f=!0,t)}function q(t,e,n,r,i){var o,a,s,u,c=t.precision,l=Math.ceil(c/7);for(f=!1,u=n.times(n),s=new t(r);;){if(a=C(s.times(u),new t(e++*e++),c,1),s=i?r.plus(a):r.minus(a),r=C(a.times(u),new t(e++*e++),c,1),void 0!==(a=s.plus(r)).d[l]){for(o=l;a.d[o]===s.d[o]&&o--;);if(-1==o)break}o=s,s=r,r=a,a=o}return f=!0,a.d.length=l+1,a}function W(t,e){for(var n=t;--e;)n*=t;return n}function Z(t,e){var n,r=e.s<0,i=I(t,t.precision,1),o=i.times(.5);if((e=e.abs()).lte(o))return s=r?4:1,e;if((n=e.divToInt(i)).isZero())s=r?3:2;else{if((e=e.minus(n.times(i))).lte(o))return s=B(n)?r?2:3:r?4:1,e;s=B(n)?r?1:4:r?3:2}return e.minus(i).abs()}function $(t,e,n,r){var i,o,s,u,l,h,p,f,d,m=t.constructor,g=void 0!==n;if(g?(N(n,1,1e9),void 0===r?r=m.rounding:N(r,0,8)):(n=m.precision,r=m.rounding),t.isFinite()){for(g?(i=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):i=e,(s=(p=R(t)).indexOf("."))>=0&&(p=p.replace(".",""),(d=new m(1)).e=p.length-s,d.d=A(R(d),10,i),d.e=d.d.length),o=l=(f=A(p,10,i)).length;0==f[--l];)f.pop();if(f[0]){if(s<0?o--:((t=new m(t)).d=f,t.e=o,f=(t=C(t,d,n,r,0,i)).d,o=t.e,h=a),s=f[n],u=i/2,h=h||void 0!==f[n+1],h=r<4?(void 0!==s||h)&&(0===r||r===(t.s<0?3:2)):s>u||s===u&&(4===r||h||6===r&&1&f[n-1]||r===(t.s<0?8:7)),f.length=n,h)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(l=f.length;!f[l-1];--l);for(s=0,p="";s<l;s++)p+=c.charAt(f[s]);if(g){if(l>1)if(16==e||8==e){for(s=16==e?4:3,--l;l%s;l++)p+="0";for(l=(f=A(p,i,e)).length;!f[l-1];--l);for(s=1,p="1.";s<l;s++)p+=c.charAt(f[s])}else p=p.charAt(0)+"."+p.slice(1);p=p+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)p="0"+p;p="0."+p}else if(++o>l)for(o-=l;o--;)p+="0";else o<l&&(p=p.slice(0,o)+"."+p.slice(o))}else p=g?"0p+0":"0";p=(16==e?"0x":2==e?"0b":8==e?"0o":"")+p}else p=H(t);return t.s<0?"-"+p:p}function Y(t,e){if(t.length>e)return t.length=e,!0}function X(t){return new this(t).abs()}function J(t){return new this(t).acos()}function Q(t){return new this(t).acosh()}function K(t,e){return new this(t).plus(e)}function tt(t){return new this(t).asin()}function et(t){return new this(t).asinh()}function nt(t){return new this(t).atan()}function rt(t){return new this(t).atanh()}function it(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(n=e.s<0?I(this,r,i):new this(0)).s=t.s:!t.d||e.isZero()?(n=I(this,o,1).times(.5)).s=t.s:e.s<0?(this.precision=o,this.rounding=1,n=this.atan(C(t,e,o,1)),e=I(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(C(t,e,o,1)):(n=I(this,o,1).times(e.s>0?.25:.75)).s=t.s:n=new this(NaN),n}function ot(t){return new this(t).cbrt()}function at(t){return O(t=new this(t),t.e+1,2)}function st(t){if(!t||"object"!=typeof t)throw Error("[DecimalError] Object expected");var e,n,r,i=!0===t.defaults,o=["precision",1,1e9,"rounding",0,8,"toExpNeg",-u,0,"toExpPos",0,u,"maxE",0,u,"minE",-u,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],i&&(this[n]=p[n]),void 0!==(r=t[n])){if(!(m(r)===r&&r>=o[e+1]&&r<=o[e+2]))throw Error(d+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=p[n]),void 0!==(r=t[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(d+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error("[DecimalError] crypto unavailable");this[n]=!0}else this[n]=!1}return this}function ut(t){return new this(t).cos()}function ct(t){return new this(t).cosh()}function lt(t,e){return new this(t).div(e)}function ht(t){return new this(t).exp()}function pt(t){return O(t=new this(t),t.e+1,3)}function ft(){var t,e,n=new this(0);for(f=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return f=!0,new this(1/0);n=e}return f=!0,n.sqrt()}function dt(t){return t instanceof o||t&&"[object Decimal]"===t.name||!1}function mt(t){return new this(t).ln()}function gt(t,e){return new this(t).log(e)}function yt(t){return new this(t).log(2)}function vt(t){return new this(t).log(10)}function xt(){return U(this,arguments,"lt")}function bt(){return U(this,arguments,"gt")}function wt(t,e){return new this(t).mod(e)}function _t(t,e){return new this(t).mul(e)}function Mt(t,e){return new this(t).pow(e)}function St(t){var e,n,r,i,o=0,a=new this(1),s=[];if(void 0===t?t=this.precision:N(t,1,1e9),r=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)(i=e[o])>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:s[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error("[DecimalError] crypto unavailable");for(e=crypto.randomBytes(r*=4);o<r;)(i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,o):(s.push(i%1e7),o+=4);o=r/4}else for(;o<r;)s[o++]=1e7*Math.random()|0;for(t%=7,(r=s[--o])&&t&&(i=g(10,7-t),s[o]=(r/i|0)*i);0===s[o];o--)s.pop();if(o<0)n=0,s=[0];else{for(n=-1;0===s[0];n-=7)s.shift();for(r=1,i=s[0];i>=10;i/=10)r++;r<7&&(n-=7-r)}return a.e=n,a.d=s,a}function Et(t){return O(t=new this(t),t.e+1,this.rounding)}function Nt(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function Tt(t){return new this(t).sin()}function At(t){return new this(t).sinh()}function Ct(t){return new this(t).sqrt()}function Ot(t,e){return new this(t).sub(e)}function Rt(t){return new this(t).tan()}function Pt(t){return new this(t).tanh()}function Lt(t){return O(t=new this(t),t.e+1,1)}(o=function t(e){var n,r,i;function o(t){var e,n,r,i=this;if(!(i instanceof o))return new o(t);if(i.constructor=o,t instanceof o)return i.s=t.s,void(f?!t.d||t.e>o.maxE?(i.e=NaN,i.d=null):t.e<o.minE?(i.e=0,i.d=[0]):(i.e=t.e,i.d=t.d.slice()):(i.e=t.e,i.d=t.d?t.d.slice():t.d));if("number"==(r=typeof t)){if(0===t)return i.s=1/t<0?-1:1,i.e=0,void(i.d=[0]);if(t<0?(t=-t,i.s=-1):i.s=1,t===~~t&&t<1e7){for(e=0,n=t;n>=10;n/=10)e++;return void(f?e>o.maxE?(i.e=NaN,i.d=null):e<o.minE?(i.e=0,i.d=[0]):(i.e=e,i.d=[t]):(i.e=e,i.d=[t]))}return 0*t!=0?(t||(i.s=NaN),i.e=NaN,void(i.d=null)):V(i,t.toString())}if("string"!==r)throw Error(d+t);return 45===(n=t.charCodeAt(0))?(t=t.slice(1),i.s=-1):(43===n&&(t=t.slice(1)),i.s=1),b.test(t)?V(i,t):G(i,t)}if(o.prototype=S,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=st,o.clone=t,o.isDecimal=dt,o.abs=X,o.acos=J,o.acosh=Q,o.add=K,o.asin=tt,o.asinh=et,o.atan=nt,o.atanh=rt,o.atan2=it,o.cbrt=ot,o.ceil=at,o.cos=ut,o.cosh=ct,o.div=lt,o.exp=ht,o.floor=pt,o.hypot=ft,o.ln=mt,o.log=gt,o.log10=vt,o.log2=yt,o.max=xt,o.min=bt,o.mod=wt,o.mul=_t,o.pow=Mt,o.random=St,o.round=Et,o.sign=Nt,o.sin=Tt,o.sinh=At,o.sqrt=Ct,o.sub=Ot,o.tan=Rt,o.tanh=Pt,o.trunc=Lt,void 0===e&&(e={}),e&&!0!==e.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)e.hasOwnProperty(r=i[n++])||(e[r]=this[r]);return o.config(e),o}(p)).default=o.Decimal=o,l=new o(l),h=new o(h),void 0===(r=(function(){return o}).call(e,n,e,t))||(t.exports=r)}()},sgX0:function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},o={"\u2013":"\\--","\u2014":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},a=function(t,e){return r({},t,e)};t.exports=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.preserveFormatting,s=void 0!==n&&n,u=e.escapeMapFn,c=void 0===u?a:u,l=String(t),h="",p=c(r({},i),s?r({},o):{}),f=Object.keys(p),d=function(){var t=!1;f.forEach((function(e,n){t||l.length>=e.length&&l.slice(0,e.length)===e&&(h+=p[f[n]],l=l.slice(e.length,l.length),t=!0)})),t||(h+=l.slice(0,1),l=l.slice(1,l.length))};l;)d();return h}},zUnb:function(t,e,n){"use strict";function r(t){return"function"==typeof t}n.r(e);let i=!1;const o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}};function a(t){setTimeout(()=>{throw t},0)}const s={closed:!0,next(t){},error(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;a(t)},complete(){}},u=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function c(t){return null!==t&&"object"==typeof t}const l=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let h=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_unsubscribe:i,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(r(i))try{i.call(this)}catch(a){e=a instanceof l?p(a.errors):[a]}if(u(o)){let t=-1,n=o.length;for(;++t<n;){const n=o[t];if(c(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof l?e=e.concat(p(a.errors)):e.push(a)}}}if(e)throw new l(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function p(t){return t.reduce((t,e)=>t.concat(e instanceof l?e.errors:e),[])}const f=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class d extends h{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s;break;case 1:if(!t){this.destination=s;break}if("object"==typeof t){t instanceof d?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,n)}}[f](){return this}static create(t,e,n){const r=new d(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends d{constructor(t,e,n,i){let o;super(),this._parentSubscriber=t;let a=this;r(e)?o=e:e&&(o=e.next,n=e.error,i=e.complete,e!==s&&(a=Object.create(e),r(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=i}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=o;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):a(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;a(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}__tryOrSetError(t,e,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(a(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const g=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function y(t){return t}let v=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof d)return t;if(t[f])return t[f]()}return t||e||n?new d(t,e,n):new d(s)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof d?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=x(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[g](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?y:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=x(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function x(t){if(t||(t=o.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const b=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class w extends h{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class _ extends d{constructor(t){super(t),this.destination=t}}let M=(()=>{class t extends v{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[f](){return new _(this)}lift(t){const e=new S(this,this);return e.operator=t,e}next(t){if(this.closed)throw new b;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new b;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new b;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new b;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new b;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new w(this,t))}asObservable(){const t=new v;return t.source=this,t}}return t.create=(t,e)=>new S(t,e),t})();class S extends M{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):h.EMPTY}}function E(t){return t&&"function"==typeof t.schedule}class N extends d{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const T=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()};function A(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const C=A(),O=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function R(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const P=t=>{if(t&&"function"==typeof t[g])return r=t,t=>{const e=r[g]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(O(t))return T(t);if(R(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,a),t);if(t&&"function"==typeof t[C])return e=t,t=>{const n=e[C]();for(;;){const e=n.next();if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=c(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,r};function L(t,e,n,r,i=new N(t,n,r)){if(!i.closed)return e instanceof v?e.subscribe(i):P(e)(i)}class I extends d{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function D(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new k(t,e))}}class k{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new z(t,this.project,this.thisArg))}}class z extends d{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function B(t,e){return new v(n=>{const r=new h;let i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r})}function U(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[g]}(t))return function(t,e){return new v(n=>{const r=new h;return r.add(e.schedule(()=>{const i=t[g]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(R(t))return function(t,e){return new v(n=>{const r=new h;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(O(t))return B(t,e);if(function(t){return t&&"function"==typeof t[C]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new v(n=>{const r=new h;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[C](),r.add(e.schedule((function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())})))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof v?t:new v(P(t))}function F(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(F((n,r)=>U(t(n,r)).pipe(D((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new j(t,n)))}class j{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new H(t,this.project,this.concurrent))}}class H extends I{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new N(this,e,n),i=this.destination;i.add(r);const o=L(this,t,void 0,void 0,r);o!==r&&i.add(o)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function V(t=Number.POSITIVE_INFINITY){return F(y,t)}function G(t,e){return e?B(t,e):new v(T(t))}function q(){return function(t){return t.lift(new W(t))}}class W{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new Z(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Z extends d{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class $ extends v{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new h,t.add(this.source.subscribe(new X(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t}refCount(){return q()(this)}}const Y=(()=>{const t=$.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class X extends _{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function J(){return new M}function Q(t){return{toString:t}.toString()}function K(t,e,n){return Q(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}const tt=K("Inject",t=>({token:t})),et=K("Optional"),nt=K("Self"),rt=K("SkipSelf");var it=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function ot(t){for(let e in t)if(t[e]===ot)return e;throw Error("Could not find renamed property on target object.")}function at(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function st(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ut(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function ct(t){return lt(t,t[pt])||lt(t,t[mt])}function lt(t,e){return e&&e.token===t?e:null}function ht(t){return t&&(t.hasOwnProperty(ft)||t.hasOwnProperty(gt))?t[ft]:null}const pt=ot({"\u0275prov":ot}),ft=ot({"\u0275inj":ot}),dt=ot({"\u0275provFallback":ot}),mt=ot({ngInjectableDef:ot}),gt=ot({ngInjectorDef:ot});function yt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(yt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function vt(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const xt=ot({__forward_ref__:ot});function bt(t){return t.__forward_ref__=bt,t.toString=function(){return yt(this())},t}function wt(t){return _t(t)?t():t}function _t(t){return"function"==typeof t&&t.hasOwnProperty(xt)&&t.__forward_ref__===bt}const Mt="undefined"!=typeof globalThis&&globalThis,St="undefined"!=typeof window&&window,Et="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Nt="undefined"!=typeof global&&global,Tt=Mt||Nt||St||Et,At=ot({"\u0275cmp":ot}),Ct=ot({"\u0275dir":ot}),Ot=ot({"\u0275pipe":ot}),Rt=ot({"\u0275mod":ot}),Pt=ot({"\u0275loc":ot}),Lt=ot({"\u0275fac":ot}),It=ot({__NG_ELEMENT_ID__:ot});class Dt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=st({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const kt=new Dt("INJECTOR",-1),zt={},Bt=/\n/gm,Ut=ot({provide:String,useValue:ot});let Ft,jt=void 0;function Ht(t){const e=jt;return jt=t,e}function Vt(t){const e=Ft;return Ft=t,e}function Gt(t,e=it.Default){if(void 0===jt)throw new Error("inject() must be called from an injection context");return null===jt?Wt(t,void 0,e):jt.get(t,e&it.Optional?null:void 0,e)}function qt(t,e=it.Default){return(Ft||Gt)(wt(t),e)}function Wt(t,e,n){const r=ct(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&it.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${yt(t)}]`)}function Zt(t){const e=[];for(let n=0;n<t.length;n++){const r=wt(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=it.Default;for(let e=0;e<r.length;e++){const i=r[e];i instanceof et||"Optional"===i.ngMetadataName||i===et?n|=it.Optional:i instanceof rt||"SkipSelf"===i.ngMetadataName||i===rt?n|=it.SkipSelf:i instanceof nt||"Self"===i.ngMetadataName||i===nt?n|=it.Self:t=i instanceof tt||i===tt?i.token:i}e.push(qt(t,n))}else e.push(qt(r))}return e}class $t{get(t,e=zt){if(e===zt){const e=new Error(`NullInjectorError: No provider for ${yt(t)}!`);throw e.name="NullInjectorError",e}return e}}class Yt{}class Xt{}function Jt(t,e){t.forEach(t=>Array.isArray(t)?Jt(t,e):e(t))}function Qt(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Kt(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function te(t,e,n){let r=ne(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function ee(t,e){const n=ne(t,e);if(n>=0)return t[1|n]}function ne(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=t[n<<1];if(e===o)return n<<1;o>e?i=n:r=n+1}return~(i<<1)}(t,e)}var re=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),ie=function(t){return t[t.Emulated=0]="Emulated",t[t.Native=1]="Native",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const oe={},ae=[];let se=0;function ue(t){return Q(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===re.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||ae,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||ie.Emulated,id:"c",styles:t.styles||ae,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,i=t.features,o=t.pipes;return n.id+=se++,n.inputs=fe(t.inputs,e),n.outputs=fe(t.outputs),i&&i.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(ce):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(le):null,n})}function ce(t){return me(t)||function(t){return t[Ct]||null}(t)}function le(t){return function(t){return t[Ot]||null}(t)}const he={};function pe(t){const e={type:t.type,bootstrap:t.bootstrap||ae,declarations:t.declarations||ae,imports:t.imports||ae,exports:t.exports||ae,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Q(()=>{he[t.id]=t.type}),e}function fe(t,e){if(null==t)return oe;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const de=ue;function me(t){return t[At]||null}function ge(t,e){return t.hasOwnProperty(Lt)?t[Lt]:null}function ye(t,e){const n=t[Rt]||null;if(!n&&!0===e)throw new Error(`Type ${yt(t)} does not have '\u0275mod' property.`);return n}function ve(t){return Array.isArray(t)&&"object"==typeof t[1]}function xe(t){return Array.isArray(t)&&!0===t[1]}function be(t){return 0!=(8&t.flags)}function we(t){return 2==(2&t.flags)}function _e(t){return 1==(1&t.flags)}function Me(t){return null!==t.template}function Se(t){return 0!=(512&t[2])}class Ee{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ne(){return Te}function Te(t){return t.type.prototype.ngOnChanges&&(t.setInput=Ce),Ae}function Ae(){const t=Oe(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===oe)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Ce(t,e,n,r){const i=Oe(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:oe,current:null}),o=i.current||(i.current={}),a=i.previous,s=this.declaredInputs[n],u=a[s];o[s]=new Ee(u&&u.currentValue,e,a===oe),t[r]=e}function Oe(t){return t.__ngSimpleChanges__||null}Ne.ngInherit=!0;let Re=void 0;function Pe(t){return!!t.listen}const Le={createRenderer:(t,e)=>void 0!==Re?Re:"undefined"!=typeof document?document:void 0};function Ie(t){for(;Array.isArray(t);)t=t[0];return t}function De(t,e){return Ie(e[t+20])}function ke(t,e){return Ie(e[t.index])}function ze(t,e){return t.data[e+20]}function Be(t,e){const n=e[t];return ve(n)?n:n[0]}function Ue(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Fe(t){return 4==(4&t[2])}function je(t){return 128==(128&t[2])}function He(t,e){return null===t||null==e?null:t[e]}function Ve(t){t[18]=0}function Ge(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const qe={lFrame:ln(null),bindingsEnabled:!0,checkNoChangesMode:!1};function We(){return qe.bindingsEnabled}function Ze(){return qe.lFrame.lView}function $e(){return qe.lFrame.tView}function Ye(t){qe.lFrame.contextLView=t}function Xe(){return qe.lFrame.previousOrParentTNode}function Je(t,e){qe.lFrame.previousOrParentTNode=t,qe.lFrame.isParent=e}function Qe(){return qe.lFrame.isParent}function Ke(){return qe.checkNoChangesMode}function tn(t){qe.checkNoChangesMode=t}function en(){return qe.lFrame.bindingIndex++}function nn(t,e){const n=qe.lFrame;n.bindingIndex=n.bindingRootIndex=t,rn(e)}function rn(t){qe.lFrame.currentDirectiveIndex=t}function on(){return qe.lFrame.currentQueryIndex}function an(t){qe.lFrame.currentQueryIndex=t}function sn(t,e){const n=cn();qe.lFrame=n,n.previousOrParentTNode=e,n.lView=t}function un(t,e){const n=cn(),r=t[1];qe.lFrame=n,n.previousOrParentTNode=e,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex}function cn(){const t=qe.lFrame,e=null===t?null:t.child;return null===e?ln(t):e}function ln(t){const e={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function hn(){const t=qe.lFrame;return qe.lFrame=t.parent,t.previousOrParentTNode=null,t.lView=null,t}const pn=hn;function fn(){const t=hn();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function dn(){return qe.lFrame.selectedIndex}function mn(t){qe.lFrame.selectedIndex=t}function gn(){const t=qe.lFrame;return ze(t.tView,t.selectedIndex)}function yn(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:o,ngAfterViewChecked:a,ngOnDestroy:s}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),i&&((t.contentHooks||(t.contentHooks=[])).push(n,i),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i)),o&&(t.viewHooks||(t.viewHooks=[])).push(-n,o),a&&((t.viewHooks||(t.viewHooks=[])).push(n,a),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,a)),null!=s&&(t.destroyHooks||(t.destroyHooks=[])).push(n,s)}}function vn(t,e,n){wn(t,e,3,n)}function xn(t,e,n,r){(3&t[2])===n&&wn(t,e,n,r)}function bn(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function wn(t,e,n,r){const i=null!=r?r:-1;let o=0;for(let a=void 0!==r?65535&t[18]:0;a<e.length;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=r&&o>=r)break}else e[a]<0&&(t[18]+=65536),(o<i||-1==i)&&(_n(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function _n(t,e,n,r){const i=n[r]<0,o=n[r+1],a=t[i?-n[r]:n[r]];i?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,o.call(a)):o.call(a)}class Mn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Sn(t,e,n){const r=Pe(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const a=n[i++],s=n[i++],u=n[i++];r?t.setAttribute(e,s,u,a):e.setAttributeNS(a,s,u)}else{const a=o,s=n[++i];Nn(a)?r&&t.setProperty(e,a,s):r?t.setAttribute(e,a,s):e.setAttribute(a,s),i++}}return i}function En(t){return 3===t||4===t||6===t}function Nn(t){return 64===t.charCodeAt(0)}function Tn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||An(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function An(t,e,n,r,i){let o=0,a=t.length;if(-1===e)a=-1;else for(;o<t.length;){const n=t[o++];if("number"==typeof n){if(n===e){a=-1;break}if(n>e){a=o-1;break}}}for(;o<t.length;){const e=t[o];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,e),o=a+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function Cn(t){return-1!==t}function On(t){return 32767&t}function Rn(t){return t>>16}function Pn(t,e){let n=Rn(t),r=e;for(;n>0;)r=r[15],n--;return r}function Ln(t){return"string"==typeof t?t:null==t?"":""+t}function In(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Ln(t)}const Dn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Tt))();function kn(t){return t instanceof Function?t():t}let zn=!0;function Bn(t){const e=zn;return zn=t,e}let Un=0;function Fn(t,e){const n=Hn(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,jn(r.data,t),jn(e,null),jn(r.blueprint,null));const i=Vn(t,e),o=t.injectorIndex;if(Cn(i)){const t=On(i),n=Pn(i,e),r=n[1].data;for(let i=0;i<8;i++)e[o+i]=n[t+i]|r[t+i]}return e[o+8]=i,o}function jn(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Hn(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null==e[t.injectorIndex+8]?-1:t.injectorIndex}function Vn(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=e[6],r=1;for(;n&&-1===n.injectorIndex;)n=(e=e[15])?e[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function Gn(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(It)&&(r=n[It]),null==r&&(r=n[It]=Un++);const i=255&r,o=1<<i,a=64&i,s=32&i,u=e.data;128&i?a?s?u[t+7]|=o:u[t+6]|=o:s?u[t+5]|=o:u[t+4]|=o:a?s?u[t+3]|=o:u[t+2]|=o:s?u[t+1]|=o:u[t]|=o}(t,e,n)}function qn(t,e,n,r=it.Default,i){if(null!==t){const i=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(It)?t[It]:void 0;return"number"==typeof e&&e>0?255&e:e}(n);if("function"==typeof i){sn(e,t);try{const t=i();if(null!=t||r&it.Optional)return t;throw new Error(`No provider for ${In(n)}!`)}finally{pn()}}else if("number"==typeof i){if(-1===i)return new Qn(t,e);let o=null,a=Hn(t,e),s=-1,u=r&it.Host?e[16][6]:null;for((-1===a||r&it.SkipSelf)&&(s=-1===a?Vn(t,e):e[a+8],Jn(r,!1)?(o=e[1],a=On(s),e=Pn(s,e)):a=-1);-1!==a;){s=e[a+8];const t=e[1];if(Xn(i,a,t.data)){const t=Zn(a,e,n,o,r,u);if(t!==Wn)return t}Jn(r,e[1].data[a+8]===u)&&Xn(i,a,e)?(o=t,a=On(s),e=Pn(s,e)):a=-1}}}if(r&it.Optional&&void 0===i&&(i=null),0==(r&(it.Self|it.Host))){const t=e[9],o=Vt(void 0);try{return t?t.get(n,i,r&it.Optional):Wt(n,i,r&it.Optional)}finally{Vt(o)}}if(r&it.Optional)return i;throw new Error(`NodeInjector: NOT_FOUND [${In(n)}]`)}const Wn={};function Zn(t,e,n,r,i,o){const a=e[1],s=a.data[t+8],u=$n(s,a,n,null==r?we(s)&&zn:r!=a&&3===s.type,i&it.Host&&o===s);return null!==u?Yn(e,a,u,s):Wn}function $n(t,e,n,r,i){const o=t.providerIndexes,a=e.data,s=1048575&o,u=t.directiveStart,c=o>>20,l=i?s+c:t.directiveEnd;for(let h=r?s:s+c;h<l;h++){const t=a[h];if(h<u&&n===t||h>=u&&t.type===n)return h}if(i){const t=a[u];if(t&&Me(t)&&t.type===n)return u}return null}function Yn(t,e,n,r){let i=t[n];const o=e.data;if(i instanceof Mn){const a=i;if(a.resolving)throw new Error("Circular dep for "+In(o[n]));const s=Bn(a.canSeeViewProviders);let u;a.resolving=!0,a.injectImpl&&(u=Vt(a.injectImpl)),sn(t,r);try{i=t[n]=a.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const r=Te(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{a.injectImpl&&Vt(u),Bn(s),a.resolving=!1,pn()}}return i}function Xn(t,e,n){const r=64&t,i=32&t;let o;return o=128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e],!!(o&1<<t)}function Jn(t,e){return!(t&it.Self||t&it.Host&&e)}class Qn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return qn(this._tNode,this._lView,t,void 0,e)}}function Kn(t){const e=t;if(_t(t))return()=>{const t=Kn(wt(e));return t?t():null};let n=ge(e);if(null===n){const t=ht(e);n=t&&t.factory}return n||null}function tr(t){return Q(()=>{const e=t.prototype.constructor,n=e[Lt]||Kn(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const t=i[Lt]||Kn(i);if(t&&t!==n)return t;i=Object.getPrototypeOf(i)}return t=>new t})}function er(t){return t.ngDebugContext}function nr(t){return t.ngOriginalError}function rr(t,...e){t.error(...e)}class ir{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||rr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?er(t)?er(t):this._findContext(nr(t)):null}_findOriginalError(t){let e=nr(t);for(;e&&nr(e);)e=nr(e);return e}}class or{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}function ar(t){return t instanceof or?t.changingThisBreaksApplicationSecurity:t}let sr=!0,ur=!1;function cr(){return ur=!0,sr}const lr=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,hr=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var pr=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function fr(t){const e=function(){const t=Ze();return t&&t[12]}();return e?e.sanitize(pr.URL,t)||"":function(t,e){const n=function(t){return t instanceof or&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see http://g.co/ng/security#xss)`)}return n===e}(t,"URL")?ar(t):(n=Ln(t),(n=String(n)).match(lr)||n.match(hr)?n:(cr()&&console.warn(`WARNING: sanitizing unsafe URL value ${n} (see http://g.co/ng/security#xss)`),"unsafe:"+n));var n}function dr(t,e){t.__ngContext__=e}function mr(t){throw new Error("Multiple components match node with tagname "+t.tagName)}function gr(){throw new Error("Cannot mix multi providers and regular providers")}function yr(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}function vr(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==yr(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function xr(t){return 0===t.type&&"ng-template"!==t.tagName}function br(t,e,n){return e===(0!==t.type||n?t.tagName:"ng-template")}function wr(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(En(t[e]))return e;return t.length}(i);let a=!1;for(let s=0;s<e.length;s++){const u=e[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!br(t,u,n)||""===u&&1===e.length){if(_r(r))return!1;a=!0}}else{const c=8&r?u:e[++s];if(8&r&&null!==t.attrs){if(!vr(t.attrs,c,n)){if(_r(r))return!1;a=!0}continue}const l=Mr(8&r?"class":u,i,xr(t),n);if(-1===l){if(_r(r))return!1;a=!0;continue}if(""!==c){let t;t=l>o?"":i[l+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==yr(e,c,0)||2&r&&c!==t){if(_r(r))return!1;a=!0}}}}else{if(!a&&!_r(r)&&!_r(u))return!1;if(a&&_r(u))continue;a=!1,r=u|1&r}}return _r(r)||a}function _r(t){return 0==(1&t)}function Mr(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Sr(t,e,n=!1){for(let r=0;r<e.length;r++)if(wr(t,e[r],n))return!0;return!1}function Er(t,e){return t?":not("+e.trim()+")":e}function Nr(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&r){const e=t[++n];i+="["+a+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""===i||_r(a)||(e+=Er(o,i),i=""),r=a,o=o||!_r(r);n++}return""!==i&&(e+=Er(o,i)),e}const Tr={};function Ar(t){const e=t[3];return xe(e)?e[3]:e}function Cr(t){return Rr(t[13])}function Or(t){return Rr(t[4])}function Rr(t){for(;null!==t&&!xe(t);)t=t[4];return t}function Pr(t){Lr($e(),Ze(),dn()+t,Ke())}function Lr(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&vn(e,r,n)}else{const r=t.preOrderHooks;null!==r&&xn(e,r,0,n)}mn(n)}function Ir(t,e){return t<<17|e<<2}function Dr(t){return t>>17&32767}function kr(t){return 2|t}function zr(t){return(131068&t)>>2}function Br(t,e){return-131069&t|e<<2}function Ur(t){return 1|t}function Fr(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=t.data[o];an(i),n.contentQueries(2,e[o],o)}}}function jr(t,e,n){return Pe(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Hr(t,e,n,r,i,o,a,s,u,c){const l=e.blueprint.slice();return l[0]=i,l[2]=140|r,Ve(l),l[3]=l[15]=t,l[8]=n,l[10]=a||t&&t[10],l[11]=s||t&&t[11],l[12]=u||t&&t[12]||null,l[9]=c||t&&t[9]||null,l[6]=o,l[16]=2==e.type?t[16]:l,l}function Vr(t,e,n,r,i,o){const a=n+20,s=t.data[a]||function(t,e,n,r,i,o){const a=Xe(),s=Qe(),u=s?a:a&&a.parent,c=t.data[n]=Kr(0,u&&u!==e?u:null,r,n,i,o);return null===t.firstChild&&(t.firstChild=c),a&&(!s||null!=a.child||null===c.parent&&2!==a.type?s||(a.next=c):a.child=c),c}(t,e,a,r,i,o);return Je(s,!0),s}function Gr(t,e,n){un(e,e[6]);try{const r=t.viewQuery;null!==r&&wi(1,r,n);const i=t.template;null!==i&&Zr(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Fr(t,e),t.staticViewQueries&&wi(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)gi(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,fn()}}function qr(t,e,n,r){const i=e[2];if(256==(256&i))return;un(e,e[6]);const o=Ke();try{Ve(e),qe.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Zr(t,e,n,2,r);const a=3==(3&i);if(!o)if(a){const n=t.preOrderCheckHooks;null!==n&&vn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&xn(e,n,0,null),bn(e,0)}if(function(t){for(let e=Cr(t);null!==e;e=Or(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&Ge(r,1),n[2]|=1024}}}(e),function(t){for(let e=Cr(t);null!==e;e=Or(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];je(n)&&qr(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&Fr(t,e),!o)if(a){const n=t.contentCheckHooks;null!==n&&vn(e,n)}else{const n=t.contentHooks;null!==n&&xn(e,n,1),bn(e,1)}!function(t,e){try{const n=t.expandoInstructions;if(null!==n){let r=t.expandoStartIndex,i=-1,o=-1;for(let t=0;t<n.length;t++){const a=n[t];"number"==typeof a?a<=0?(o=0-a,mn(o),r+=9+n[++t],i=r):r+=a:(null!==a&&(nn(r,i),a(2,e[i])),i++)}}}finally{mn(-1)}}(t,e);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)mi(t,e[n])}(e,s);const u=t.viewQuery;if(null!==u&&wi(2,u,r),!o)if(a){const n=t.viewCheckHooks;null!==n&&vn(e,n)}else{const n=t.viewHooks;null!==n&&xn(e,n,2),bn(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Ge(e[3],-1))}finally{fn()}}function Wr(t,e,n,r){const i=e[10],o=!Ke(),a=Fe(e);try{o&&!a&&i.begin&&i.begin(),a&&Gr(t,e,r),qr(t,e,n,r)}finally{o&&!a&&i.end&&i.end()}}function Zr(t,e,n,r,i){const o=dn();try{mn(-1),2&r&&e.length>20&&Lr(t,e,0,Ke()),n(r,i)}finally{mn(o)}}function $r(t,e,n){We()&&(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Fn(n,e),dr(r,e);const a=n.initialInputs;for(let s=i;s<o;s++){const r=t.data[s],o=Me(r);o&&hi(e,n,r);const u=Yn(e,t,s,n);dr(u,e),null!==a&&pi(0,s-i,u,r,0,a),o&&(Be(n.index,e)[8]=u)}}(t,e,n,ke(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=t.expandoInstructions,a=t.firstCreatePass,s=n.index-20,u=qe.lFrame.currentDirectiveIndex;try{mn(s);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];rn(n),null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs?oi(r,i):a&&o.push(null)}}finally{mn(-1),rn(u)}}(t,e,n))}function Yr(t,e,n=ke){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],s=-1===a?n(e,t):t[a];t[i++]=s}}}function Xr(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Jr(1,-1,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Jr(t,e,n,r,i,o,a,s,u,c){const l=20+r,h=l+i,p=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Tr);return n}(l,h);return p[1]={type:t,id:e,blueprint:p,template:n,queries:null,viewQuery:s,node:null,data:p.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:c,incompleteFirstPass:!1}}function Qr(t,e,n,r){const i=Mi(e);i.push(n),t.firstCreatePass&&function(t){return t.cleanup||(t.cleanup=[])}(t).push(r,i.length-1)}function Kr(t,e,n,r,i,o){return{type:n,index:r,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function ti(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function ei(t,e,n,r,i,o,a,s){const u=ke(e,n);let c,l=e.inputs;var h;!s&&null!=l&&(c=l[r])?(Ei(t,n,c,r,i),we(e)&&function(t,e){const n=Be(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3===e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=a?a(i,e.tagName||"",r):i,Pe(o)?o.setProperty(u,r,i):Nn(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function ni(t,e,n,r){let i=!1;if(We()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const a=r[o];Sr(n,a.selectors,!1)&&(i||(i=[]),Gn(Fn(n,e),t,a.type),Me(a)?(2&n.flags&&mr(n),si(t,n),i.unshift(a)):i.push(a))}return i}(t,e,n),a=null===r?null:{"":-1};if(null!==o){let r=0;i=!0,ci(n,t.data.length,o.length);for(let t=0;t<o.length;t++){const e=o[t];e.providersResolver&&e.providersResolver(e)}ai(t,n,o.length);let s=!1,u=!1;for(let i=0;i<o.length;i++){const c=o[i];n.mergedAttrs=Tn(n.mergedAttrs,c.hostAttrs),li(t,e,c),ui(t.data.length-1,c,a),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const l=c.type.prototype;!s&&(l.ngOnChanges||l.ngOnInit||l.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index-20),s=!0),u||!l.ngOnChanges&&!l.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index-20),u=!0),ri(t,c),r+=c.hostVars}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,o=[];let a=null,s=null;for(let u=e.directiveStart;u<n;u++){const t=r[u],n=t.inputs,c=null===i||xr(e)?null:fi(n,i);o.push(c),a=ti(n,u,a),s=ti(t.outputs,u,s)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=s}(t,n),ii(t,e,r)}a&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new Error(`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,a)}return n.mergedAttrs=Tn(n.mergedAttrs,n.attrs),i}function ri(t,e){const n=t.expandoInstructions;n.push(e.hostBindings),0!==e.hostVars&&n.push(e.hostVars)}function ii(t,e,n){for(let r=0;r<n;r++)e.push(Tr),t.blueprint.push(Tr),t.data.push(null)}function oi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function ai(t,e,n){const r=20-e.index,i=t.data.length-(1048575&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(r,i,n)}function si(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function ui(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Me(e)&&(n[""]=t)}}function ci(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function li(t,e,n){t.data.push(n);const r=n.factory||(n.factory=ge(n.type)),i=new Mn(r,Me(n),null);t.blueprint.push(i),e.push(i)}function hi(t,e,n){const r=ke(e,t),i=Xr(n),o=t[10],a=yi(t,Hr(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n)));t[e.index]=a}function pi(t,e,n,r,i,o){const a=o[e];if(null!==a){const t=r.setInput;for(let e=0;e<a.length;){const i=a[e++],o=a[e++],s=a[e++];null!==t?r.setInput(n,s,i,o):n[o]=s}}}function fi(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function di(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function mi(t,e){const n=Be(e,t);if(je(n)){const t=n[1];80&n[2]?qr(t,n,t.template,n[8]):n[5]>0&&function t(e){for(let r=Cr(e);null!==r;r=Or(r))for(let e=10;e<r.length;e++){const n=r[e];if(1024&n[2]){const t=n[1];qr(t,n,t.template,n[8])}else n[5]>0&&t(n)}const n=e[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Be(n[r],e);je(i)&&i[5]>0&&t(i)}}(n)}}function gi(t,e){const n=Be(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Gr(r,n,n[8])}function yi(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function vi(t){for(;t;){t[2]|=64;const e=Ar(t);if(Se(t)&&!e)return t;t=e}return null}function xi(t,e,n){const r=e[10];r.begin&&r.begin();try{qr(t,e,t.template,n)}catch(i){throw Si(e,i),i}finally{r.end&&r.end()}}function bi(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Ue(n),i=r[1];Wr(i,r,i.template,n)}}(t[8])}function wi(t,e,n){an(0),e(t,n)}const _i=(()=>Promise.resolve(null))();function Mi(t){return t[7]||(t[7]=[])}function Si(t,e){const n=t[9],r=n?n.get(ir,null):null;r&&r.handleError(e)}function Ei(t,e,n,r,i){for(let o=0;o<n.length;){const a=n[o++],s=n[o++],u=e[a],c=t.data[a];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function Ni(t,e){const n=e[3];return-1===t.index?xe(n)?n:null:n}function Ti(t,e){const n=Ni(t,e);return n?Bi(e[11],n[7]):null}function Ai(t,e,n,r,i){if(null!=r){let o,a=!1;xe(r)?o=r:ve(r)&&(a=!0,r=r[0]);const s=Ie(r);0===t&&null!==n?null==i?ki(e,n,s):Di(e,n,s,i||null):1===t&&null!==n?Di(e,n,s,i||null):2===t?function(t,e,n){const r=Bi(t,e);r&&function(t,e,n,r){Pe(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,s,a):3===t&&e.destroyNode(s),null!=o&&function(t,e,n,r,i){const o=n[7];o!==Ie(n)&&Ai(e,t,r,o,i);for(let a=10;a<n.length;a++){const i=n[a];Hi(i[1],i,t,e,r,o)}}(e,t,o,n,i)}}function Ci(t,e,n,r){const i=Ti(t.node,e);i&&Hi(t,e,e[11],n?1:2,i,r)}function Oi(t,e){const n=t[9],r=n.indexOf(e);1024&e[2]&&Ge(e[3],-1),n.splice(r,1)}function Ri(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&Oi(i,r),e>0&&(t[n-1][4]=r[4]);const o=Kt(t,10+e);Ci(r[1],r,!1,null);const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Pi(t,e){if(!(256&e[2])){const n=e[11];Pe(n)&&n.destroyNode&&Hi(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Ii(t[1],t);for(;e;){let n=null;if(ve(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)ve(e)&&Ii(e[1],e),e=Li(e,t);null===e&&(e=t),ve(e)&&Ii(e[1],e),n=e&&e[4]}e=n}}(e)}}function Li(t,e){let n;return ve(t)&&(n=t[6])&&2===n.type?Ni(n,t):t[3]===e?null:t[3]}function Ii(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof Mn)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup;if(null!==n){const t=e[7];for(let r=0;r<n.length-1;r+=2)if("string"==typeof n[r]){const i=n[r+1],o="function"==typeof i?i(e):Ie(e[i]),a=t[n[r+2]],s=n[r+3];"boolean"==typeof s?o.removeEventListener(n[r],a,s):s>=0?t[s]():t[-s].unsubscribe(),r+=2}else n[r].call(t[n[r+1]]);e[7]=null}}(t,e);const n=e[6];n&&3===n.type&&Pe(e[11])&&e[11].destroy();const r=e[17];if(null!==r&&xe(e[3])){r!==e[3]&&Oi(r,e);const n=e[19];null!==n&&n.detachView(t)}}}function Di(t,e,n,r){Pe(t)?t.insertBefore(e,n,r):e.insertBefore(n,r,!0)}function ki(t,e,n){Pe(t)?t.appendChild(e,n):e.appendChild(n)}function zi(t,e,n,r){null!==r?Di(t,e,n,r):ki(t,e,n)}function Bi(t,e){return Pe(t)?t.parentNode(e):e.parentNode}function Ui(t,e,n,r){const i=function(t,e,n){let r=e.parent;for(;null!=r&&(4===r.type||5===r.type);)r=(e=r).parent;if(null==r){const t=n[6];return 2===t.type?Ti(t,n):n[0]}if(e&&5===e.type&&4&e.flags)return ke(e,n).parentNode;if(2&r.flags){const e=t.data,n=e[e[r.index].directiveStart].encapsulation;if(n!==ie.ShadowDom&&n!==ie.Native)return null}return ke(r,n)}(t,r,e);if(null!=i){const t=e[11],o=function(t,e){if(2===t.type){const n=Ni(t,e);return null===n?null:Fi(n.indexOf(e,10)-10,n)}return 4===t.type||5===t.type?ke(t,e):null}(r.parent||e[6],e);if(Array.isArray(n))for(let e=0;e<n.length;e++)zi(t,i,n[e],o);else zi(t,i,n,o)}}function Fi(t,e){const n=10+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return function t(e,n){if(null!==n){const r=n.type;if(3===r)return ke(n,e);if(0===r)return Fi(-1,e[n.index]);if(4===r||5===r){const r=n.child;if(null!==r)return t(e,r);{const t=e[n.index];return xe(t)?Fi(-1,t):Ie(t)}}{const r=e[16],i=r[6],o=Ar(r),a=i.projection[n.projection];return null!=a?t(o,a):t(e,n.next)}}return null}(t,r)}return e[7]}function ji(t,e,n,r,i,o,a){for(;null!=n;){const s=r[n.index],u=n.type;a&&0===e&&(s&&dr(Ie(s),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(ji(t,e,n.child,r,i,o,!1),Ai(e,t,i,s,o)):1===u?Vi(t,e,r,n,i,o):Ai(e,t,i,s,o)),n=a?n.projectionNext:n.next}}function Hi(t,e,n,r,i,o){ji(n,r,t.node.child,e,i,o,!1)}function Vi(t,e,n,r,i,o){const a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(let u=0;u<s.length;u++)Ai(e,t,i,s[u],o);else ji(t,e,s,a[3],i,o,!0)}function Gi(t,e,n){Pe(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function qi(t,e,n){Pe(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}class Wi{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView;return null==t[0]?function t(e,n,r,i,o=!1){for(;null!==r;){const a=n[r.index];if(null!==a&&i.push(Ie(a)),xe(a))for(let e=10;e<a.length;e++){const n=a[e],r=n[1].firstChild;null!==r&&t(n[1],n,r,i)}const s=r.type;if(4===s||5===s)t(e,n,r.child,i);else if(1===s){const e=n[16],o=e[6].projection[r.projection];if(Array.isArray(o))i.push(...o);else{const n=Ar(e);t(n[1],n,o,i,!0)}}r=o?r.projectionNext:r.next}return i}(t[1],t,t[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Pi(this._lView[1],this._lView)}onDestroy(t){Qr(this._lView[1],this._lView,null,t)}markForCheck(){vi(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){xi(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){tn(!0);try{xi(t,e,n)}finally{tn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,Hi(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Zi extends Wi{constructor(t){super(t),this._view=t}detectChanges(){bi(this._view)}checkNoChanges(){!function(t){tn(!0);try{bi(t)}finally{tn(!1)}}(this._view)}get context(){return null}}let $i,Yi,Xi;function Ji(t,e,n){return $i||($i=class extends t{}),new $i(ke(e,n))}function Qi(t,e,n,r){return Yi||(Yi=class extends t{constructor(t,e,n){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Hr(this._declarationView,e,t,16,null,e.node);n[17]=this._declarationView[this._declarationTContainer.index];const r=this._declarationView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),Gr(e,n,t),new Wi(n)}}),0===n.type?new Yi(r,n,Ji(e,n,r)):null}function Ki(t,e,n,r){let i;Xi||(Xi=class extends t{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostView=n}get element(){return Ji(e,this._hostTNode,this._hostView)}get injector(){return new Qn(this._hostTNode,this._hostView)}get parentInjector(){const t=Vn(this._hostTNode,this._hostView),e=Pn(t,this._hostView),n=function(t,e,n){if(n.parent&&-1!==n.parent.injectorIndex){const t=n.parent.injectorIndex;let e=n.parent;for(;null!=e.parent&&t==e.parent.injectorIndex;)e=e.parent;return e}let r=Rn(t),i=e,o=e[6];for(;r>1;)i=i[15],o=i[6],r--;return o}(t,this._hostView,this._hostTNode);return Cn(t)&&null!=n?new Qn(n,e):new Qn(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;if(!i&&null==t.ngModule&&o){const t=o.get(Yt,null);t&&(i=t)}const a=t.create(o,r,void 0,i);return this.insert(a.hostView,e),a}insert(t,e){const n=t._lView,r=n[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),xe(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Xi(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e);return function(t,e,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-10?(e[4]=n[i],Qt(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const s=e[19];null!==s&&s.insertView(t),e[2]|=128}(r,n,this._lContainer,i),Ci(r,n,!0,Fi(i,this._lContainer)),t.attachToViewContainerRef(this),Qt(this._lContainer[8],i,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1);!function(t,e){const n=Ri(t,e);n&&Pi(n[1],n)}(this._lContainer,e),Kt(this._lContainer[8],e)}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),n=Ri(this._lContainer,e);return n&&null!=Kt(this._lContainer[8],e)?new Wi(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const o=r[n.index];if(xe(o))i=o;else{let t;if(4===n.type)t=Ie(o);else if(t=r[11].createComment(""),Se(r)){const e=r[11],i=ke(n,r);Di(e,Bi(e,i),t,function(t,e){return Pe(t)?t.nextSibling(e):e.nextSibling}(e,i))}else Ui(r[1],r,t,n);r[n.index]=i=di(o,r,t,n),yi(r,i)}return new Xi(i,n,r)}let to=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>eo(),t})();const eo=function(t=!1){return function(t,e,n){if(!n&&we(t)){const n=Be(t.index,e);return new Wi(n,n)}return 3===t.type||0===t.type||4===t.type||5===t.type?new Wi(e[16],e):null}(Xe(),Ze(),t)},no=Function,ro=new Dt("Set Injector scope."),io={},oo={},ao=[];let so=void 0;function uo(){return void 0===so&&(so=new $t),so}function co(t,e=null,n=null,r){return new lo(t,n,e||uo(),r)}class lo{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&Jt(e,n=>this.processProvider(n,t,e)),Jt([t],t=>this.processInjectorType(t,[],i)),this.records.set(kt,fo(void 0,this));const o=this.records.get(ro);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:yt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=zt,n=it.Default){this.assertNotDestroyed();const r=Ht(this);try{if(!(n&it.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof Dt)&&ct(t);e=n&&this.injectableDefInScope(n)?fo(ho(t),io):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&it.Self?uo():this.parent).get(t,e=n&it.Optional&&e===zt?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(yt(t)),r)throw o;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=yt(e);if(Array.isArray(e))i=e.map(yt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):yt(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Bt,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{Ht(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(yt(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=wt(t)))return!1;let r=ht(t);const i=null==r&&t.ngModule||void 0,o=void 0===i?t:i,a=-1!==n.indexOf(o);if(void 0!==i&&(r=ht(i)),null==r)return!1;if(null!=r.imports&&!a){let t;n.push(o);try{Jt(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];Jt(r,t=>this.processProvider(t,n,r||ao))}}this.injectorDefTypes.add(o),this.records.set(o,fo(r.factory,io));const s=r.providers;if(null!=s&&!a){const e=t;Jt(s,t=>this.processProvider(t,e,s))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=go(t=wt(t))?t:wt(t&&t.provide);const i=function(t,e,n){return mo(t)?fo(void 0,t.useValue):fo(po(t,e,n),io)}(t,e,n);if(go(t)||!0!==t.multi){const t=this.records.get(r);t&&void 0!==t.multi&&gr()}else{let e=this.records.get(r);e?void 0===e.multi&&gr():(e=fo(void 0,io,!0),e.factory=()=>Zt(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===oo?function(t){throw new Error("Cannot instantiate cyclic dependency! "+t)}(yt(t)):e.value===io&&(e.value=oo,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function ho(t){const e=ct(t),n=null!==e?e.factory:ge(t);if(null!==n)return n;const r=ht(t);if(null!==r)return r.factory;if(t instanceof Dt)throw new Error(`Token ${yt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=function(t,e){const n=[];for(let r=0;r<t;r++)n.push("?");return n}(e);throw new Error(`Can't resolve all parameters for ${yt(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[pt]||t[mt]||t[dt]&&t[dt]());if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function po(t,e,n){let r=void 0;if(go(t)){const e=wt(t);return ge(e)||ho(e)}if(mo(t))r=()=>wt(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...Zt(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>qt(wt(t.useExisting));else{const i=wt(t&&(t.useClass||t.provide));if(i||function(t,e,n){let r="";throw t&&e&&(r=` - only instances of Provider and Type are allowed, got: [${e.map(t=>t==n?"?"+n+"?":"...").join(", ")}]`),new Error(`Invalid provider for the NgModule '${yt(t)}'`+r)}(e,n,t),!function(t){return!!t.deps}(t))return ge(i)||ho(i);r=()=>new i(...Zt(t.deps))}var i;return r}function fo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function mo(t){return null!==t&&"object"==typeof t&&Ut in t}function go(t){return"function"==typeof t}const yo=function(t,e,n){return function(t,e=null,n=null,r){const i=co(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let vo=(()=>{class t{static create(t,e){return Array.isArray(t)?yo(t,e,""):yo(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=zt,t.NULL=new $t,t.\u0275prov=st({token:t,providedIn:"any",factory:()=>qt(kt)}),t.__NG_ELEMENT_ID__=-1,t})();const xo=new Dt("AnalyzeForEntryComponents");function bo(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let a=0;a<e.length;a++){const t=e[a];"number"==typeof t?o=t:1==o?i=vt(i,t):2==o&&(r=vt(r,t+": "+e[++a]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}let wo=null;function _o(){if(!wo){const t=Tt.Symbol;if(t&&t.iterator)wo=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(wo=n)}}}return wo}function Mo(t){return!!So(t)&&(Array.isArray(t)||!(t instanceof Map)&&_o()in t)}function So(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Eo(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function No(t,e,n,r){return Eo(t,en(),n)?e+Ln(n)+r:Tr}function To(t,e,n,r,i,o,a,s){const u=Ze(),c=$e(),l=t+20,h=c.firstCreatePass?function(t,e,n,r,i,o,a,s,u){const c=e.consts,l=Vr(e,n[6],t,0,a||null,He(c,s));ni(e,n,l,He(c,u)),yn(e,l);const h=l.tViews=Jr(2,-1,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c),p=Kr(0,null,2,-1,null,null);return p.injectorIndex=l.injectorIndex,h.node=p,null!==e.queries&&(e.queries.template(e,l),h.queries=e.queries.embeddedTView(l)),l}(t,c,u,e,n,r,i,o,a):c.data[l];Je(h,!1);const p=u[11].createComment("");Ui(c,u,p,h),dr(p,u),yi(u,u[l]=di(p,u,p,h)),_e(h)&&$r(c,u,h),null!=a&&Yr(u,h,s)}function Ao(t,e=it.Default){const n=Ze();return null==n?qt(t,e):qn(Xe(),n,wt(t),e)}function Co(t,e,n){const r=Ze();return Eo(r,en(),e)&&ei($e(),gn(),r,t,e,r[11],n,!1),Co}function Oo(t,e,n,r,i){const o=i?"class":"style";Ei(t,n,e.inputs[o],o,r)}function Ro(t,e,n,r){const i=Ze(),o=$e(),a=20+t,s=i[11],u=i[a]=jr(e,s,qe.lFrame.currentNamespace),c=o.firstCreatePass?function(t,e,n,r,i,o,a){const s=e.consts,u=He(s,o),c=Vr(e,n[6],t,3,i,u);return ni(e,n,c,He(s,a)),null!==c.attrs&&bo(c,c.attrs,!1),null!==c.mergedAttrs&&bo(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(t,o,i,0,e,n,r):o.data[a];Je(c,!0);const l=c.mergedAttrs;null!==l&&Sn(s,u,l);const h=c.classes;null!==h&&qi(s,u,h);const p=c.styles;null!==p&&Gi(s,u,p),Ui(o,i,u,c),0===qe.lFrame.elementDepthCount&&dr(u,i),qe.lFrame.elementDepthCount++,_e(c)&&($r(o,i,c),function(t,e,n){if(be(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}(o,c,i)),null!==r&&Yr(i,c)}function Po(){let t=Xe();Qe()?qe.lFrame.isParent=!1:(t=t.parent,Je(t,!1));const e=t;qe.lFrame.elementDepthCount--;const n=$e();n.firstCreatePass&&(yn(n,t),be(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Oo(n,e,Ze(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Oo(n,e,Ze(),e.stylesWithoutHost,!1)}function Lo(t,e,n,r){Ro(t,e,n,r),Po()}function Io(){return Ze()}function Do(t){return!!t&&"function"==typeof t.then}function ko(t){return!!t&&"function"==typeof t.subscribe}function zo(t,e,n=!1,r){const i=Ze(),o=$e(),a=Xe();return function(t,e,n,r,i,o,a=!1,s){const u=_e(r),c=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),l=Mi(e);let h=!0;if(3===r.type){const p=ke(r,e),f=s?s(p):oe,d=f.target||p,m=l.length,g=s?t=>s(Ie(t[r.index])).target:r.index;if(Pe(n)){let a=null;if(!s&&u&&(a=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const t=i[o];if(t===n&&i[o+1]===r){const t=e[7],n=i[o+2];return t.length>n?t[n]:null}"string"==typeof t&&(o+=2)}return null}(t,e,i,r.index)),null!==a)(a.__ngLastListenerFn__||a).__ngNextListenerFn__=o,a.__ngLastListenerFn__=o,h=!1;else{o=Uo(r,e,o,!1);const t=n.listen(f.name||d,i,o);l.push(o,t),c&&c.push(i,g,m,m+1)}}else o=Uo(r,e,o,!0),d.addEventListener(i,o,a),l.push(o),c&&c.push(i,g,m,a)}const p=r.outputs;let f;if(h&&null!==p&&(f=p[i])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(o),a=l.length;l.push(o,t),c&&c.push(i,r.index,a,-(a+1))}}}(o,i,i[11],a,t,e,n,r),zo}function Bo(t,e,n){try{return!1!==e(n)}catch(r){return Si(t,r),!1}}function Uo(t,e,n,r){return function i(o){if(o===Function)return n;const a=2&t.flags?Be(t.index,e):e;0==(32&e[2])&&vi(a);let s=Bo(e,n,o),u=i.__ngNextListenerFn__;for(;u;)s=Bo(e,u,o)&&s,u=u.__ngNextListenerFn__;return r&&!1===s&&(o.preventDefault(),o.returnValue=!1),s}}function Fo(t=1){return function(t){return(qe.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,qe.lFrame.contextLView))[8]}(t)}function jo(t,e,n,r,i){const o=Ze(),a=No(o,e,n,r);return a!==Tr&&ei($e(),gn(),o,t,a,o[11],i,!1),jo}const Ho=[];function Vo(t,e,n,r,i){const o=t[n+1],a=null===e;let s=r?Dr(o):zr(o),u=!1;for(;0!==s&&(!1===u||a);){const n=t[s+1];Go(t[s],e)&&(u=!0,t[s+1]=r?Ur(n):kr(n)),s=r?Dr(n):zr(n)}u&&(t[n+1]=r?kr(o):Ur(o))}function Go(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ne(t,e)>=0}function qo(t,e){return function(t,e,n,r){const i=Ze(),o=$e(),a=function(t){const e=qe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+2,n}();o.firstUpdatePass&&function(t,e,n,r){const i=t.data;if(null===i[n+1]){const r=i[dn()+20],o=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(16&t.flags)})(r)&&null===e&&!o&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=qe.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let o=e.residualClasses;if(null===i)0===e.classBindings&&(n=Zo(n=Wo(null,t,e,n,!0),e.attrs,!0),o=null);else{const r=e.directiveStylingLast;if(-1===r||t[r]!==i)if(n=Wo(i,t,e,n,!0),null===o){let n=function(t,e,n){const r=e.classBindings;if(0!==zr(r))return t[Dr(r)]}(t,e);void 0!==n&&Array.isArray(n)&&(n=Wo(null,t,e,n[1],!0),n=Zo(n,e.attrs,!0),function(t,e,n,r){t[Dr(e.classBindings)]=r}(t,e,0,n))}else o=function(t,e,n){let r=void 0;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=Zo(r,t[o].hostAttrs,!0);return Zo(r,e.attrs,!0)}(t,e)}return void 0!==o&&(e.residualClasses=o),n}(i,r,e),function(t,e,n,r,i,o){let a=e.classBindings,s=Dr(a),u=zr(a);t[r]=n;let c,l=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||ne(t,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){const e=Dr(t[s+1]);t[r+1]=Ir(e,s),0!==e&&(t[e+1]=Br(t[e+1],r)),t[s+1]=131071&t[s+1]|r<<17}else t[r+1]=Ir(s,0),0!==s&&(t[s+1]=Br(t[s+1],r)),s=r;else t[r+1]=Ir(u,0),0===s?s=r:t[u+1]=Br(t[u+1],r),u=r;l&&(t[r+1]=kr(t[r+1])),Vo(t,c,r,!0),Vo(t,c,r,!1),function(t,e,n,r,i){const o=t.residualClasses;null!=o&&"string"==typeof e&&ne(o,e)>=0&&(n[r+1]=Ur(n[r+1]))}(e,c,t,r),a=Ir(s,u),e.classBindings=a}(i,r,e,n,o)}}(o,t,a),e!==Tr&&Eo(i,a,e)&&function(t,e,n,r,i,o,a,s){if(3!==e.type)return;const u=t.data,c=u[s+1];Yo(1==(1&c)?$o(u,e,n,i,zr(c),!0):void 0)||(Yo(o)||function(t){return 2==(2&t)}(c)&&(o=$o(u,null,n,i,s,!0)),function(t,e,n,r,i){const o=Pe(t);i?o?t.addClass(n,r):n.classList.add(r):o?t.removeClass(n,r):n.classList.remove(r)}(r,0,De(dn(),n),i,o))}(o,o.data[dn()+20],i,i[11],t,i[a+1]=function(t,e){return null==t||"object"==typeof t&&(t=yt(ar(t))),t}(e),0,a)}(t,e),qo}function Wo(t,e,n,r,i){let o=null;const a=n.directiveEnd;let s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<a&&(o=e[s],r=Zo(r,o.hostAttrs,i),o!==t);)s++;return null!==t&&(n.directiveStylingLast=s),r}function Zo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),te(t,a,!!n||e[++o]))}return void 0===t?null:t}function $o(t,e,n,r,i,o){const a=null===e;let s=void 0;for(;i>0;){const e=t[i],o=Array.isArray(e),u=o?e[1]:e,c=null===u;let l=n[i+1];l===Tr&&(l=c?Ho:void 0);let h=c?ee(l,r):u===r?l:void 0;if(o&&!Yo(h)&&(h=ee(e,r)),Yo(h)&&(s=h,a))return s;const p=t[i+1];i=a?Dr(p):zr(p)}if(null!==e){let t=o?e.residualClasses:e.residualStyles;null!=t&&(s=ee(t,r))}return s}function Yo(t){return void 0!==t}function Xo(t,e=""){const n=Ze(),r=$e(),i=t+20,o=r.firstCreatePass?Vr(r,n[6],t,3,null,null):r.data[i],a=n[i]=function(t,e){return Pe(e)?e.createText(t):e.createTextNode(t)}(e,n[11]);Ui(r,n,a,o),Je(o,!1)}function Jo(t){return Qo("",t,""),Jo}function Qo(t,e,n){const r=Ze(),i=No(r,t,e,n);return i!==Tr&&function(t,e,n){const r=De(e,t),i=t[11];Pe(i)?i.setValue(r,n):r.textContent=n}(r,dn(),i),Qo}function Ko(t,e){const n=Ue(t)[1],r=n.data.length-1;yn(n,{directiveStart:r,directiveEnd:r+1})}function ta(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i=void 0;if(Me(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=ea(t.inputs),e.declaredInputs=ea(t.declaredInputs),e.outputs=ea(t.outputs);const n=i.hostBindings;n&&ia(t,n);const o=i.viewQuery,a=i.contentQueries;if(o&&na(t,o),a&&ra(t,a),at(t.inputs,i.inputs),at(t.declaredInputs,i.declaredInputs),at(t.outputs,i.outputs),Me(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===ta&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Tn(i.hostAttrs,n=Tn(n,i.hostAttrs))}}(r)}function ea(t){return t===oe?{}:t===ae?[]:t}function na(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function ra(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function ia(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}function oa(t,e,n,r,i){if(t=wt(t),Array.isArray(t))for(let o=0;o<t.length;o++)oa(t[o],e,n,r,i);else{const o=$e(),a=Ze();let s=go(t)?t:wt(t.provide),u=po(t);const c=Xe(),l=1048575&c.providerIndexes,h=c.directiveStart,p=c.providerIndexes>>20;if(go(t)||!t.multi){const r=new Mn(u,i,Ao),f=ua(s,e,i?l:l+p,h);-1===f?(Gn(Fn(c,a),o,s),aa(o,t,e.length),e.push(s),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),a.push(r)):(n[f]=r,a[f]=r)}else{const f=ua(s,e,l+p,h),d=ua(s,e,l,l+p),m=f>=0&&n[f],g=d>=0&&n[d];if(i&&!g||!i&&!m){Gn(Fn(c,a),o,s);const l=function(t,e,n,r,i){const o=new Mn(t,n,Ao);return o.multi=[],o.index=e,o.componentProviders=0,sa(o,i,r&&!n),o}(i?la:ca,n.length,i,r,u);!i&&g&&(n[d].providerFactory=l),aa(o,t,e.length,0),e.push(s),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(l),a.push(l)}else aa(o,t,f>-1?f:d,sa(n[i?d:f],u,!i&&r));!i&&r&&g&&n[d].componentProviders++}}}function aa(t,e,n,r){const i=go(e);if(i||e.useClass){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const t=a.indexOf(n);-1===t?a.push(n,[r,o]):a[t+1].push(r,o)}else a.push(n,o)}}}function sa(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function ua(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function ca(t,e,n,r){return ha(this.multi,[])}function la(t,e,n,r){const i=this.multi;let o;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Yn(n,n[1],this.providerFactory.index,r);o=e.slice(0,t),ha(i,o);for(let n=t;n<e.length;n++)o.push(e[n])}else o=[],ha(i,o);return o}function ha(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function pa(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=$e();if(r.firstCreatePass){const i=Me(t);oa(n,r.data,r.blueprint,i,!0),oa(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}class fa{}class da{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${yt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let ma=(()=>{class t{}return t.NULL=new da,t})(),ga=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>ya(t),t})();const ya=function(t){return Ji(t,Xe(),Ze())};class va{}var xa=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});let ba=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>wa(),t})();const wa=function(){const t=Ze(),e=Be(Xe().index,t);return function(t){const e=t[11];if(Pe(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(ve(e)?e:t)};let _a=(()=>{class t{}return t.\u0275prov=st({token:t,providedIn:"root",factory:()=>null}),t})();class Ma{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Sa=new Ma("10.0.5");class Ea{constructor(){}supports(t){return Mo(t)}create(t){return new Ta(t)}}const Na=(t,e)=>e;class Ta{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Na}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<Ra(n,r,i)?e:n,a=Ra(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=a-r,e=s-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}a!==s&&t(o,a,s)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Mo(t))throw new Error(`Error trying to diff '${yt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[_o()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),Object.is(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Aa(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Oa),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Oa),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Aa{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ca{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Oa{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Ca,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ra(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Pa{constructor(){}supports(t){return t instanceof Map||So(t)}create(){return new La}}class La{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||So(t)))throw new Error(`Error trying to diff '${yt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Ia(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Ia{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let Da=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new rt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=st({token:t,providedIn:"root",factory:()=>new t([new Ea])}),t})(),ka=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new rt,new et]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=st({token:t,providedIn:"root",factory:()=>new t([new Pa])}),t})();const za=[new Pa],Ba=new Da([new Ea]),Ua=new ka(za);let Fa=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ja(t,ga),t})();const ja=function(t,e){return Qi(t,e,Xe(),Ze())};let Ha=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Va(t,ga),t})();const Va=function(t,e){return Ki(t,e,Xe(),Ze())},Ga={};class qa extends ma{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=me(t);return new $a(e,this.ngModule)}}function Wa(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Za=new Dt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Dn});class $a extends fa{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(Nr).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Wa(this.componentDef.inputs)}get outputs(){return Wa(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,Ga,i);return o!==Ga||r===Ga?o:e.get(n,r,i)}}}(t,r.injector):t,o=i.get(va,Le),a=i.get(_a,null),s=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(Pe(t))return t.selectRootElement(e,n===ie.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(s,n,this.componentDef.encapsulation):jr(u,o.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),l=this.componentDef.onPush?576:528,h={components:[],scheduler:Dn,clean:_i,playerHandler:null,flags:0},p=Jr(0,-1,null,1,0,null,null,null,null,null),f=Hr(null,p,h,l,null,null,o,s,a,i);let d,m;un(f,null);try{const t=function(t,e,n,r,i,o){const a=n[1];n[20]=t;const s=Vr(a,null,0,3,null,null),u=s.mergedAttrs=e.hostAttrs;null!==u&&(bo(s,u,!0),null!==t&&(Sn(i,t,u),null!==s.classes&&qi(i,t,s.classes),null!==s.styles&&Gi(i,t,s.styles)));const c=r.createRenderer(t,e),l=Hr(n,Xr(e),null,e.onPush?64:16,n[20],s,r,c,void 0);return a.firstCreatePass&&(Gn(Fn(s,n),a,e.type),si(a,s),ci(s,n.length,1)),yi(n,l),n[20]=l}(c,this.componentDef,f,o,s);if(c)if(n)Sn(s,c,["ng-version",Sa.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!_r(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&Sn(s,c,t),e&&e.length>0&&qi(s,c,e.join(" "))}if(m=ze(p,0),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}d=function(t,e,n,r,i){const o=n[1],a=function(t,e,n){const r=Xe();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),ai(t,r,1),li(t,e,n));const i=Yn(e,t,e.length-1,r);dr(i,e);const o=ke(r,e);return o&&dr(o,e),i}(o,n,e);r.components.push(a),t[8]=a,i&&i.forEach(t=>t(a,e)),e.contentQueries&&e.contentQueries(1,a,n.length-1);const s=Xe();if(o.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){mn(s.index-20);const t=n[1];ri(t,e),ii(t,n,e.hostVars),oi(e,a)}return a}(t,this.componentDef,f,h,[Ko]),Gr(p,f,null)}finally{fn()}const g=new Ya(this.componentType,d,Ji(ga,m,f),f,m);return p.node.child=m,g}}class Ya extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new Zi(r),function(t,e,n,r){let i=t.node;null==i&&(t.node=i=Kr(0,null,2,-1,null,null)),r[6]=i}(r[1],0,0,r),this.componentType=t}get injector(){return new Qn(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}var Xa=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Ja={};function Qa(t){return t in Ja||(Ja[t]=Tt.ng&&Tt.ng.common&&Tt.ng.common.locales&&Tt.ng.common.locales[t]),Ja[t]}var Ka=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});let ts="en-US";function es(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(ts=t.toLowerCase().replace(/_/g,"-"))}const ns=new Map;class rs extends Yt{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new qa(this);const n=ye(t),r=t[Pt]||null;r&&es(r),this._bootstrapComponents=kn(n.bootstrap),this._r3Injector=co(t,e,[{provide:Yt,useValue:this},{provide:ma,useValue:this.componentFactoryResolver}],yt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=vo.THROW_IF_NOT_FOUND,n=it.Default){return t===vo||t===Yt||t===kt?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class is extends Xt{constructor(t){super(),this.moduleType=t,null!==ye(t)&&function t(e){if(null!==e.\u0275mod.id){const t=e.\u0275mod.id;(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${yt(e)} vs ${yt(e.name)}`)})(t,ns.get(t),e),ns.set(t,e)}let n=e.\u0275mod.imports;n instanceof Function&&(n=n()),n&&n.forEach(e=>t(e))}(t)}create(t){return new rs(this.moduleType,t)}}const os=class extends M{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const a=super.subscribe(r,i,o);return t instanceof h&&t.add(a),a}};function as(){return this._results[_o()]()}class ss{constructor(){this.dirty=!0,this._results=[],this.changes=new os,this.length=0;const t=_o(),e=ss.prototype;e[t]||(e[t]=as)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class us{constructor(t){this.queryList=t,this.matches=null}clone(){return new us(this.queryList)}setDirty(){this.queryList.setDirty()}}class cs{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new cs(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==xs(t,e).matches&&this.queries[e].setDirty()}}class ls{constructor(t,e,n,r=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=r}}class hs{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new hs(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class ps{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new ps(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&4===n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){if(Array.isArray(this.metadata.predicate)){const n=this.metadata.predicate;for(let r=0;r<n.length;r++)this.matchTNodeWithReadOption(t,e,fs(e,n[r]))}else{const n=this.metadata.predicate;n===Fa?0===e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,$n(e,t,n,!1,!1))}}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===ga||r===Ha||r===Fa&&0===e.type)this.addMatch(e.index,-2);else{const n=$n(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function fs(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function ds(t,e,n,r){return-1===n?function(t,e){return 3===t.type||4===t.type?Ji(ga,t,e):0===t.type?Qi(Fa,ga,t,e):null}(e,t):-2===n?function(t,e,n){return n===ga?Ji(ga,e,t):n===Fa?Qi(Fa,ga,e,t):n===Ha?Ki(Ha,ga,e,t):void 0}(t,e,r):Yn(t,t[1],n,e)}function ms(t,e,n,r){const i=e[19].queries[r];if(null===i.matches){const r=t.data,o=n.matches,a=[];for(let t=0;t<o.length;t+=2){const i=o[t];a.push(i<0?null:ds(e,r[i],o[t+1],n.metadata.read))}i.matches=a}return i.matches}function gs(t){const e=Ze(),n=$e(),r=on();an(r+1);const i=xs(n,r);if(t.dirty&&Fe(e)===i.metadata.isStatic){if(null===i.matches)t.reset([]);else{const o=i.crossesNgTemplate?function t(e,n,r,i){const o=e.queries.getByIndex(r),a=o.matches;if(null!==a){const s=ms(e,n,o,r);for(let e=0;e<a.length;e+=2){const r=a[e];if(r>0)i.push(s[e/2]);else{const o=a[e+1],s=n[-r];for(let e=10;e<s.length;e++){const n=s[e];n[17]===n[3]&&t(n[1],n,o,i)}if(null!==s[9]){const e=s[9];for(let n=0;n<e.length;n++){const r=e[n];t(r[1],r,o,i)}}}}}return i}(n,e,r,[]):ms(n,e,i,r);t.reset(o),t.notifyOnChanges()}return!0}return!1}function ys(t,e,n){!function(t,e,n,r,i,o){t.firstCreatePass&&function(t,e,n){null===t.queries&&(t.queries=new hs),t.queries.track(new ps(e,-1))}(t,new ls(n,r,!1,i)),function(t,e){const n=new ss;Qr(t,e,n,n.destroy),null===e[19]&&(e[19]=new cs),e[19].queries.push(new us(n))}(t,e)}($e(),Ze(),t,e,n)}function vs(){return t=Ze(),e=on(),t[19].queries[e].queryList;var t,e}function xs(t,e){return t.queries.getByIndex(e)}const bs=new Dt("Application Initializer");let ws=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Do(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(qt(bs,8))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const _s=new Dt("AppId"),Ms={provide:_s,useFactory:function(){return`${Ss()}${Ss()}${Ss()}`},deps:[]};function Ss(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Es=new Dt("Platform Initializer"),Ns=new Dt("Platform ID"),Ts=new Dt("appBootstrapListener");let As=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const Cs=new Dt("LocaleId"),Os=new Dt("DefaultCurrencyCode");class Rs{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Ps=function(t){return new is(t)},Ls=Ps,Is=function(t){return Promise.resolve(Ps(t))},Ds=function(t){const e=Ps(t),n=kn(ye(t).declarations).reduce((t,e)=>{const n=me(e);return n&&t.push(new $a(n)),t},[]);return new Rs(e,n)},ks=Ds,zs=function(t){return Promise.resolve(Ds(t))};let Bs=(()=>{class t{constructor(){this.compileModuleSync=Ls,this.compileModuleAsync=Is,this.compileModuleAndAllComponentsSync=ks,this.compileModuleAndAllComponentsAsync=zs}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const Us=(()=>Promise.resolve(0))();function Fs(t){"undefined"==typeof Zone?Us.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class js{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new os(!1),this.onMicrotaskEmpty=new os(!1),this.onStable=new os(!1),this.onError=new os(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=Tt.requestAnimationFrame,e=Tt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Tt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,qs(t),Gs(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),qs(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,i,o,a,s)=>{try{return Ws(t),n.invokeTask(i,o,a,s)}finally{e&&"eventTask"===o.type&&e(),Zs(t)}},onInvoke:(e,n,r,i,o,a,s)=>{try{return Ws(t),e.invoke(r,i,o,a,s)}finally{Zs(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,qs(t),Gs(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!js.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(js.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,Vs,Hs,Hs);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function Hs(){}const Vs={};function Gs(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function qs(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function Ws(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Zs(t){t._nesting--,Gs(t)}class $s{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new os,this.onMicrotaskEmpty=new os,this.onStable=new os,this.onError=new os}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let Ys=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{js.assertNotInAngularZone(),Fs(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Fs(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(qt(js))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Xs=(()=>{class t{constructor(){this._applications=new Map,Ks.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return Ks.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();class Js{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Qs,Ks=new Js;const tu=new Dt("AllowMultipleToken");class eu{constructor(t,e){this.name=t,this.token=e}}function nu(t,e,n=[]){const r="Platform: "+e,i=new Dt(r);return(e=[])=>{let o=ru();if(!o||o.injector.get(tu,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:ro,useValue:"platform"});!function(t){if(Qs&&!Qs.destroyed&&!Qs.injector.get(tu,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Qs=t.get(iu);const e=t.get(Es,null);e&&e.forEach(t=>t())}(vo.create({providers:t,name:r}))}return function(t){const e=ru();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function ru(){return Qs&&!Qs.destroyed?Qs:null}let iu=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new $s:("zone.js"===t?void 0:t)||new js({enableLongStackTrace:cr(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:js,useValue:n}];return n.run(()=>{const e=vo.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(ir,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>su(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const r=n();return Do(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,n,()=>{const t=i.injector.get(ws);return t.runInitializers(),t.donePromise.then(()=>(es(i.injector.get(Cs,"en-US")||"en-US"),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=ou({},e);return function(t,e,n){const r=new is(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(au);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${yt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(qt(vo))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();function ou(t,e){return Array.isArray(e)?e.reduce(ou,t):Object.assign(Object.assign({},t),e)}let au=(()=>{class t{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=cr(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new v(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),s=new v(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{js.assertNotInAngularZone(),Fs(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{js.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return E(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof v?t[0]:V(e)(G(t,n))}(a,s.pipe(t=>{return q()((e=J,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,Y);return r.source=t,r.subjectFactory=n,r})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof fa?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(Yt),i=n.create(vo.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(Ys,null);return o&&i.injector.get(Xs).registerApplication(i.location.nativeElement,o),this._loadComponent(i),cr()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;su(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Ts,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),su(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(qt(js),qt(As),qt(vo),qt(ir),qt(ma),qt(ws))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();function su(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class uu{}class cu{}const lu={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let hu=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||lu}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>pu(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>pu(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(qt(Bs),qt(cu,8))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();function pu(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const fu=nu(null,"core",[{provide:Ns,useValue:"unknown"},{provide:iu,deps:[vo]},{provide:Xs,deps:[]},{provide:As,deps:[]}]),du=[{provide:au,useClass:au,deps:[js,As,vo,ir,ma,ws]},{provide:Za,deps:[js],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:ws,useClass:ws,deps:[[new et,bs]]},{provide:Bs,useClass:Bs,deps:[]},Ms,{provide:Da,useFactory:function(){return Ba},deps:[]},{provide:ka,useFactory:function(){return Ua},deps:[]},{provide:Cs,useFactory:function(t){return es(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new tt(Cs),new et,new rt]]},{provide:Os,useValue:"USD"}];let mu=(()=>{class t{constructor(t){}}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)(qt(au))},providers:du}),t})(),gu=null;function yu(){return gu}const vu=new Dt("DocumentToken");let xu=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({factory:bu,token:t,providedIn:"platform"}),t})();function bu(){return qt(_u)}const wu=new Dt("Location Initialized");let _u=(()=>{class t extends xu{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=yu().getLocation(),this._history=yu().getHistory()}getBaseHrefFromDOM(){return yu().getBaseHref(this._doc)}onPopState(t){yu().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){yu().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){Mu()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){Mu()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(qt(vu))},t.\u0275prov=st({factory:Su,token:t,providedIn:"platform"}),t})();function Mu(){return!!window.history.pushState}function Su(){return new _u(qt(vu))}function Eu(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Nu(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Tu(t){return t&&"?"!==t[0]?"?"+t:t}let Au=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({factory:Cu,token:t,providedIn:"root"}),t})();function Cu(t){const e=qt(vu).location;return new Ru(qt(xu),e&&e.origin||"")}const Ou=new Dt("appBaseHref");let Ru=(()=>{class t extends Au{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Eu(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Tu(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+Tu(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+Tu(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(qt(xu),qt(Ou,8))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Pu=(()=>{class t extends Au{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Eu(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+Tu(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+Tu(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(qt(xu),qt(Ou,8))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Lu=(()=>{class t{constructor(t,e){this._subject=new os,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Nu(Du(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Tu(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Du(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Tu(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Tu(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(qt(Au),qt(xu))},t.normalizeQueryParams=Tu,t.joinWithSlash=Eu,t.stripTrailingSlash=Nu,t.\u0275prov=st({factory:Iu,token:t,providedIn:"root"}),t})();function Iu(){return new Lu(qt(Au),qt(xu))}function Du(t){return t.replace(/\/index.html$/,"")}var ku=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});class zu{}let Bu=(()=>{class t extends zu{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Qa(e);if(n)return n;const r=e.split("-")[0];if(n=Qa(r),n)return n;if("en"===r)return Xa;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Ka.PluralCase]}(e||this.locale)(t)){case ku.Zero:return"zero";case ku.One:return"one";case ku.Two:return"two";case ku.Few:return"few";case ku.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(qt(Cs))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();class Uu{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Fu=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){cr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Uu(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new ju(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new ju(t,i);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ao(Ha),Ao(Fa),Ao(Da))},t.\u0275dir=de({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class ju{constructor(t,e){this.record=t,this.view=e}}let Hu=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new Vu,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Gu("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Gu("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ao(Ha),Ao(Fa))},t.\u0275dir=de({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Vu{constructor(){this.$implicit=null,this.ngIf=null}}function Gu(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${yt(e)}'.`)}let qu=(()=>{class t{}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)},providers:[{provide:zu,useClass:Bu}]}),t})(),Wu=(()=>{class t{}return t.\u0275prov=st({token:t,providedIn:"root",factory:()=>new Zu(qt(vu),window,qt(ir))}),t})();class Zu{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector("#"+t);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}class $u extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new $u,gu||(gu=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=Xu||(Xu=document.querySelector("base"),Xu)?Xu.getAttribute("href"):null;return null==e?null:(n=e,Yu||(Yu=document.createElement("a")),Yu.setAttribute("href",n),"/"===Yu.pathname.charAt(0)?Yu.pathname:"/"+Yu.pathname);var n}resetBaseElement(){Xu=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}}let Yu,Xu=null;const Ju=new Dt("TRANSITION_ID"),Qu=[{provide:bs,useFactory:function(t,e,n){return()=>{n.get(ws).donePromise.then(()=>{const n=yu();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Ju,vu,vo],multi:!0}];class Ku{static init(){var t;t=new Ku,Ks=t}addToWindow(t){Tt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Tt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Tt.getAllAngularRootElements=()=>t.getAllRootElements(),Tt.frameworkStabilizers||(Tt.frameworkStabilizers=[]),Tt.frameworkStabilizers.push(t=>{const e=Tt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach((function(t){t.whenStable(i)}))})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?yu().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const tc=new Dt("EventManagerPlugins");let ec=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(qt(tc),qt(js))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();class nc{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=yu().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let rc=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),ic=(()=>{class t extends rc{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>yu().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(qt(vu))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const oc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ac=/%COMP%/g;function sc(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?sc(t,i,n):(i=i.replace(ac,t),n.push(i))}return n}function uc(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let cc=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new lc(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case ie.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new hc(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case ie.Native:case ie.ShadowDom:return new pc(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=sc(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(qt(ec),qt(ic),qt(_s))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();class lc{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(oc[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=oc[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=oc[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&xa.DashCase?t.style.setProperty(e,n,r&xa.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&xa.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,uc(n)):this.eventManager.addEventListener(t,e,uc(n))}}class hc extends lc{constructor(t,e,n,r){super(t),this.component=n;const i=sc(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(ac,r+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(ac,t)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class pc extends lc{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===ie.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=sc(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let fc=(()=>{class t extends nc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(qt(vu))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const dc=["alt","control","meta","shift"],mc={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},yc={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let vc=(()=>{class t extends nc{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yu().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let o="";if(dc.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&gc.hasOwnProperty(e)&&(e=gc[e]))}return mc[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),dc.forEach(r=>{r!=n&&(0,yc[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(qt(vu))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const xc=nu(fu,"browser",[{provide:Ns,useValue:"browser"},{provide:Es,useValue:function(){$u.makeCurrent(),Ku.init()},multi:!0},{provide:vu,useFactory:function(){return function(t){Re=t}(document),document},deps:[]}]),bc=[[],{provide:ro,useValue:"root"},{provide:ir,useFactory:function(){return new ir},deps:[]},{provide:tc,useClass:fc,multi:!0,deps:[vu,js,Ns]},{provide:tc,useClass:vc,multi:!0,deps:[vu]},[],{provide:cc,useClass:cc,deps:[ec,ic,_s]},{provide:va,useExisting:cc},{provide:rc,useExisting:ic},{provide:ic,useClass:ic,deps:[vu]},{provide:Ys,useClass:Ys,deps:[js]},{provide:ec,useClass:ec,deps:[tc,js]},[]];let wc=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:_s,useValue:e.appId},{provide:Ju,useExisting:_s},Qu]}}}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)(qt(t,12))},providers:bc,imports:[qu,mu]}),t})();function _c(t,e){return new v(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,a=0;for(let s=0;s<r;s++){const u=U(t[s]);let c=!1;n.add(u.subscribe({next:t=>{c||(c=!0,a++),i[s]=t},error:t=>n.error(t),complete:()=>{o++,o!==r&&c||(a===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}"undefined"!=typeof window&&window;const Mc=new Dt("NgValueAccessor"),Sc={provide:Mc,useExisting:bt(()=>Ec),multi:!0};let Ec=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga))},t.\u0275dir=de({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&zo("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[pa([Sc])]}),t})();const Nc={provide:Mc,useExisting:bt(()=>Ac),multi:!0},Tc=new Dt("CompositionEventMode");let Ac=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=yu()?yu().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga),Ao(Tc,8))},t.\u0275dir=de({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&zo("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[pa([Nc])]}),t})(),Cc=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=de({type:t}),t})(),Oc=(()=>{class t extends Cc{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Rc(e||t)},t.\u0275dir=de({type:t,features:[ta]}),t})();const Rc=tr(Oc);function Pc(){throw new Error("unimplemented")}class Lc extends Cc{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Pc()}get asyncValidator(){return Pc()}}let Ic=(()=>{class t extends class{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(Ao(Lc,2))},t.\u0275dir=de({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&qo("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[ta]}),t})();function Dc(t){return null==t||0===t.length}function kc(t){return null!=t&&"number"==typeof t.length}const zc=new Dt("NgValidators"),Bc=new Dt("NgAsyncValidators"),Uc=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Fc{static min(t){return e=>{if(Dc(e.value)||Dc(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Dc(e.value)||Dc(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Dc(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Dc(t.value)||Uc.test(t.value)?null:{email:!0}}static minLength(t){return e=>Dc(e.value)||!kc(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>kc(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return Fc.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Dc(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(jc);return 0==e.length?null:function(t){return Vc(function(t,e){return e.map(e=>e(t))}(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(jc);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if(u(e))return _c(e,null);if(c(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return _c(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return _c(t=1===t.length&&u(t[0])?t[0]:t,null).pipe(D(t=>e(...t)))}return _c(t,null)}(function(t,e){return e.map(e=>e(t))}(t,e).map(Hc)).pipe(D(Vc))}}}function jc(t){return null!=t}function Hc(t){const e=Do(t)?U(t):t;if(!ko(e))throw new Error("Expected validator to return Promise or Observable.");return e}function Vc(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Gc(t){return t.validate?e=>t.validate(e):t}function qc(t){return t.validate?e=>t.validate(e):t}const Wc={provide:Mc,useExisting:bt(()=>Zc),multi:!0};let Zc=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga))},t.\u0275dir=de({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&zo("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[pa([Wc])]}),t})();const $c={provide:Mc,useExisting:bt(()=>Xc),multi:!0};let Yc=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Xc=(()=>{class t{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Lc),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga),Ao(Yc),Ao(vo))},t.\u0275dir=de({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&zo("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[pa([$c])]}),t})();const Jc={provide:Mc,useExisting:bt(()=>Qc),multi:!0};let Qc=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga))},t.\u0275dir=de({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&zo("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[pa([Jc])]}),t})();const Kc='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',tl='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',el={provide:Mc,useExisting:bt(()=>nl),multi:!0};let nl=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga))},t.\u0275dir=de({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&zo("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[pa([el])]}),t})();const rl={provide:Mc,useExisting:bt(()=>il),multi:!0};let il=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(Ao(ba),Ao(ga))},t.\u0275dir=de({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&zo("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[pa([rl])]}),t})();function ol(t,e){return[...e.path,t]}function al(t,e){t||ul(e,"Cannot find control with"),e.valueAccessor||ul(e,"No value accessor for form control with"),t.validator=Fc.compose([t.validator,e.validator]),t.asyncValidator=Fc.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&sl(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&sl(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function sl(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function ul(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function cl(t){return null!=t?Fc.compose(t.map(Gc)):null}function ll(t){return null!=t?Fc.composeAsync(t.map(qc)):null}const hl=[Ec,Qc,Zc,nl,il,Xc];function pl(t){const e=dl(t)?t.validators:t;return Array.isArray(e)?cl(e):e||null}function fl(t,e){const n=dl(e)?e.asyncValidators:t;return Array.isArray(n)?ll(n):n||null}function dl(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class ml{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=pl(t)}setAsyncValidators(t){this.asyncValidator=fl(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING";const e=Hc(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof yl?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof vl&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new os,this.statusChanges=new os}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){dl(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class gl extends ml{constructor(t=null,e,n){super(pl(e),fl(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class yl extends ml{constructor(t,e,n){super(pl(e),fl(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof gl?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class vl extends ml{constructor(t,e,n){super(pl(e),fl(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof gl?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const xl={provide:Oc,useExisting:bt(()=>wl)},bl=(()=>Promise.resolve(null))();let wl=(()=>{class t extends Oc{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new os,this.form=new yl({},cl(t),ll(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){bl.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),al(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){bl.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),function(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}(this._directives,t)})}addFormGroup(t){bl.then(()=>{const e=this._findContainer(t.path),n=new yl({});(function(t,e){null==t&&ul(e,"Cannot find control with"),t.validator=Fc.compose([t.validator,e.validator]),t.asyncValidator=Fc.composeAsync([t.asyncValidator,e.asyncValidator])})(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){bl.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){bl.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,e=this._directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(Ao(zc,10),Ao(Bc,10))},t.\u0275dir=de({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&zo("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[pa([xl]),ta]}),t})(),_l=(()=>{class t extends Oc{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return ol(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return cl(this._validators)}get asyncValidator(){return ll(this._asyncValidators)}_checkParentType(){}}return t.\u0275fac=function(e){return Ml(e||t)},t.\u0275dir=de({type:t,features:[ta]}),t})();const Ml=tr(_l);class Sl{static modelParentException(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      \n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ')}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${Kc}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${tl}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${Kc}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${tl}`)}}const El={provide:Oc,useExisting:bt(()=>Nl)};let Nl=(()=>{class t extends _l{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){this._parent instanceof t||this._parent instanceof wl||Sl.modelGroupParentException()}}return t.\u0275fac=function(e){return new(e||t)(Ao(Oc,5),Ao(zc,10),Ao(Bc,10))},t.\u0275dir=de({type:t,selectors:[["","ngModelGroup",""]],inputs:{name:["ngModelGroup","name"]},exportAs:["ngModelGroup"],features:[pa([El]),ta]}),t})();const Tl={provide:Lc,useExisting:bt(()=>Cl)},Al=(()=>Promise.resolve(null))();let Cl=(()=>{class t extends Lc{constructor(t,e,n,r){super(),this.control=new gl,this._registered=!1,this.update=new os,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e)||ul(t,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{var o;e.constructor===Ac?n=e:(o=e,hl.some(t=>o.constructor===t)?(r&&ul(t,"More than one built-in value accessor matches form control with"),r=e):(i&&ul(t,"More than one custom value accessor matches form control with"),i=e))}),i||r||n||(ul(t,"No valid value accessor for form control with"),null)}(this,r)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?ol(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return cl(this._rawValidators)}get asyncValidator(){return ll(this._rawAsyncValidators)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){al(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof Nl)&&this._parent instanceof _l?Sl.formGroupNameException():this._parent instanceof Nl||this._parent instanceof wl||Sl.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Sl.missingNameException()}_updateValue(t){Al.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;Al.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(Ao(Oc,9),Ao(zc,10),Ao(Bc,10),Ao(Mc,10))},t.\u0275dir=de({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[pa([Tl]),ta,Ne]}),t})(),Ol=(()=>{class t{}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)}}),t})(),Rl=(()=>{class t{}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)},providers:[Yc],imports:[Ol]}),t})();function Pl(...t){let e=t[t.length-1];return E(e)?(t.pop(),B(t,e)):G(t)}class Ll extends M{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new b;return this._value}next(t){super.next(this._value=t)}}const Il=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})(),Dl={};class kl{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new zl(t,this.resultSelector))}}class zl extends I{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(Dl),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(L(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const o=this.values,a=this.toRespond?o[n]===Dl?--this.toRespond:this.toRespond:0;o[n]=e,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const Bl=new v(t=>t.complete());function Ul(t){return t?function(t){return new v(e=>t.schedule(()=>e.complete()))}(t):Bl}function Fl(t){return new v(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?U(n):Ul()).subscribe(e)})}function jl(){return V(1)}function Hl(t,e){return function(n){return n.lift(new Vl(t,e))}}class Vl{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Gl(t,this.predicate,this.thisArg))}}class Gl extends d{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}const ql=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function Wl(t){return function(e){return 0===t?Ul():e.lift(new Zl(t))}}class Zl{constructor(t){if(this.total=t,this.total<0)throw new ql}call(t,e){return e.subscribe(new $l(t,this.total))}}class $l extends d{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function Yl(t=Ql){return e=>e.lift(new Xl(t))}class Xl{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Jl(t,this.errorFactory))}}class Jl extends d{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Ql(){return new Il}function Kl(t=null){return e=>e.lift(new th(t))}class th{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new eh(t,this.defaultValue))}}class eh extends d{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function nh(t){return function(e){const n=new rh(t),r=e.lift(n);return n.caught=r}}class rh{constructor(t){this.selector=t}call(t,e){return e.subscribe(new ih(t,this.selector,this.caught))}}class ih extends I{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new N(this,void 0,void 0);this.add(r);const i=L(this,n,void 0,void 0,r);i!==r&&this.add(i)}}}function oh(t){return e=>0===t?Ul():e.lift(new ah(t))}class ah{constructor(t){if(this.total=t,this.total<0)throw new ql}call(t,e){return e.subscribe(new sh(t,this.total))}}class sh extends d{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function uh(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Hl((e,n)=>t(e,n,r)):y,oh(1),n?Kl(e):Yl(()=>new Il))}function ch(){}function lh(t,e,n){return function(r){return r.lift(new hh(t,e,n))}}class hh{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new ph(t,this.nextOrObserver,this.error,this.complete))}}class ph extends d{constructor(t,e,n,i){super(t),this._tapNext=ch,this._tapError=ch,this._tapComplete=ch,this._tapError=n||ch,this._tapComplete=i||ch,r(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||ch,this._tapError=e.error||ch,this._tapComplete=e.complete||ch)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class fh{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new dh(t,this.predicate,this.thisArg,this.source))}}class dh extends d{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function mh(t,e){return"function"==typeof e?n=>n.pipe(mh((n,r)=>U(t(n,r)).pipe(D((t,i)=>e(n,t,r,i))))):e=>e.lift(new gh(t))}class gh{constructor(t){this.project=t}call(t,e){return e.subscribe(new yh(t,this.project))}}class yh extends I{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new N(this,e,n),o=this.destination;o.add(i),this.innerSubscription=L(this,t,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function vh(...t){return jl()(Pl(...t))}class xh{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new bh(t,this.accumulator,this.seed,this.hasSeed))}}class bh extends d{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function wh(t,e){return F(t,e,1)}class _h{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Mh(t,this.callback))}}class Mh extends d{constructor(t,e){super(t),this.add(new h(e))}}class Sh{constructor(t,e){this.id=t,this.url=e}}class Eh extends Sh{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Nh extends Sh{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Th extends Sh{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ah extends Sh{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ch extends Sh{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oh extends Sh{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rh extends Sh{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ph extends Sh{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lh extends Sh{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ih{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Dh{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class kh{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zh{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Bh{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uh{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fh{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let jh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ue({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Lo(0,"router-outlet")},directives:function(){return[Hf]},encapsulation:2}),t})();class Hh{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Vh(t){return new Hh(t)}function Gh(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function qh(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class Wh{constructor(t,e){this.routes=t,this.module=e}}function Zh(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];$h(r,Yh(e,r))}}function $h(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&Zh(t.children,e)}function Yh(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Xh(t){const e=t.children&&t.children.map(Xh),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=jh),n}function Jh(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!Qh(t[i],e[i]))return!1;return!0}function Qh(t,e){return Array.isArray(t)&&Array.isArray(e)?t.length==e.length&&t.every(t=>e.indexOf(t)>-1):t===e}function Kh(t){return Array.prototype.concat.apply([],t)}function tp(t){return t.length>0?t[t.length-1]:null}function ep(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function np(t){return ko(t)?t:Do(t)?U(Promise.resolve(t)):Pl(t)}function rp(t,e,n){return n?function(t,e){return Jh(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!sp(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>Qh(t[n],e[n]))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!sp(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!sp(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!sp(n.segments,t)&&!!n.children.primary&&e(n.children.primary,r,o)}}(e,n,n.segments)}(t.root,e.root)}class ip{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vh(this.queryParams)),this._queryParamMap}toString(){return hp.serialize(this)}}class op{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ep(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return pp(this)}}class ap{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Vh(this.parameters)),this._parameterMap}toString(){return vp(this)}}function sp(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function up(t,e){let n=[];return ep(t.children,(t,r)=>{"primary"===r&&(n=n.concat(e(t,r)))}),ep(t.children,(t,r)=>{"primary"!==r&&(n=n.concat(e(t,r)))}),n}class cp{}class lp{parse(t){const e=new Mp(t);return new ip(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+function t(e,n){if(!e.hasChildren())return pp(e);if(n){const n=e.children.primary?t(e.children.primary,!1):"",r=[];return ep(e.children,(e,n)=>{"primary"!==n&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=up(e,(n,r)=>"primary"===r?[t(e.children.primary,!1)]:[`${r}:${t(n,!1)}`]);return`${pp(e)}/(${n.join("//")})`}}(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${dp(e)}=${dp(t)}`).join("&"):`${dp(e)}=${dp(n)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const hp=new lp;function pp(t){return t.segments.map(t=>vp(t)).join("/")}function fp(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function dp(t){return fp(t).replace(/%3B/gi,";")}function mp(t){return fp(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function gp(t){return decodeURIComponent(t)}function yp(t){return gp(t.replace(/\+/g,"%20"))}function vp(t){return`${mp(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${mp(t)}=${mp(e[t])}`).join("")}`;var e}const xp=/^[^\/()?;=#]+/;function bp(t){const e=t.match(xp);return e?e[0]:""}const wp=/^[^=?&#]+/,_p=/^[^?&#]+/;class Mp{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new op([],{}):new op([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new op(t,e)),n}parseSegment(){const t=bp(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new ap(gp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=bp(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=bp(this.remaining);t&&(n=t,this.capture(n))}t[gp(e)]=gp(n)}parseQueryParam(t){const e=function(t){const e=t.match(wp);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(_p);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=yp(e),i=yp(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=bp(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");const o=this.parseChildren();e[i]=1===Object.keys(o).length?o.primary:new op([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Sp{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Ep(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Ep(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Np(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Np(t,this._root).map(t=>t.value)}}function Ep(t,e){if(t===e.value)return e;for(const n of e.children){const e=Ep(t,n);if(e)return e}return null}function Np(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Np(t,n);if(r.length)return r.unshift(e),r}return[]}class Tp{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Ap(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Cp extends Sp{constructor(t,e){super(t),this.snapshot=e,Dp(this,t)}toString(){return this.snapshot.toString()}}function Op(t,e){const n=function(t,e){const n=new Lp([],{},{},"",{},"primary",e,null,t.root,-1,{});return new Ip("",new Tp(n,[]))}(t,e),r=new Ll([new ap("",{})]),i=new Ll({}),o=new Ll({}),a=new Ll({}),s=new Ll(""),u=new Rp(r,i,a,s,o,"primary",e,n.root);return u.snapshot=n.root,new Cp(new Tp(u,[]),n)}class Rp{constructor(t,e,n,r,i,o,a,s){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this._futureSnapshot=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(D(t=>Vh(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(D(t=>Vh(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Pp(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Lp{constructor(t,e,n,r,i,o,a,s,u,c,l){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this.routeConfig=s,this._urlSegment=u,this._lastPathIndex=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Vh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ip extends Sp{constructor(t,e){super(e),this.url=t,Dp(this,e)}toString(){return kp(this._root)}}function Dp(t,e){e.value._routerState=t,e.children.forEach(e=>Dp(t,e))}function kp(t){const e=t.children.length>0?` { ${t.children.map(kp).join(", ")} } `:"";return`${t.value}${e}`}function zp(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Jh(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Jh(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Jh(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Jh(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Bp(t,e){var n,r;return Jh(t.params,e.params)&&sp(n=t.url,r=e.url)&&n.every((t,e)=>Jh(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||Bp(t.parent,e.parent))}function Up(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Fp(t,e,n,r,i){let o={};return r&&ep(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new ip(n.root===t?e:function t(e,n,r){const i={};return ep(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new op(e.segments,i)}(n.root,t,e),o,i)}class jp{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Up(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==tp(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Hp{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function Vp(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:""+t}function Gp(t,e,n){if(t||(t=new op([],{})),0===t.segments.length&&t.hasChildren())return qp(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],a=Vp(n[r]),s=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&s&&"object"==typeof s&&void 0===s.outlets){if(!Yp(a,s,e))return o;r+=2}else{if(!Yp(a,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new op(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new op(t.segments.slice(r.pathIndex),t.children),qp(e,0,i)}return r.match&&0===i.length?new op(t.segments,{}):r.match&&!t.hasChildren()?Wp(t,e,n):r.match?qp(t,0,i):Wp(t,e,n)}function qp(t,e,n){if(0===n.length)return new op(t.segments,{});{const r=function(t){return"object"==typeof t[0]&&null!==t[0]&&t[0].outlets?t[0].outlets:{primary:t}}(n),i={};return ep(r,(n,r)=>{null!==n&&(i[r]=Gp(t.children[r],e,n))}),ep(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new op(t.segments,i)}}function Wp(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&null!==n[i]&&void 0!==n[i].outlets){const t=Zp(n[i].outlets);return new op(r,t)}if(0===i&&Up(n[0])){r.push(new ap(t.segments[e].path,n[0])),i++;continue}const o=Vp(n[i]),a=i<n.length-1?n[i+1]:null;o&&a&&Up(a)?(r.push(new ap(o,$p(a))),i+=2):(r.push(new ap(o,{})),i++)}return new op(r,{})}function Zp(t){const e={};return ep(t,(t,n)=>{null!==t&&(e[n]=Wp(new op([],{}),0,t))}),e}function $p(t){const e={};return ep(t,(t,n)=>e[n]=""+t),e}function Yp(t,e,n){return t==n.path&&Jh(e,n.parameters)}class Xp{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),zp(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Ap(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),ep(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=Ap(t),i=t.value.component?n.children:e;ep(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=Ap(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new Uh(t.value.snapshot))}),t.children.length&&this.forwardEvent(new zh(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(zp(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Jp(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Jp(t){zp(t.value),t.children.forEach(Jp)}function Qp(t){return"function"==typeof t}function Kp(t){return t instanceof ip}class tf{constructor(t){this.segmentGroup=t||null}}class ef{constructor(t){this.urlTree=t}}function nf(t){return new v(e=>e.error(new tf(t)))}function rf(t){return new v(e=>e.error(new ef(t)))}function of(t){return new v(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class af{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(Yt)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(D(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(nh(t=>{if(t instanceof ef)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof tf)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(D(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(nh(t=>{if(t instanceof tf)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new op([],{primary:t}):t;return new ip(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(D(t=>new op([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Pl({});const n=[],r=[],i={};return ep(t,(t,o)=>{const a=e(o,t).pipe(D(t=>i[o]=t));"primary"===o?n.push(a):r.push(a)}),Pl.apply(null,n.concat(r)).pipe(jl(),function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Hl((e,n)=>t(e,n,r)):y,Wl(1),n?Kl(e):Yl(()=>new Il))}(),D(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){return Pl(...n).pipe(D(a=>this.expandSegmentAgainstRoute(t,e,n,a,r,i,o).pipe(nh(t=>{if(t instanceof tf)return Pl(null);throw t}))),jl(),uh(t=>!!t),nh((t,n)=>{if(t instanceof Il||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Pl(new op([],{}));throw new tf(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,a){return lf(r)!==o?nf(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):nf(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?rf(i):this.lineralizeSegments(n,i).pipe(F(n=>{const i=new op(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:a,consumedSegments:s,lastChild:u,positionalParamSegments:c}=sf(e,r,i);if(!a)return nf(e);const l=this.applyRedirectCommands(s,r.redirectTo,c);return r.redirectTo.startsWith("/")?rf(l):this.lineralizeSegments(r,l).pipe(F(r=>this.expandSegment(t,e,n,r.concat(i.slice(u)),o,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(D(t=>(n._loadedConfig=t,new op(r,{})))):Pl(new op(r,{}));const{matched:i,consumedSegments:o,lastChild:a}=sf(e,n,r);if(!i)return nf(e);const s=r.slice(a);return this.getChildConfig(t,n,r).pipe(F(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:a}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>cf(t,e,n)&&"primary"!==lf(n))}(t,n,r)?{segmentGroup:uf(new op(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&"primary"!==lf(r)&&(n[lf(r)]=new op([],{}));return n}(r,new op(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>cf(t,e,n))}(t,n,r)?{segmentGroup:uf(new op(t.segments,function(t,e,n,r){const i={};for(const o of n)cf(t,e,o)&&!r[lf(o)]&&(i[lf(o)]=new op([],{}));return Object.assign(Object.assign({},r),i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,s,r);return 0===a.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(D(t=>new op(o,t))):0===r.length&&0===a.length?Pl(new op(o,{})):this.expandSegment(n,i,r,a,"primary",!0).pipe(D(t=>new op(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Pl(new Wh(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Pl(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(F(n=>n?this.configLoader.load(t.injector,e).pipe(D(t=>(e._loadedConfig=t,t))):function(t){return new v(e=>e.error(Gh(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Pl(new Wh([],t))}runCanLoadGuards(t,e,n){const r=e.canLoad;return r&&0!==r.length?U(r).pipe(D(r=>{const i=t.get(r);let o;if(function(t){return t&&Qp(t.canLoad)}(i))o=i.canLoad(e,n);else{if(!Qp(i))throw new Error("Invalid CanLoad guard");o=i(e,n)}return np(o)})).pipe(jl(),lh(t=>{if(!Kp(t))return;const e=Gh(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),(i=t=>!0===t,t=>t.lift(new fh(i,void 0,t)))):Pl(!0);var i}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Pl(n);if(r.numberOfChildren>1||!r.children.primary)return of(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new ip(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return ep(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return ep(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new op(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function sf(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||qh)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function uf(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new op(t.segments.concat(e.segments),e.children)}return t}function cf(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function lf(t){return t.outlet||"primary"}class hf{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class pf{constructor(t,e){this.component=t,this.route=e}}function ff(t,e,n){const r=t._root;return function t(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const a=Ap(n);return e.children.forEach(e=>{!function(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const a=e.value,s=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){const c=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!sp(t.url,e.url);case"pathParamsOrQueryParamsChange":return!sp(t.url,e.url)||!Jh(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Bp(t,e)||!Jh(t.queryParams,e.queryParams);case"paramsChange":default:return!Bp(t,e)}}(s,a,a.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new hf(i)):(a.data=s.data,a._resolvedData=s._resolvedData),t(e,n,a.component?u?u.children:null:r,i,o),c&&o.canDeactivateChecks.push(new pf(u&&u.outlet&&u.outlet.component||null,s))}else s&&mf(n,u,o),o.canActivateChecks.push(new hf(i)),t(e,null,a.component?u?u.children:null:r,i,o)}(e,a[e.value.outlet],r,i.concat([e.value]),o),delete a[e.value.outlet]}),ep(a,(t,e)=>mf(t,r.getContext(e),o)),o}(r,e?e._root:null,n,[r.value])}function df(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function mf(t,e,n){const r=Ap(t),i=t.value;ep(r,(t,r)=>{mf(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new pf(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const gf=Symbol("INITIAL_VALUE");function yf(){return mh(t=>function(...t){let e=null,n=null;return E(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&u(t[0])&&(t=t[0]),G(t,n).lift(new kl(e))}(...t.map(t=>t.pipe(oh(1),function(...t){const e=t[t.length-1];return E(e)?(t.pop(),n=>vh(t,n,e)):e=>vh(t,e)}(gf)))).pipe(function(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new xh(t,e,n))}}((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==gf)return t;if(r===gf&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Kp(r))return r}return t},t)},gf),Hl(t=>t!==gf),D(t=>Kp(t)?t:!0===t),oh(1)))}function vf(t,e){return null!==t&&e&&e(new Bh(t)),Pl(!0)}function xf(t,e){return null!==t&&e&&e(new kh(t)),Pl(!0)}function bf(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Pl(r.map(r=>Fl(()=>{const i=df(r,e,n);let o;if(function(t){return t&&Qp(t.canActivate)}(i))o=np(i.canActivate(e,t));else{if(!Qp(i))throw new Error("Invalid CanActivate guard");o=np(i(e,t))}return o.pipe(uh())}))).pipe(yf()):Pl(!0)}function wf(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>Fl(()=>Pl(e.guards.map(i=>{const o=df(i,e.node,n);let a;if(function(t){return t&&Qp(t.canActivateChild)}(o))a=np(o.canActivateChild(r,t));else{if(!Qp(o))throw new Error("Invalid CanActivateChild guard");a=np(o(r,t))}return a.pipe(uh())})).pipe(yf())));return Pl(i).pipe(yf())}class _f{}class Mf{constructor(t,e,n,r,i,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){try{const t=Nf(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new Lp([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Tp(n,e),i=new Ip(this.url,r);return this.inheritParamsAndData(i._root),Pl(i)}catch(t){return new v(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=Pp(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=up(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const o of t)try{return this.processSegmentAgainstRoute(o,e,n,r)}catch(i){if(!(i instanceof _f))throw i}if(this.noLeftoversInUrl(e,n,r))return[];throw new _f}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new _f;if((t.outlet||"primary")!==r)throw new _f;let i,o=[],a=[];if("**"===t.path){const o=n.length>0?tp(n).parameters:{};i=new Lp(n,o,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Cf(t),r,t.component,t,Sf(e),Ef(e)+n.length,Of(t))}else{const s=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new _f;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||qh)(n,t,e);if(!r)throw new _f;const i={};ep(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},i),r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=s.consumedSegments,a=n.slice(s.lastChild),i=new Lp(o,s.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Cf(t),r,t.component,t,Sf(e),Ef(e)+o.length,Of(t))}const s=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:c}=Nf(e,o,a,s,this.relativeLinkResolution);if(0===c.length&&u.hasChildren()){const t=this.processChildren(s,u);return[new Tp(i,t)]}if(0===s.length&&0===c.length)return[new Tp(i,[])];const l=this.processSegment(s,u,c,"primary");return[new Tp(i,l)]}}function Sf(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Ef(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function Nf(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some(n=>Tf(t,e,n)&&"primary"!==Af(n))}(t,n,r)){const i=new op(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&"primary"!==Af(o)){const n=new op([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[Af(o)]=n}return i}(t,e,r,new op(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Tf(t,e,n))}(t,n,r)){const o=new op(t.segments,function(t,e,n,r,i,o){const a={};for(const s of r)if(Tf(t,n,s)&&!i[Af(s)]){const n=new op([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,a[Af(s)]=n}return Object.assign(Object.assign({},i),a)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new op(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function Tf(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function Af(t){return t.outlet||"primary"}function Cf(t){return t.data||{}}function Of(t){return t.resolve||{}}function Rf(t){return function(e){return e.pipe(mh(e=>{const n=t(e);return n?U(n).pipe(D(()=>e)):U([e])}))}}class Pf{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const Lf=new Dt("ROUTES");class If{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(D(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new Wh(Kh(r.injector.get(Lf)).map(Xh),r)}))}loadModuleFactory(t){return"string"==typeof t?U(this.loader.load(t)):np(t()).pipe(F(t=>t instanceof Xt?Pl(t):U(this.compiler.compileModuleAsync(t))))}}class Df{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new kf,this.attachRef=null}}class kf{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Df,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class zf{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function Bf(t){throw t}function Uf(t,e,n){return e.parse("/")}function Ff(t,e){return Pl(null)}let jf=(()=>{class t{constructor(t,e,n,r,i,o,a,s){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=s,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new M,this.errorHandler=Bf,this.malformedUriErrorHandler=Uf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Ff,afterPreactivation:Ff},this.urlHandlingStrategy=new zf,this.routeReuseStrategy=new Pf,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(Yt),this.console=i.get(As);const u=i.get(js);this.isNgZoneEnabled=u instanceof js,this.resetConfig(s),this.currentUrlTree=new ip(new op([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new If(o,a,t=>this.triggerEvent(new Ih(t)),t=>this.triggerEvent(new Dh(t))),this.routerState=Op(this.currentUrlTree,this.rootComponentType),this.transitions=new Ll({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(Hl(t=>0!==t.id),D(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),mh(t=>{let n=!1,r=!1;return Pl(t).pipe(lh(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),mh(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Pl(t).pipe(mh(t=>{const n=this.transitions.getValue();return e.next(new Eh(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?Bl:[t]}),mh(t=>Promise.resolve(t)),(r=this.ngModule.injector,i=this.configLoader,o=this.urlSerializer,a=this.config,function(t){return t.pipe(mh(t=>function(t,e,n,r,i){return new af(t,e,n,r,i).apply()}(r,i,o,t.extractedUrl,a).pipe(D(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),lh(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(o){return o.pipe(F(o=>function(t,e,n,r,i="emptyOnly",o="legacy"){return new Mf(t,e,n,r,i,o).recognize()}(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(D(t=>Object.assign(Object.assign({},o),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),lh(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),lh(t=>{const n=new Ch(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,o,a;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:a}=t,s=new Eh(n,this.serializeUrl(r),i,o);e.next(s);const u=Op(r,this.rootComponentType).snapshot;return Pl(Object.assign(Object.assign({},t),{targetSnapshot:u,urlAfterRedirects:r,extras:Object.assign(Object.assign({},a),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Bl}),Rf(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:a}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!a})}),lh(t=>{const e=new Oh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),D(t=>Object.assign(Object.assign({},t),{guards:ff(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(F(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=n;return 0===a.length&&0===o.length?Pl(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return U(t).pipe(F(t=>function(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Pl(o.map(o=>{const a=df(o,e,i);let s;if(function(t){return t&&Qp(t.canDeactivate)}(a))s=np(a.canDeactivate(t,e,n,r));else{if(!Qp(a))throw new Error("Invalid CanDeactivate guard");s=np(a(t,e,n,r))}return s.pipe(uh())})).pipe(yf()):Pl(!0)}(t.component,t.route,n,e,r)),uh(t=>!0!==t,!0))}(a,r,i,t).pipe(F(n=>n&&"boolean"==typeof n?function(t,e,n,r){return U(e).pipe(wh(e=>U([xf(e.route.parent,r),vf(e.route,r),wf(t,e.path,n),bf(t,e.route,n)]).pipe(jl(),uh(t=>!0!==t,!0))),uh(t=>!0!==t,!0))}(r,o,t,e):Pl(n)),D(t=>Object.assign(Object.assign({},n),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),lh(t=>{if(Kp(t.guardsResult)){const e=Gh(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),lh(t=>{const e=new Rh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Hl(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Th(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),Rf(t=>{if(t.guards.canActivateChecks.length)return Pl(t).pipe(lh(t=>{const e=new Ph(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),mh(t=>{let n=!1;return Pl(t).pipe((r=this.paramsInheritanceStrategy,i=this.ngModule.injector,function(t){return t.pipe(F(t=>{const{targetSnapshot:e,guards:{canActivateChecks:n}}=t;if(!n.length)return Pl(t);let o=0;return U(n).pipe(wh(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Pl({});const o={};return U(i).pipe(F(i=>function(t,e,n,r){const i=df(t,e,r);return np(i.resolve?i.resolve(e,n):i(e,n))}(t[i],e,n,r).pipe(lh(t=>{o[i]=t}))),Wl(1),F(()=>Object.keys(o).length===i.length?Pl(o):Bl))}(t._resolve,t,e,r).pipe(D(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Pp(t,n).resolve),null)))}(t.route,e,r,i)),lh(()=>o++),Wl(1),F(e=>o===n.length?Pl(t):Bl))}))}),lh({next:()=>n=!0,complete:()=>{if(!n){const n=new Th(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(n),t.resolve(!1)}}}));var r,i}),lh(t=>{const e=new Lh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),Rf(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:a}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!a})}),D(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new Tp(i,o)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new Rp(new Ll((i=n.value).url),new Ll(i.params),new Ll(i.queryParams),new Ll(i.fragment),new Ll(i.data),i.outlet,i.component,i),o=n.children.map(n=>t(e,n));return new Tp(r,o)}}var i}(t,e._root,n?n._root:void 0);return new Cp(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),lh(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(o=this.rootContexts,a=this.routeReuseStrategy,s=t=>this.triggerEvent(t),D(t=>(new Xp(a,t.targetRouterState,t.currentRouterState,s).activate(o),t))),lh({next(){n=!0},complete(){n=!0}}),(i=()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new Th(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new _h(i))),nh(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=Kp(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new Th(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new Ah(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(o){t.reject(o)}}var i;return Bl}));var i,o,a,s}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Zh(t),this.config=t.map(Xh),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:a,preserveFragment:s}=e;cr()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const u=n||this.routerState.root,c=s?this.currentUrlTree.fragment:i;let l=null;if(a)switch(a){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=o?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(t,e,n,r,i){if(0===n.length)return Fp(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new jp(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return ep(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new jp(n,e,r)}(n);if(o.toRoot())return Fp(e.root,new op([],{}),e,r,i);const a=function(t,e,n){if(t.isAbsolute)return new Hp(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new Hp(t,t===e.root,0)}const r=Up(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new Hp(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(o,e,t),s=a.processChildren?qp(a.segmentGroup,a.index,o.commands):Gp(a.segmentGroup,a.index,o.commands);return Fp(a.segmentGroup,s,e,r,i)}(u,this.currentUrlTree,t,l,c)}navigateByUrl(t,e={skipLocationChange:!1}){cr()&&this.isNgZoneEnabled&&!js.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=Kp(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(Kp(t))return rp(this.currentUrlTree,t,e);const n=this.parseUrl(t);return rp(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Nh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,i){const o=this.getTransition();if(o&&"imperative"!==e&&"imperative"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"hashchange"==e&&"popstate"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"popstate"==e&&"hashchange"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);let a,s,u;i?(a=i.resolve,s=i.reject,u=i.promise):u=new Promise((t,e)=>{a=t,s=e});const c=++this.navigationId;return this.setTransition({id:c,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:a,reject:s,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(qt(no),qt(cp),qt(kf),qt(Lu),qt(vo),qt(uu),qt(Bs),qt(void 0))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Hf=(()=>{class t{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new os,this.deactivateEvents=new os,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new Vf(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Ao(kf),Ao(Ha),Ao(ma),("name",function(t,e){const n=t.attrs;if(n){const t=n.length;let e=0;for(;e<t;){const r=n[e];if(En(r))break;if(0===r)e+=2;else if("number"==typeof r)for(e++;e<t&&"string"==typeof n[e];)e++;else{if("name"===r)return n[e+1];e+=2}}}return null}(Xe())),Ao(to))},t.\u0275dir=de({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class Vf{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Rp?this.route:t===kf?this.childContexts:this.parent.get(t,e)}}class Gf{}class qf{preload(t,e){return Pl(null)}}let Wf=(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new If(e,n,e=>t.triggerEvent(new Ih(e)),e=>t.triggerEvent(new Dh(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Hl(t=>t instanceof Nh),wh(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Yt);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return U(n).pipe(V(),D(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(F(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(qt(jf),qt(uu),qt(Bs),qt(vo),qt(Gf))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})(),Zf=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Eh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Nh&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Fh&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new Fh(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(qt(jf),qt(Wu),qt(void 0))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();const $f=new Dt("ROUTER_CONFIGURATION"),Yf=new Dt("ROUTER_FORROOT_GUARD"),Xf=[Lu,{provide:cp,useClass:lp},{provide:jf,useFactory:function(t,e,n,r,i,o,a,s={},u,c){const l=new jf(null,t,e,n,r,i,o,Kh(a));if(u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),s.errorHandler&&(l.errorHandler=s.errorHandler),s.malformedUriErrorHandler&&(l.malformedUriErrorHandler=s.malformedUriErrorHandler),s.enableTracing){const t=yu();l.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return s.onSameUrlNavigation&&(l.onSameUrlNavigation=s.onSameUrlNavigation),s.paramsInheritanceStrategy&&(l.paramsInheritanceStrategy=s.paramsInheritanceStrategy),s.urlUpdateStrategy&&(l.urlUpdateStrategy=s.urlUpdateStrategy),s.relativeLinkResolution&&(l.relativeLinkResolution=s.relativeLinkResolution),l},deps:[cp,kf,Lu,vo,uu,Bs,Lf,$f,[class{},new et],[class{},new et]]},kf,{provide:Rp,useFactory:function(t){return t.routerState.root},deps:[jf]},{provide:uu,useClass:hu},Wf,qf,class{preload(t,e){return e().pipe(nh(()=>Pl(null)))}},{provide:$f,useValue:{enableTracing:!1}}];function Jf(){return new eu("Router",jf)}let Qf=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Xf,nd(e),{provide:Yf,useFactory:ed,deps:[[jf,new et,new rt]]},{provide:$f,useValue:n||{}},{provide:Au,useFactory:td,deps:[xu,[new tt(Ou),new et],$f]},{provide:Zf,useFactory:Kf,deps:[jf,Wu,$f]},{provide:Gf,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:qf},{provide:eu,multi:!0,useFactory:Jf},[rd,{provide:bs,multi:!0,useFactory:id,deps:[rd]},{provide:ad,useFactory:od,deps:[rd]},{provide:Ts,multi:!0,useExisting:ad}]]}}static forChild(e){return{ngModule:t,providers:[nd(e)]}}}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)(qt(Yf,8),qt(jf,8))}}),t})();function Kf(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Zf(t,e,n)}function td(t,e,n={}){return n.useHash?new Pu(t,e):new Ru(t,e)}function ed(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function nd(t){return[{provide:xo,multi:!0,useValue:t},{provide:Lf,multi:!0,useValue:t}]}let rd=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new M}appInitializer(){return this.injector.get(wu,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(jf),r=this.injector.get($f);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Pl(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get($f),n=this.injector.get(Wf),r=this.injector.get(Zf),i=this.injector.get(jf),o=this.injector.get(au);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(qt(vo))},t.\u0275prov=st({token:t,factory:t.\u0275fac}),t})();function id(t){return t.appInitializer.bind(t)}function od(t){return t.bootstrapListener.bind(t)}const ad=new Dt("Router Initializer"),sd=[];let ud=(()=>{class t{}return t.\u0275mod=pe({type:t}),t.\u0275inj=ut({factory:function(e){return new(e||t)},imports:[[Qf.forRoot(sd)],Qf]}),t})();function cd(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const e=Object(t);for(let n=1;n<arguments.length;n++){const t=arguments[n];if(null!=t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}),Object.assign(cd.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t)}}});const ld=[];for(let ZH=0;ZH<256;ZH++)ld[ZH]=(ZH<16?"0":"")+ZH.toString(16);const hd={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(ld[255&t]+ld[t>>8&255]+ld[t>>16&255]+ld[t>>24&255]+"-"+ld[255&e]+ld[e>>8&255]+"-"+ld[e>>16&15|64]+ld[e>>24&255]+"-"+ld[63&n|128]+ld[n>>8&255]+"-"+ld[n>>16&255]+ld[n>>24&255]+ld[255&r]+ld[r>>8&255]+ld[r>>16&255]+ld[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*hd.DEG2RAD},radToDeg:function(t){return t*hd.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((e+r)/2),l=a((e+r)/2),h=o((e-r)/2),p=a((e-r)/2),f=o((r-e)/2),d=a((r-e)/2);switch(i){case"XYX":t.set(s*l,u*h,u*p,s*c);break;case"YZY":t.set(u*p,s*l,u*h,s*c);break;case"ZXZ":t.set(u*h,u*p,s*l,s*c);break;case"XZX":t.set(s*l,u*d,u*f,s*c);break;case"YXY":t.set(u*f,s*l,u*d,s*c);break;case"ZYZ":t.set(u*d,u*f,s*l,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};function pd(t=0,e=0){this.x=t,this.y=e}function fd(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let dd;Object.defineProperties(pd.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(pd.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(fd.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){const c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],h=n[2],p=n[5],f=n[8],d=r[0],m=r[3],g=r[6],y=r[1],v=r[4],x=r[7],b=r[2],w=r[5],_=r[8];return i[0]=o*d+a*y+s*b,i[3]=o*m+a*v+s*w,i[6]=o*g+a*x+s*_,i[1]=u*d+c*y+l*b,i[4]=u*m+c*v+l*w,i[7]=u*g+c*x+l*_,i[2]=h*d+p*y+f*b,i[5]=h*m+p*v+f*w,i[8]=h*g+p*x+f*_,this},multiplyScalar:function(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*i*c+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],p=n[8],f=p*u-c*h,d=c*l-p*s,m=h*s-u*l,g=i*f+o*d+a*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const y=1/g;return r[0]=f*y,r[1]=(a*h-p*o)*y,r[2]=(c*o-a*u)*y,r[3]=d*y,r[4]=(p*i-a*l)*y,r[5]=(a*s-c*i)*y,r[6]=m*y,r[7]=(o*l-h*i)*y,r[8]=(u*i-o*s)*y,this},transpose:function(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){const s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*c,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*c,this},translate:function(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});const md={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===dd&&(dd=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),dd.width=t.width,dd.height=t.height;const n=dd.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=dd}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}};let gd=0;function yd(t,e,n,r,i,o,a,s,u,c){Object.defineProperty(this,"id",{value:gd++}),this.uuid=hd.generateUUID(),this.name="",this.image=void 0!==t?t:yd.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:yd.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==i?i:1006,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:1023,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new pd(0,0),this.repeat=new pd(1,1),this.center=new pd(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new fd,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:3e3,this.version=0,this.onUpdate=null}function vd(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}function xd(t,e,n){this.width=t,this.height=e,this.scissor=new vd(0,0,t,e),this.scissorTest=!1,this.viewport=new vd(0,0,t,e),this.texture=new yd(void 0,(n=n||{}).mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function bd(t,e,n){xd.call(this,t,e,n),this.samples=4}function wd(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}yd.DEFAULT_IMAGE=void 0,yd.DEFAULT_MAPPING=300,yd.prototype=Object.assign(Object.create(cd.prototype),{constructor:yd,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=hd.generateUUID()),!e&&void 0===t.images[r.uuid]){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)e.push(md.getDataURL(r[t]))}else e=md.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:e}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(yd.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(vd.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(vd.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){let e,n,r,i;const o=t.elements,a=o[0],s=o[4],u=o[8],c=o[1],l=o[5],h=o[9],p=o[2],f=o[6],d=o[10];if(Math.abs(s-c)<.01&&Math.abs(u-p)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(u+p)<.1&&Math.abs(h+f)<.1&&Math.abs(a+l+d-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const t=(a+1)/2,o=(l+1)/2,m=(d+1)/2,g=(s+c)/4,y=(u+p)/4,v=(h+f)/4;return t>o&&t>m?t<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=g/n,i=y/n):o>m?o<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=g/r,i=v/r):m<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(m),n=y/i,r=v/i),this.set(n,r,i,e),this}let m=Math.sqrt((f-h)*(f-h)+(u-p)*(u-p)+(c-s)*(c-s));return Math.abs(m)<.001&&(m=1),this.x=(f-h)/m,this.y=(u-p)/m,this.z=(c-s)/m,this.w=Math.acos((a+l+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),xd.prototype=Object.assign(Object.create(cd.prototype),{constructor:xd,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),bd.prototype=Object.assign(Object.create(xd.prototype),{constructor:bd,isWebGLMultisampleRenderTarget:!0,copy:function(t){return xd.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(wd,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){let s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3];const h=i[o+0],p=i[o+1],f=i[o+2],d=i[o+3];if(l!==d||s!==h||u!==p||c!==f){let t=1-a,e=s*h+u*p+c*f+l*d,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(s=s*t+h*i,u=u*t+p*i,c=c*t+f*i,l=l*t+d*i,t===1-a){const t=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=t,u*=t,c*=t,l*=t}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l},multiplyQuaternionsFlat:function(t,e,n,r,i,o){const a=n[r],s=n[r+1],u=n[r+2],c=n[r+3],l=i[o],h=i[o+1],p=i[o+2],f=i[o+3];return t[e]=a*f+c*l+s*p-u*h,t[e+1]=s*f+c*h+u*l-a*p,t[e+2]=u*f+c*p+a*h-s*l,t[e+3]=c*f-a*l-s*h-u*p,t}}),Object.defineProperties(wd.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(wd.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),h=s(n/2),p=s(r/2),f=s(i/2);switch(o){case"XYZ":this._x=h*c*l+u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l-h*p*f;break;case"YXZ":this._x=h*c*l+u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l+h*p*f;break;case"ZXY":this._x=h*c*l-u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l-h*p*f;break;case"ZYX":this._x=h*c*l-u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l+h*p*f;break;case"YZX":this._x=h*c*l+u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l-h*p*f;break;case"XZY":this._x=h*c*l-u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l+h*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],u=e[2],c=e[6],l=e[10],h=n+a+l;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-s)*t,this._y=(i-u)*t,this._z=(o-r)*t}else if(n>a&&n>l){const t=2*Math.sqrt(1+n-a-l);this._w=(c-s)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+u)/t}else if(a>l){const t=2*Math.sqrt(1+a-n-l);this._w=(i-u)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+l-n-a);this._w=(o-r)/t,this._x=(i+u)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this},setFromUnitVectors:function(t,e){let n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(hd.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(s),c=Math.atan2(u,a),l=Math.sin((1-e)*c)/u,h=Math.sin(e*c)/u;return this._w=o*l+this._w*h,this._x=n*l+this._x*h,this._y=r*l+this._y*h,this._z=i*l+this._z*h,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});const _d=new Sd,Md=new wd;function Sd(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}Object.assign(Sd.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Md.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Md.setFromAxisAngle(t,e))},applyMatrix3:function(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,c=s*n+a*e-i*r,l=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return _d.copy(this).projectOnVector(t),this.sub(_d)},reflect:function(t){return this.sub(_d.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(hd.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const Ed=new Sd,Nd=new Pd,Td=new Sd(0,0,0),Ad=new Sd(1,1,1),Cd=new Sd,Od=new Sd,Rd=new Sd;function Pd(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Pd.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,c,l,h,p,f,d,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=c,g[10]=l,g[14]=h,g[3]=p,g[7]=f,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Pd).fromArray(this.elements)},copy:function(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){const e=this.elements,n=t.elements,r=1/Ed.setFromMatrixColumn(t,0).length(),i=1/Ed.setFromMatrixColumn(t,1).length(),o=1/Ed.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){const t=o*c,n=o*l,r=a*c,i=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-a*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,n=s*l,r=u*c,i=u*l;e[0]=t+i*a,e[4]=r*a-n,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=n*a-r,e[6]=i+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,n=s*l,r=u*c,i=u*l;e[0]=t-i*a,e[4]=-o*l,e[8]=r+n*a,e[1]=n+r*a,e[5]=o*c,e[9]=i-t*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,n=o*l,r=a*c,i=a*l;e[0]=s*c,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*l,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*c,e[4]=i-t*l,e[8]=r*l+n,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=n*l+r,e[10]=t-i*l}else if("XZY"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=t*l+i,e[5]=o*c,e[9]=n*l-r,e[2]=r*l-n,e[6]=a*c,e[10]=i*l+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Td,t,Ad)},lookAt:function(t,e,n){const r=this.elements;return Rd.subVectors(t,e),0===Rd.lengthSq()&&(Rd.z=1),Rd.normalize(),Cd.crossVectors(n,Rd),0===Cd.lengthSq()&&(1===Math.abs(n.z)?Rd.x+=1e-4:Rd.z+=1e-4,Rd.normalize(),Cd.crossVectors(n,Rd)),Cd.normalize(),Od.crossVectors(Rd,Cd),r[0]=Cd.x,r[4]=Od.x,r[8]=Rd.x,r[1]=Cd.y,r[5]=Od.y,r[9]=Rd.y,r[2]=Cd.z,r[6]=Od.z,r[10]=Rd.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],p=n[13],f=n[2],d=n[6],m=n[10],g=n[14],y=n[3],v=n[7],x=n[11],b=n[15],w=r[0],_=r[4],M=r[8],S=r[12],E=r[1],N=r[5],T=r[9],A=r[13],C=r[2],O=r[6],R=r[10],P=r[14],L=r[3],I=r[7],D=r[11],k=r[15];return i[0]=o*w+a*E+s*C+u*L,i[4]=o*_+a*N+s*O+u*I,i[8]=o*M+a*T+s*R+u*D,i[12]=o*S+a*A+s*P+u*k,i[1]=c*w+l*E+h*C+p*L,i[5]=c*_+l*N+h*O+p*I,i[9]=c*M+l*T+h*R+p*D,i[13]=c*S+l*A+h*P+p*k,i[2]=f*w+d*E+m*C+g*L,i[6]=f*_+d*N+m*O+g*I,i[10]=f*M+d*T+m*R+g*D,i[14]=f*S+d*A+m*P+g*k,i[3]=y*w+v*E+x*C+b*L,i[7]=y*_+v*N+x*O+b*I,i[11]=y*M+v*T+x*R+b*D,i[15]=y*S+v*A+x*P+b*k,this},multiplyScalar:function(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],p=t[14];return t[3]*(+i*s*l-r*u*l-i*a*h+n*u*h+r*a*p-n*s*p)+t[7]*(+e*s*p-e*u*h+i*o*h-r*o*p+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*p-i*o*l+n*o*p+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*h+r*o*l-n*o*h+n*s*c)},transpose:function(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],h=r[7],p=r[8],f=r[9],d=r[10],m=r[11],g=r[12],y=r[13],v=r[14],x=r[15],b=f*v*h-y*d*h+y*l*m-c*v*m-f*l*x+c*d*x,w=g*d*h-p*v*h-g*l*m+u*v*m+p*l*x-u*d*x,_=p*y*h-g*f*h+g*c*m-u*y*m-p*c*x+u*f*x,M=g*f*l-p*y*l-g*c*d+u*y*d+p*c*v-u*f*v,S=i*b+o*w+a*_+s*M;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/S;return n[0]=b*E,n[1]=(y*d*s-f*v*s-y*a*m+o*v*m+f*a*x-o*d*x)*E,n[2]=(c*v*s-y*l*s+y*a*h-o*v*h-c*a*x+o*l*x)*E,n[3]=(f*l*s-c*d*s-f*a*h+o*d*h+c*a*m-o*l*m)*E,n[4]=w*E,n[5]=(p*v*s-g*d*s+g*a*m-i*v*m-p*a*x+i*d*x)*E,n[6]=(g*l*s-u*v*s-g*a*h+i*v*h+u*a*x-i*l*x)*E,n[7]=(u*d*s-p*l*s+p*a*h-i*d*h-u*a*m+i*l*m)*E,n[8]=_*E,n[9]=(g*f*s-p*y*s-g*o*m+i*y*m+p*o*x-i*f*x)*E,n[10]=(u*y*s-g*c*s+g*o*h-i*y*h-u*o*x+i*c*x)*E,n[11]=(p*c*s-u*f*s-p*o*h+i*f*h+u*o*m-i*c*m)*E,n[12]=M*E,n[13]=(p*y*a-g*f*a+g*o*d-i*y*d-p*o*v+i*f*v)*E,n[14]=(g*c*a-u*y*a-g*o*l+i*y*l+u*o*v-i*c*v)*E,n[15]=(u*f*a-p*c*a+p*o*l-i*f*l-u*o*d+i*c*d)*E,this},scale:function(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){const r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,c=o+o,l=a+a,h=i*u,p=i*c,f=i*l,d=o*c,m=o*l,g=a*l,y=s*u,v=s*c,x=s*l,b=n.x,w=n.y,_=n.z;return r[0]=(1-(d+g))*b,r[1]=(p+x)*b,r[2]=(f-v)*b,r[3]=0,r[4]=(p-x)*w,r[5]=(1-(h+g))*w,r[6]=(m+y)*w,r[7]=0,r[8]=(f+v)*_,r[9]=(m-y)*_,r[10]=(1-(h+d))*_,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){const r=this.elements;let i=Ed.set(r[0],r[1],r[2]).length(),o=Ed.set(r[4],r[5],r[6]).length(),a=Ed.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Nd.copy(this);const s=1/i,u=1/o,c=1/a;return Nd.elements[0]*=s,Nd.elements[1]*=s,Nd.elements[2]*=s,Nd.elements[4]*=u,Nd.elements[5]*=u,Nd.elements[6]*=u,Nd.elements[8]*=c,Nd.elements[9]*=c,Nd.elements[10]*=c,e.setFromRotationMatrix(Nd),n.x=i,n.y=o,n.z=a,this},makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*i/(n-r),u=(e+t)/(e-t),c=(n+r)/(n-r),l=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=2*i/(e-t),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=s,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=l,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){const a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i),l=(e+t)*s,h=(n+r)*u,p=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});const Ld=new Pd,Id=new wd;function Dd(t=0,e=0,n=0,r=Dd.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}function kd(){this.mask=1}Dd.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Dd.DefaultOrder="XYZ",Object.defineProperties(Dd.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(Dd.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){const r=hd.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],c=i[5],l=i[9],h=i[2],p=i[6],f=i[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return Ld.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ld,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return Id.setFromEuler(this),this.setFromQuaternion(Id,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Sd(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(kd.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});let zd=0;const Bd=new Sd,Ud=new wd,Fd=new Pd,jd=new Sd,Hd=new Sd,Vd=new Sd,Gd=new wd,qd=new Sd(1,0,0),Wd=new Sd(0,1,0),Zd=new Sd(0,0,1),$d={type:"added"},Yd={type:"removed"};function Xd(){Object.defineProperty(this,"id",{value:zd++}),this.uuid=hd.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xd.DefaultUp.clone();const t=new Sd,e=new Dd,n=new wd,r=new Sd(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Pd},normalMatrix:{value:new fd}}),this.matrix=new Pd,this.matrixWorld=new Pd,this.matrixAutoUpdate=Xd.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new kd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Jd(){Xd.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Xd.DefaultUp=new Sd(0,1,0),Xd.DefaultMatrixAutoUpdate=!0,Xd.prototype=Object.assign(Object.create(cd.prototype),{constructor:Xd,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Ud.setFromAxisAngle(t,e),this.quaternion.multiply(Ud),this},rotateOnWorldAxis:function(t,e){return Ud.setFromAxisAngle(t,e),this.quaternion.premultiply(Ud),this},rotateX:function(t){return this.rotateOnAxis(qd,t)},rotateY:function(t){return this.rotateOnAxis(Wd,t)},rotateZ:function(t){return this.rotateOnAxis(Zd,t)},translateOnAxis:function(t,e){return Bd.copy(t).applyQuaternion(this.quaternion),this.position.add(Bd.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(qd,t)},translateY:function(t){return this.translateOnAxis(Wd,t)},translateZ:function(t){return this.translateOnAxis(Zd,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Fd.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?jd.copy(t):jd.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Hd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Fd.lookAt(Hd,jd,this.up):Fd.lookAt(jd,Hd,this.up),this.quaternion.setFromRotationMatrix(Fd),r&&(Fd.extractRotation(r.matrixWorld),Ud.setFromRotationMatrix(Fd),this.quaternion.premultiply(Ud.inverse()))},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent($d)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Yd)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Fd.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Fd.multiply(t.parent.matrixWorld)),t.applyMatrix4(Fd),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Sd),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new wd),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hd,t,Vd),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Sd),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hd,Gd,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Sd),this.updateMatrixWorld(!0);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++)i(t.shapes,n[e]);else i(t.shapes,n)}}if(void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),a=o(t.images),s=o(t.shapes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}),Jd.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Jd,isScene:!0,copy:function(t,e){return Xd.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){const e=Xd.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Qd=[new Sd,new Sd,new Sd,new Sd,new Sd,new Sd,new Sd,new Sd],Kd=new Sd,tm=new hm,em=new Sd,nm=new Sd,rm=new Sd,im=new Sd,om=new Sd,am=new Sd,sm=new Sd,um=new Sd,cm=new Sd,lm=new Sd;function hm(t,e){this.min=void 0!==t?t:new Sd(1/0,1/0,1/0),this.max=void 0!==e?e:new Sd(-1/0,-1/0,-1/0)}function pm(t,e,n,r,i){for(let o=0,a=t.length-3;o<=a;o+=3){lm.fromArray(t,o);const a=i.x*Math.abs(lm.x)+i.y*Math.abs(lm.y)+i.z*Math.abs(lm.z),s=e.dot(lm),u=n.dot(lm),c=r.dot(lm);if(Math.max(-Math.max(s,u,c),Math.min(s,u,c))>a)return!1}return!0}Object.assign(hm.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.length;s<u;s+=3){const u=t[s],c=t[s+1],l=t[s+2];u<e&&(e=u),c<n&&(n=c),l<r&&(r=l),u>i&&(i=u),c>o&&(o=c),l>a&&(a=l)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.count;s<u;s++){const u=t.getX(s),c=t.getY(s),l=t.getZ(s);u<e&&(e=u),c<n&&(n=c),l<r&&(r=l),u>i&&(i=u),c>o&&(o=c),l>a&&(a=l)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){const n=Kd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Sd),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Sd),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),tm.copy(e.boundingBox),tm.applyMatrix4(t.matrixWorld),this.union(tm));const n=t.children;for(let r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Sd),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Kd),Kd.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(sm),um.subVectors(this.max,sm),em.subVectors(t.a,sm),nm.subVectors(t.b,sm),rm.subVectors(t.c,sm),im.subVectors(nm,em),om.subVectors(rm,nm),am.subVectors(em,rm);let e=[0,-im.z,im.y,0,-om.z,om.y,0,-am.z,am.y,im.z,0,-im.x,om.z,0,-om.x,am.z,0,-am.x,-im.y,im.x,0,-om.y,om.x,0,-am.y,am.x,0];return!!pm(e,em,nm,rm,um)&&(e=[1,0,0,0,1,0,0,0,1],!!pm(e,em,nm,rm,um)&&(cm.crossVectors(im,om),e=[cm.x,cm.y,cm.z],pm(e,em,nm,rm,um)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Sd),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Kd.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Kd).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Qd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Qd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Qd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Qd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Qd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Qd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Qd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Qd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Qd)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const fm=new hm;function dm(t,e){this.center=void 0!==t?t:new Sd,this.radius=void 0!==e?e:-1}Object.assign(dm.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){const n=this.center;void 0!==e?n.copy(e):fm.setFromPoints(t).getCenter(n);let r=0;for(let i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){const n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Sd),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new hm),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});const mm=new Sd,gm=new Sd,ym=new Sd,vm=new Sd,xm=new Sd,bm=new Sd,wm=new Sd;function _m(t,e){this.origin=void 0!==t?t:new Sd,this.direction=void 0!==e?e:new Sd(0,0,-1)}Object.assign(_m.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Sd),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,mm)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Sd),e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){const e=mm.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(mm.copy(this.direction).multiplyScalar(e).add(this.origin),mm.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){gm.copy(t).add(e).multiplyScalar(.5),ym.copy(e).sub(t).normalize(),vm.copy(this.origin).sub(gm);const i=.5*t.distanceTo(e),o=-this.direction.dot(ym),a=vm.dot(this.direction),s=-vm.dot(ym),u=vm.lengthSq(),c=Math.abs(1-o*o);let l,h,p,f;if(c>0)if(l=o*s-a,h=o*a-s,f=i*c,l>=0)if(h>=-f)if(h<=f){const t=1/c;l*=t,h*=t,p=l*(l+o*h+2*a)+h*(o*l+h+2*s)+u}else h=i,l=Math.max(0,-(o*h+a)),p=-l*l+h*(h+2*s)+u;else h=-i,l=Math.max(0,-(o*h+a)),p=-l*l+h*(h+2*s)+u;else h<=-f?(l=Math.max(0,-(-o*i+a)),h=l>0?-i:Math.min(Math.max(-i,-s),i),p=-l*l+h*(h+2*s)+u):h<=f?(l=0,h=Math.min(Math.max(-i,-s),i),p=h*(h+2*s)+u):(l=Math.max(0,-(o*i+a)),h=l>0?i:Math.min(Math.max(-i,-s),i),p=-l*l+h*(h+2*s)+u);else h=o>0?-i:i,l=Math.max(0,-(o*h+a)),p=-l*l+h*(h+2*s)+u;return n&&n.copy(this.direction).multiplyScalar(l).add(this.origin),r&&r.copy(ym).multiplyScalar(h).add(gm),p},intersectSphere:function(t,e){mm.subVectors(t.center,this.origin);const n=mm.dot(this.direction),r=mm.dot(mm)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:this.at(a<0?s:a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){let n,r,i,o,a,s;const u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,mm)},intersectTriangle:function(t,e,n,r,i){xm.subVectors(e,t),bm.subVectors(n,t),wm.crossVectors(xm,bm);let o,a=this.direction.dot(wm);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}vm.subVectors(this.origin,t);const s=o*this.direction.dot(bm.crossVectors(vm,bm));if(s<0)return null;const u=o*this.direction.dot(xm.cross(vm));if(u<0)return null;if(s+u>a)return null;const c=-o*vm.dot(wm);return c<0?null:this.at(c/a,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});const Mm=new Sd,Sm=new Sd,Em=new fd;function Nm(t,e){this.normal=void 0!==t?t:new Sd(1,0,0),this.constant=void 0!==e?e:0}Object.assign(Nm.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){const r=Mm.subVectors(n,e).cross(Sm.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Sd),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Sd);const n=t.delta(Mm),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Sd),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){const n=e||Em.getNormalMatrix(t),r=this.coplanarPoint(Mm).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});const Tm=new Sd,Am=new Sd,Cm=new Sd,Om=new Sd,Rm=new Sd,Pm=new Sd,Lm=new Sd,Im=new Sd,Dm=new Sd,km=new Sd;function zm(t,e,n){this.a=void 0!==t?t:new Sd,this.b=void 0!==e?e:new Sd,this.c=void 0!==n?n:new Sd}Object.assign(zm,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Sd),r.subVectors(n,e),Tm.subVectors(t,e),r.cross(Tm);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){Tm.subVectors(r,e),Am.subVectors(n,e),Cm.subVectors(t,e);const o=Tm.dot(Tm),a=Tm.dot(Am),s=Tm.dot(Cm),u=Am.dot(Am),c=Am.dot(Cm),l=o*u-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Sd),0===l)return i.set(-2,-1,-1);const h=1/l,p=(u*s-a*c)*h,f=(o*c-a*s)*h;return i.set(1-p-f,f,p)},containsPoint:function(t,e,n,r){return zm.getBarycoord(t,e,n,r,Om),Om.x>=0&&Om.y>=0&&Om.x+Om.y<=1},getUV:function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Om),s.set(0,0),s.addScaledVector(i,Om.x),s.addScaledVector(o,Om.y),s.addScaledVector(a,Om.z),s},isFrontFacing:function(t,e,n,r){return Tm.subVectors(n,e),Am.subVectors(t,e),Tm.cross(Am).dot(r)<0}}),Object.assign(zm.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Tm.subVectors(this.c,this.b),Am.subVectors(this.a,this.b),.5*Tm.cross(Am).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Sd),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return zm.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Nm),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return zm.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return zm.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return zm.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return zm.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Sd);const n=this.a,r=this.b,i=this.c;let o,a;Rm.subVectors(r,n),Pm.subVectors(i,n),Im.subVectors(t,n);const s=Rm.dot(Im),u=Pm.dot(Im);if(s<=0&&u<=0)return e.copy(n);Dm.subVectors(t,r);const c=Rm.dot(Dm),l=Pm.dot(Dm);if(c>=0&&l<=c)return e.copy(r);const h=s*l-c*u;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),e.copy(n).addScaledVector(Rm,o);km.subVectors(t,i);const p=Rm.dot(km),f=Pm.dot(km);if(f>=0&&p<=f)return e.copy(i);const d=p*u-s*f;if(d<=0&&u>=0&&f<=0)return a=u/(u-f),e.copy(n).addScaledVector(Pm,a);const m=c*f-p*l;if(m<=0&&l-c>=0&&p-f>=0)return Lm.subVectors(i,r),a=(l-c)/(l-c+(p-f)),e.copy(r).addScaledVector(Lm,a);const g=1/(m+d+h);return o=d*g,a=h*g,e.copy(n).addScaledVector(Rm,o).addScaledVector(Pm,a)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});const Bm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Um={h:0,s:0,l:0},Fm={h:0,s:0,l:0};function jm(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Hm(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Vm(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Gm(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function qm(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new Sd,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new jm,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(jm.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=hd.euclideanModulo(t,1),e=hd.clamp(e,0,1),n=hd.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Hm(i,r,t+1/3),this.g=Hm(i,r,t),this.b=Hm(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let t;const r=n[2];switch(n[1]){case"rgb":case"rgba":if(t=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[5]),this;if(t=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[5]),this;break;case"hsl":case"hsla":if(t=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return e(t[5]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){const e=Bm[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Vm(t.r),this.g=Vm(t.g),this.b=Vm(t.b),this},copyLinearToSRGB:function(t){return this.r=Gm(t.r),this.g=Gm(t.g),this.b=Gm(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,n=this.g,r=this.b,i=Math.max(e,n,r),o=Math.min(e,n,r);let a,s;const u=(o+i)/2;if(o===i)a=0,s=0;else{const t=i-o;switch(s=u<=.5?t/(i+o):t/(2-i-o),i){case e:a=(n-r)/t+(n<r?6:0);break;case n:a=(r-e)/t+2;break;case r:a=(e-n)/t+4}a/=6}return t.h=a,t.s=s,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(Um),Um.h+=t,Um.s+=e,Um.l+=n,this.setHSL(Um.h,Um.s,Um.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Um),t.getHSL(Fm);const n=hd.lerp(Um.h,Fm.h,e),r=hd.lerp(Um.s,Fm.s,e),i=hd.lerp(Um.l,Fm.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},fromBufferAttribute:function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),jm.NAMES=Bm,Object.assign(qm.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});let Wm=0;function Zm(){Object.defineProperty(this,"id",{value:Wm++}),this.uuid=hd.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function $m(t){Zm.call(this),this.type="MeshBasicMaterial",this.color=new jm(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Zm.prototype=Object.assign(Object.create(cd.prototype),{constructor:Zm,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}},toJSON:function(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Zm.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),($m.prototype=Object.create(Zm.prototype)).constructor=$m,$m.prototype.isMeshBasicMaterial=!0,$m.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Ym=new Sd,Xm=new pd;function Jm(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Qm(t,e,n){Jm.call(this,new Int8Array(t),e,n)}function Km(t,e,n){Jm.call(this,new Uint8Array(t),e,n)}function tg(t,e,n){Jm.call(this,new Uint8ClampedArray(t),e,n)}function eg(t,e,n){Jm.call(this,new Int16Array(t),e,n)}function ng(t,e,n){Jm.call(this,new Uint16Array(t),e,n)}function rg(t,e,n){Jm.call(this,new Int32Array(t),e,n)}function ig(t,e,n){Jm.call(this,new Uint32Array(t),e,n)}function og(t,e,n){Jm.call(this,new Float32Array(t),e,n)}function ag(t,e,n){Jm.call(this,new Float64Array(t),e,n)}function sg(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function ug(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Jm.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Jm.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new jm),e[n++]=i.r,e[n++]=i.g,e[n++]=i.b}return this},copyVector2sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new pd),e[n++]=i.x,e[n++]=i.y}return this},copyVector3sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new Sd),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z}return this},copyVector4sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new vd),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z,e[n++]=i.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Xm.fromBufferAttribute(this,e),Xm.applyMatrix3(t),this.setXY(e,Xm.x,Xm.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Ym.fromBufferAttribute(this,e),Ym.applyMatrix3(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this},applyMatrix4:function(t){for(let e=0,n=this.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.applyMatrix4(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this},applyNormalMatrix:function(t){for(let e=0,n=this.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.applyNormalMatrix(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this},transformDirection:function(t){for(let e=0,n=this.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.transformDirection(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(Qm.prototype=Object.create(Jm.prototype)).constructor=Qm,(Km.prototype=Object.create(Jm.prototype)).constructor=Km,(tg.prototype=Object.create(Jm.prototype)).constructor=tg,(eg.prototype=Object.create(Jm.prototype)).constructor=eg,(ng.prototype=Object.create(Jm.prototype)).constructor=ng,(rg.prototype=Object.create(Jm.prototype)).constructor=rg,(ig.prototype=Object.create(Jm.prototype)).constructor=ig,(og.prototype=Object.create(Jm.prototype)).constructor=og,(ag.prototype=Object.create(Jm.prototype)).constructor=ag,Object.assign(sg.prototype,{computeGroups:function(t){const e=[];let n,r,i=void 0;const o=t.faces;for(r=0;r<o.length;r++){const t=o[r];t.materialIndex!==i&&(i=t.materialIndex,void 0!==n&&(n.count=3*r-n.start,e.push(n)),n={start:3*r,materialIndex:i})}void 0!==n&&(n.count=3*r-n.start,e.push(n)),this.groups=e},fromGeometry:function(t){const e=t.faces,n=t.vertices,r=t.faceVertexUvs,i=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,a=t.morphTargets,s=a.length;let u;if(s>0){u=[];for(let t=0;t<s;t++)u[t]={name:a[t].name,data:[]};this.morphTargets.position=u}const c=t.morphNormals,l=c.length;let h;if(l>0){h=[];for(let t=0;t<l;t++)h[t]={name:c[t].name,data:[]};this.morphTargets.normal=h}const p=t.skinIndices,f=t.skinWeights,d=p.length===n.length,m=f.length===n.length;n.length>0&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<e.length;g++){const t=e[g];this.vertices.push(n[t.a],n[t.b],n[t.c]);const y=t.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{const e=t.normal;this.normals.push(e,e,e)}const v=t.vertexColors;if(3===v.length)this.colors.push(v[0],v[1],v[2]);else{const e=t.color;this.colors.push(e,e,e)}if(!0===i){const t=r[0][g];void 0!==t?this.uvs.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new pd,new pd,new pd))}if(!0===o){const t=r[1][g];void 0!==t?this.uvs2.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new pd,new pd,new pd))}for(let e=0;e<s;e++){const n=a[e].vertices;u[e].data.push(n[t.a],n[t.b],n[t.c])}for(let e=0;e<l;e++){const t=c[e].vertexNormals[g];h[e].data.push(t.a,t.b,t.c)}d&&this.skinIndices.push(p[t.a],p[t.b],p[t.c]),m&&this.skinWeights.push(f[t.a],f[t.b],f[t.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});let cg=1;const lg=new Pd,hg=new Xd,pg=new Sd,fg=new hm,dg=new hm,mg=new Sd;function gg(){Object.defineProperty(this,"id",{value:cg+=2}),this.uuid=hd.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}gg.prototype=Object.assign(Object.create(cd.prototype),{constructor:gg,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(ug(t)>65535?ig:ng)(t,1):t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new fd).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return lg.makeRotationX(t),this.applyMatrix4(lg),this},rotateY:function(t){return lg.makeRotationY(t),this.applyMatrix4(lg),this},rotateZ:function(t){return lg.makeRotationZ(t),this.applyMatrix4(lg),this},translate:function(t,e,n){return lg.makeTranslation(t,e,n),this.applyMatrix4(lg),this},scale:function(t,e,n){return lg.makeScale(t,e,n),this.applyMatrix4(lg),this},lookAt:function(t){return hg.lookAt(t),hg.updateMatrix(),this.applyMatrix4(hg.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(pg).negate(),this.translate(pg.x,pg.y,pg.z),this},setFromObject:function(t){const e=t.geometry;if(t.isPoints||t.isLine){const t=new og(3*e.vertices.length,3),n=new og(3*e.colors.length,3);if(this.setAttribute("position",t.copyVector3sArray(e.vertices)),this.setAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){const t=new og(e.lineDistances.length,1);this.setAttribute("lineDistance",t.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new og(e,3)),this},updateFromObject:function(t){let e=t.geometry;if(t.isMesh){let t=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(t=void 0,e.elementsNeedUpdate=!1),void 0===t)return this.fromGeometry(e);t.verticesNeedUpdate=e.verticesNeedUpdate,t.normalsNeedUpdate=e.normalsNeedUpdate,t.colorsNeedUpdate=e.colorsNeedUpdate,t.uvsNeedUpdate=e.uvsNeedUpdate,t.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=t}if(!0===e.verticesNeedUpdate){const t=this.attributes.position;void 0!==t&&(t.copyVector3sArray(e.vertices),t.needsUpdate=!0),e.verticesNeedUpdate=!1}if(!0===e.normalsNeedUpdate){const t=this.attributes.normal;void 0!==t&&(t.copyVector3sArray(e.normals),t.needsUpdate=!0),e.normalsNeedUpdate=!1}if(!0===e.colorsNeedUpdate){const t=this.attributes.color;void 0!==t&&(t.copyColorsArray(e.colors),t.needsUpdate=!0),e.colorsNeedUpdate=!1}if(e.uvsNeedUpdate){const t=this.attributes.uv;void 0!==t&&(t.copyVector2sArray(e.uvs),t.needsUpdate=!0),e.uvsNeedUpdate=!1}if(e.lineDistancesNeedUpdate){const t=this.attributes.lineDistance;void 0!==t&&(t.copyArray(e.lineDistances),t.needsUpdate=!0),e.lineDistancesNeedUpdate=!1}return e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new sg).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Jm(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){const e=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Jm(e,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const e=new Float32Array(3*t.colors.length);this.setAttribute("color",new Jm(e,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const e=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Jm(e,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const e=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Jm(e,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const n in t.morphTargets){const e=[],r=t.morphTargets[n];for(let t=0,n=r.length;t<n;t++){const n=r[t],i=new og(3*n.data.length,3);i.name=n.name,e.push(i.copyVector3sArray(n.data))}this.morphAttributes[n]=e}if(t.skinIndices.length>0){const e=new og(4*t.skinIndices.length,4);this.setAttribute("skinIndex",e.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const e=new og(4*t.skinWeights.length,4);this.setAttribute("skinWeight",e.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new hm);const t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++)fg.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(mg.addVectors(this.boundingBox.min,fg.min),this.boundingBox.expandByPoint(mg),mg.addVectors(this.boundingBox.max,fg.max),this.boundingBox.expandByPoint(mg)):(this.boundingBox.expandByPoint(fg.min),this.boundingBox.expandByPoint(fg.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new dm);const t=this.attributes.position,e=this.morphAttributes.position;if(t){const n=this.boundingSphere.center;if(fg.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++)dg.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(mg.addVectors(fg.min,dg.min),fg.expandByPoint(mg),mg.addVectors(fg.max,dg.max),fg.expandByPoint(mg)):(fg.expandByPoint(dg.min),fg.expandByPoint(dg.max));fg.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)mg.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(mg));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],a=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)mg.fromBufferAttribute(o,e),a&&(pg.fromBufferAttribute(t,e),mg.add(pg)),r=Math.max(r,n.distanceToSquared(mg))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Jm(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new Sd,i=new Sd,o=new Sd,a=new Sd,s=new Sd,u=new Sd,c=new Sd,l=new Sd;if(t)for(let h=0,p=t.count;h<p;h+=3){const p=t.getX(h+0),f=t.getX(h+1),d=t.getX(h+2);r.fromBufferAttribute(e,p),i.fromBufferAttribute(e,f),o.fromBufferAttribute(e,d),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),a.fromBufferAttribute(n,p),s.fromBufferAttribute(n,f),u.fromBufferAttribute(n,d),a.add(c),s.add(c),u.add(c),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(d,u.x,u.y,u.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,u=Math.min(a.length,i.length-s);for(let t=0,e=s;t<u;t++,e++)i[e]=a[t]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)mg.fromBufferAttribute(t,e),mg.normalize(),t.setXYZ(e,mg.x,mg.y,mg.z)},toNonIndexed:function(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let a=0,s=0;for(let u=0,c=e.length;u<c;u++){a=e[u]*r;for(let t=0;t<r;t++)o[s++]=n[a++]}return new Jm(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const e=new gg,n=this.index.array,r=this.attributes;for(const a in r){const i=t(r[a],n);e.setAttribute(a,i)}const i=this.morphAttributes;for(const a in i){const r=[],o=i[a];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],n);r.push(i)}e.morphAttributes[a]=r}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,s=o.length;a<s;a++){const t=o[a];e.addGroup(t.start,t.count,t.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const s in n){const e=n[s],r=e.toJSON(t.data);""!==e.name&&(r.name=e.name),t.data.attributes[s]=r}const r={};let i=!1;for(const s in this.morphAttributes){const e=this.morphAttributes[s],n=[];for(let r=0,i=e.length;r<i;r++){const i=e[r],o=i.toJSON(t.data);""!==i.name&&(o.name=i.name),n.push(o)}n.length>0&&(r[s]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t},clone:function(){return(new gg).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const u in r)this.setAttribute(u,r[u].clone(e));const i=t.morphAttributes;for(const u in i){const t=[],n=i[u];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[u]=t}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let u=0,c=o.length;u<c;u++){const t=o[u];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const yg=new Pd,vg=new _m,xg=new dm,bg=new Sd,wg=new Sd,_g=new Sd,Mg=new Sd,Sg=new Sd,Eg=new Sd,Ng=new Sd,Tg=new Sd,Ag=new Sd,Cg=new pd,Og=new pd,Rg=new pd,Pg=new Sd,Lg=new Sd;function Ig(t,e){Xd.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new gg,this.material=void 0!==e?e:new $m,this.updateMorphTargets()}function Dg(t,e,n,r,i,o,a,s){let u;if(u=1===e.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==e.side,s),null===u)return null;Lg.copy(s),Lg.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(Lg);return c<n.near||c>n.far?null:{distance:c,point:Lg.clone(),object:t}}function kg(t,e,n,r,i,o,a,s,u,c,l,h){bg.fromBufferAttribute(i,c),wg.fromBufferAttribute(i,l),_g.fromBufferAttribute(i,h);const p=t.morphTargetInfluences;if(e.morphTargets&&o&&p){Ng.set(0,0,0),Tg.set(0,0,0),Ag.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=p[t],n=o[t];0!==e&&(Mg.fromBufferAttribute(n,c),Sg.fromBufferAttribute(n,l),Eg.fromBufferAttribute(n,h),a?(Ng.addScaledVector(Mg,e),Tg.addScaledVector(Sg,e),Ag.addScaledVector(Eg,e)):(Ng.addScaledVector(Mg.sub(bg),e),Tg.addScaledVector(Sg.sub(wg),e),Ag.addScaledVector(Eg.sub(_g),e)))}bg.add(Ng),wg.add(Tg),_g.add(Ag)}t.isSkinnedMesh&&(t.boneTransform(c,bg),t.boneTransform(l,wg),t.boneTransform(h,_g));const f=Dg(t,e,n,r,bg,wg,_g,Pg);if(f){s&&(Cg.fromBufferAttribute(s,c),Og.fromBufferAttribute(s,l),Rg.fromBufferAttribute(s,h),f.uv=zm.getUV(Pg,bg,wg,_g,Cg,Og,Rg,new pd)),u&&(Cg.fromBufferAttribute(u,c),Og.fromBufferAttribute(u,l),Rg.fromBufferAttribute(u,h),f.uv2=zm.getUV(Pg,bg,wg,_g,Cg,Og,Rg,new pd));const t=new qm(c,l,h);zm.getNormal(bg,wg,_g,t.normal),f.face=t}return f}Ig.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Ig,isMesh:!0,copy:function(t){return Xd.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),xg.copy(n.boundingSphere),xg.applyMatrix4(i),!1===t.ray.intersectsSphere(xg))return;if(yg.getInverse(i),vg.copy(t.ray).applyMatrix4(yg),null!==n.boundingBox&&!1===vg.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const i=n.index,a=n.attributes.position,s=n.morphAttributes.position,u=n.morphTargetsRelative,c=n.attributes.uv,l=n.attributes.uv2,h=n.groups,p=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,f=h.length;n<f;n++){const f=h[n],d=r[f.materialIndex];for(let n=Math.max(f.start,p.start),r=Math.min(f.start+f.count,p.start+p.count);n<r;n+=3){const r=i.getX(n),h=i.getX(n+1),p=i.getX(n+2);o=kg(this,d,t,vg,a,s,u,c,l,r,h,p),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=f.materialIndex,e.push(o))}}else for(let n=Math.max(0,p.start),f=Math.min(i.count,p.start+p.count);n<f;n+=3){const h=i.getX(n),p=i.getX(n+1),f=i.getX(n+2);o=kg(this,r,t,vg,a,s,u,c,l,h,p,f),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}else if(void 0!==a)if(Array.isArray(r))for(let n=0,f=h.length;n<f;n++){const i=h[n],f=r[i.materialIndex];for(let n=Math.max(i.start,p.start),r=Math.min(i.start+i.count,p.start+p.count);n<r;n+=3)o=kg(this,f,t,vg,a,s,u,c,l,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,e.push(o))}else for(let n=Math.max(0,p.start),f=Math.min(a.count,p.start+p.count);n<f;n+=3)o=kg(this,r,t,vg,a,s,u,c,l,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}else if(n.isGeometry){const i=Array.isArray(r),a=n.vertices,s=n.faces;let u;const c=n.faceVertexUvs[0];c.length>0&&(u=c);for(let n=0,l=s.length;n<l;n++){const c=s[n],l=i?r[c.materialIndex]:r;if(void 0===l)continue;const h=a[c.a],p=a[c.b],f=a[c.c];if(o=Dg(this,l,t,vg,h,p,f,Pg),o){if(u&&u[n]){const t=u[n];Cg.copy(t[0]),Og.copy(t[1]),Rg.copy(t[2]),o.uv=zm.getUV(Pg,h,p,f,Cg,Og,Rg,new pd)}o.face=c,o.faceIndex=n,e.push(o)}}}}});let zg=0;const Bg=new Pd,Ug=new Xd,Fg=new Sd;function jg(){Object.defineProperty(this,"id",{value:zg+=2}),this.uuid=hd.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}jg.prototype=Object.assign(Object.create(cd.prototype),{constructor:jg,isGeometry:!0,applyMatrix4:function(t){const e=(new fd).getNormalMatrix(t);for(let n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(t);for(let n=0,r=this.faces.length;n<r;n++){const t=this.faces[n];t.normal.applyMatrix3(e).normalize();for(let n=0,r=t.vertexNormals.length;n<r;n++)t.vertexNormals[n].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Bg.makeRotationX(t),this.applyMatrix4(Bg),this},rotateY:function(t){return Bg.makeRotationY(t),this.applyMatrix4(Bg),this},rotateZ:function(t){return Bg.makeRotationZ(t),this.applyMatrix4(Bg),this},translate:function(t,e,n){return Bg.makeTranslation(t,e,n),this.applyMatrix4(Bg),this},scale:function(t,e,n){return Bg.makeScale(t,e,n),this.applyMatrix4(Bg),this},lookAt:function(t){return Ug.lookAt(t),Ug.updateMatrix(),this.applyMatrix4(Ug.matrix),this},fromBufferGeometry:function(t){const e=this,n=null!==t.index?t.index:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const i=r.position,o=r.normal,a=r.color,s=r.uv,u=r.uv2;void 0!==u&&(this.faceVertexUvs[1]=[]);for(let h=0;h<i.count;h++)e.vertices.push((new Sd).fromBufferAttribute(i,h)),void 0!==a&&e.colors.push((new jm).fromBufferAttribute(a,h));function c(t,n,r,i){const c=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],l=new qm(t,n,r,void 0===o?[]:[(new Sd).fromBufferAttribute(o,t),(new Sd).fromBufferAttribute(o,n),(new Sd).fromBufferAttribute(o,r)],c,i);e.faces.push(l),void 0!==s&&e.faceVertexUvs[0].push([(new pd).fromBufferAttribute(s,t),(new pd).fromBufferAttribute(s,n),(new pd).fromBufferAttribute(s,r)]),void 0!==u&&e.faceVertexUvs[1].push([(new pd).fromBufferAttribute(u,t),(new pd).fromBufferAttribute(u,n),(new pd).fromBufferAttribute(u,r)])}const l=t.groups;if(l.length>0)for(let h=0;h<l.length;h++){const t=l[h],e=t.start;for(let r=e,i=e+t.count;r<i;r+=3)void 0!==n?c(n.getX(r),n.getX(r+1),n.getX(r+2),t.materialIndex):c(r,r+1,r+2,t.materialIndex)}else if(void 0!==n)for(let h=0;h<n.count;h+=3)c(n.getX(h),n.getX(h+1),n.getX(h+2));else for(let h=0;h<i.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fg).negate(),this.translate(Fg.x,Fg.y,Fg.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new Pd;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){const t=new Sd,e=new Sd;for(let n=0,r=this.faces.length;n<r;n++){const r=this.faces[n],i=this.vertices[r.a],o=this.vertices[r.b];t.subVectors(this.vertices[r.c],o),e.subVectors(i,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);const e=new Array(this.vertices.length);for(let n=0,r=this.vertices.length;n<r;n++)e[n]=new Sd;if(t){const t=new Sd,n=new Sd;for(let r=0,i=this.faces.length;r<i;r++){const i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b];t.subVectors(this.vertices[i.c],a),n.subVectors(o,a),t.cross(n),e[i.a].add(t),e[i.b].add(t),e[i.c].add(t)}}else{this.computeFaceNormals();for(let t=0,n=this.faces.length;t<n;t++){const n=this.faces[t];e[n.a].add(n.normal),e[n.b].add(n.normal),e[n.c].add(n.normal)}}for(let n=0,r=this.vertices.length;n<r;n++)e[n].normalize();for(let n=0,r=this.faces.length;n<r;n++){const t=this.faces[n],r=t.vertexNormals;3===r.length?(r[0].copy(e[t.a]),r[1].copy(e[t.b]),r[2].copy(e[t.c])):(r[0]=e[t.a].clone(),r[1]=e[t.b].clone(),r[2]=e[t.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t],n=e.vertexNormals;3===n.length?(n[0].copy(e.normal),n[1].copy(e.normal),n[2].copy(e.normal)):(n[0]=e.normal.clone(),n[1]=e.normal.clone(),n[2]=e.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let e=0,n=this.faces.length;e<n;e++){const t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(let e=0,n=t.vertexNormals.length;e<n;e++)t.__originalVertexNormals[e]?t.__originalVertexNormals[e].copy(t.vertexNormals[e]):t.__originalVertexNormals[e]=t.vertexNormals[e].clone()}const t=new jg;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];const t=this.morphNormals[e].faceNormals,n=this.morphNormals[e].vertexNormals;for(let e=0,r=this.faces.length;e<r;e++){const e=new Sd,r={a:new Sd,b:new Sd,c:new Sd};t.push(e),n.push(r)}}const n=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t],r=n.vertexNormals[t];n.faceNormals[t].copy(e.normal),r.a.copy(e.vertexNormals[0]),r.b.copy(e.vertexNormals[1]),r.c.copy(e.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){const t=this.faces[e];t.normal=t.__originalFaceNormal,t.vertexNormals=t.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new hm),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new dm),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,c=this.colors,l=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new fd).getNormalMatrix(e));for(let h=0,p=a.length;h<p;h++){const t=a[h].clone();void 0!==e&&t.applyMatrix4(e),o.push(t)}for(let h=0,p=l.length;h<p;h++)c.push(l[h].clone());for(let h=0,p=u.length;h<p;h++){let t,e,o,a=u[h],c=a.vertexNormals,l=a.vertexColors;t=new qm(a.a+i,a.b+i,a.c+i),t.normal.copy(a.normal),void 0!==r&&t.normal.applyMatrix3(r).normalize();for(let n=0,i=c.length;n<i;n++)e=c[n].clone(),void 0!==r&&e.applyMatrix3(r).normalize(),t.vertexNormals.push(e);t.color.copy(a.color);for(let n=0,r=l.length;n<r;n++)o=l[n],t.vertexColors.push(o.clone());t.materialIndex=a.materialIndex+n,s.push(t)}for(let h=0,p=t.faceVertexUvs.length;h<p;h++){const e=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let t=0,n=e.length;t<n;t++){const n=e[t],r=[];for(let t=0,e=n.length;t<e;t++)r.push(n[t].clone());this.faceVertexUvs[h].push(r)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){const t={},e=[],n=[],r=Math.pow(10,4);for(let a=0,s=this.vertices.length;a<s;a++){const i=this.vertices[a],o=Math.round(i.x*r)+"_"+Math.round(i.y*r)+"_"+Math.round(i.z*r);void 0===t[o]?(t[o]=a,e.push(this.vertices[a]),n[a]=e.length-1):n[a]=n[t[o]]}const i=[];for(let a=0,s=this.faces.length;a<s;a++){const t=this.faces[a];t.a=n[t.a],t.b=n[t.b],t.c=n[t.c];const e=[t.a,t.b,t.c];for(let n=0;n<3;n++)if(e[n]===e[(n+1)%3]){i.push(a);break}}for(let a=i.length-1;a>=0;a--){const t=i[a];this.faces.splice(t,1);for(let e=0,n=this.faceVertexUvs.length;e<n;e++)this.faceVertexUvs[e].splice(t,1)}const o=this.vertices.length-e.length;return this.vertices=e,o},setFromPoints:function(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){const n=t[e];this.vertices.push(new Sd(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));const n=this.faceVertexUvs[0],r=this.faceVertexUvs[1];let i,o;n&&n.length===e&&(i=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){const e=t[a]._id;i&&i.push(n[e]),o&&o.push(r[e])}i&&(this.faceVertexUvs[0]=i),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}const e=[];for(let f=0;f<this.vertices.length;f++){const t=this.vertices[f];e.push(t.x,t.y,t.z)}const n=[],r=[],i={},o=[],a={},s=[],u={};for(let f=0;f<this.faces.length;f++){const t=this.faces[f],e=!0,r=!1,i=void 0!==this.faceVertexUvs[0][f],o=t.normal.length()>0,a=t.vertexNormals.length>0,s=1!==t.color.r||1!==t.color.g||1!==t.color.b,u=t.vertexColors.length>0;let d=0;if(d=c(d,0,0),d=c(d,1,e),d=c(d,2,r),d=c(d,3,i),d=c(d,4,o),d=c(d,5,a),d=c(d,6,s),d=c(d,7,u),n.push(d),n.push(t.a,t.b,t.c),n.push(t.materialIndex),i){const t=this.faceVertexUvs[0][f];n.push(p(t[0]),p(t[1]),p(t[2]))}if(o&&n.push(l(t.normal)),a){const e=t.vertexNormals;n.push(l(e[0]),l(e[1]),l(e[2]))}if(s&&n.push(h(t.color)),u){const e=t.vertexColors;n.push(h(e[0]),h(e[1]),h(e[2]))}}function c(t,e,n){return n?t|1<<e:t&~(1<<e)}function l(t){const e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==i[e]||(i[e]=r.length/3,r.push(t.x,t.y,t.z)),i[e]}function h(t){const e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==a[e]||(a[e]=o.length,o.push(t.getHex())),a[e]}function p(t){const e=t.x.toString()+t.y.toString();return void 0!==u[e]||(u[e]=s.length/2,s.push(t.x,t.y)),u[e]}return t.data={},t.data.vertices=e,t.data.normals=r,o.length>0&&(t.data.colors=o),s.length>0&&(t.data.uvs=[s]),t.data.faces=n,t},clone:function(){return(new jg).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const e=t.vertices;for(let h=0,p=e.length;h<p;h++)this.vertices.push(e[h].clone());const n=t.colors;for(let h=0,p=n.length;h<p;h++)this.colors.push(n[h].clone());const r=t.faces;for(let h=0,p=r.length;h<p;h++)this.faces.push(r[h].clone());for(let h=0,p=t.faceVertexUvs.length;h<p;h++){const e=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(let t=0,n=e.length;t<n;t++){const n=e[t],r=[];for(let t=0,e=n.length;t<e;t++)r.push(n[t].clone());this.faceVertexUvs[h].push(r)}}const i=t.morphTargets;for(let h=0,p=i.length;h<p;h++){const t={};if(t.name=i[h].name,void 0!==i[h].vertices){t.vertices=[];for(let e=0,n=i[h].vertices.length;e<n;e++)t.vertices.push(i[h].vertices[e].clone())}if(void 0!==i[h].normals){t.normals=[];for(let e=0,n=i[h].normals.length;e<n;e++)t.normals.push(i[h].normals[e].clone())}this.morphTargets.push(t)}const o=t.morphNormals;for(let h=0,p=o.length;h<p;h++){const t={};if(void 0!==o[h].vertexNormals){t.vertexNormals=[];for(let e=0,n=o[h].vertexNormals.length;e<n;e++){const n=o[h].vertexNormals[e],r={};r.a=n.a.clone(),r.b=n.b.clone(),r.c=n.c.clone(),t.vertexNormals.push(r)}}if(void 0!==o[h].faceNormals){t.faceNormals=[];for(let e=0,n=o[h].faceNormals.length;e<n;e++)t.faceNormals.push(o[h].faceNormals[e].clone())}this.morphNormals.push(t)}const a=t.skinWeights;for(let h=0,p=a.length;h<p;h++)this.skinWeights.push(a[h].clone());const s=t.skinIndices;for(let h=0,p=s.length;h<p;h++)this.skinIndices.push(s[h].clone());const u=t.lineDistances;for(let h=0,p=u.length;h<p;h++)this.lineDistances.push(u[h]);const c=t.boundingBox;null!==c&&(this.boundingBox=c.clone());const l=t.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Hg extends gg{constructor(t,e,n,r,i,o){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const a=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;const s=[],u=[],c=[],l=[];let h=0,p=0;function f(t,e,n,r,i,o,f,d,m,g,y){const v=o/m,x=f/g,b=o/2,w=f/2,_=d/2,M=m+1,S=g+1;let E=0,N=0;const T=new Sd;for(let a=0;a<S;a++){const o=a*x-w;for(let s=0;s<M;s++)T[t]=(s*v-b)*r,T[e]=o*i,T[n]=_,u.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[n]=d>0?1:-1,c.push(T.x,T.y,T.z),l.push(s/m),l.push(1-a/g),E+=1}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=h+t+M*(a+1),n=h+(t+1)+M*(a+1),r=h+(t+1)+M*a;s.push(h+t+M*a,e,r),s.push(e,n,r),N+=6}a.addGroup(p,N,y),p+=N,h+=E}f("z","y","x",-1,-1,n,e,t,o,i,0),f("z","y","x",1,-1,n,e,-t,o,i,1),f("x","z","y",1,1,t,n,e,r,o,2),f("x","z","y",1,-1,t,n,-e,r,o,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new og(u,3)),this.setAttribute("normal",new og(c,3)),this.setAttribute("uv",new og(l,2))}}function Vg(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];e[n][r]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}}return e}function Gg(t){const e={};for(let n=0;n<t.length;n++){const r=Vg(t[n]);for(const t in r)e[t]=r[t]}return e}const qg={clone:Vg,merge:Gg};function Wg(t){Zm.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Zg(){Xd.call(this),this.type="Camera",this.matrixWorldInverse=new Pd,this.projectionMatrix=new Pd,this.projectionMatrixInverse=new Pd}function $g(t,e,n,r){Zg.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Yg(t,e,n){if(Xd.call(this),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new $g(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Sd(1,0,0)),this.add(r);const i=new $g(90,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Sd(-1,0,0)),this.add(i);const o=new $g(90,1,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Sd(0,1,0)),this.add(o);const a=new $g(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Sd(0,-1,0)),this.add(a);const s=new $g(90,1,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Sd(0,0,1)),this.add(s);const u=new $g(90,1,t,e);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Sd(0,0,-1)),this.add(u),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();const c=t.xr.enabled,l=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,s),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,u),t.setRenderTarget(l),t.xr.enabled=c},this.clear=function(t,e,r,i){const o=t.getRenderTarget();for(let a=0;a<6;a++)t.setRenderTarget(n,a),t.clear(e,r,i);t.setRenderTarget(o)}}function Xg(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),xd.call(this,t,t,e)}function Jg(t,e,n,r,i,o,a,s,u,c,l,h){yd.call(this,null,o,a,s,u,c,r,i,l,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==u?u:1003,this.minFilter=void 0!==c?c:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Wg.prototype=Object.create(Zm.prototype)).constructor=Wg,Wg.prototype.isShaderMaterial=!0,Wg.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Vg(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this},Wg.prototype.toJSON=function(t){const e=Zm.prototype.toJSON.call(this,t);e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;e.uniforms[r]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e},Zg.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Zg,isCamera:!0,copy:function(t,e){return Xd.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Sd),this.updateMatrixWorld(!0);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Xd.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Xd.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),$g.prototype=Object.assign(Object.create(Zg.prototype),{constructor:$g,isPerspectiveCamera:!0,copy:function(t,e){return Zg.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const e=.5*this.getFilmHeight()/t;this.fov=2*hd.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*hd.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*hd.RAD2DEG*Math.atan(Math.tan(.5*hd.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let t=this.near,e=t*Math.tan(.5*hd.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/a,r*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(i+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const e=Xd.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),(Yg.prototype=Object.create(Xd.prototype)).constructor=Yg,(Xg.prototype=Object.create(xd.prototype)).constructor=Xg,Xg.prototype.isWebGLCubeRenderTarget=!0,Xg.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;const n=new Jd,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#include <common>","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV = equirectUv( direction );","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new Wg({name:"CubemapFromEquirect",uniforms:Vg(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=e;const o=new Ig(new Hg(5,5,5),i);return n.add(o),new Yg(1,10,this).update(t,n),o.geometry.dispose(),o.material.dispose(),this},(Jg.prototype=Object.create(yd.prototype)).constructor=Jg,Jg.prototype.isDataTexture=!0;const Qg=new dm,Kg=new Sd;function ty(t,e,n,r,i,o){this.planes=[void 0!==t?t:new Nm,void 0!==e?e:new Nm,void 0!==n?n:new Nm,void 0!==r?r:new Nm,void 0!==i?i:new Nm,void 0!==o?o:new Nm]}Object.assign(ty.prototype,{set:function(t,e,n,r,i,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],p=n[9],f=n[10],d=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return e[0].setComponents(a-r,l-s,d-h,v-m).normalize(),e[1].setComponents(a+r,l+s,d+h,v+m).normalize(),e[2].setComponents(a+i,l+u,d+p,v+g).normalize(),e[3].setComponents(a-i,l-u,d-p,v-g).normalize(),e[4].setComponents(a-o,l-c,d-f,v-y).normalize(),e[5].setComponents(a+o,l+c,d+f,v+y).normalize(),this},intersectsObject:function(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Qg.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Qg)},intersectsSprite:function(t){return Qg.center.set(0,0,0),Qg.radius=.7071067811865476,Qg.applyMatrix4(t.matrixWorld),this.intersectsSphere(Qg)},intersectsSphere:function(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++)if(e[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:function(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(Kg.x=r.normal.x>0?t.max.x:t.min.x,Kg.y=r.normal.y>0?t.max.y:t.min.y,Kg.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Kg)<0)return!1}return!0},containsPoint:function(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});const ey={common:{diffuse:{value:new jm(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new fd},uv2Transform:{value:new fd},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pd(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new jm(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new jm(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new fd}},sprite:{diffuse:{value:new jm(15658734)},opacity:{value:1},center:{value:new pd(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new fd}}};function ny(){let t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function ry(t,e){const n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);const o=r.get(e);void 0===o?r.set(e,function(e,n){const r=e.array,i=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();let a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(function(e,r,i){const o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,i),o.version=e.version)}}}function iy(t,e,n,r){jg.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new oy(t,e,n,r)),this.mergeVertices()}function oy(t,e,n,r){gg.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=(t=t||1)/2,o=(e=e||1)/2,a=Math.floor(n)||1,s=Math.floor(r)||1,u=a+1,c=s+1,l=t/a,h=e/s,p=[],f=[],d=[],m=[];for(let g=0;g<c;g++){const t=g*h-o;for(let e=0;e<u;e++)f.push(e*l-i,-t,0),d.push(0,0,1),m.push(e/a),m.push(1-g/s)}for(let g=0;g<s;g++)for(let t=0;t<a;t++){const e=t+u*(g+1),n=t+1+u*(g+1),r=t+1+u*g;p.push(t+u*g,e,r),p.push(e,n,r)}this.setIndex(p),this.setAttribute("position",new og(f,3)),this.setAttribute("normal",new og(d,3)),this.setAttribute("uv",new og(m,2))}(iy.prototype=Object.create(jg.prototype)).constructor=iy,(oy.prototype=Object.create(gg.prototype)).constructor=oy;const ay={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},sy={basic:{uniforms:Gg([ey.common,ey.specularmap,ey.envmap,ey.aomap,ey.lightmap,ey.fog]),vertexShader:ay.meshbasic_vert,fragmentShader:ay.meshbasic_frag},lambert:{uniforms:Gg([ey.common,ey.specularmap,ey.envmap,ey.aomap,ey.lightmap,ey.emissivemap,ey.fog,ey.lights,{emissive:{value:new jm(0)}}]),vertexShader:ay.meshlambert_vert,fragmentShader:ay.meshlambert_frag},phong:{uniforms:Gg([ey.common,ey.specularmap,ey.envmap,ey.aomap,ey.lightmap,ey.emissivemap,ey.bumpmap,ey.normalmap,ey.displacementmap,ey.fog,ey.lights,{emissive:{value:new jm(0)},specular:{value:new jm(1118481)},shininess:{value:30}}]),vertexShader:ay.meshphong_vert,fragmentShader:ay.meshphong_frag},standard:{uniforms:Gg([ey.common,ey.envmap,ey.aomap,ey.lightmap,ey.emissivemap,ey.bumpmap,ey.normalmap,ey.displacementmap,ey.roughnessmap,ey.metalnessmap,ey.fog,ey.lights,{emissive:{value:new jm(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ay.meshphysical_vert,fragmentShader:ay.meshphysical_frag},toon:{uniforms:Gg([ey.common,ey.aomap,ey.lightmap,ey.emissivemap,ey.bumpmap,ey.normalmap,ey.displacementmap,ey.gradientmap,ey.fog,ey.lights,{emissive:{value:new jm(0)}}]),vertexShader:ay.meshtoon_vert,fragmentShader:ay.meshtoon_frag},matcap:{uniforms:Gg([ey.common,ey.bumpmap,ey.normalmap,ey.displacementmap,ey.fog,{matcap:{value:null}}]),vertexShader:ay.meshmatcap_vert,fragmentShader:ay.meshmatcap_frag},points:{uniforms:Gg([ey.points,ey.fog]),vertexShader:ay.points_vert,fragmentShader:ay.points_frag},dashed:{uniforms:Gg([ey.common,ey.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ay.linedashed_vert,fragmentShader:ay.linedashed_frag},depth:{uniforms:Gg([ey.common,ey.displacementmap]),vertexShader:ay.depth_vert,fragmentShader:ay.depth_frag},normal:{uniforms:Gg([ey.common,ey.bumpmap,ey.normalmap,ey.displacementmap,{opacity:{value:1}}]),vertexShader:ay.normal_vert,fragmentShader:ay.normal_frag},sprite:{uniforms:Gg([ey.sprite,ey.fog]),vertexShader:ay.sprite_vert,fragmentShader:ay.sprite_frag},background:{uniforms:{uvTransform:{value:new fd},t2D:{value:null}},vertexShader:ay.background_vert,fragmentShader:ay.background_frag},cube:{uniforms:Gg([ey.envmap,{opacity:{value:1}}]),vertexShader:ay.cube_vert,fragmentShader:ay.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ay.equirect_vert,fragmentShader:ay.equirect_frag},distanceRGBA:{uniforms:Gg([ey.common,ey.displacementmap,{referencePosition:{value:new Sd},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ay.distanceRGBA_vert,fragmentShader:ay.distanceRGBA_frag},shadow:{uniforms:Gg([ey.lights,ey.fog,{color:{value:new jm(0)},opacity:{value:1}}]),vertexShader:ay.shadow_vert,fragmentShader:ay.shadow_frag}};function uy(t,e,n,r){const i=new jm(0);let o,a,s=0,u=null,c=0,l=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return i},setClearColor:function(t,e){i.set(t),s=void 0!==e?e:1,h(i,s)},getClearAlpha:function(){return s},setClearAlpha:function(t){s=t,h(i,s)},render:function(e,r,p,f){let d=!0===r.isScene?r.background:null;const m=t.xr,g=m.getSession&&m.getSession();if(g&&"additive"===g.environmentBlendMode&&(d=null),null===d?h(i,s):d&&d.isColor&&(h(d,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||306===d.mapping)){void 0===a&&(a=new Ig(new Hg(1,1,1),new Wg({name:"BackgroundCubeMaterial",uniforms:Vg(sy.cube.uniforms),vertexShader:sy.cube.vertexShader,fragmentShader:sy.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));const r=d.isWebGLCubeRenderTarget?d.texture:d;a.material.uniforms.envMap.value=r,a.material.uniforms.flipEnvMap.value=r.isCubeTexture?-1:1,u===d&&c===r.version&&l===t.toneMapping||(a.material.needsUpdate=!0,u=d,c=r.version,l=t.toneMapping),e.unshift(a,a.geometry,a.material,0,0,null)}else d&&d.isTexture&&(void 0===o&&(o=new Ig(new oy(2,2),new Wg({name:"BackgroundMaterial",uniforms:Vg(sy.background.uniforms),vertexShader:sy.background.vertexShader,fragmentShader:sy.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(o)),o.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),o.material.uniforms.uvTransform.value.copy(d.matrix),u===d&&c===d.version&&l===t.toneMapping||(o.material.needsUpdate=!0,u=d,c=d.version,l=t.toneMapping),e.unshift(o,o.geometry,o.material,0,0,null))}}}function cy(t,e,n,r){const i=t.getParameter(34921),o=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},u=p(null);let c=u;function l(e){return r.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function h(e){return r.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function p(t){const e=[],n=[],r=[];for(let o=0;o<i;o++)e[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{}}}function f(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function d(t){m(t,0)}function m(n,i){const o=c.enabledAttributes,a=c.attributeDivisors;c.newAttributes[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),a[n]!==i&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i)}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function y(e,n,i,o,a,s){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,o,a,s):t.vertexAttribIPointer(e,n,i,o,a,s)}function v(){x(),c!==u&&(c=u,l(c.object))}function x(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,h,v,x){let b=!1;if(a){const e=function(e,n,i){const a=!0===i.wireframe;let u=s[e.id];void 0===u&&(u={},s[e.id]=u);let c=u[n.id];void 0===c&&(c={},u[n.id]=c);let l=c[a];return void 0===l&&(l=p(r.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),c[a]=l),l}(v,h,u);c!==e&&(c=e,l(c.object)),b=function(t){const e=c.attributes,n=t.attributes;if(Object.keys(e).length!==Object.keys(n).length)return!0;for(const r in n){const t=e[r],i=n[r];if(t.attribute!==i)return!0;if(t.data!==i.data)return!0}return!1}(v),b&&function(t){const e={},n=t.attributes;for(const r in n){const t=n[r],i={};i.attribute=t,t.data&&(i.data=t.data),e[r]=i}c.attributes=e}(v)}else{const t=!0===u.wireframe;c.geometry===v.id&&c.program===h.id&&c.wireframe===t||(c.geometry=v.id,c.program=h.id,c.wireframe=t,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==x&&n.update(x,34963),b&&(function(i,o,a,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;f();const u=s.attributes,c=a.getAttributes(),l=o.defaultAttributeValues;for(const e in c){const r=c[e];if(r>=0){const o=u[e];if(void 0!==o){const e=o.normalized,i=o.itemSize,a=n.get(o);if(void 0===a)continue;const u=a.buffer,c=a.type,l=a.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,a=n.stride,h=o.offset;n&&n.isInstancedInterleavedBuffer?(m(r,n.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)):d(r),t.bindBuffer(34962,u),y(r,i,c,e,a*l,h*l)}else o.isInstancedBufferAttribute?(m(r,o.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)):d(r),t.bindBuffer(34962,u),y(r,i,c,e,0,0)}else if("instanceMatrix"===e){const e=n.get(i.instanceMatrix);if(void 0===e)continue;const o=e.buffer,a=e.type;m(r+0,1),m(r+1,1),m(r+2,1),m(r+3,1),t.bindBuffer(34962,o),t.vertexAttribPointer(r+0,4,a,!1,64,0),t.vertexAttribPointer(r+1,4,a,!1,64,16),t.vertexAttribPointer(r+2,4,a,!1,64,32),t.vertexAttribPointer(r+3,4,a,!1,64,48)}else if(void 0!==l){const n=l[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r,n);break;case 3:t.vertexAttrib3fv(r,n);break;case 4:t.vertexAttrib4fv(r,n);break;default:t.vertexAttrib1fv(r,n)}}}}g()}(i,u,h,v),null!==x&&t.bindBuffer(34963,n.get(x).buffer))},reset:v,resetDefaultState:x,dispose:function(){v();for(const t in s){const e=s[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const n in e){const t=e[n];for(const e in t)h(t[e].object),delete t[e];delete e[n]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const n=s[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)h(r[t].object),delete r[t];delete n[t.id]}},initAttributes:f,enableAttribute:d,disableUnusedAttributes:g}}function ly(t,e,n,r){const i=r.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,r){t.drawArrays(o,e,r),n.update(r,o)},this.renderInstances=function(r,a,s,u){if(0===u)return;let c,l;if(i)c=t,l="drawArraysInstanced";else if(c=e.get("ANGLE_instanced_arrays"),l="drawArraysInstancedANGLE",null===c)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[l](o,a,s,u),n.update(s,o,u)}}function hy(t,e,n){let r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==n.precision?n.precision:"highp";const s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const u=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),l=t.getParameter(35660),h=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),d=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),y=l>0,v=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;const n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,r},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:v,floatVertexTextures:y&&v,maxSamples:o?t.getParameter(36183):0}}function py(){const t=this;let e=null,n=0,r=!1,i=!1;const o=new Nm,a=new fd,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function c(e,n,r,i){let u=null!==e?e.length:0,c=null;if(0!==u){if(c=s.value,!0!==i||null===c){const t=r+4*u,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,s=r;n!==u;++n,s+=4)o.copy(e[n]).applyMatrix4(i,a),o.normal.toArray(c,s),c[s+3]=o.constant}s.value=c,s.needsUpdate=!0}return t.numPlanes=u,t.numIntersection=0,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){const a=0!==t.length||i||0!==n||r;return r=i,e=c(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,a,l,h,p){if(!r||null===t||0===t.length||i&&!a)i?c(null):u();else{const r=i?0:n,a=4*r;let u=h.clippingState||null;s.value=u,u=c(t,l,a,p);for(let t=0;t!==a;++t)u[t]=e[t];h.clippingState=u,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=r}}}function fy(t){const e={};return{get:function(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function dy(t,e,n,r){const i=new WeakMap,o=new WeakMap;function a(t){const s=t.target,u=i.get(s);null!==u.index&&e.remove(u.index);for(const n in u.attributes)e.remove(u.attributes[n]);s.removeEventListener("dispose",a),i.delete(s);const c=o.get(u);c&&(e.remove(c),o.delete(u)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){const n=[],r=t.index,i=t.attributes.position;let a=0;if(null!==r){const t=r.array;a=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],o=t[e+2];n.push(r,i,i,o,o,r)}}else{a=i.version;for(let t=0,e=i.array.length/3-1;t<e;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const s=new(ug(n)>65535?ig:ng)(n,1);s.version=a;const u=o.get(t);u&&e.remove(u),o.set(t,s)}return{get:function(t,e){let r=i.get(e);return r||(e.addEventListener("dispose",a),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new gg).setFromObject(t)),r=e._bufferGeometry),i.set(e,r),n.memory.geometries++,r)},update:function(t){const n=t.attributes;for(const i in n)e.update(n[i],34962);const r=t.morphAttributes;for(const i in r){const t=r[i];for(let n=0,r=t.length;n<r;n++)e.update(t[n],34962)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return o.get(t)}}}function my(t,e,n,r){const i=r.isWebGL2;let o,a,s;this.setMode=function(t){o=t},this.setIndex=function(t){a=t.type,s=t.bytesPerElement},this.render=function(e,r){t.drawElements(o,r,a,e*s),n.update(r,o)},this.renderInstances=function(r,u,c,l){if(0===l)return;let h,p;if(i)h=t,p="drawElementsInstanced";else if(h=e.get("ANGLE_instanced_arrays"),p="drawElementsInstancedANGLE",null===h)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[p](o,c,a,u*s,l),n.update(c,o,l)}}function gy(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function yy(t,e){return t[0]-e[0]}function vy(t,e){return Math.abs(e[1])-Math.abs(t[1])}function xy(t){const e={},n=new Float32Array(8),r=[];for(let i=0;i<8;i++)r[i]=[i,0];return{update:function(i,o,a,s){const u=i.morphTargetInfluences,c=void 0===u?0:u.length;let l=e[o.id];if(void 0===l){l=[];for(let t=0;t<c;t++)l[t]=[t,0];e[o.id]=l}for(let t=0;t<c;t++){const e=l[t];e[0]=t,e[1]=u[t]}l.sort(vy);for(let t=0;t<8;t++)t<c&&l[t][1]?(r[t][0]=l[t][0],r[t][1]=l[t][1]):(r[t][0]=Number.MAX_SAFE_INTEGER,r[t][1]=0);r.sort(yy);const h=a.morphTargets&&o.morphAttributes.position,p=a.morphNormals&&o.morphAttributes.normal;let f=0;for(let t=0;t<8;t++){const e=r[t],i=e[0],a=e[1];i!==Number.MAX_SAFE_INTEGER&&a?(h&&o.getAttribute("morphTarget"+t)!==h[i]&&o.setAttribute("morphTarget"+t,h[i]),p&&o.getAttribute("morphNormal"+t)!==p[i]&&o.setAttribute("morphNormal"+t,p[i]),n[t]=a,f+=a):(h&&void 0!==o.getAttribute("morphTarget"+t)&&o.deleteAttribute("morphTarget"+t),p&&void 0!==o.getAttribute("morphNormal"+t)&&o.deleteAttribute("morphNormal"+t),n[t]=0)}const d=o.morphTargetsRelative?1:1-f;s.getUniforms().setValue(t,"morphTargetBaseInfluence",d),s.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function by(t,e,n,r){let i=new WeakMap;return{update:function(t){const o=r.render.frame,a=t.geometry,s=e.get(t,a);return i.get(s)!==o&&(a.isGeometry&&s.updateFromObject(t),e.update(s),i.set(s,o)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function wy(t,e,n,r,i,o,a,s,u,c){yd.call(this,t=void 0!==t?t:[],e=void 0!==e?e:301,n,r,i,o,a=void 0!==a?a:1022,s,u,c),this.flipY=!1}function _y(t,e,n,r){yd.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function My(t,e,n,r){yd.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}sy.physical={uniforms:Gg([sy.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new pd(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new jm(0)},transparency:{value:0}}]),vertexShader:ay.meshphysical_vert,fragmentShader:ay.meshphysical_frag},(wy.prototype=Object.create(yd.prototype)).constructor=wy,wy.prototype.isCubeTexture=!0,Object.defineProperty(wy.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),(_y.prototype=Object.create(yd.prototype)).constructor=_y,_y.prototype.isDataTexture2DArray=!0,(My.prototype=Object.create(yd.prototype)).constructor=My,My.prototype.isDataTexture3D=!0;const Sy=new yd,Ey=new _y,Ny=new My,Ty=new wy,Ay=[],Cy=[],Oy=new Float32Array(16),Ry=new Float32Array(9),Py=new Float32Array(4);function Ly(t,e,n){const r=t[0];if(r<=0||r>0)return t;let i=e*n,o=Ay[i];if(void 0===o&&(o=new Float32Array(i),Ay[i]=o),0!==e){r.toArray(o,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i)}return o}function Iy(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Dy(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function ky(t,e){let n=Cy[e];void 0===n&&(n=new Int32Array(e),Cy[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function zy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function By(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Iy(n,e))return;t.uniform2fv(this.addr,e),Dy(n,e)}}function Uy(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Iy(n,e))return;t.uniform3fv(this.addr,e),Dy(n,e)}}function Fy(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Iy(n,e))return;t.uniform4fv(this.addr,e),Dy(n,e)}}function jy(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Iy(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Dy(n,e)}else{if(Iy(n,r))return;Py.set(r),t.uniformMatrix2fv(this.addr,!1,Py),Dy(n,r)}}function Hy(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Iy(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Dy(n,e)}else{if(Iy(n,r))return;Ry.set(r),t.uniformMatrix3fv(this.addr,!1,Ry),Dy(n,r)}}function Vy(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Iy(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Dy(n,e)}else{if(Iy(n,r))return;Oy.set(r),t.uniformMatrix4fv(this.addr,!1,Oy),Dy(n,r)}}function Gy(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Sy,i)}function qy(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Ey,i)}function Wy(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Ny,i)}function Zy(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Ty,i)}function $y(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Yy(t,e){const n=this.cache;Iy(n,e)||(t.uniform2iv(this.addr,e),Dy(n,e))}function Xy(t,e){const n=this.cache;Iy(n,e)||(t.uniform3iv(this.addr,e),Dy(n,e))}function Jy(t,e){const n=this.cache;Iy(n,e)||(t.uniform4iv(this.addr,e),Dy(n,e))}function Qy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ky(t,e){t.uniform1fv(this.addr,e)}function tv(t,e){t.uniform1iv(this.addr,e)}function ev(t,e){t.uniform2iv(this.addr,e)}function nv(t,e){t.uniform3iv(this.addr,e)}function rv(t,e){t.uniform4iv(this.addr,e)}function iv(t,e){const n=Ly(e,this.size,2);t.uniform2fv(this.addr,n)}function ov(t,e){const n=Ly(e,this.size,3);t.uniform3fv(this.addr,n)}function av(t,e){const n=Ly(e,this.size,4);t.uniform4fv(this.addr,n)}function sv(t,e){const n=Ly(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function uv(t,e){const n=Ly(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function cv(t,e){const n=Ly(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function lv(t,e,n){const r=e.length,i=ky(n,r);t.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.safeSetTexture2D(e[o]||Sy,i[o])}function hv(t,e,n){const r=e.length,i=ky(n,r);t.uniform1iv(this.addr,i);for(let o=0;o!==r;++o)n.safeSetTextureCube(e[o]||Ty,i[o])}function pv(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return zy;case 35664:return By;case 35665:return Uy;case 35666:return Fy;case 35674:return jy;case 35675:return Hy;case 35676:return Vy;case 5124:case 35670:return $y;case 35667:case 35671:return Yy;case 35668:case 35672:return Xy;case 35669:case 35673:return Jy;case 5125:return Qy;case 35678:case 36198:case 36298:case 36306:case 35682:return Gy;case 35679:case 36299:case 36307:return Wy;case 35680:case 36300:case 36308:case 36293:return Zy;case 36289:case 36303:case 36311:case 36292:return qy}}(e.type)}function fv(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ky;case 35664:return iv;case 35665:return ov;case 35666:return av;case 35674:return sv;case 35675:return uv;case 35676:return cv;case 5124:case 35670:return tv;case 35667:case 35671:return ev;case 35668:case 35672:return nv;case 35669:case 35673:return rv;case 35678:case 36198:case 36298:case 36306:case 35682:return lv;case 35680:case 36300:case 36308:case 36293:return hv}}(e.type)}function dv(t){this.id=t,this.seq=[],this.map={}}fv.prototype.updateCache=function(t){let e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Dy(e,t)},dv.prototype.setValue=function(t,e,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(t,e[o.id],n)}};const mv=/([\w\d_]+)(\])?(\[|\.)?/g;function gv(t,e){t.seq.push(e),t.map[e.id]=e}function yv(t,e,n){const r=t.name,i=r.length;for(mv.lastIndex=0;;){const o=mv.exec(r),a=mv.lastIndex;let s=o[1],u=o[3];if("]"===o[2]&&(s|=0),void 0===u||"["===u&&a+2===i){gv(n,void 0===u?new pv(s,t,e):new fv(s,t,e));break}{let t=n.map[s];void 0===t&&(t=new dv(s),gv(n,t)),n=t}}}function vv(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);yv(n,t.getUniformLocation(e,n.name),this)}}function xv(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}vv.prototype.setValue=function(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)},vv.prototype.setOptional=function(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)},vv.upload=function(t,e,n,r){for(let i=0,o=e.length;i!==o;++i){const o=e[i],a=n[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,r)}},vv.seqWithValue=function(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n};let bv=0;function wv(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function _v(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){const e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Mv(t,e){const n=wv(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Sv(t,e){const n=wv(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Ev(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Nv(t){return""!==t}function Tv(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Av(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Cv=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ov(t){return t.replace(Cv,Rv)}function Rv(t,e){const n=ay[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Ov(n)}const Pv=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Lv=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Iv(t){return t.replace(Lv,kv).replace(Pv,Dv)}function Dv(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),kv(0,e,n,r)}function kv(t,e,n,r){let i="";for(let o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function zv(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Bv(t,e,n,r){const i=t.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const u=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC"}return e}(n),l=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),p=t.gammaFactor>0?t.gammaFactor:1,f=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Nv).join("\n")}(n),d=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(o),m=i.createProgram();let g,y;if(n.isRawShaderMaterial?(g=[d].filter(Nv).join("\n"),g.length>0&&(g+="\n"),y=[f,d].filter(Nv).join("\n"),y.length>0&&(y+="\n")):(g=[zv(n),"#define SHADER_NAME "+n.shaderName,d,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Nv).join("\n"),y=[f,zv(n),"#define SHADER_NAME "+n.shaderName,d,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+l:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ay.tonemapping_pars_fragment:"",0!==n.toneMapping?Ev("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",ay.encodings_pars_fragment,n.map?Mv("mapTexelToLinear",n.mapEncoding):"",n.matcap?Mv("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Mv("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Mv("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Mv("lightMapTexelToLinear",n.lightMapEncoding):"",Sv("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Nv).join("\n")),a=Ov(a),a=Tv(a,n),a=Av(a,n),s=Ov(s),s=Tv(s,n),s=Av(s,n),a=Iv(a),s=Iv(s),n.isWebGL2&&!n.isRawShaderMaterial){let t=!1;const e=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==a.match(e)&&null!==s.match(e)&&(t=!0,a=a.replace(e,""),s=s.replace(e,"")),g=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#version 300 es\n","#define varying in",t?"":"out highp vec4 pc_fragColor;",t?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y}const v=y+s,x=xv(i,35633,g+a),b=xv(i,35632,v);if(i.attachShader(m,x),i.attachShader(m,b),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(m).trim(),e=i.getShaderInfoLog(x).trim(),n=i.getShaderInfoLog(b).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(m,35714)){r=!1;const e=_v(i,x,"vertex"),n=_v(i,b,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(m,35715),"gl.getProgramInfoLog",t,e,n)}else""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:y}})}let w,_;return i.deleteShader(x),i.deleteShader(b),this.getUniforms=function(){return void 0===w&&(w=new vv(i,m)),w},this.getAttributes=function(){return void 0===_&&(_=function(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i).name;n[r]=t.getAttribLocation(e,r)}return n}(i,m)),_},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=bv++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=b,this}function Uv(t,e,n,r){const i=[],o=n.isWebGL2,a=n.logarithmicDepthBuffer,s=n.floatVertexTextures,u=n.maxVertexUniforms,c=n.vertexTextures;let l=n.precision;const h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(t){let e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}return{getParameters:function(r,i,p,d,m,g,y){const v=d.fog,x=r.envMap||(r.isMeshStandardMaterial?d.environment:null),b=h[r.type],w=y.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(s)return 1024;{const t=Math.floor((u-20)/4),n=Math.min(t,e.length);return n<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+n+"."),0):n}}(y):0;null!==r.precision&&(l=n.getMaxPrecision(r.precision),l!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",l,"instead."));const _=function(t,e){let n;if(e){const r=sy[e];n={name:t.name||t.type,uniforms:qg.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.name||t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,b);r.onBeforeCompile(_,t);const M=t.getRenderTarget();return{isWebGL2:o,shaderID:b,shaderName:_.name,uniforms:_.uniforms,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:l,instancing:!0===y.isInstancedMesh,supportsVertexTextures:c,outputEncoding:null!==M?f(M.texture):t.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!x,envMapMode:x&&x.mapping,envMapEncoding:f(x),envMapCubeUV:!!x&&(306===x.mapping||307===x.mapping),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!v,useFog:r.fog,fogExp2:v&&v.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:a,skinning:r.skinning&&w>0,maxBones:w,useVertexTexture:s,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numDirLightShadows:i.directionalShadowMap.length,numPointLightShadows:i.pointShadowMap.length,numSpotLightShadows:i.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&p.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:o||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:o||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:o||null!==e.get("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(void 0===e.isRawShaderMaterial){for(let t=0;t<p.length;t++)n.push(e[p[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},acquireProgram:function(e,n){let o;for(let t=0,r=i.length;t<r;t++){const e=i[t];if(e.cacheKey===n){o=e,++o.usedTimes;break}}return void 0===o&&(o=new Bv(t,n,e,r),i.push(o)),o},releaseProgram:function(t){if(0==--t.usedTimes){const e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},programs:i}}function Fv(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function jv(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Hv(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Vv(){const t=[];let e=0;const n=[],r=[],i={id:-1};function o(n,r,o,a,s,u){let c=t[e];return void 0===c?(c={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:u},t[e]=c):(c.id=n.id,c.object=n,c.geometry=r,c.material=o,c.program=o.program||i,c.groupOrder=a,c.renderOrder=n.renderOrder,c.z=s,c.group=u),e++,c}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,u){const c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).push(c)},unshift:function(t,e,i,a,s,u){const c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).unshift(c)},finish:function(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.program=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||jv),r.length>1&&r.sort(e||Hv)}}}function Gv(){let t=new WeakMap;function e(n){const r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){const i=t.get(n);let o;return void 0===i?(o=new Vv,t.set(n,new WeakMap),t.get(n).set(r,o),n.addEventListener("dispose",e)):(o=i.get(r),void 0===o&&(o=new Vv,i.set(r,o))),o},dispose:function(){t=new WeakMap}}}function qv(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Sd,color:new jm};break;case"SpotLight":n={position:new Sd,direction:new Sd,color:new jm,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Sd,color:new jm,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Sd,skyColor:new jm,groundColor:new jm};break;case"RectAreaLight":n={color:new jm,position:new Sd,halfWidth:new Sd,halfHeight:new Sd}}return t[e.id]=n,n}}}let Wv=0;function Zv(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function $v(){const t=new qv,e=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pd};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pd,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let a=0;a<9;a++)n.probe.push(new Sd);const r=new Sd,i=new Pd,o=new Pd;return{setup:function(a,s,u){let c=0,l=0,h=0;for(let t=0;t<9;t++)n.probe[t].set(0,0,0);let p=0,f=0,d=0,m=0,g=0,y=0,v=0,x=0;const b=u.matrixWorldInverse;a.sort(Zv);for(let _=0,M=a.length;_<M;_++){const s=a[_],u=s.color,w=s.intensity,M=s.distance,S=s.shadow&&s.shadow.map?s.shadow.map.texture:null;if(s.isAmbientLight)c+=u.r*w,l+=u.g*w,h+=u.b*w;else if(s.isLightProbe)for(let t=0;t<9;t++)n.probe[t].addScaledVector(s.sh.coefficients[t],w);else if(s.isDirectionalLight){const i=t.get(s);if(i.color.copy(s.color).multiplyScalar(s.intensity),i.direction.setFromMatrixPosition(s.matrixWorld),r.setFromMatrixPosition(s.target.matrixWorld),i.direction.sub(r),i.direction.transformDirection(b),s.castShadow){const t=s.shadow,r=e.get(s);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,n.directionalShadow[p]=r,n.directionalShadowMap[p]=S,n.directionalShadowMatrix[p]=s.shadow.matrix,y++}n.directional[p]=i,p++}else if(s.isSpotLight){const i=t.get(s);if(i.position.setFromMatrixPosition(s.matrixWorld),i.position.applyMatrix4(b),i.color.copy(u).multiplyScalar(w),i.distance=M,i.direction.setFromMatrixPosition(s.matrixWorld),r.setFromMatrixPosition(s.target.matrixWorld),i.direction.sub(r),i.direction.transformDirection(b),i.coneCos=Math.cos(s.angle),i.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),i.decay=s.decay,s.castShadow){const t=s.shadow,r=e.get(s);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,n.spotShadow[d]=r,n.spotShadowMap[d]=S,n.spotShadowMatrix[d]=s.shadow.matrix,x++}n.spot[d]=i,d++}else if(s.isRectAreaLight){const e=t.get(s);e.color.copy(u).multiplyScalar(w),e.position.setFromMatrixPosition(s.matrixWorld),e.position.applyMatrix4(b),o.identity(),i.copy(s.matrixWorld),i.premultiply(b),o.extractRotation(i),e.halfWidth.set(.5*s.width,0,0),e.halfHeight.set(0,.5*s.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),n.rectArea[m]=e,m++}else if(s.isPointLight){const r=t.get(s);if(r.position.setFromMatrixPosition(s.matrixWorld),r.position.applyMatrix4(b),r.color.copy(s.color).multiplyScalar(s.intensity),r.distance=s.distance,r.decay=s.decay,s.castShadow){const t=s.shadow,r=e.get(s);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,r.shadowCameraNear=t.camera.near,r.shadowCameraFar=t.camera.far,n.pointShadow[f]=r,n.pointShadowMap[f]=S,n.pointShadowMatrix[f]=s.shadow.matrix,v++}n.point[f]=r,f++}else if(s.isHemisphereLight){const e=t.get(s);e.direction.setFromMatrixPosition(s.matrixWorld),e.direction.transformDirection(b),e.direction.normalize(),e.skyColor.copy(s.color).multiplyScalar(w),e.groundColor.copy(s.groundColor).multiplyScalar(w),n.hemi[g]=e,g++}}n.ambient[0]=c,n.ambient[1]=l,n.ambient[2]=h;const w=n.hash;w.directionalLength===p&&w.pointLength===f&&w.spotLength===d&&w.rectAreaLength===m&&w.hemiLength===g&&w.numDirectionalShadows===y&&w.numPointShadows===v&&w.numSpotShadows===x||(n.directional.length=p,n.spot.length=d,n.rectArea.length=m,n.point.length=f,n.hemi.length=g,n.directionalShadow.length=y,n.directionalShadowMap.length=y,n.pointShadow.length=v,n.pointShadowMap.length=v,n.spotShadow.length=x,n.spotShadowMap.length=x,n.directionalShadowMatrix.length=y,n.pointShadowMatrix.length=v,n.spotShadowMatrix.length=x,w.directionalLength=p,w.pointLength=f,w.spotLength=d,w.rectAreaLength=m,w.hemiLength=g,w.numDirectionalShadows=y,w.numPointShadows=v,w.numSpotShadows=x,n.version=Wv++)},state:n}}function Yv(){const t=new $v,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Xv(){let t=new WeakMap;function e(n){const r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){let i;return!1===t.has(n)?(i=new Yv,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new Yv,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function Jv(t){Zm.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Qv(t){Zm.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Sd,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Kv(t,e,n){let r=new ty;const i=new pd,o=new pd,a=new vd,s=[],u=[],c={},l={0:1,1:0,2:2},h=new Wg({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new pd},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONAL_PASS=1;const f=new gg;f.setAttribute("position",new Jm(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const d=new Ig(f,h),m=this;function g(n,r){const i=e.update(d);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,h,d,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,p,d,null)}function y(t,e,n){const r=t<<0|e<<1|n<<2;let i=s[r];return void 0===i&&(i=new Jv({depthPacking:3201,morphTargets:t,skinning:e}),s[r]=i),i}function v(t,e,n){const r=t<<0|e<<1|n<<2;let i=u[r];return void 0===i&&(i=new Qv({morphTargets:t,skinning:e}),u[r]=i),i}function x(e,n,r,i,o,a,s){let u=null,h=y,p=e.customDepthMaterial;if(!0===i.isPointLight&&(h=v,p=e.customDistanceMaterial),void 0===p){let t=!1;!0===r.morphTargets&&(t=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);let i=!1;!0===e.isSkinnedMesh&&(!0===r.skinning?i=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),u=h(t,i,!0===e.isInstancedMesh)}else u=p;if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){const t=u.uuid,e=r.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let i=n[e];void 0===i&&(i=u.clone(),n[e]=i),u=i}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:l[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=o,u.farDistance=a),u}function b(n,i,o,a,s){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let u=0,c=e.length;u<c;u++){const c=e[u],l=i[c.materialIndex];if(l&&l.visible){const e=x(n,r,l,a,o.near,o.far,s);t.renderBufferDirect(o,null,r,e,n,c)}}}else if(i.visible){const e=x(n,r,i,a,o.near,o.far,s);t.renderBufferDirect(o,null,r,e,n,null)}}const u=n.children;for(let t=0,e=u.length;t<e;t++)b(u[t],i,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,s,u){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===e.length)return;const c=t.getRenderTarget(),l=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),p=t.state;p.setBlending(0),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(let f=0,d=e.length;f<d;f++){const c=e[f],l=c.shadow;if(!1===l.autoUpdate&&!1===l.needsUpdate)continue;if(void 0===l){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}i.copy(l.mapSize);const h=l.getFrameExtents();if(i.multiply(h),o.copy(l.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(o.x=Math.floor(n/h.x),i.x=o.x*h.x,l.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/h.y),i.y=o.y*h.y,l.mapSize.y=o.y)),null===l.map&&!l.isPointLightShadow&&3===this.type){const t={minFilter:1006,magFilter:1006,format:1023};l.map=new xd(i.x,i.y,t),l.map.texture.name=c.name+".shadowMap",l.mapPass=new xd(i.x,i.y,t),l.camera.updateProjectionMatrix()}null===l.map&&(l.map=new xd(i.x,i.y,{minFilter:1003,magFilter:1003,format:1023}),l.map.texture.name=c.name+".shadowMap",l.camera.updateProjectionMatrix()),t.setRenderTarget(l.map),t.clear();const d=l.getViewportCount();for(let t=0;t<d;t++){const e=l.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),p.viewport(a),l.updateMatrices(c,t),r=l.getFrustum(),b(s,u,l.camera,c,this.type)}l.isPointLightShadow||3!==this.type||g(l,u),l.needsUpdate=!1}m.needsUpdate=!1,t.setRenderTarget(c,l,h)}}function tx(t,e,n){const r=n.isWebGL2,i=new function(){let e=!1;const n=new vd;let r=null;const i=new vd(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(t){t?L(2929):I(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},a=new function(){let e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(t){e||(t?L(2960):I(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}};let s={},u=null,c=null,l=null,h=null,p=null,f=null,d=null,m=null,g=null,y=!1,v=null,x=null,b=null,w=null,_=null;const M=t.getParameter(35661);let S=!1,E=0;const N=t.getParameter(7938);-1!==N.indexOf("WebGL")?(E=parseFloat(/^WebGL\ ([0-9])/.exec(N)[1]),S=E>=1):-1!==N.indexOf("OpenGL ES")&&(E=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(N)[1]),S=E>=2);let T=null,A={};const C=new vd,O=new vd;function R(e,n,r){const i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}const P={};function L(e){!0!==s[e]&&(t.enable(e),s[e]=!0)}function I(e){!1!==s[e]&&(t.disable(e),s[e]=!1)}P[3553]=R(3553,3553,1),P[34067]=R(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),L(2929),o.setFunc(3),B(!1),U(1),L(2884),z(0);const D={100:32774,101:32778,102:32779};if(r)D[103]=32775,D[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(D[103]=t.MIN_EXT,D[104]=t.MAX_EXT)}const k={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function z(e,n,r,i,o,a,s,u){if(0!==e){if(c||(L(3042),c=!0),5===e)o=o||n,a=a||r,s=s||i,n===h&&o===d||(t.blendEquationSeparate(D[n],D[o]),h=n,d=o),r===p&&i===f&&a===m&&s===g||(t.blendFuncSeparate(k[r],k[i],k[a],k[s]),p=r,f=i,m=a,g=s),l=e,y=null;else if(e!==l||u!==y){if(100===h&&100===d||(t.blendEquation(32774),h=100,d=100),u)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}p=null,f=null,m=null,g=null,l=e,y=u}}else c&&(I(3042),c=!1)}function B(e){v!==e&&(t.frontFace(e?2304:2305),v=e)}function U(e){0!==e?(L(2884),e!==x&&t.cullFace(1===e?1029:2===e?1028:1032)):I(2884),x=e}function F(e,n,r){e?(L(32823),w===n&&_===r||(t.polygonOffset(n,r),w=n,_=r)):I(32823)}function j(e){void 0===e&&(e=33984+M-1),T!==e&&(t.activeTexture(e),T=e)}return{buffers:{color:i,depth:o,stencil:a},enable:L,disable:I,useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:z,setMaterial:function(t,e){2===t.side?I(2884):L(2884);let n=1===t.side;e&&(n=!n),B(n),1===t.blending&&!1===t.transparent?z(0):z(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);const r=t.stencilWrite;a.setTest(r),r&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),F(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:B,setCullFace:U,setLineWidth:function(e){e!==b&&(S&&t.lineWidth(e),b=e)},setPolygonOffset:F,setScissorTest:function(t){t?L(3089):I(3089)},activeTexture:j,bindTexture:function(e,n){null===T&&j();let r=A[T];void 0===r&&(r={type:void 0,texture:void 0},A[T]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||P[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=A[T];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===C.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),C.copy(e))},viewport:function(e){!1===O.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){s={},T=null,A={},u=null,l=null,v=null,x=null,i.reset(),o.reset(),a.reset()}}}function ex(t,e,n,r,i,o,a){const s=i.isWebGL2,u=i.maxTextures,c=i.maxCubemapSize,l=i.maxTextureSize,h=i.maxSamples,p=new WeakMap;let f,d=!1;try{d="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(B){}function m(t,e){return d?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?hd.floorPowerOfTwo:Math.floor,o=r(i*t.width),a=r(i*t.height);void 0===f&&(f=m(o,a));const s=n?m(o,a):f;return s.width=o,s.height=a,s.getContext("2d").drawImage(t,0,0,o,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+a+")."),s}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return hd.isPowerOfTwo(t.width)&&hd.isPowerOfTwo(t.height)}function v(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function x(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function b(n,r,i){if(!1===s)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function w(t){return 1003===t||1004===t||1005===t?9728:9729}function _(e){const n=e.target;n.removeEventListener("dispose",_),function(e){const n=r.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),r.remove(e))}(n),n.isVideoTexture&&p.delete(n),a.memory.textures--}function M(e){const n=e.target;n.removeEventListener("dispose",M),function(e){const n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(e.texture),r.remove(e)}}(n),a.memory.textures--}let S=0;function E(t,e){const i=r.get(t);if(t.isVideoTexture&&function(t){const e=a.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void P(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function N(e,i){if(6!==e.image.length)return;const a=r.get(e);if(e.version>0&&a.__version!==e.version){R(a,e),n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture),t.pixelStorei(37440,e.flipY);const r=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),u=e.image[0]&&e.image[0].isDataTexture,l=[];for(let t=0;t<6;t++)l[t]=r||u?u?e.image[t].image:e.image[t]:g(e.image[t],!1,!0,c);const h=l[0],p=y(h)||s,f=o.convert(e.format),d=o.convert(e.type),m=b(e.internalFormat,f,d);let w;if(O(34067,e,p),r){for(let t=0;t<6;t++){w=l[t].mipmaps;for(let r=0;r<w.length;r++){const i=w[r];1023!==e.format&&1022!==e.format?null!==f?n.compressedTexImage2D(34069+t,r,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+t,r,m,i.width,i.height,0,f,d,i.data)}}a.__maxMipLevel=w.length-1}else{w=e.mipmaps;for(let t=0;t<6;t++)if(u){n.texImage2D(34069+t,0,m,l[t].width,l[t].height,0,f,d,l[t].data);for(let e=0;e<w.length;e++){const r=w[e].image[t].image;n.texImage2D(34069+t,e+1,m,r.width,r.height,0,f,d,r.data)}}else{n.texImage2D(34069+t,0,m,f,d,l[t]);for(let e=0;e<w.length;e++)n.texImage2D(34069+t,e+1,m,f,d,w[e].image[t])}a.__maxMipLevel=w.length}v(e,p)&&x(34067,e,h.width,h.height),a.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture)}function T(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}const A={1e3:10497,1001:33071,1002:33648},C={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function O(n,o,a){a?(t.texParameteri(n,10242,A[o.wrapS]),t.texParameteri(n,10243,A[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,A[o.wrapR]),t.texParameteri(n,10240,C[o.magFilter]),t.texParameteri(n,10241,C[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),1001===o.wrapS&&1001===o.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,w(o.magFilter)),t.texParameteri(n,10241,w(o.minFilter)),1003!==o.minFilter&&1006!==o.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const u=e.get("EXT_texture_filter_anisotropic");if(u){if(1015===o.type&&null===e.get("OES_texture_float_linear"))return;if(1016===o.type&&null===(s||e.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function R(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",_),e.__webglTexture=t.createTexture(),a.memory.textures++)}function P(e,r,i){let a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),R(e,r),n.activeTexture(33984+i),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);const u=function(t){return!s&&(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)}(r)&&!1===y(r.image),c=g(r.image,u,!1,l),h=y(c)||s,p=o.convert(r.format);let f,d=o.convert(r.type),m=b(r.internalFormat,p,d);O(a,r,h);const w=r.mipmaps;if(r.isDepthTexture)m=6402,s?m=1015===r.type?36012:1014===r.type?33190:1020===r.type?35056:33189:1015===r.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===r.format&&6402===m&&1012!==r.type&&1014!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=1012,d=o.convert(r.type)),1027===r.format&&6402===m&&(m=34041,1020!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=1020,d=o.convert(r.type))),n.texImage2D(3553,0,m,c.width,c.height,0,p,d,null);else if(r.isDataTexture)if(w.length>0&&h){for(let t=0,e=w.length;t<e;t++)f=w[t],n.texImage2D(3553,t,m,f.width,f.height,0,p,d,f.data);r.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,m,c.width,c.height,0,p,d,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(let t=0,e=w.length;t<e;t++)f=w[t],1023!==r.format&&1022!==r.format?null!==p?n.compressedTexImage2D(3553,t,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,t,m,f.width,f.height,0,p,d,f.data);e.__maxMipLevel=w.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,p,d,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,p,d,c.data),e.__maxMipLevel=0;else if(w.length>0&&h){for(let t=0,e=w.length;t<e;t++)f=w[t],n.texImage2D(3553,t,m,p,d,f);r.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,m,p,d,c),e.__maxMipLevel=0;v(r,h)&&x(a,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function L(e,i,a,s){const u=o.convert(i.texture.format),c=o.convert(i.texture.type),l=b(i.texture.internalFormat,u,c);n.texImage2D(s,0,l,i.width,i.height,0,u,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function I(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r){const e=n.depthTexture;e&&e.isDepthTexture&&(1015===e.type?i=36012:1014===e.type&&(i=33190));const r=D(n);t.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){const e=D(n);t.renderbufferStorageMultisample(36161,e,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=o.convert(n.texture.format),i=o.convert(n.texture.type),a=b(n.texture.internalFormat,e,i);if(r){const e=D(n);t.renderbufferStorageMultisample(36161,e,a,n.width,n.height)}else t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function D(t){return s&&t.isWebGLMultisampleRenderTarget?Math.min(h,t.samples):0}let k=!1,z=!1;this.allocateTextureUnit=function(){const t=S;return t>=u&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+u),S+=1,t},this.resetTextureUnits=function(){S=0},this.setTexture2D=E,this.setTexture2DArray=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?P(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?P(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=N,this.setTextureCubeDynamic=T,this.setupRenderTarget=function(e){const i=r.get(e),u=r.get(e.texture);e.addEventListener("dispose",M),u.__webglTexture=t.createTexture(),a.memory.textures++;const c=!0===e.isWebGLCubeRenderTarget,l=!0===e.isWebGLMultisampleRenderTarget,h=y(e)||s;if(!s||1022!==e.texture.format||1015!==e.texture.type&&1016!==e.texture.type||(e.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){i.__webglFramebuffer=[];for(let e=0;e<6;e++)i.__webglFramebuffer[e]=t.createFramebuffer()}else if(i.__webglFramebuffer=t.createFramebuffer(),l)if(s){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer);const n=o.convert(e.texture.format),r=o.convert(e.texture.type),a=b(e.texture.internalFormat,n,r),s=D(e);t.renderbufferStorageMultisample(36161,s,a,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),I(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(34067,u.__webglTexture),O(34067,e.texture,h);for(let t=0;t<6;t++)L(i.__webglFramebuffer[t],e,36064,34069+t);v(e.texture,h)&&x(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,u.__webglTexture),O(3553,e.texture,h),L(i.__webglFramebuffer,e,36064,3553),v(e.texture,h)&&x(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&function(e){const n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),E(n.depthTexture,0);const i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(let r=0;r<6;r++)t.bindFramebuffer(36160,n.__webglFramebuffer[r]),n.__webglDepthbuffer[r]=t.createRenderbuffer(),I(n.__webglDepthbuffer[r],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),I(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}(e)},this.updateRenderTargetMipmap=function(t){const e=t.texture;if(v(e,y(t)||s)){const i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),x(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(s){const n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);const i=e.width,o=e.height;let a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===k&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),k=!0),t=t.texture),E(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?N(t,e):T(t,e)}}function nx(t,e,n){const r=n.isWebGL2;return{convert:function(t){let n;if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t)return r?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):36492===t?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):1020===t?r?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function rx(t){$g.call(this),this.cameras=t||[]}function ix(){Xd.call(this),this.type="Group"}function ox(){this._targetRay=null,this._grip=null}function ax(t,e){const n=this;let r=null,i=1,o=null,a="local-floor",s=null;const u=[],c=new Map,l=new $g;l.layers.enable(1),l.viewport=new vd;const h=new $g;h.layers.enable(2),h.viewport=new vd;const p=[l,h],f=new rx;f.layers.enable(1),f.layers.enable(2);let d=null,m=null;function g(t){const e=c.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function y(){c.forEach((function(t,e){t.disconnect(e)})),c.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(t){o=t,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function x(t){const e=r.inputSources;for(let n=0;n<u.length;n++)c.set(e[n],u[n]);for(let n=0;n<t.removed.length;n++){const e=t.removed[n],r=c.get(e);r&&(r.dispatchEvent({type:"disconnected",data:e}),c.delete(e))}for(let n=0;n<t.added.length;n++){const e=t.added[n],r=c.get(e);r&&r.dispatchEvent({type:"connected",data:e})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=u[t];return void 0===e&&(e=new ox,u[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=u[t];return void 0===e&&(e=new ox,u[t]=e),e.getGripSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(t){if(r=t,null!==r){r.addEventListener("select",g),r.addEventListener("selectstart",g),r.addEventListener("selectend",g),r.addEventListener("squeeze",g),r.addEventListener("squeezestart",g),r.addEventListener("squeezeend",g),r.addEventListener("end",y);const t=e.getContextAttributes();!0!==t.xrCompatible&&e.makeXRCompatible();const n=new XRWebGLLayer(r,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:i});r.updateRenderState({baseLayer:n}),r.requestReferenceSpace(a).then(v),r.addEventListener("inputsourceschange",x)}};const b=new Sd,w=new Sd;function _(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=h.near=l.near=t.near,f.far=h.far=l.far=t.far,d===f.near&&m===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),d=f.near,m=f.far);const e=t.parent,n=f.cameras;_(f,e);for(let r=0;r<n.length;r++)_(n[r],e);t.matrixWorld.copy(f.matrixWorld);const i=t.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){b.setFromMatrixPosition(e.matrixWorld),w.setFromMatrixPosition(n.matrixWorld);const r=b.distanceTo(w),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(o[8]+1)/o[0],p=a*l,f=a*h,d=r/(-l+h),m=d*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);const g=a+d,y=s+d;t.projectionMatrix.makePerspective(p-m,f+(r-m),u*s/y*g,c*s/y*g,g,y)}(f,l,h):f.projectionMatrix.copy(l.projectionMatrix),f};let M=null;const S=new ny;S.setAnimationLoop((function(e,n){if(s=n.getViewerPose(o),null!==s){const e=s.views,n=r.renderState.baseLayer;t.setFramebuffer(n.framebuffer);let i=!1;e.length!==f.cameras.length&&(f.cameras.length=0,i=!0);for(let t=0;t<e.length;t++){const r=e[t],o=n.getViewport(r),a=p[t];a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===t&&f.matrix.copy(a.matrix),!0===i&&f.cameras.push(a)}}const i=r.inputSources;for(let t=0;t<u.length;t++)u[t].update(i[t],n,o);M&&M(e,n)})),this.setAnimationLoop=function(t){M=t},this.dispose=function(){}}function sx(t){function e(e,n,r){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);const i=n.envMap||r;let o,a;i&&(e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio,e.maxMipLevel.value=t.get(i).__maxMipLevel),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?o=n.map:n.specularMap?o=n.specularMap:n.displacementMap?o=n.displacementMap:n.normalMap?o=n.normalMap:n.bumpMap?o=n.bumpMap:n.roughnessMap?o=n.roughnessMap:n.metalnessMap?o=n.metalnessMap:n.alphaMap?o=n.alphaMap:n.emissiveMap&&(o=n.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uvTransform.value.copy(o.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),e.uv2Transform.value.copy(a.matrix))}function n(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,r,i,o,a){r.isMeshBasicMaterial?e(t,r):r.isMeshLambertMaterial?(e(t,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,r)):r.isMeshToonMaterial?(e(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshPhongMaterial?(e(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshStandardMaterial?(e(t,r,i),r.isMeshPhysicalMaterial?function(t,e,r){n(t,e,r),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transparency.value=e.transparency}(t,r,i):n(t,r,i)):r.isMeshMatcapMaterial?(e(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDepthMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDistanceMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?(e(t,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){let i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,o,a):r.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ux(t){const e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,p=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const f=this;let d=!1,m=null,g=0,y=0,v=null,x=null,b=-1,w=null,_=null;const M=new vd,S=new vd;let E=null,N=e.width,T=e.height,A=1,C=null,O=null;const R=new vd(0,0,N,T),P=new vd(0,0,N,T);let L=!1;const I=new ty,D=new py;let k=!1,z=!1;const B=new Pd,U=new Sd,F={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function j(){return null===v?A:1}let H,V,G,q,W,Z,$,Y,X,J,Q,K,tt,et,nt,rt,it,ot,at,st=n;function ut(t,n){for(let r=0;r<t.length;r++){const i=e.getContext(t[r],n);if(null!==i)return i}return null}try{const t={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:l};if(e.addEventListener("webglcontextlost",pt,!1),e.addEventListener("webglcontextrestored",ft,!1),null===st){const e=["webgl2","webgl","experimental-webgl"];if(!0===f.isWebGL1Renderer&&e.shift(),st=ut(e,t),null===st)throw ut(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===st.getShaderPrecisionFormat&&(st.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw console.error("THREE.WebGLRenderer: "+Mt.message),Mt}function ct(){H=new fy(st),V=new hy(st,H,t),!1===V.isWebGL2&&(H.get("WEBGL_depth_texture"),H.get("OES_texture_float"),H.get("OES_texture_half_float"),H.get("OES_texture_half_float_linear"),H.get("OES_standard_derivatives"),H.get("OES_element_index_uint"),H.get("OES_vertex_array_object"),H.get("ANGLE_instanced_arrays")),H.get("OES_texture_float_linear"),ot=new nx(st,H,V),G=new tx(st,H,V),G.scissor(S.copy(P).multiplyScalar(A).floor()),G.viewport(M.copy(R).multiplyScalar(A).floor()),q=new gy(st),W=new Fv,Z=new ex(st,H,G,W,V,ot,q),$=new ry(st,V),at=new cy(st,H,$,V),Y=new dy(st,$,q,at),X=new by(st,Y,$,q),nt=new xy(st),J=new Uv(f,H,V,at),Q=new sx(W),K=new Gv,tt=new Xv,et=new uy(f,G,X,s),rt=new ly(st,H,q,V),it=new my(st,H,q,V),q.programs=J.programs,f.capabilities=V,f.extensions=H,f.properties=W,f.renderLists=K,f.state=G,f.info=q}ct();const lt=new ax(f,st);this.xr=lt;const ht=new Kv(f,X,V.maxTextureSize);function pt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),d=!0}function ft(){console.log("THREE.WebGLRenderer: Context Restored."),d=!1,ct()}function dt(t){const e=t.target;e.removeEventListener("dispose",dt),function(t){mt(t),W.remove(t)}(e)}function mt(t){const e=W.get(t).program;t.program=void 0,void 0!==e&&J.releaseProgram(e)}this.shadowMap=ht,this.getContext=function(){return st},this.getContextAttributes=function(){return st.getContextAttributes()},this.forceContextLoss=function(){const t=H.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=H.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return A},this.setPixelRatio=function(t){void 0!==t&&(A=t,this.setSize(N,T,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new pd),t.set(N,T)},this.setSize=function(t,n,r){lt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(N=t,T=n,e.width=Math.floor(t*A),e.height=Math.floor(n*A),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new pd),t.set(N*A,T*A).floor()},this.setDrawingBufferSize=function(t,n,r){N=t,T=n,A=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new vd),t.copy(M)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,n,r){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,n,r),G.viewport(M.copy(R).multiplyScalar(A).floor())},this.getScissor=function(t){return t.copy(P)},this.setScissor=function(t,e,n,r){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,n,r),G.scissor(S.copy(P).multiplyScalar(A).floor())},this.getScissorTest=function(){return L},this.setScissorTest=function(t){G.setScissorTest(L=t)},this.setOpaqueSort=function(t){C=t},this.setTransparentSort=function(t){O=t},this.getClearColor=function(){return et.getClearColor()},this.setClearColor=function(){et.setClearColor.apply(et,arguments)},this.getClearAlpha=function(){return et.getClearAlpha()},this.setClearAlpha=function(){et.setClearAlpha.apply(et,arguments)},this.clear=function(t,e,n){let r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),st.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",pt,!1),e.removeEventListener("webglcontextrestored",ft,!1),K.dispose(),tt.dispose(),W.dispose(),X.dispose(),at.dispose(),lt.dispose(),yt.stop()},this.renderBufferImmediate=function(t,e){at.initAttributes();const n=W.get(t);t.hasPositions&&!n.position&&(n.position=st.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=st.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=st.createBuffer()),t.hasColors&&!n.color&&(n.color=st.createBuffer());const r=e.getAttributes();t.hasPositions&&(st.bindBuffer(34962,n.position),st.bufferData(34962,t.positionArray,35048),at.enableAttribute(r.position),st.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(st.bindBuffer(34962,n.normal),st.bufferData(34962,t.normalArray,35048),at.enableAttribute(r.normal),st.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(st.bindBuffer(34962,n.uv),st.bufferData(34962,t.uvArray,35048),at.enableAttribute(r.uv),st.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(st.bindBuffer(34962,n.color),st.bufferData(34962,t.colorArray,35048),at.enableAttribute(r.color),st.vertexAttribPointer(r.color,3,5126,!1,0,0)),at.disableUnusedAttributes(),st.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=F);const a=i.isMesh&&i.matrixWorld.determinant()<0,s=_t(t,e,r,i);G.setMaterial(r,a);let u=n.index;const c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;let l,h=1;!0===r.wireframe&&(u=Y.getWireframeAttribute(n),h=2),(r.morphTargets||r.morphNormals)&&nt.update(i,n,r,s),at.setup(i,r,s,n,u);let p=rt;null!==u&&(l=$.get(u),p=it,p.setIndex(l));const f=null!==u?u.count:c.count,d=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==o?o.start*h:0,y=null!==o?o.count*h:1/0,v=Math.max(d,g),x=Math.min(f,d+m,g+y)-1,b=Math.max(0,x-v+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(G.setLineWidth(r.wireframeLinewidth*j()),p.setMode(1)):p.setMode(4);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),G.setLineWidth(t*j()),p.setMode(i.isLineSegments?1:i.isLineLoop?2:3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);if(i.isInstancedMesh)p.renderInstances(n,v,b,i.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);p.renderInstances(n,v,b,t)}else p.render(v,b)}},this.compile=function(t,e){p=tt.get(t,e),p.init(),t.traverse((function(t){t.isLight&&(p.pushLight(t),t.castShadow&&p.pushShadow(t))})),p.setupLights(e);const n=new WeakMap;t.traverse((function(e){let r=e.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];!1===n.has(o)&&(wt(o,t,e),n.set(o))}else!1===n.has(r)&&(wt(r,t,e),n.set(r))}))};let gt=null;const yt=new ny;function vt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)p.pushLight(t),t.castShadow&&p.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||I.intersectsSprite(t)){r&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=X.update(t),i=t.material;i.visible&&h.push(t,e,i,n,U.z,null)}}else if(t.isImmediateRenderObject)r&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B),h.push(t,null,t.material,n,U.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==q.render.frame&&(t.skeleton.update(),t.skeleton.frame=q.render.frame),!t.frustumCulled||I.intersectsObject(t))){r&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=X.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i[a.materialIndex];s&&s.visible&&h.push(t,e,s,n,U.z,a)}}else i.visible&&h.push(t,e,i,n,U.z,null)}const i=t.children;for(let o=0,a=i.length;o<a;o++)vt(i[o],e,n,r)}function xt(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,o=t.length;i<o;i++){const o=t[i],a=o.object,s=o.geometry,u=null===r?o.material:r,c=o.group;if(n.isArrayCamera){_=n;const t=n.cameras;for(let n=0,r=t.length;n<r;n++){const r=t[n];a.layers.test(r.layers)&&(G.viewport(M.copy(r.viewport)),p.setupLights(r),bt(a,e,r,s,u,c))}}else _=null,bt(a,e,n,s,u,c)}}function bt(t,e,n,r,i,o){if(t.onBeforeRender(f,e,n,r,i,o),p=tt.get(e,_||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const r=_t(n,e,i,t);G.setMaterial(i),at.reset(),function(t,e){t.render((function(t){f.renderBufferImmediate(t,e)}))}(t,r)}else f.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(f,e,n,r,i,o),p=tt.get(e,_||n)}function wt(t,e,n){!0!==e.isScene&&(e=F);const r=W.get(t),i=p.state.lights,o=i.state.version,a=J.getParameters(t,i.state,p.state.shadowsArray,e,D.numPlanes,D.numIntersection,n),s=J.getProgramCacheKey(a);let u=r.program,c=!0;if(void 0===u)t.addEventListener("dispose",dt);else if(u.cacheKey!==s)mt(t);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,c=!1;else{if(void 0!==a.shaderID)return;c=!1}c&&(u=J.acquireProgram(a,s),r.program=u,r.uniforms=a.uniforms,r.outputEncoding=a.outputEncoding,t.program=u);const l=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(let e=0;e<f.maxMorphTargets;e++)l["morphTarget"+e]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(let e=0;e<f.maxMorphNormals;e++)l["morphNormal"+e]>=0&&t.numSupportedMorphNormals++}const h=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=D.numPlanes,r.numIntersection=D.numIntersection,h.clippingPlanes=D.uniform),r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=r.program.getUniforms(),m=vv.seqWithValue(d.seq,h);r.uniformsList=m}function _t(t,e,n,r){!0!==e.isScene&&(e=F),Z.resetTextureUnits();const i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=null===v?f.outputEncoding:v.texture.encoding,s=W.get(n),u=p.state.lights;!0!==k||!0!==z&&t===w||D.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,s,t===w&&n.id===b),n.version===s.__version?void 0===s.program||n.fog&&s.fog!==i||s.environment!==o||s.needsLights&&s.lightsStateVersion!==u.state.version?wt(n,e,r):void 0===s.numClippingPlanes||s.numClippingPlanes===D.numPlanes&&s.numIntersection===D.numIntersection?s.outputEncoding!==a&&wt(n,e,r):wt(n,e,r):(wt(n,e,r),s.__version=n.version);let c=!1,l=!1,h=!1;const d=s.program,m=d.getUniforms(),g=s.uniforms;if(G.useProgram(d.program)&&(c=!0,l=!0,h=!0),n.id!==b&&(b=n.id,l=!0),c||w!==t){if(m.setValue(st,"projectionMatrix",t.projectionMatrix),V.logarithmicDepthBuffer&&m.setValue(st,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),w!==t&&(w=t,l=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=m.map.cameraPosition;void 0!==e&&e.setValue(st,U.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&m.setValue(st,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&m.setValue(st,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){m.setOptional(st,r,"bindMatrix"),m.setOptional(st,r,"bindMatrixInverse");const t=r.skeleton;if(t){const e=t.bones;if(V.floatVertexTextures){if(void 0===t.boneTexture){let n=Math.sqrt(4*e.length);n=hd.ceilPowerOfTwo(n),n=Math.max(n,4);const r=new Float32Array(n*n*4);r.set(t.boneMatrices);const i=new Jg(r,n,n,1023,1015);t.boneMatrices=r,t.boneTexture=i,t.boneTextureSize=n}m.setValue(st,"boneTexture",t.boneTexture,Z),m.setValue(st,"boneTextureSize",t.boneTextureSize)}else m.setOptional(st,t,"boneMatrices")}}var y,x;return(l||s.receiveShadow!==r.receiveShadow)&&(s.receiveShadow=r.receiveShadow,m.setValue(st,"receiveShadow",r.receiveShadow)),l&&(m.setValue(st,"toneMappingExposure",f.toneMappingExposure),s.needsLights&&((y=g).ambientLightColor.needsUpdate=x=h,y.lightProbe.needsUpdate=x,y.directionalLights.needsUpdate=x,y.directionalLightShadows.needsUpdate=x,y.pointLights.needsUpdate=x,y.pointLightShadows.needsUpdate=x,y.spotLights.needsUpdate=x,y.spotLightShadows.needsUpdate=x,y.rectAreaLights.needsUpdate=x,y.hemisphereLights.needsUpdate=x),i&&n.fog&&Q.refreshFogUniforms(g,i),Q.refreshMaterialUniforms(g,n,o,A,T),void 0!==g.ltc_1&&(g.ltc_1.value=ey.LTC_1),void 0!==g.ltc_2&&(g.ltc_2.value=ey.LTC_2),vv.upload(st,s.uniformsList,g,Z)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(vv.upload(st,s.uniformsList,g,Z),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&m.setValue(st,"center",r.center),m.setValue(st,"modelViewMatrix",r.modelViewMatrix),m.setValue(st,"normalMatrix",r.normalMatrix),m.setValue(st,"modelMatrix",r.matrixWorld),d}yt.setAnimationLoop((function(t){lt.isPresenting||gt&&gt(t)})),"undefined"!=typeof window&&yt.setContext(window),this.setAnimationLoop=function(t){gt=t,lt.setAnimationLoop(t),null===t?yt.stop():yt.start()},this.render=function(t,e){let n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===d)return;at.resetDefaultState(),b=-1,w=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===lt.enabled&&!0===lt.isPresenting&&(e=lt.getCamera(e)),!0===t.isScene&&t.onBeforeRender(f,t,e,n||v),p=tt.get(t,e),p.init(),B.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),I.setFromProjectionMatrix(B),z=this.localClippingEnabled,k=D.init(this.clippingPlanes,z,e),h=K.get(t,e),h.init(),vt(t,e,0,f.sortObjects),h.finish(),!0===f.sortObjects&&h.sort(C,O),!0===k&&D.beginShadows();const i=p.state.shadowsArray;ht.render(i,t,e),p.setupLights(e),!0===k&&D.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),et.render(h,t,e,r);const o=h.opaque,a=h.transparent;o.length>0&&xt(o,t,e),a.length>0&&xt(a,t,e),!0===t.isScene&&t.onAfterRender(f,t,e),null!==v&&(Z.updateRenderTargetMipmap(v),Z.updateMultisampleRenderTarget(v)),G.buffers.depth.setTest(!0),G.buffers.depth.setMask(!0),G.buffers.color.setMask(!0),G.setPolygonOffset(!1),h=null,p=null},this.setFramebuffer=function(t){m!==t&&null===v&&st.bindFramebuffer(36160,t),m=t},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return v},this.setRenderTarget=function(t,e,n){v=t,g=e,y=n,t&&void 0===W.get(t).__webglFramebuffer&&Z.setupRenderTarget(t);let r=m,i=!1;if(t){const n=W.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=n[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?W.get(t).__webglMultisampledFramebuffer:n,M.copy(t.viewport),S.copy(t.scissor),E=t.scissorTest}else M.copy(R).multiplyScalar(A).floor(),S.copy(P).multiplyScalar(A).floor(),E=L;if(x!==r&&(st.bindFramebuffer(36160,r),x=r),G.viewport(M),G.scissor(S),G.setScissorTest(E),i){const r=W.get(t.texture);st.framebufferTexture2D(36160,36064,34069+(e||0),r.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=W.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){let a=!1;s!==x&&(st.bindFramebuffer(36160,s),a=!0);try{const s=t.texture,u=s.format,c=s.type;if(1023!==u&&ot.convert(u)!==st.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===c||ot.convert(c)===st.getParameter(35738)||1015===c&&(V.isWebGL2||H.get("OES_texture_float")||H.get("WEBGL_color_buffer_float"))||1016===c&&H.get(V.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===st.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&st.readPixels(e,n,r,i,ot.convert(u),ot.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&st.bindFramebuffer(36160,x)}}},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=ot.convert(e.format);Z.setTexture2D(e,0),st.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),G.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){void 0===r&&(r=0);const i=e.image.width,o=e.image.height,a=ot.convert(n.format),s=ot.convert(n.type);Z.setTexture2D(n,0),st.pixelStorei(37440,n.flipY),st.pixelStorei(37441,n.premultiplyAlpha),st.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?st.texSubImage2D(3553,r,t.x,t.y,i,o,a,s,e.image.data):e.isCompressedTexture?st.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):st.texSubImage2D(3553,r,t.x,t.y,a,s,e.image),0===r&&n.generateMipmaps&&st.generateMipmap(3553),G.unbindTexture()},this.initTexture=function(t){Z.setTexture2D(t,0),G.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function cx(t){ux.call(this,t)}function lx(t,e){this.name="",this.color=new jm(t),this.density=void 0!==e?e:25e-5}function hx(t,e,n){this.name="",this.color=new jm(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function px(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=hd.generateUUID()}(Jv.prototype=Object.create(Zm.prototype)).constructor=Jv,Jv.prototype.isMeshDepthMaterial=!0,Jv.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(Qv.prototype=Object.create(Zm.prototype)).constructor=Qv,Qv.prototype.isMeshDistanceMaterial=!0,Qv.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},rx.prototype=Object.assign(Object.create($g.prototype),{constructor:rx,isArrayCamera:!0}),ix.prototype=Object.assign(Object.create(Xd.prototype),{constructor:ix,isGroup:!0}),Object.assign(ox.prototype,{constructor:ox,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new ix,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new ix,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(t,e,n){let r=null,i=null;const o=this._targetRay,a=this._grip;return t&&(null!==o&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==a&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)))),null!==o&&(o.visible=null!==r),null!==a&&(a.visible=null!==i),this}}),Object.assign(ax.prototype,cd.prototype),cx.prototype=Object.assign(Object.create(ux.prototype),{constructor:cx,isWebGL1Renderer:!0}),Object.assign(lx.prototype,{isFogExp2:!0,clone:function(){return new lx(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(hx.prototype,{isFog:!0,clone:function(){return new hx(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(px.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(px.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=hd.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new px(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=hd.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const fx=new Sd;function dx(t,e,n,r){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function mx(t){Zm.call(this),this.type="SpriteMaterial",this.color=new jm(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let gx;Object.defineProperties(dx.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(dx.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let e=0,n=this.data.count;e<n;e++)fx.x=this.getX(e),fx.y=this.getY(e),fx.z=this.getZ(e),fx.applyMatrix4(t),this.setXYZ(e,fx.x,fx.y,fx.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Jm(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new dx(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(mx.prototype=Object.create(Zm.prototype)).constructor=mx,mx.prototype.isSpriteMaterial=!0,mx.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const yx=new Sd,vx=new Sd,xx=new Sd,bx=new pd,wx=new pd,_x=new Pd,Mx=new Sd,Sx=new Sd,Ex=new Sd,Nx=new pd,Tx=new pd,Ax=new pd;function Cx(t){if(Xd.call(this),this.type="Sprite",void 0===gx){gx=new gg;const t=new px(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);gx.setIndex([0,1,2,0,2,3]),gx.setAttribute("position",new dx(t,3,0,!1)),gx.setAttribute("uv",new dx(t,2,3,!1))}this.geometry=gx,this.material=void 0!==t?t:new mx,this.center=new pd(.5,.5)}function Ox(t,e,n,r,i,o){bx.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(wx.x=o*bx.x-i*bx.y,wx.y=i*bx.x+o*bx.y):wx.copy(bx),t.copy(e),t.x+=wx.x,t.y+=wx.y,t.applyMatrix4(_x)}Cx.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Cx,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vx.setFromMatrixScale(this.matrixWorld),_x.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),xx.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&vx.multiplyScalar(-xx.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;Ox(Mx.set(-.5,-.5,0),xx,o,vx,r,i),Ox(Sx.set(.5,-.5,0),xx,o,vx,r,i),Ox(Ex.set(.5,.5,0),xx,o,vx,r,i),Nx.set(0,0),Tx.set(1,0),Ax.set(1,1);let a=t.ray.intersectTriangle(Mx,Sx,Ex,!1,yx);if(null===a&&(Ox(Sx.set(-.5,.5,0),xx,o,vx,r,i),Tx.set(0,1),a=t.ray.intersectTriangle(Mx,Ex,Sx,!1,yx),null===a))return;const s=t.ray.origin.distanceTo(yx);s<t.near||s>t.far||e.push({distance:s,point:yx.clone(),uv:zm.getUV(yx,Mx,Sx,Ex,Nx,Tx,Ax,new pd),face:null,object:this})},copy:function(t){return Xd.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const Rx=new Sd,Px=new Sd;function Lx(){Xd.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Ix(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ig.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Pd,this.bindMatrixInverse=new Pd}Lx.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Lx,isLOD:!0,copy:function(t){Xd.prototype.copy.call(this,t,!1);const e=t.levels;for(let n=0,r=e.length;n<r;n++){const t=e[n];this.addLevel(t.object.clone(),t.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);const n=this.levels;let r;for(r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Rx.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(Rx);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){const e=this.levels;if(e.length>1){Rx.setFromMatrixPosition(t.matrixWorld),Px.setFromMatrixPosition(this.matrixWorld);const n=Rx.distanceTo(Px)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){const e=Xd.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const t=n[r];e.object.levels.push({object:t.object.uuid,distance:t.distance})}return e}}),Ix.prototype=Object.assign(Object.create(Ig.prototype),{constructor:Ix,isSkinnedMesh:!0,copy:function(t){return Ig.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new vd,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Ig.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const t=new Sd,e=new vd,n=new vd,r=new Sd,i=new Pd;return function(o,a){const s=this.skeleton,u=this.geometry;e.fromBufferAttribute(u.attributes.skinIndex,o),n.fromBufferAttribute(u.attributes.skinWeight,o),t.fromBufferAttribute(u.attributes.position,o).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let c=0;c<4;c++){const o=n.getComponent(c);if(0!==o){const n=e.getComponent(c);i.multiplyMatrices(s.bones[n].matrixWorld,s.boneInverses[n]),a.addScaledVector(r.copy(t).applyMatrix4(i),o)}}return a.applyMatrix4(this.bindMatrixInverse)}}()});const Dx=new Pd,kx=new Pd;function zx(t,e){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Pd)}}function Bx(){Xd.call(this),this.type="Bone"}Object.assign(zx.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++){const e=new Pd;this.bones[t]&&e.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(e)}},pose:function(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}},update:function(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,o=t.length;i<o;i++)Dx.multiplyMatrices(t[i]?t[i].matrixWorld:kx,e[i]),Dx.toArray(n,16*i);void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new zx(this.bones,this.boneInverses)},getBoneByName:function(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Bx.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Bx,isBone:!0});const Ux=new Pd,Fx=new Pd,jx=[],Hx=new Ig;function Vx(t,e,n){Ig.call(this,t,e),this.instanceMatrix=new Jm(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Gx(t){Zm.call(this),this.type="LineBasicMaterial",this.color=new jm(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}Vx.prototype=Object.assign(Object.create(Ig.prototype),{constructor:Vx,isInstancedMesh:!0,copy:function(t){return Ig.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){const n=this.matrixWorld,r=this.count;if(Hx.geometry=this.geometry,Hx.material=this.material,void 0!==Hx.material)for(let i=0;i<r;i++){this.getMatrixAt(i,Ux),Fx.multiplyMatrices(n,Ux),Hx.matrixWorld=Fx,Hx.raycast(t,jx);for(let t=0,n=jx.length;t<n;t++){const n=jx[t];n.instanceId=i,n.object=this,e.push(n)}jx.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),(Gx.prototype=Object.create(Zm.prototype)).constructor=Gx,Gx.prototype.isLineBasicMaterial=!0,Gx.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const qx=new Sd,Wx=new Sd,Zx=new Pd,$x=new _m,Yx=new dm;function Xx(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Xd.call(this),this.type="Line",this.geometry=void 0!==t?t:new gg,this.material=void 0!==e?e:new Gx,this.updateMorphTargets()}Xx.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Xx,isLine:!0,copy:function(t){return Xd.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)qx.fromBufferAttribute(e,t-1),Wx.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=qx.distanceTo(Wx);t.setAttribute("lineDistance",new og(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const e=t.vertices,n=t.lineDistances;n[0]=0;for(let t=1,r=e.length;t<r;t++)n[t]=n[t-1],n[t]+=e[t-1].distanceTo(e[t])}return this},raycast:function(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Yx.copy(n.boundingSphere),Yx.applyMatrix4(r),Yx.radius+=i,!1===t.ray.intersectsSphere(Yx))return;Zx.getInverse(r),$x.copy(t.ray).applyMatrix4(Zx);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new Sd,u=new Sd,c=new Sd,l=new Sd,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position.array;if(null!==r){const n=r.array;for(let r=0,o=n.length-1;r<o;r+=h){const o=n[r+1];if(s.fromArray(i,3*n[r]),u.fromArray(i,3*o),$x.distanceSqToSegment(s,u,l,c)>a)continue;l.applyMatrix4(this.matrixWorld);const h=t.ray.origin.distanceTo(l);h<t.near||h>t.far||e.push({distance:h,point:c.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else for(let n=0,o=i.length/3-1;n<o;n+=h){if(s.fromArray(i,3*n),u.fromArray(i,3*n+3),$x.distanceSqToSegment(s,u,l,c)>a)continue;l.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(l);r<t.near||r>t.far||e.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const r=n.vertices,i=r.length;for(let n=0;n<i-1;n+=h){if($x.distanceSqToSegment(r[n],r[n+1],l,c)>a)continue;l.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(l);i<t.near||i>t.far||e.push({distance:i,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Jx=new Sd,Qx=new Sd;function Kx(t,e){Xx.call(this,t,e),this.type="LineSegments"}function tb(t,e){Xx.call(this,t,e),this.type="LineLoop"}function eb(t){Zm.call(this),this.type="PointsMaterial",this.color=new jm(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Kx.prototype=Object.assign(Object.create(Xx.prototype),{constructor:Kx,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)Jx.fromBufferAttribute(e,t),Qx.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Jx.distanceTo(Qx);t.setAttribute("lineDistance",new og(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const e=t.vertices,n=t.lineDistances;for(let t=0,r=e.length;t<r;t+=2)Jx.copy(e[t]),Qx.copy(e[t+1]),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Jx.distanceTo(Qx)}return this}}),tb.prototype=Object.assign(Object.create(Xx.prototype),{constructor:tb,isLineLoop:!0}),(eb.prototype=Object.create(Zm.prototype)).constructor=eb,eb.prototype.isPointsMaterial=!0,eb.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const nb=new Pd,rb=new _m,ib=new dm,ob=new Sd;function ab(t,e){Xd.call(this),this.type="Points",this.geometry=void 0!==t?t:new gg,this.material=void 0!==e?e:new eb,this.updateMorphTargets()}function sb(t,e,n,r,i,o,a){const s=rb.distanceSqToPoint(t);if(s<n){const n=new Sd;rb.closestPointToPoint(t,n),n.applyMatrix4(r);const u=i.ray.origin.distanceTo(n);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}function ub(t,e,n,r,i,o,a,s,u){yd.call(this,t,e,n,r,i,o,a,s,u),this.format=void 0!==a?a:1022,this.minFilter=void 0!==o?o:1006,this.magFilter=void 0!==i?i:1006,this.generateMipmaps=!1}function cb(t,e,n,r,i,o,a,s,u,c,l,h){yd.call(this,null,o,a,s,u,c,r,i,l,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function lb(t,e,n,r,i,o,a,s,u){yd.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function hb(t,e,n,r,i,o,a,s,u,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===c&&(n=1012),void 0===n&&1027===c&&(n=1020),yd.call(this,null,r,i,o,a,s,c,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function pb(t){gg.call(this),this.type="WireframeGeometry";const e=[],n=[0,0],r={},i=["a","b","c"];if(t&&t.isGeometry){const o=t.faces;for(let t=0,e=o.length;t<e;t++){const e=o[t];for(let t=0;t<3;t++){const o=e[i[t]],a=e[i[(t+1)%3]];n[0]=Math.min(o,a),n[1]=Math.max(o,a);const s=n[0]+","+n[1];void 0===r[s]&&(r[s]={index1:n[0],index2:n[1]})}}for(const n in r){const i=r[n];let o=t.vertices[i.index1];e.push(o.x,o.y,o.z),o=t.vertices[i.index2],e.push(o.x,o.y,o.z)}}else if(t&&t.isBufferGeometry){let i=new Sd;if(null!==t.index){const o=t.attributes.position,a=t.index;let s=t.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let t=0,e=s.length;t<e;++t){const e=s[t],i=e.start;for(let t=i,o=i+e.count;t<o;t+=3)for(let e=0;e<3;e++){const i=a.getX(t+e),o=a.getX(t+(e+1)%3);n[0]=Math.min(i,o),n[1]=Math.max(i,o);const s=n[0]+","+n[1];void 0===r[s]&&(r[s]={index1:n[0],index2:n[1]})}}for(const t in r){const n=r[t];i.fromBufferAttribute(o,n.index1),e.push(i.x,i.y,i.z),i.fromBufferAttribute(o,n.index2),e.push(i.x,i.y,i.z)}}else{const n=t.attributes.position;for(let t=0,r=n.count/3;t<r;t++)for(let o=0;o<3;o++)i.fromBufferAttribute(n,3*t+o),e.push(i.x,i.y,i.z),i.fromBufferAttribute(n,3*t+(o+1)%3),e.push(i.x,i.y,i.z)}}this.setAttribute("position",new og(e,3))}function fb(t,e,n){jg.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new db(t,e,n)),this.mergeVertices()}function db(t,e,n){gg.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};const r=[],i=[],o=[],a=[],s=1e-5,u=new Sd,c=new Sd,l=new Sd,h=new Sd,p=new Sd;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const f=e+1;for(let d=0;d<=n;d++){const r=d/n;for(let n=0;n<=e;n++){const f=n/e;t(f,r,c),i.push(c.x,c.y,c.z),f-s>=0?(t(f-s,r,l),h.subVectors(c,l)):(t(f+s,r,l),h.subVectors(l,c)),r-s>=0?(t(f,r-s,l),p.subVectors(c,l)):(t(f,r+s,l),p.subVectors(l,c)),u.crossVectors(h,p).normalize(),o.push(u.x,u.y,u.z),a.push(f,r)}}for(let d=0;d<n;d++)for(let t=0;t<e;t++){const e=d*f+t+1,n=(d+1)*f+t+1,i=(d+1)*f+t;r.push(d*f+t,e,i),r.push(e,n,i)}this.setIndex(r),this.setAttribute("position",new og(i,3)),this.setAttribute("normal",new og(o,3)),this.setAttribute("uv",new og(a,2))}function mb(t,e,n,r){jg.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new gb(t,e,n,r)),this.mergeVertices()}function gb(t,e,n,r){gg.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;const i=[],o=[];function a(t,e,n,r){const i=Math.pow(2,r),o=[];for(let a=0;a<=i;a++){o[a]=[];const r=t.clone().lerp(n,a/i),s=e.clone().lerp(n,a/i),u=i-a;for(let t=0;t<=u;t++)o[a][t]=0===t&&a===i?r:r.clone().lerp(s,t/u)}for(let a=0;a<i;a++)for(let t=0;t<2*(i-a)-1;t++){const e=Math.floor(t/2);t%2==0?(s(o[a][e+1]),s(o[a+1][e]),s(o[a][e])):(s(o[a][e+1]),s(o[a+1][e+1]),s(o[a+1][e]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){const r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new Sd,r=new Sd,i=new Sd;for(let o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){const e=new Sd;for(let n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){const t=new Sd;for(let n=0;n<i.length;n+=3){t.x=i[n+0],t.y=i[n+1],t.z=i[n+2];const r=l(t)/2/Math.PI+.5,a=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);o.push(r,1-a)}var e;(function(){const t=new Sd,e=new Sd,n=new Sd,r=new Sd,a=new pd,s=new pd,u=new pd;for(let h=0,p=0;h<i.length;h+=9,p+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),u.set(o[p+4],o[p+5]),r.copy(t).add(e).add(n).divideScalar(3);const f=l(r);c(a,p+0,t,f),c(s,p+2,e,f),c(u,p+4,n,f)}})(),function(){for(let t=0;t<o.length;t+=6){const e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new og(i,3)),this.setAttribute("normal",new og(i.slice(),3)),this.setAttribute("uv",new og(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function yb(t,e){jg.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new vb(t,e)),this.mergeVertices()}function vb(t,e){gb.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function xb(t,e){jg.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new bb(t,e)),this.mergeVertices()}function bb(t,e){gb.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function wb(t,e){jg.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new _b(t,e)),this.mergeVertices()}function _b(t,e){const n=(1+Math.sqrt(5))/2;gb.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Mb(t,e){jg.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Sb(t,e)),this.mergeVertices()}function Sb(t,e){const n=(1+Math.sqrt(5))/2,r=1/n;gb.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Eb(t,e,n,r,i,o){jg.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");const a=new Nb(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Nb(t,e,n,r,i){gg.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},n=n||1,r=r||8;const o=t.computeFrenetFrames(e=e||64,i=i||!1);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Sd,s=new Sd,u=new pd;let c=new Sd;const l=[],h=[],p=[],f=[];function d(i){c=t.getPointAt(i/e,c);const u=o.normals[i],p=o.binormals[i];for(let t=0;t<=r;t++){const e=t/r*Math.PI*2,i=Math.sin(e),o=-Math.cos(e);s.x=o*u.x+i*p.x,s.y=o*u.y+i*p.y,s.z=o*u.z+i*p.z,s.normalize(),h.push(s.x,s.y,s.z),a.x=c.x+n*s.x,a.y=c.y+n*s.y,a.z=c.z+n*s.z,l.push(a.x,a.y,a.z)}}!function(){for(let t=0;t<e;t++)d(t);d(!1===i?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=r;n++)u.x=t/e,u.y=n/r,p.push(u.x,u.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=r;e++){const n=(r+1)*t+(e-1),i=(r+1)*t+e,o=(r+1)*(t-1)+e;f.push((r+1)*(t-1)+(e-1),n,o),f.push(n,i,o)}}()}(),this.setIndex(f),this.setAttribute("position",new og(l,3)),this.setAttribute("normal",new og(h,3)),this.setAttribute("uv",new og(p,2))}function Tb(t,e,n,r,i,o,a){jg.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ab(t,e,n,r,i,o)),this.mergeVertices()}function Ab(t,e,n,r,i,o){gg.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;const a=[],s=[],u=[],c=[],l=new Sd,h=new Sd,p=new Sd,f=new Sd,d=new Sd,m=new Sd,g=new Sd;for(let v=0;v<=n;++v){const a=v/n*i*Math.PI*2;y(a,i,o,t,p),y(a+.01,i,o,t,f),m.subVectors(f,p),g.addVectors(f,p),d.crossVectors(m,g),g.crossVectors(d,m),d.normalize(),g.normalize();for(let t=0;t<=r;++t){const i=t/r*Math.PI*2,o=-e*Math.cos(i),a=e*Math.sin(i);l.x=p.x+(o*g.x+a*d.x),l.y=p.y+(o*g.y+a*d.y),l.z=p.z+(o*g.z+a*d.z),s.push(l.x,l.y,l.z),h.subVectors(l,p).normalize(),u.push(h.x,h.y,h.z),c.push(v/n),c.push(t/r)}}for(let v=1;v<=n;v++)for(let t=1;t<=r;t++){const e=(r+1)*v+(t-1),n=(r+1)*v+t,i=(r+1)*(v-1)+t;a.push((r+1)*(v-1)+(t-1),e,i),a.push(e,n,i)}function y(t,e,n,r,i){const o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new og(s,3)),this.setAttribute("normal",new og(u,3)),this.setAttribute("uv",new og(c,2))}function Cb(t,e,n,r,i){jg.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Ob(t,e,n,r,i)),this.mergeVertices()}function Ob(t,e,n,r,i){gg.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;const o=[],a=[],s=[],u=[],c=new Sd,l=new Sd,h=new Sd;for(let p=0;p<=n;p++)for(let o=0;o<=r;o++){const f=o/r*i,d=p/n*Math.PI*2;l.x=(t+e*Math.cos(d))*Math.cos(f),l.y=(t+e*Math.cos(d))*Math.sin(f),l.z=e*Math.sin(d),a.push(l.x,l.y,l.z),c.x=t*Math.cos(f),c.y=t*Math.sin(f),h.subVectors(l,c).normalize(),s.push(h.x,h.y,h.z),u.push(o/r),u.push(p/n)}for(let p=1;p<=n;p++)for(let t=1;t<=r;t++){const e=(r+1)*(p-1)+t-1,n=(r+1)*(p-1)+t,i=(r+1)*p+t;o.push((r+1)*p+t-1,e,i),o.push(e,n,i)}this.setIndex(o),this.setAttribute("position",new og(a,3)),this.setAttribute("normal",new og(s,3)),this.setAttribute("uv",new og(u,2))}function Rb(t,e,n,r,i){let o,a;if(i===function(t,e,n,r){let i=0;for(let o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Qb(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Qb(o,t[o],t[o+1],a);return a&&Wb(a,a.next)&&(Kb(a),a=a.next),a}function Pb(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Wb(r,r.next)&&0!==qb(r.prev,r,r.next))r=r.next;else{if(Kb(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function Lb(t,e,n,r,i,o,a){if(!t)return;!a&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=jb(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ,r);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);let s,u,c=t;for(;t.prev!==t.next;)if(s=t.prev,u=t.next,o?Db(t,r,i,o):Ib(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Kb(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?Lb(t=kb(Pb(t),e,n),e,n,r,i,o,2):2===a&&zb(t,e,n,r,i,o):Lb(Pb(t),e,n,r,i,o,1);break}}function Ib(t){let e=t.prev,n=t,r=t.next;if(qb(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(Vb(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&qb(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Db(t,e,n,r){let i=t.prev,o=t,a=t.next;if(qb(i,o,a)>=0)return!1;let s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,c=jb(i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,e,n,r),l=jb(s,u,e,n,r),h=t.prevZ,p=t.nextZ;for(;h&&h.z>=c&&p&&p.z<=l;){if(h!==t.prev&&h!==t.next&&Vb(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&qb(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&Vb(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&qb(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&Vb(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&qb(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=l;){if(p!==t.prev&&p!==t.next&&Vb(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&qb(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function kb(t,e,n){let r=t;do{let i=r.prev,o=r.next.next;!Wb(i,o)&&Zb(i,r,r.next,o)&&Xb(i,o)&&Xb(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Kb(r),Kb(r.next),r=t=o),r=r.next}while(r!==t);return Pb(r)}function zb(t,e,n,r,i,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&Gb(a,t)){let s=Jb(a,t);return a=Pb(a,a.next),s=Pb(s,s.next),Lb(a,e,n,r,i,o),void Lb(s,e,n,r,i,o)}t=t.next}a=a.next}while(a!==t)}function Bb(t,e){return t.x-e.x}function Ub(t,e){if(e=function(t,e){let n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let t=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=i&&t>a){if(a=t,t===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;let s,u=n,c=n.x,l=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&Vb(o<l?i:a,o,c,l,o<l?a:i,o,r.x,r.y)&&(s=Math.abs(o-r.y)/(i-r.x),Xb(r,t)&&(s<h||s===h&&(r.x>n.x||r.x===n.x&&Fb(n,r)))&&(n=r,h=s)),r=r.next}while(r!==u);return n}(t,e)){const n=Jb(e,t);Pb(e,e.next),Pb(n,n.next)}}function Fb(t,e){return qb(t.prev,t,e.prev)<0&&qb(e.next,t,t.next)<0}function jb(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Hb(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Vb(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Gb(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Zb(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Xb(t,e)&&Xb(e,t)&&function(t,e){let n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(qb(t.prev,t,e.prev)||qb(t,e.prev,e))||Wb(t,e)&&qb(t.prev,t,t.next)>0&&qb(e.prev,e,e.next)>0)}function qb(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Wb(t,e){return t.x===e.x&&t.y===e.y}function Zb(t,e,n,r){const i=Yb(qb(t,e,n)),o=Yb(qb(t,e,r)),a=Yb(qb(n,r,t)),s=Yb(qb(n,r,e));return i!==o&&a!==s||!(0!==i||!$b(t,n,e))||!(0!==o||!$b(t,r,e))||!(0!==a||!$b(n,t,r))||!(0!==s||!$b(n,e,r))}function $b(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Yb(t){return t>0?1:t<0?-1:0}function Xb(t,e){return qb(t.prev,t,t.next)<0?qb(t,e,t.next)>=0&&qb(t,t.prev,e)>=0:qb(t,e,t.prev)<0||qb(t,t.next,e)<0}function Jb(t,e){let n=new tw(t.i,t.x,t.y),r=new tw(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Qb(t,e,n,r){const i=new tw(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Kb(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function tw(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}ab.prototype=Object.assign(Object.create(Xd.prototype),{constructor:ab,isPoints:!0,copy:function(t){return Xd.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ib.copy(n.boundingSphere),ib.applyMatrix4(r),ib.radius+=i,!1===t.ray.intersectsSphere(ib))return;nb.getInverse(r),rb.copy(t.ray).applyMatrix4(nb);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const i=n.index,o=n.attributes.position.array;if(null!==i){const n=i.array;for(let i=0,s=n.length;i<s;i++){const s=n[i];ob.fromArray(o,3*s),sb(ob,s,a,r,t,e,this)}}else for(let n=0,s=o.length/3;n<s;n++)ob.fromArray(o,3*n),sb(ob,n,a,r,t,e,this)}else{const i=n.vertices;for(let n=0,o=i.length;n<o;n++)sb(i[n],n,a,r,t,e,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),ub.prototype=Object.assign(Object.create(yd.prototype),{constructor:ub,isVideoTexture:!0,update:function(){const t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(cb.prototype=Object.create(yd.prototype)).constructor=cb,cb.prototype.isCompressedTexture=!0,(lb.prototype=Object.create(yd.prototype)).constructor=lb,lb.prototype.isCanvasTexture=!0,(hb.prototype=Object.create(yd.prototype)).constructor=hb,hb.prototype.isDepthTexture=!0,(pb.prototype=Object.create(gg.prototype)).constructor=pb,(fb.prototype=Object.create(jg.prototype)).constructor=fb,(db.prototype=Object.create(gg.prototype)).constructor=db,(mb.prototype=Object.create(jg.prototype)).constructor=mb,(gb.prototype=Object.create(gg.prototype)).constructor=gb,(yb.prototype=Object.create(jg.prototype)).constructor=yb,(vb.prototype=Object.create(gb.prototype)).constructor=vb,(xb.prototype=Object.create(jg.prototype)).constructor=xb,(bb.prototype=Object.create(gb.prototype)).constructor=bb,(wb.prototype=Object.create(jg.prototype)).constructor=wb,(_b.prototype=Object.create(gb.prototype)).constructor=_b,(Mb.prototype=Object.create(jg.prototype)).constructor=Mb,(Sb.prototype=Object.create(gb.prototype)).constructor=Sb,(Eb.prototype=Object.create(jg.prototype)).constructor=Eb,(Nb.prototype=Object.create(gg.prototype)).constructor=Nb,Nb.prototype.toJSON=function(){const t=gg.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Tb.prototype=Object.create(jg.prototype)).constructor=Tb,(Ab.prototype=Object.create(gg.prototype)).constructor=Ab,(Cb.prototype=Object.create(jg.prototype)).constructor=Cb,(Ob.prototype=Object.create(gg.prototype)).constructor=Ob;const ew={area:function(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return ew.area(t)<0},triangulateShape:function(t,e){const n=[],r=[],i=[];nw(t),rw(n,t);let o=t.length;e.forEach(nw);for(let s=0;s<e.length;s++)r.push(o),o+=e[s].length,rw(n,e[s]);const a=function(t,e,n){n=n||2;let r,i,o,a,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,p=Rb(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(l&&(p=function(t,e,n,r){let i,o,a,s,u,c=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,u=Rb(t,a,s,r,!1),u===u.next&&(u.steiner=!0),c.push(Hb(u));for(c.sort(Bb),i=0;i<c.length;i++)Ub(c[i],n),n=Pb(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(let e=n;e<h;e+=n)s=t[e],u=t[e+1],s<r&&(r=s),u<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=Math.max(o-r,a-i),c=0!==c?1/c:0}return Lb(p,f,n,r,i,c),f}(n,r);for(let s=0;s<a.length;s+=3)i.push(a.slice(s,s+3));return i}};function nw(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function rw(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function iw(t,e){jg.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new ow(t,e)),this.mergeVertices()}function ow(t,e){gg.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let a=0,s=t.length;a<s;a++)o(t[a]);function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1;let u=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:l-2,p=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3;const d=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:aw;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=e.amount);let g,y,v,x,b,w=!1;d&&(g=d.getSpacedPoints(s),w=!0,c=!1,y=d.computeFrenetFrames(s,!1),v=new Sd,x=new Sd,b=new Sd),c||(f=0,l=0,h=0,p=0);const _=t.extractPoints(a);let M=_.shape;const S=_.holes;if(!ew.isClockWise(M)){M=M.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];ew.isClockWise(e)&&(S[t]=e.reverse())}}const E=ew.triangulateShape(M,S),N=M;for(let e=0,n=S.length;e<n;e++)M=M.concat(S[e]);function T(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const A=M.length,C=E.length;function O(t,e,n){let r,i,o;const a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,c=n.y-t.y,l=a*a+s*s;if(Math.abs(a*c-s*u)>Number.EPSILON){const h=Math.sqrt(l),p=Math.sqrt(u*u+c*c),f=e.x-s/h,d=e.y+a/h,m=((n.x-c/p-f)*c-(n.y+u/p-d)*u)/(a*c-s*u);r=f+a*m-t.x,i=d+s*m-t.y;const g=r*r+i*i;if(g<=2)return new pd(r,i);o=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?u>Number.EPSILON&&(t=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(c)&&(t=!0),t?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new pd(r/o,i/o)}const R=[];for(let e=0,n=N.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),R[e]=O(N[e],N[r],N[i]);const P=[];let L,I=R.concat();for(let e=0,n=S.length;e<n;e++){const t=S[e];L=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),L[e]=O(t[e],t[r],t[i]);P.push(L),I=I.concat(L)}for(let e=0;e<f;e++){const t=e/f,n=l*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+p;for(let e=0,i=N.length;e<i;e++){const t=T(N[e],R[e],r);z(t.x,t.y,-n)}for(let e=0,i=S.length;e<i;e++){const t=S[e];L=P[e];for(let e=0,i=t.length;e<i;e++){const i=T(t[e],L[e],r);z(i.x,i.y,-n)}}}const D=h+p;for(let e=0;e<A;e++){const t=c?T(M[e],I[e],D):M[e];w?(x.copy(y.normals[0]).multiplyScalar(t.x),v.copy(y.binormals[0]).multiplyScalar(t.y),b.copy(g[0]).add(x).add(v),z(b.x,b.y,b.z)):z(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<A;t++){const n=c?T(M[t],I[t],D):M[t];w?(x.copy(y.normals[e]).multiplyScalar(n.x),v.copy(y.binormals[e]).multiplyScalar(n.y),b.copy(g[e]).add(x).add(v),z(b.x,b.y,b.z)):z(n.x,n.y,u/s*e)}for(let e=f-1;e>=0;e--){const t=e/f,n=l*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+p;for(let e=0,i=N.length;e<i;e++){const t=T(N[e],R[e],r);z(t.x,t.y,u+n)}for(let e=0,i=S.length;e<i;e++){const t=S[e];L=P[e];for(let e=0,i=t.length;e<i;e++){const i=T(t[e],L[e],r);w?z(i.x,i.y+g[s-1].y,g[s-1].x+n):z(i.x,i.y,u+n)}}}function k(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=s+2*f;t<n;t++){const n=A*t,o=A*(t+1);U(e+r+n,e+i+n,e+i+o,e+r+o)}}}function z(t,e,n){o.push(t),o.push(e),o.push(n)}function B(t,e,i){F(t),F(e),F(i);const o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);j(a[0]),j(a[1]),j(a[2])}function U(t,e,i,o){F(t),F(e),F(o),F(e),F(i),F(o);const a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);j(s[0]),j(s[1]),j(s[3]),j(s[1]),j(s[2]),j(s[3])}function F(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function j(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(c){let t=0,e=A*t;for(let n=0;n<C;n++){const t=E[n];B(t[2]+e,t[1]+e,t[0]+e)}t=s+2*f,e=A*t;for(let n=0;n<C;n++){const t=E[n];B(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<C;t++){const e=E[t];B(e[2],e[1],e[0])}for(let t=0;t<C;t++){const e=E[t];B(e[0]+A*s,e[1]+A*s,e[2]+A*s)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;k(N,e),e+=N.length;for(let n=0,r=S.length;n<r;n++){const t=S[n];k(t,e),e+=t.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new og(r,3)),this.setAttribute("uv",new og(i,2)),this.computeVertexNormals()}(iw.prototype=Object.create(jg.prototype)).constructor=iw,iw.prototype.toJSON=function(){const t=jg.prototype.toJSON.call(this);return sw(this.parameters.shapes,this.parameters.options,t)},(ow.prototype=Object.create(gg.prototype)).constructor=ow,ow.prototype.toJSON=function(){const t=gg.prototype.toJSON.call(this);return sw(this.parameters.shapes,this.parameters.options,t)};const aw={generateTopUV:function(t,e,n,r,i){const o=e[3*r],a=e[3*r+1],s=e[3*i],u=e[3*i+1];return[new pd(e[3*n],e[3*n+1]),new pd(o,a),new pd(s,u)]},generateSideWallUV:function(t,e,n,r,i,o){const a=e[3*n],s=e[3*n+1],u=e[3*n+2],c=e[3*r],l=e[3*r+1],h=e[3*r+2],p=e[3*i],f=e[3*i+1],d=e[3*i+2],m=e[3*o],g=e[3*o+1],y=e[3*o+2];return Math.abs(s-l)<.01?[new pd(a,1-u),new pd(c,1-h),new pd(p,1-d),new pd(m,1-y)]:[new pd(s,1-u),new pd(l,1-h),new pd(f,1-d),new pd(g,1-y)]}};function sw(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++)n.shapes.push(t[r].uuid);else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function uw(t,e){jg.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new cw(t,e)),this.mergeVertices()}function cw(t,e){const n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new jg;const r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),ow.call(this,r,e),this.type="TextBufferGeometry"}function lw(t,e,n,r,i,o,a){jg.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new hw(t,e,n,r,i,o,a)),this.mergeVertices()}function hw(t,e,n,r,i,o,a){gg.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;const s=Math.min(o+a,Math.PI);let u=0;const c=[],l=new Sd,h=new Sd,p=[],f=[],d=[],m=[];for(let g=0;g<=n;g++){const p=[],y=g/n;let v=0;0==g&&0==o?v=.5/e:g==n&&s==Math.PI&&(v=-.5/e);for(let n=0;n<=e;n++){const s=n/e;l.x=-t*Math.cos(r+s*i)*Math.sin(o+y*a),l.y=t*Math.cos(o+y*a),l.z=t*Math.sin(r+s*i)*Math.sin(o+y*a),f.push(l.x,l.y,l.z),h.copy(l).normalize(),d.push(h.x,h.y,h.z),m.push(s+v,1-y),p.push(u++)}c.push(p)}for(let g=0;g<n;g++)for(let t=0;t<e;t++){const e=c[g][t+1],r=c[g][t],i=c[g+1][t],a=c[g+1][t+1];(0!==g||o>0)&&p.push(e,r,a),(g!==n-1||s<Math.PI)&&p.push(r,i,a)}this.setIndex(p),this.setAttribute("position",new og(f,3)),this.setAttribute("normal",new og(d,3)),this.setAttribute("uv",new og(m,2))}function pw(t,e,n,r,i,o){jg.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new fw(t,e,n,r,i,o)),this.mergeVertices()}function fw(t,e,n,r,i,o){gg.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;const a=[],s=[],u=[],c=[];let l=t;const h=(e-t)/(r=void 0!==r?Math.max(1,r):1),p=new Sd,f=new pd;for(let d=0;d<=r;d++){for(let t=0;t<=n;t++){const r=i+t/n*o;p.x=l*Math.cos(r),p.y=l*Math.sin(r),s.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,c.push(f.x,f.y)}l+=h}for(let d=0;d<r;d++){const t=d*(n+1);for(let e=0;e<n;e++){const r=e+t,i=r+n+1,o=r+n+2,s=r+1;a.push(r,i,s),a.push(i,o,s)}}this.setIndex(a),this.setAttribute("position",new og(s,3)),this.setAttribute("normal",new og(u,3)),this.setAttribute("uv",new og(c,2))}function dw(t,e,n,r){jg.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new mw(t,e,n,r)),this.mergeVertices()}function mw(t,e,n,r){gg.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=hd.clamp(r,0,2*Math.PI);const i=[],o=[],a=[],s=1/e,u=new Sd,c=new pd;for(let l=0;l<=e;l++){const i=n+l*s*r,h=Math.sin(i),p=Math.cos(i);for(let n=0;n<=t.length-1;n++)u.x=t[n].x*h,u.y=t[n].y,u.z=t[n].x*p,o.push(u.x,u.y,u.z),c.x=l/e,c.y=n/(t.length-1),a.push(c.x,c.y)}for(let l=0;l<e;l++)for(let e=0;e<t.length-1;e++){const n=e+l*t.length,r=n+t.length,o=n+t.length+1,a=n+1;i.push(n,r,a),i.push(r,o,a)}if(this.setIndex(i),this.setAttribute("position",new og(o,3)),this.setAttribute("uv",new og(a,2)),this.computeVertexNormals(),r===2*Math.PI){const n=this.attributes.normal.array,r=new Sd,i=new Sd,o=new Sd,a=e*t.length*3;for(let e=0,s=0;e<t.length;e++,s+=3)r.x=n[s+0],r.y=n[s+1],r.z=n[s+2],i.x=n[a+s+0],i.y=n[a+s+1],i.z=n[a+s+2],o.addVectors(r,i).normalize(),n[s+0]=n[a+s+0]=o.x,n[s+1]=n[a+s+1]=o.y,n[s+2]=n[a+s+2]=o.z}}function gw(t,e){jg.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new yw(t,e)),this.mergeVertices()}function yw(t,e){gg.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;const n=[],r=[],i=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))u(t);else for(let c=0;c<t.length;c++)u(t[c]),this.addGroup(a,s,c),a+=s,s=0;function u(t){const a=r.length/3,u=t.extractPoints(e);let c=u.shape;const l=u.holes;!1===ew.isClockWise(c)&&(c=c.reverse());for(let e=0,n=l.length;e<n;e++){const t=l[e];!0===ew.isClockWise(t)&&(l[e]=t.reverse())}const h=ew.triangulateShape(c,l);for(let e=0,n=l.length;e<n;e++)c=c.concat(l[e]);for(let e=0,n=c.length;e<n;e++){const t=c[e];r.push(t.x,t.y,0),i.push(0,0,1),o.push(t.x,t.y)}for(let e=0,r=h.length;e<r;e++){const t=h[e];n.push(t[0]+a,t[1]+a,t[2]+a),s+=3}}this.setIndex(n),this.setAttribute("position",new og(r,3)),this.setAttribute("normal",new og(i,3)),this.setAttribute("uv",new og(o,2))}function vw(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}function xw(t,e){gg.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;const n=[],r=Math.cos(hd.DEG2RAD*e),i=[0,0],o={};let a,s,u;const c=["a","b","c"];let l;t.isBufferGeometry?(l=new jg,l.fromBufferGeometry(t)):l=t.clone(),l.mergeVertices(),l.computeFaceNormals();const h=l.vertices,p=l.faces;for(let f=0,d=p.length;f<d;f++){const t=p[f];for(let e=0;e<3;e++)a=t[c[e]],s=t[c[(e+1)%3]],i[0]=Math.min(a,s),i[1]=Math.max(a,s),u=i[0]+","+i[1],void 0===o[u]?o[u]={index1:i[0],index2:i[1],face1:f,face2:void 0}:o[u].face2=f}for(u in o){const t=o[u];if(void 0===t.face2||p[t.face1].normal.dot(p[t.face2].normal)<=r){let e=h[t.index1];n.push(e.x,e.y,e.z),e=h[t.index2],n.push(e.x,e.y,e.z)}}this.setAttribute("position",new og(n,3))}function bw(t,e,n,r,i,o,a,s){jg.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new ww(t,e,n,r,i,o,a,s)),this.mergeVertices()}function ww(t,e,n,r,i,o,a,s){gg.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};const u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;const c=[],l=[],h=[],p=[];let f=0;const d=[],m=n/2;let g=0;function y(n){let i,o;const d=new pd,y=new Sd;let v=0;const x=!0===n?t:e,b=!0===n?1:-1;i=f;for(let t=1;t<=r;t++)l.push(0,m*b,0),h.push(0,b,0),p.push(.5,.5),f++;o=f;for(let t=0;t<=r;t++){const e=t/r*s+a,n=Math.cos(e),i=Math.sin(e);y.x=x*i,y.y=m*b,y.z=x*n,l.push(y.x,y.y,y.z),h.push(0,b,0),d.x=.5*n+.5,d.y=.5*i*b+.5,p.push(d.x,d.y),f++}for(let t=0;t<r;t++){const e=i+t,r=o+t;!0===n?c.push(r,r+1,e):c.push(r+1,r,e),v+=3}u.addGroup(g,v,!0===n?1:2),g+=v}!function(){const o=new Sd,y=new Sd;let v=0;const x=(e-t)/n;for(let u=0;u<=i;u++){const c=[],g=u/i,v=g*(e-t)+t;for(let t=0;t<=r;t++){const e=t/r,i=e*s+a,u=Math.sin(i),d=Math.cos(i);y.x=v*u,y.y=-g*n+m,y.z=v*d,l.push(y.x,y.y,y.z),o.set(u,x,d).normalize(),h.push(o.x,o.y,o.z),p.push(e,1-g),c.push(f++)}d.push(c)}for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=d[e+1][t],r=d[e+1][t+1],i=d[e][t+1];c.push(d[e][t],n,i),c.push(n,r,i),v+=6}u.addGroup(g,v,0),g+=v}(),!1===o&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new og(l,3)),this.setAttribute("normal",new og(h,3)),this.setAttribute("uv",new og(p,2))}function _w(t,e,n,r,i,o,a){bw.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Mw(t,e,n,r,i,o,a){ww.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Sw(t,e,n,r){jg.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ew(t,e,n,r)),this.mergeVertices()}function Ew(t,e,n,r){gg.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;const i=[],o=[],a=[],s=[],u=new Sd,c=new pd;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let l=0,h=3;l<=e;l++,h+=3){const i=n+l/e*r;u.x=t*Math.cos(i),u.y=t*Math.sin(i),o.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(o[h]/t+1)/2,c.y=(o[h+1]/t+1)/2,s.push(c.x,c.y)}for(let l=1;l<=e;l++)i.push(l,l+1,0);this.setIndex(i),this.setAttribute("position",new og(o,3)),this.setAttribute("normal",new og(a,3)),this.setAttribute("uv",new og(s,2))}(uw.prototype=Object.create(jg.prototype)).constructor=uw,(cw.prototype=Object.create(ow.prototype)).constructor=cw,(lw.prototype=Object.create(jg.prototype)).constructor=lw,(hw.prototype=Object.create(gg.prototype)).constructor=hw,(pw.prototype=Object.create(jg.prototype)).constructor=pw,(fw.prototype=Object.create(gg.prototype)).constructor=fw,(dw.prototype=Object.create(jg.prototype)).constructor=dw,(mw.prototype=Object.create(gg.prototype)).constructor=mw,(gw.prototype=Object.create(jg.prototype)).constructor=gw,gw.prototype.toJSON=function(){const t=jg.prototype.toJSON.call(this);return vw(this.parameters.shapes,t)},(yw.prototype=Object.create(gg.prototype)).constructor=yw,yw.prototype.toJSON=function(){const t=gg.prototype.toJSON.call(this);return vw(this.parameters.shapes,t)},(xw.prototype=Object.create(gg.prototype)).constructor=xw,(bw.prototype=Object.create(jg.prototype)).constructor=bw,(ww.prototype=Object.create(gg.prototype)).constructor=ww,(_w.prototype=Object.create(bw.prototype)).constructor=_w,(Mw.prototype=Object.create(ww.prototype)).constructor=Mw,(Sw.prototype=Object.create(jg.prototype)).constructor=Sw,(Ew.prototype=Object.create(gg.prototype)).constructor=Ew;var Nw=Object.freeze({__proto__:null,WireframeGeometry:pb,ParametricGeometry:fb,ParametricBufferGeometry:db,TetrahedronGeometry:yb,TetrahedronBufferGeometry:vb,OctahedronGeometry:xb,OctahedronBufferGeometry:bb,IcosahedronGeometry:wb,IcosahedronBufferGeometry:_b,DodecahedronGeometry:Mb,DodecahedronBufferGeometry:Sb,PolyhedronGeometry:mb,PolyhedronBufferGeometry:gb,TubeGeometry:Eb,TubeBufferGeometry:Nb,TorusKnotGeometry:Tb,TorusKnotBufferGeometry:Ab,TorusGeometry:Cb,TorusBufferGeometry:Ob,TextGeometry:uw,TextBufferGeometry:cw,SphereGeometry:lw,SphereBufferGeometry:hw,RingGeometry:pw,RingBufferGeometry:fw,PlaneGeometry:iy,PlaneBufferGeometry:oy,LatheGeometry:dw,LatheBufferGeometry:mw,ShapeGeometry:gw,ShapeBufferGeometry:yw,ExtrudeGeometry:iw,ExtrudeBufferGeometry:ow,EdgesGeometry:xw,ConeGeometry:_w,ConeBufferGeometry:Mw,CylinderGeometry:bw,CylinderBufferGeometry:ww,CircleGeometry:Sw,CircleBufferGeometry:Ew,BoxGeometry:class extends jg{constructor(t,e,n,r,i,o){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Hg(t,e,n,r,i,o)),this.mergeVertices()}},BoxBufferGeometry:Hg});function Tw(t){Zm.call(this),this.type="ShadowMaterial",this.color=new jm(0),this.transparent=!0,this.setValues(t)}function Aw(t){Wg.call(this,t),this.type="RawShaderMaterial"}function Cw(t){Zm.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new jm(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jm(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new pd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function Ow(t){Cw.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new pd(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Rw(t){Zm.call(this),this.type="MeshPhongMaterial",this.color=new jm(16777215),this.specular=new jm(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jm(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new pd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Pw(t){Zm.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new jm(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jm(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new pd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Lw(t){Zm.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new pd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Iw(t){Zm.call(this),this.type="MeshLambertMaterial",this.color=new jm(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new jm(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Dw(t){Zm.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new jm(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new pd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function kw(t){Gx.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(Tw.prototype=Object.create(Zm.prototype)).constructor=Tw,Tw.prototype.isShadowMaterial=!0,Tw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this},(Aw.prototype=Object.create(Wg.prototype)).constructor=Aw,Aw.prototype.isRawShaderMaterial=!0,(Cw.prototype=Object.create(Zm.prototype)).constructor=Cw,Cw.prototype.isMeshStandardMaterial=!0,Cw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},(Ow.prototype=Object.create(Cw.prototype)).constructor=Ow,Ow.prototype.isMeshPhysicalMaterial=!0,Ow.prototype.copy=function(t){return Cw.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new jm).copy(t.sheen):null,this.transparency=t.transparency,this},(Rw.prototype=Object.create(Zm.prototype)).constructor=Rw,Rw.prototype.isMeshPhongMaterial=!0,Rw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Pw.prototype=Object.create(Zm.prototype)).constructor=Pw,Pw.prototype.isMeshToonMaterial=!0,Pw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Lw.prototype=Object.create(Zm.prototype)).constructor=Lw,Lw.prototype.isMeshNormalMaterial=!0,Lw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Iw.prototype=Object.create(Zm.prototype)).constructor=Iw,Iw.prototype.isMeshLambertMaterial=!0,Iw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Dw.prototype=Object.create(Zm.prototype)).constructor=Dw,Dw.prototype.isMeshMatcapMaterial=!0,Dw.prototype.copy=function(t){return Zm.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(kw.prototype=Object.create(Gx.prototype)).constructor=kw,kw.prototype.isLineDashedMaterial=!0,kw.prototype.copy=function(t){return Gx.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var zw=Object.freeze({__proto__:null,ShadowMaterial:Tw,SpriteMaterial:mx,RawShaderMaterial:Aw,ShaderMaterial:Wg,PointsMaterial:eb,MeshPhysicalMaterial:Ow,MeshStandardMaterial:Cw,MeshPhongMaterial:Rw,MeshToonMaterial:Pw,MeshNormalMaterial:Lw,MeshLambertMaterial:Iw,MeshDepthMaterial:Jv,MeshDistanceMaterial:Qv,MeshBasicMaterial:$m,MeshMatcapMaterial:Dw,LineDashedMaterial:kw,LineBasicMaterial:Gx,Material:Zm});const Bw={arraySlice:function(t,e,n){return Bw.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,a=0;a!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[a++]=t[r+n]}return i},flattenJSON:function(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let a=o[r];if(void 0!==a)if(Array.isArray(a))do{a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)},subclip:function(t,e,n,r,i){i=i||30;const o=t.clone();o.name=e;const a=[];for(let u=0;u<o.tracks.length;++u){const t=o.tracks[u],e=t.getValueSize(),s=[],c=[];for(let o=0;o<t.times.length;++o){const a=t.times[o]*i;if(!(a<n||a>=r)){s.push(t.times[o]);for(let n=0;n<e;++n)c.push(t.values[o*e+n])}}0!==s.length&&(t.times=Bw.convertArray(s,t.times.constructor),t.values=Bw.convertArray(c,t.values.constructor),a.push(t))}o.tracks=a;let s=1/0;for(let u=0;u<o.tracks.length;++u)s>o.tracks[u].times[0]&&(s=o.tracks[u].times[0]);for(let u=0;u<o.tracks.length;++u)o.tracks[u].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=t),(void 0===r||r<=0)&&(r=30);const i=t.tracks.length,o=e/r;for(let a=0;a<i;++a){const e=n.tracks[a],r=e.ValueTypeName;if("bool"===r||"string"===r)continue;const i=t.tracks.find((function(t){return t.name===e.name&&t.ValueTypeName===r}));if(void 0===i)continue;const s=e.getValueSize(),u=e.times.length-1;let c;if(o<=e.times[0])c=Bw.arraySlice(e.values,0,e.valueSize);else if(o>=e.times[u])c=Bw.arraySlice(e.values,u*s);else{const t=e.createInterpolant();t.evaluate(o),c=t.resultBuffer}"quaternion"===r&&new wd(c[0],c[1],c[2],c[3]).normalize().conjugate().toArray(c);const l=i.times.length;for(let t=0;t<l;++t){const e=t*s;if("quaternion"===r)wd.multiplyQuaternionsFlat(i.values,e,c,0,i.values,e);else for(let t=0;t<s;++t)i.values[e+t]-=c[t]}}return t.blendMode=2501,t}};function Uw(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Fw(t,e,n,r){Uw.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function jw(t,e,n,r){Uw.call(this,t,e,n,r)}function Hw(t,e,n,r){Uw.call(this,t,e,n,r)}function Vw(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Bw.convertArray(e,this.TimeBufferType),this.values=Bw.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Gw(t,e,n){Vw.call(this,t,e,n)}function qw(t,e,n,r){Vw.call(this,t,e,n,r)}function Ww(t,e,n,r){Vw.call(this,t,e,n,r)}function Zw(t,e,n,r){Uw.call(this,t,e,n,r)}function $w(t,e,n,r){Vw.call(this,t,e,n,r)}function Yw(t,e,n,r){Vw.call(this,t,e,n,r)}function Xw(t,e,n,r){Vw.call(this,t,e,n,r)}function Jw(t,e,n,r){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==r?r:2500,this.uuid=hd.generateUUID(),this.duration<0&&this.resetDuration()}function Qw(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ww;case"vector":case"vector2":case"vector3":case"vector4":return Xw;case"color":return qw;case"quaternion":return $w;case"bool":case"boolean":return Gw;case"string":return Yw}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];Bw.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Uw.prototype,{evaluate:function(t){let e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const a=e[1];t<a&&(n=2,i=a);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Uw.prototype,{beforeStart_:Uw.prototype.copySampleValue_,afterEnd_:Uw.prototype.copySampleValue_}),Fw.prototype=Object.assign(Object.create(Uw.prototype),{constructor:Fw,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){let r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=t,a=2*e-n;break;case 2402:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}const u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(n-e)/(r-e),d=f*f,m=d*f,g=-h*m+2*h*d-h*f,y=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,v=(-1-p)*m+(1.5+p)*d+.5*f,x=p*m-p*d;for(let b=0;b!==a;++b)i[b]=g*o[c+b]+y*o[u+b]+v*o[s+b]+x*o[l+b];return i}}),jw.prototype=Object.assign(Object.create(Uw.prototype),{constructor:jw,interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(r-e),l=1-c;for(let h=0;h!==a;++h)i[h]=o[u+h]*l+o[s+h]*c;return i}}),Hw.prototype=Object.assign(Object.create(Uw.prototype),{constructor:Hw,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(Vw,{toJSON:function(t){const e=t.constructor;let n;if(void 0!==e.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Bw.convertArray(t.times,Array),values:Bw.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}}),Object.assign(Vw.prototype,{constructor:Vw,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Hw(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new jw(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Fw(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this},scale:function(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this},trim:function(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=Bw.arraySlice(n,i,o),this.values=Bw.arraySlice(this.values,i*t,o*t)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==i;a++){const e=n[a];if("number"==typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,e),t=!1;break}if(null!==o&&o>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,e,o),t=!1;break}o=e}if(void 0!==r&&Bw.isTypedArray(r))for(let a=0,s=r.length;a!==s;++a){const e=r[a];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,e),t=!1;break}}return t},optimize:function(){const t=Bw.arraySlice(this.times),e=Bw.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=t.length-1;let o=1;for(let a=1;a<i;++a){let i=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==s[0]))if(r)i=!0;else{const t=a*n,r=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[r+a]||n!==e[o+a]){i=!0;break}}}if(i){if(a!==o){t[o]=t[a];const r=a*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,a=0;a!==n;++a)e[r+a]=e[t+a];++o}return o!==t.length?(this.times=Bw.arraySlice(t,0,o),this.values=Bw.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this},clone:function(){const t=Bw.arraySlice(this.times,0),e=Bw.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),Gw.prototype=Object.assign(Object.create(Vw.prototype),{constructor:Gw,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),qw.prototype=Object.assign(Object.create(Vw.prototype),{constructor:qw,ValueTypeName:"color"}),Ww.prototype=Object.assign(Object.create(Vw.prototype),{constructor:Ww,ValueTypeName:"number"}),Zw.prototype=Object.assign(Object.create(Uw.prototype),{constructor:Zw,interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(r-e);let u=t*a;for(let c=u+a;u!==c;u+=4)wd.slerpFlat(i,0,o,u-a,o,u,s);return i}}),$w.prototype=Object.assign(Object.create(Vw.prototype),{constructor:$w,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Zw(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Yw.prototype=Object.assign(Object.create(Vw.prototype),{constructor:Yw,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Xw.prototype=Object.assign(Object.create(Vw.prototype),{constructor:Xw,ValueTypeName:"vector"}),Object.assign(Jw,{parse:function(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let i=0,o=n.length;i!==o;++i)e.push(Qw(n[i]).scale(r));return new Jw(t.name,t.duration,e,t.blendMode)},toJSON:function(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let i=0,o=n.length;i!==o;++i)e.push(Vw.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){const i=e.length,o=[];for(let a=0;a<i;a++){let t=[],s=[];t.push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0);const u=Bw.getKeyframeOrder(t);t=Bw.sortedArray(t,1,u),s=Bw.sortedArray(s,1,u),r||0!==t[0]||(t.push(i),s.push(s[0])),o.push(new Ww(".morphTargetInfluences["+e[a].name+"]",t,s).scale(1/n))}return new Jw(t,-1,o)},findByName:function(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,s=t.length;a<s;a++){const e=t[a],n=e.name.match(i);if(n&&n.length>1){const t=n[1];let i=r[t];i||(r[t]=i=[]),i.push(e)}}const o=[];for(const a in r)o.push(Jw.CreateFromMorphTargetSequence(a,r[a],e,n));return o},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],a=[];Bw.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const u=t.hierarchy||[];for(let c=0;c<u.length;c++){const t=u[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let r=0;r<t[n].morphTargets.length;r++)e[t[n].morphTargets[r]]=-1;for(const i in e){const e=[],o=[];for(let r=0;r!==t[n].morphTargets.length;++r){const r=t[n];e.push(r.time),o.push(r.morphTarget===i?1:0)}r.push(new Ww(".morphTargetInfluence["+i+"]",e,o))}s=e.length*(o||1)}else{const i=".bones["+e[c].name+"]";n(Xw,i+".position",t,"pos",r),n($w,i+".quaternion",t,"rot",r),n(Xw,i+".scale",t,"scl",r)}}return 0===r.length?null:new Jw(i,s,r,a)}}),Object.assign(Jw.prototype,{resetDuration:function(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Jw(this.name,this.duration,t,this.blendMode)}});const Kw={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function t_(t,e,n){const r=this;let i=!1,o=0,a=0,s=void 0;const u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){const e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=u.length;e<n;e+=2){const n=u[e],r=u[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}const e_=new t_;function n_(t){this.manager=void 0!==t?t:e_,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(n_.prototype,{load:function(){},loadAsync:function(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const r_={};function i_(t){n_.call(this,t)}function o_(t){n_.call(this,t)}function a_(t){n_.call(this,t)}function s_(t){n_.call(this,t)}function u_(t){n_.call(this,t)}function c_(t){n_.call(this,t)}function l_(t){n_.call(this,t)}function h_(){this.type="Curve",this.arcLengthDivisions=200}function p_(t,e,n,r,i,o,a,s){h_.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function f_(t,e,n,r,i,o){p_.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function d_(){let t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){let u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(r-e)/(a+s)+(r-n)/s;u*=a,c*=a,i(e,n,u,c)},calc:function(i){const o=i*i;return t+e*i+n*o+r*(o*i)}}}i_.prototype=Object.assign(Object.create(n_.prototype),{constructor:i_,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=Kw.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0!==r_[t])return void r_[t].push({onLoad:e,onProgress:n,onError:r});const a=t.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(a){const n=a[1],o=!!a[2];let s=a[3];s=decodeURIComponent(s),o&&(s=atob(s));try{let r;const o=(this.responseType||"").toLowerCase();switch(o){case"arraybuffer":case"blob":const t=new Uint8Array(s.length);for(let n=0;n<s.length;n++)t[n]=s.charCodeAt(n);r="blob"===o?new Blob([t.buffer],{type:n}):t.buffer;break;case"document":const e=new DOMParser;r=e.parseFromString(s,n);break;case"json":r=JSON.parse(s);break;default:r=s}setTimeout((function(){e&&e(r),i.manager.itemEnd(t)}),0)}catch(u){setTimeout((function(){r&&r(u),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{r_[t]=[],r_[t].push({onLoad:e,onProgress:n,onError:r}),s=new XMLHttpRequest,s.open("GET",t,!0),s.addEventListener("load",(function(e){const n=this.response,r=r_[t];if(delete r_[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Kw.add(t,n);for(let t=0,e=r.length;t<e;t++){const e=r[t];e.onLoad&&e.onLoad(n)}i.manager.itemEnd(t)}else{for(let t=0,n=r.length;t<n;t++){const n=r[t];n.onError&&n.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),s.addEventListener("progress",(function(e){const n=r_[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onProgress&&r.onProgress(e)}}),!1),s.addEventListener("error",(function(e){const n=r_[t];delete r_[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),s.addEventListener("abort",(function(e){const n=r_[t];delete r_[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeader)s.setRequestHeader(t,this.requestHeader[t]);s.send(null)}return i.manager.itemStart(t),s},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),o_.prototype=Object.assign(Object.create(n_.prototype),{constructor:o_,load:function(t,e,n,r){const i=this,o=new i_(i.manager);o.setPath(i.path),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(t)}}),n,r)},parse:function(t){const e=[];for(let n=0;n<t.length;n++){const r=Jw.parse(t[n]);e.push(r)}return e}}),a_.prototype=Object.assign(Object.create(n_.prototype),{constructor:a_,load:function(t,e,n,r){const i=this,o=[],a=new cb;a.image=o;const s=new i_(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer");let u=0;function c(c){s.load(t[c],(function(t){const n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(a.minFilter=1006),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(Array.isArray(t))for(let l=0,h=t.length;l<h;++l)c(l);else s.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=1006),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}),s_.prototype=Object.assign(Object.create(n_.prototype),{constructor:s_,load:function(t,e,n,r){const i=this,o=new Jg,a=new i_(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){const n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:1001,o.wrapT=void 0!==n.wrapT?n.wrapT:1001,o.magFilter=void 0!==n.magFilter?n.magFilter:1006,o.minFilter=void 0!==n.minFilter?n.minFilter:1006,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=1008),1===n.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),u_.prototype=Object.assign(Object.create(n_.prototype),{constructor:u_,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=Kw.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Kw.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}),c_.prototype=Object.assign(Object.create(n_.prototype),{constructor:c_,load:function(t,e,n,r){const i=new wy,o=new u_(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,a++,6===a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let u=0;u<t.length;++u)s(u);return i}}),l_.prototype=Object.assign(Object.create(n_.prototype),{constructor:l_,load:function(t,e,n,r){const i=new yd,o=new u_(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;const r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?1022:1023,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(h_.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){const n=this.getLengths();let r,i=0,o=n.length;r=e||t*n[o-1];let a,s=0,u=o-1;for(;s<=u;)if(i=Math.floor(s+(u-s)/2),a=n[i]-r,a<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(i=u,n[i]===r)return i/(o-1);const c=n[i];return(i+(r-c)/(n[i+1]-c))/(o-1)},getTangent:function(t,e){let n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);const i=this.getPoint(n),o=this.getPoint(r),a=e||(i.isVector2?new pd:new Sd);return a.copy(o).sub(i).normalize(),a},getTangentAt:function(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){const n=new Sd,r=[],i=[],o=[],a=new Sd,s=new Pd;for(let p=0;p<=t;p++)r[p]=this.getTangentAt(p/t,new Sd),r[p].normalize();i[0]=new Sd,o[0]=new Sd;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),l=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=u&&(u=c,n.set(1,0,0)),l<=u&&(u=l,n.set(0,1,0)),h<=u&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(let p=1;p<=t;p++){if(i[p]=i[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(r[p-1],r[p]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(hd.clamp(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(a,t))}o[p].crossVectors(r[p],i[p])}if(!0===e){let e=Math.acos(hd.clamp(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(a.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],e*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(p_.prototype=Object.create(h_.prototype)).constructor=p_,p_.prototype.isEllipseCurve=!0,p_.prototype.getPoint=function(t,e){const n=e||new pd,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const a=this.aStartAngle+t*i;let s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=s-this.aX,r=u-this.aY;s=n*t-r*e+this.aX,u=n*e+r*t+this.aY}return n.set(s,u)},p_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},p_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},p_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(f_.prototype=Object.create(p_.prototype)).constructor=f_,f_.prototype.isArcCurve=!0;const m_=new Sd,g_=new d_,y_=new d_,v_=new d_;function x_(t,e,n,r){h_.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function b_(t,e,n,r,i){const o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function w_(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function __(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function M_(t,e,n,r){h_.call(this),this.type="CubicBezierCurve",this.v0=t||new pd,this.v1=e||new pd,this.v2=n||new pd,this.v3=r||new pd}function S_(t,e,n,r){h_.call(this),this.type="CubicBezierCurve3",this.v0=t||new Sd,this.v1=e||new Sd,this.v2=n||new Sd,this.v3=r||new Sd}function E_(t,e){h_.call(this),this.type="LineCurve",this.v1=t||new pd,this.v2=e||new pd}function N_(t,e){h_.call(this),this.type="LineCurve3",this.v1=t||new Sd,this.v2=e||new Sd}function T_(t,e,n){h_.call(this),this.type="QuadraticBezierCurve",this.v0=t||new pd,this.v1=e||new pd,this.v2=n||new pd}function A_(t,e,n){h_.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Sd,this.v1=e||new Sd,this.v2=n||new Sd}function C_(t){h_.call(this),this.type="SplineCurve",this.points=t||[]}(x_.prototype=Object.create(h_.prototype)).constructor=x_,x_.prototype.isCatmullRomCurve3=!0,x_.prototype.getPoint=function(t,e){const n=e||new Sd,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t;let a,s,u,c,l=Math.floor(o),h=o-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===h&&l===i-1&&(l=i-2,h=1),this.closed||l>0?a=r[(l-1)%i]:(m_.subVectors(r[0],r[1]).add(r[0]),a=m_),s=r[l%i],u=r[(l+1)%i],this.closed||l+2<i?c=r[(l+2)%i]:(m_.subVectors(r[i-1],r[i-2]).add(r[i-1]),c=m_),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(s),t),n=Math.pow(s.distanceToSquared(u),t),r=Math.pow(u.distanceToSquared(c),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),g_.initNonuniformCatmullRom(a.x,s.x,u.x,c.x,e,n,r),y_.initNonuniformCatmullRom(a.y,s.y,u.y,c.y,e,n,r),v_.initNonuniformCatmullRom(a.z,s.z,u.z,c.z,e,n,r)}else"catmullrom"===this.curveType&&(g_.initCatmullRom(a.x,s.x,u.x,c.x,this.tension),y_.initCatmullRom(a.y,s.y,u.y,c.y,this.tension),v_.initCatmullRom(a.z,s.z,u.z,c.z,this.tension));return n.set(g_.calc(h),y_.calc(h),v_.calc(h)),n},x_.prototype.copy=function(t){h_.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},x_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},x_.prototype.fromJSON=function(t){h_.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Sd).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(M_.prototype=Object.create(h_.prototype)).constructor=M_,M_.prototype.isCubicBezierCurve=!0,M_.prototype.getPoint=function(t,e){const n=e||new pd,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(__(t,r.x,i.x,o.x,a.x),__(t,r.y,i.y,o.y,a.y)),n},M_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},M_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},M_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(S_.prototype=Object.create(h_.prototype)).constructor=S_,S_.prototype.isCubicBezierCurve3=!0,S_.prototype.getPoint=function(t,e){const n=e||new Sd,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(__(t,r.x,i.x,o.x,a.x),__(t,r.y,i.y,o.y,a.y),__(t,r.z,i.z,o.z,a.z)),n},S_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},S_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},S_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(E_.prototype=Object.create(h_.prototype)).constructor=E_,E_.prototype.isLineCurve=!0,E_.prototype.getPoint=function(t,e){const n=e||new pd;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},E_.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},E_.prototype.getTangent=function(t,e){const n=e||new pd;return n.copy(this.v2).sub(this.v1).normalize(),n},E_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},E_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},E_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(N_.prototype=Object.create(h_.prototype)).constructor=N_,N_.prototype.isLineCurve3=!0,N_.prototype.getPoint=function(t,e){const n=e||new Sd;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},N_.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},N_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},N_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},N_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(T_.prototype=Object.create(h_.prototype)).constructor=T_,T_.prototype.isQuadraticBezierCurve=!0,T_.prototype.getPoint=function(t,e){const n=e||new pd,r=this.v0,i=this.v1,o=this.v2;return n.set(w_(t,r.x,i.x,o.x),w_(t,r.y,i.y,o.y)),n},T_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},T_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},T_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(A_.prototype=Object.create(h_.prototype)).constructor=A_,A_.prototype.isQuadraticBezierCurve3=!0,A_.prototype.getPoint=function(t,e){const n=e||new Sd,r=this.v0,i=this.v1,o=this.v2;return n.set(w_(t,r.x,i.x,o.x),w_(t,r.y,i.y,o.y),w_(t,r.z,i.z,o.z)),n},A_.prototype.copy=function(t){return h_.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},A_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},A_.prototype.fromJSON=function(t){return h_.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(C_.prototype=Object.create(h_.prototype)).constructor=C_,C_.prototype.isSplineCurve=!0,C_.prototype.getPoint=function(t,e){const n=e||new pd,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(b_(a,s.x,u.x,c.x,l.x),b_(a,s.y,u.y,c.y,l.y)),n},C_.prototype.copy=function(t){h_.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this},C_.prototype.toJSON=function(){const t=h_.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t},C_.prototype.fromJSON=function(t){h_.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new pd).fromArray(n))}return this};var O_=Object.freeze({__proto__:null,ArcCurve:f_,CatmullRomCurve3:x_,CubicBezierCurve:M_,CubicBezierCurve3:S_,EllipseCurve:p_,LineCurve:E_,LineCurve3:N_,QuadraticBezierCurve:T_,QuadraticBezierCurve3:A_,SplineCurve:C_});function R_(){h_.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function P_(t){R_.call(this),this.type="Path",this.currentPoint=new pd,t&&this.setFromPoints(t)}function L_(t){P_.call(this,t),this.uuid=hd.generateUUID(),this.type="Shape",this.holes=[]}function I_(t,e){Xd.call(this),this.type="Light",this.color=new jm(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function D_(t,e,n){I_.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Xd.DefaultUp),this.updateMatrix(),this.groundColor=new jm(e)}function k_(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new pd(512,512),this.map=null,this.mapPass=null,this.matrix=new Pd,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ty,this._frameExtents=new pd(1,1),this._viewportCount=1,this._viewports=[new vd(0,0,1,1)]}function z_(){k_.call(this,new $g(50,1,.5,500))}function B_(t,e,n,r,i,o){I_.call(this,t,e),this.type="SpotLight",this.position.copy(Xd.DefaultUp),this.updateMatrix(),this.target=new Xd,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new z_}function U_(){k_.call(this,new $g(90,1,.5,500)),this._frameExtents=new pd(4,2),this._viewportCount=6,this._viewports=[new vd(2,1,1,1),new vd(0,1,1,1),new vd(3,1,1,1),new vd(1,1,1,1),new vd(3,0,1,1),new vd(1,0,1,1)],this._cubeDirections=[new Sd(1,0,0),new Sd(-1,0,0),new Sd(0,0,1),new Sd(0,0,-1),new Sd(0,1,0),new Sd(0,-1,0)],this._cubeUps=[new Sd(0,1,0),new Sd(0,1,0),new Sd(0,1,0),new Sd(0,1,0),new Sd(0,0,1),new Sd(0,0,-1)]}function F_(t,e,n,r){I_.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new U_}function j_(t,e,n,r,i,o){Zg.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function H_(){k_.call(this,new j_(-5,5,5,-5,.5,500))}function V_(t,e){I_.call(this,t,e),this.type="DirectionalLight",this.position.copy(Xd.DefaultUp),this.updateMatrix(),this.target=new Xd,this.shadow=new H_}function G_(t,e){I_.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function q_(t,e,n,r){I_.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function W_(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Sd)}function Z_(t,e){I_.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new W_}function $_(t){n_.call(this,t),this.textures={}}R_.prototype=Object.assign(Object.create(h_.prototype),{constructor:R_,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new E_(e,t))},getPoint:function(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const t=n[r]-e,i=this.curves[r],o=i.getLength();return i.getPointAt(0===o?0:1-t/o)}r++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],a=o.getPoints(o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t);for(let t=0;t<a.length;t++){const r=a[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){h_.prototype.copy.call(this,t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){const t=h_.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){h_.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new O_[n.type]).fromJSON(n))}return this}}),P_.prototype=Object.assign(Object.create(R_.prototype),{constructor:P_,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){const n=new E_(this.currentPoint.clone(),new pd(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){const i=new T_(this.currentPoint.clone(),new pd(t,e),new pd(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){const a=new M_(this.currentPoint.clone(),new pd(t,e),new pd(n,r),new pd(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(t){const e=new C_([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,a,s){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o,a,s),this},absellipse:function(t,e,n,r,i,o,a,s){const u=new p_(t,e,n,r,i,o,a,s);if(this.curves.length>0){const t=u.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this},copy:function(t){return R_.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=R_.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return R_.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),L_.prototype=Object.assign(Object.create(P_.prototype),{constructor:L_,getPointsHoles:function(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){P_.prototype.copy.call(this,t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){const t=P_.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){P_.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new P_).fromJSON(n))}return this}}),I_.prototype=Object.assign(Object.create(Xd.prototype),{constructor:I_,isLight:!0,copy:function(t){return Xd.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const e=Xd.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),D_.prototype=Object.assign(Object.create(I_.prototype),{constructor:D_,isHemisphereLight:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(k_.prototype,{_projScreenMatrix:new Pd,_lightPositionWorld:new Sd,_lookTarget:new Sd,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),z_.prototype=Object.assign(Object.create(k_.prototype),{constructor:z_,isSpotLightShadow:!0,updateMatrices:function(t){const e=this.camera,n=2*hd.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),k_.prototype.updateMatrices.call(this,t)}}),B_.prototype=Object.assign(Object.create(I_.prototype),{constructor:B_,isSpotLight:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),U_.prototype=Object.assign(Object.create(k_.prototype),{constructor:U_,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);const n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),F_.prototype=Object.assign(Object.create(I_.prototype),{constructor:F_,isPointLight:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),j_.prototype=Object.assign(Object.create(Zg.prototype),{constructor:j_,isOrthographicCamera:!0,copy:function(t,e){return Zg.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const e=Xd.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),H_.prototype=Object.assign(Object.create(k_.prototype),{constructor:H_,isDirectionalLightShadow:!0,updateMatrices:function(t){k_.prototype.updateMatrices.call(this,t)}}),V_.prototype=Object.assign(Object.create(I_.prototype),{constructor:V_,isDirectionalLight:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),G_.prototype=Object.assign(Object.create(I_.prototype),{constructor:G_,isAmbientLight:!0}),q_.prototype=Object.assign(Object.create(I_.prototype),{constructor:q_,isRectAreaLight:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const e=I_.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(W_.prototype,{isSphericalHarmonics3:!0,set:function(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e},add:function(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(W_,{getBasisAt:function(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),Z_.prototype=Object.assign(Object.create(I_.prototype),{constructor:Z_,isLightProbe:!0,copy:function(t){return I_.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const e=I_.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),$_.prototype=Object.assign(Object.create(n_.prototype),{constructor:$_,load:function(t,e,n,r){const i=this,o=new i_(i.manager);o.setPath(i.path),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(t)}}),n,r)},parse:function(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const r=new zw[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new jm).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&(r.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const i in t.uniforms){const e=t.uniforms[i];switch(r.uniforms[i]={},e.type){case"t":r.uniforms[i].value=n(e.value);break;case"c":r.uniforms[i].value=(new jm).setHex(e.value);break;case"v2":r.uniforms[i].value=(new pd).fromArray(e.value);break;case"v3":r.uniforms[i].value=(new Sd).fromArray(e.value);break;case"v4":r.uniforms[i].value=(new vd).fromArray(e.value);break;case"m3":r.uniforms[i].value=(new fd).fromArray(e.value);case"m4":r.uniforms[i].value=(new Pd).fromArray(e.value);break;default:r.uniforms[i].value=e.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const i in t.extensions)r.extensions[i]=t.extensions[i];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new pd).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new pd).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});const Y_=function(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};function X_(){gg.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function J_(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Jm.call(this,t,e,n),this.meshPerAttribute=r||1}function Q_(t){n_.call(this,t)}X_.prototype=Object.assign(Object.create(gg.prototype),{constructor:X_,isInstancedBufferGeometry:!0,copy:function(t){return gg.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=gg.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),J_.prototype=Object.assign(Object.create(Jm.prototype),{constructor:J_,isInstancedBufferAttribute:!0,copy:function(t){return Jm.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Jm.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Q_.prototype=Object.assign(Object.create(n_.prototype),{constructor:Q_,load:function(t,e,n,r){const i=this,o=new i_(i.manager);o.setPath(i.path),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(o){r?r(o):console.error(o),i.manager.itemError(t)}}),n,r)},parse:function(t){const e={},n={};function r(t,r){if(void 0!==e[r])return e[r];const i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];const r=new Uint32Array(t.arrayBuffers[e]).buffer;return n[e]=r,r}(t,i.buffer),a=new px(new K_[i.type](o),i.stride);return a.uuid=i.uuid,e[r]=a,a}const i=t.isInstancedBufferGeometry?new X_:new gg,o=t.data.index;if(void 0!==o){const t=new K_[o.type](o.array);i.setIndex(new Jm(t,1))}const a=t.data.attributes;for(const l in a){const e=a[l];let n;if(e.isInterleavedBufferAttribute)n=new dx(r(t.data,e.data),e.itemSize,e.offset,e.normalized);else{const t=new K_[e.type](e.array);n=new(e.isInstancedBufferAttribute?J_:Jm)(t,e.itemSize,e.normalized)}void 0!==e.name&&(n.name=e.name),i.setAttribute(l,n)}const s=t.data.morphAttributes;if(s)for(const l in s){const e=s[l],n=[];for(let i=0,o=e.length;i<o;i++){const o=e[i];let a;a=o.isInterleavedBufferAttribute?new dx(r(t.data,o.data),o.itemSize,o.offset,o.normalized):new Jm(new K_[o.type](o.array),o.itemSize,o.normalized),void 0!==o.name&&(a.name=o.name),n.push(a)}i.morphAttributes[l]=n}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const u=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==u)for(let l=0,h=u.length;l!==h;++l){const t=u[l];i.addGroup(t.start,t.count,t.materialIndex)}const c=t.data.boundingSphere;if(void 0!==c){const t=new Sd;void 0!==c.center&&t.fromArray(c.center),i.boundingSphere=new dm(t,c.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}});const K_={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function tM(t){n_.call(this,t)}tM.prototype=Object.assign(Object.create(n_.prototype),{constructor:tM,load:function(t,e,n,r){const i=this,o=""===this.path?Y_(t):this.path;this.resourcePath=this.resourcePath||o;const a=new i_(i.manager);a.setPath(this.path),a.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+t+".",s.message)}const a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){const n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const r=(new L_).fromJSON(t[n]);e[r.uuid]=r}return e},parseGeometries:function(t,e){const n={};let r;if(void 0!==t){const i=new Q_;for(let o=0,a=t.length;o<a;o++){let a;const s=t[o];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Nw[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Nw[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Nw[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Nw[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Nw[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Nw[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Nw[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Nw[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Nw[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Nw[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Nw[s.type]((new O_[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Nw[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Nw[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":r=[];for(let n=0,i=s.shapes.length;n<i;n++)r.push(e[s.shapes[n]]);a=new Nw[s.type](r,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":r=[];for(let n=0,i=s.shapes.length;n<i;n++)r.push(e[s.shapes[n]]);const t=s.options.extrudePath;void 0!==t&&(s.options.extrudePath=(new O_[t.type]).fromJSON(t)),a=new Nw[s.type](r,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}}return n},parseMaterials:function(t,e){const n={},r={};if(void 0!==t){const i=new $_;i.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];if("MultiMaterial"===o.type){const t=[];for(let e=0;e<o.materials.length;e++){const r=o.materials[e];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),t.push(n[r.uuid])}r[o.uuid]=t}else void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r},parseAnimations:function(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n],i=Jw.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){const n=this,r={};let i;function o(t){return n.manager.itemStart(t),i.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){const a=new t_(e);i=new u_(a),i.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const i=t[e],a=i.url;if(Array.isArray(a)){r[i.uuid]=[];for(let t=0,e=a.length;t<e;t++){const e=a[t],s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e;r[i.uuid].push(o(s))}}else{const t=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(i.url)?i.url:n.resourcePath+i.url;r[i.uuid]=o(t)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}const r={};if(void 0!==t)for(let i=0,o=t.length;i<o;i++){const o=t[i];let a;void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image),a=Array.isArray(e[o.image])?new wy(e[o.image]):new yd(e[o.image]),a.needsUpdate=!0,a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.mapping&&(a.mapping=n(o.mapping,eM)),void 0!==o.offset&&a.offset.fromArray(o.offset),void 0!==o.repeat&&a.repeat.fromArray(o.repeat),void 0!==o.center&&a.center.fromArray(o.center),void 0!==o.rotation&&(a.rotation=o.rotation),void 0!==o.wrap&&(a.wrapS=n(o.wrap[0],nM),a.wrapT=n(o.wrap[1],nM)),void 0!==o.format&&(a.format=o.format),void 0!==o.type&&(a.type=o.type),void 0!==o.encoding&&(a.encoding=o.encoding),void 0!==o.minFilter&&(a.minFilter=n(o.minFilter,rM)),void 0!==o.magFilter&&(a.magFilter=n(o.magFilter,rM)),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),void 0!==o.flipY&&(a.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(a.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(a.unpackAlignment=o.unpackAlignment),r[o.uuid]=a}return r},parseObject:function(t,e,n){let r,i,o;function a(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function s(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(n[i])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new Jd,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new jm(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new hx(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new lx(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new $g(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new j_(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new G_(t.color,t.intensity);break;case"DirectionalLight":r=new V_(t.color,t.intensity);break;case"PointLight":r=new F_(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new q_(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new B_(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new D_(t.color,t.groundColor,t.intensity);break;case"LightProbe":r=(new Z_).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":i=a(t.geometry),o=s(t.material),r=new Ig(i,o);break;case"InstancedMesh":i=a(t.geometry),o=s(t.material);const e=t.instanceMatrix;r=new Vx(i,o,t.count),r.instanceMatrix=new Jm(new Float32Array(e.array),16);break;case"LOD":r=new Lx;break;case"Line":r=new Xx(a(t.geometry),s(t.material),t.mode);break;case"LineLoop":r=new tb(a(t.geometry),s(t.material));break;case"LineSegments":r=new Kx(a(t.geometry),s(t.material));break;case"PointCloud":case"Points":r=new ab(a(t.geometry),s(t.material));break;case"Sprite":r=new Cx(s(t.material));break;case"Group":r=new ix;break;default:r=new Xd}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(r.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children){const i=t.children;for(let t=0;t<i.length;t++)r.add(this.parseObject(i[t],e,n))}if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],i=r.getObjectByProperty("uuid",n.object);void 0!==i&&r.addLevel(i,n.distance)}}return r}});const eM={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},nM={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},rM={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function iM(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),n_.call(this,t),this.options={premultiplyAlpha:"none"}}function oM(){this.type="ShapePath",this.color=new jm,this.subPaths=[],this.currentPath=null}function aM(t){this.type="Font",this.data=t}function sM(t,e,n,r,i){const o=i.glyphs[t]||i.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".");const a=new oM;let s,u,c,l,h,p,f,d;if(o.o){const t=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let i=0,o=t.length;i<o;)switch(t[i++]){case"m":s=t[i++]*e+n,u=t[i++]*e+r,a.moveTo(s,u);break;case"l":s=t[i++]*e+n,u=t[i++]*e+r,a.lineTo(s,u);break;case"q":c=t[i++]*e+n,l=t[i++]*e+r,h=t[i++]*e+n,p=t[i++]*e+r,a.quadraticCurveTo(h,p,c,l);break;case"b":c=t[i++]*e+n,l=t[i++]*e+r,h=t[i++]*e+n,p=t[i++]*e+r,f=t[i++]*e+n,d=t[i++]*e+r,a.bezierCurveTo(h,p,f,d,c,l)}}return{offsetX:o.ha*e,path:a}}function uM(t){n_.call(this,t)}let cM;iM.prototype=Object.assign(Object.create(n_.prototype),{constructor:iM,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=Kw.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,i.options)})).then((function(n){Kw.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(oM.prototype,{moveTo:function(t,e){return this.currentPath=new P_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new L_;i.curves=r.curves,e.push(i)}return e}function r(t,e){const n=e.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=e[i],a=e[o],s=a.x-n.x,u=a.y-n.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(n=e[o],s=-s,a=e[i],u=-u),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=u*(t.x-n.x)-s*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return r}const i=ew.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);let a,s,u,c=[];if(1===o.length)return s=o[0],u=new L_,u.curves=s.curves,c.push(u),c;let l=!i(o[0].getPoints());l=t?!l:l;const h=[],p=[];let f,d,m=[],g=0;p[g]=void 0,m[g]=[];for(let y=0,v=o.length;y<v;y++)s=o[y],f=s.getPoints(),a=i(f),a=t?!a:a,a?(!l&&p[g]&&g++,p[g]={s:new L_,p:f},p[g].s.curves=s.curves,l&&g++,m[g]=[]):m[g].push({h:s,p:f[0]});if(!p[0])return n(o);if(p.length>1){let t=!1;const e=[];for(let n=0,r=p.length;n<r;n++)h[n]=[];for(let n=0,i=p.length;n<i;n++){const i=m[n];for(let o=0;o<i.length;o++){const a=i[o];let s=!0;for(let i=0;i<p.length;i++)r(a.p,p[i].p)&&(n!==i&&e.push({froms:n,tos:i,hole:o}),s?(s=!1,h[i].push(a)):t=!0);s&&h[n].push(a)}}e.length>0&&(t||(m=h))}for(let y=0,v=p.length;y<v;y++){u=p[y].s,c.push(u),d=m[y];for(let t=0,e=d.length;t<e;t++)u.holes.push(d[t].h)}return c}}),Object.assign(aM.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);const n=[],r=function(t,e,n){const r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[];let s=0,u=0;for(let c=0;c<r.length;c++){const t=r[c];if("\n"===t)s=0,u-=o;else{const e=sM(t,i,s,u,n);s+=e.offsetX,a.push(e.path)}}return a}(t,e,this.data);for(let i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),uM.prototype=Object.assign(Object.create(n_.prototype),{constructor:uM,load:function(t,e,n,r){const i=this,o=new i_(this.manager);o.setPath(this.path),o.load(t,(function(t){let n;try{n=JSON.parse(t)}catch(o){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}const r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new aM(t)}});const lM=function(){return void 0===cM&&(cM=new(window.AudioContext||window.webkitAudioContext)),cM};function hM(t){n_.call(this,t)}function pM(t,e,n){Z_.call(this,void 0,n);const r=(new jm).set(t),i=(new jm).set(e),o=new Sd(r.r,r.g,r.b),a=new Sd(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}function fM(t,e){Z_.call(this,void 0,e);const n=(new jm).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}hM.prototype=Object.assign(Object.create(n_.prototype),{constructor:hM,load:function(t,e,n,r){const i=this,o=new i_(i.manager);o.setResponseType("arraybuffer"),o.setPath(i.path),o.load(t,(function(n){try{const t=n.slice(0);lM().decodeAudioData(t,(function(t){e(t)}))}catch(o){r?r(o):console.error(o),i.manager.itemError(t)}}),n,r)}}),pM.prototype=Object.assign(Object.create(Z_.prototype),{constructor:pM,isHemisphereLightProbe:!0,copy:function(t){return Z_.prototype.copy.call(this,t),this},toJSON:function(t){return Z_.prototype.toJSON.call(this,t)}}),fM.prototype=Object.assign(Object.create(Z_.prototype),{constructor:fM,isAmbientLightProbe:!0,copy:function(t){return Z_.prototype.copy.call(this,t),this},toJSON:function(t){return Z_.prototype.toJSON.call(this,t)}});const dM=new Pd,mM=new Pd;function gM(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign((function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new $g,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new $g,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}).prototype,{update:function(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;const n=t.projectionMatrix.clone(),r=e.eyeSep/2,i=r*e.near/e.focus,o=e.near*Math.tan(hd.DEG2RAD*e.fov*.5)/e.zoom;let a,s;mM.elements[12]=-r,dM.elements[12]=r,a=-o*e.aspect+i,s=o*e.aspect+i,n.elements[0]=2*e.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(n),a=-o*e.aspect-i,s=o*e.aspect-i,n.elements[0]=2*e.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(mM),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(dM)}}),Object.assign(gM.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});const yM=new Sd,vM=new wd,xM=new Sd,bM=new Sd;function wM(){Xd.call(this),this.type="AudioListener",this.context=lM(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new gM}function _M(t){Xd.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}wM.prototype=Object.assign(Object.create(Xd.prototype),{constructor:wM,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Xd.prototype.updateMatrixWorld.call(this,t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(yM,vM,xM),bM.set(0,0,-1).applyQuaternion(vM),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(yM.x,t),e.positionY.linearRampToValueAtTime(yM.y,t),e.positionZ.linearRampToValueAtTime(yM.z,t),e.forwardX.linearRampToValueAtTime(bM.x,t),e.forwardY.linearRampToValueAtTime(bM.y,t),e.forwardZ.linearRampToValueAtTime(bM.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(yM.x,yM.y,yM.z),e.setOrientation(bM.x,bM.y,bM.z,n.x,n.y,n.z)}}),_M.prototype=Object.assign(Object.create(Xd.prototype),{constructor:_M,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});const MM=new Sd,SM=new wd,EM=new Sd,NM=new Sd;function TM(t){_M.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function AM(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function CM(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}TM.prototype=Object.assign(Object.create(_M.prototype),{constructor:TM,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Xd.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(MM,SM,EM),NM.set(0,0,1).applyQuaternion(SM);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(MM.x,t),e.positionY.linearRampToValueAtTime(MM.y,t),e.positionZ.linearRampToValueAtTime(MM.z,t),e.orientationX.linearRampToValueAtTime(NM.x,t),e.orientationY.linearRampToValueAtTime(NM.y,t),e.orientationZ.linearRampToValueAtTime(NM.z,t)}else e.setPosition(MM.x,MM.y,MM.z),e.setOrientation(NM.x,NM.y,NM.z)}}),Object.assign(AM.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(CM.prototype,{accumulate:function(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else o+=e,this._mixBufferRegion(n,i,0,e/o,r);this.cumulativeWeight=o},accumulateAdditive:function(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1&&this._mixBufferRegion(n,r,e*this._origIndex,1-i,e),o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}},saveOriginalState:function(){const t=this.buffer,e=this.valueSize,n=e*this._origIndex;this.binding.getValue(t,n);for(let r=e,i=n;r!==i;++r)t[r]=t[n+r%e];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]},_select:function(t,e,n,r,i){if(r>=.5)for(let o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){wd.slerpFlat(t,e,t,e,t,n,r)},_slerpAdditive:function(t,e,n,r,i){const o=this._workIndex*i;wd.multiplyQuaternionsFlat(t,o,t,e,t,n),wd.slerpFlat(t,e,t,e,t,o,r)},_lerp:function(t,e,n,r,i){const o=1-r;for(let a=0;a!==i;++a){const i=e+a;t[i]=t[i]*o+t[n+a]*r}},_lerpAdditive:function(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}});const OM=new RegExp("[\\[\\]\\.:\\/]","g"),RM="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",PM=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),LM=/(WCOD+)?/.source.replace("WCOD",RM),IM=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),DM=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),kM=new RegExp("^"+PM+LM+IM+DM+"$"),zM=["material","materials","bones"];function BM(t,e,n){const r=n||UM.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function UM(t,e,n){this.path=e,this.parsedPath=n||UM.parseTrackName(e),this.node=UM.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function FM(t,e,n,r){this._mixer=t,this._clip=e,this._localRoot=n||null,this.blendMode=r||e.blendMode;const i=e.tracks,o=i.length,a=new Array(o),s={endingStart:2400,endingEnd:2400};for(let u=0;u!==o;++u){const t=i[u].createInterpolant(null);a[u]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function jM(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function HM(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function VM(t,e,n){px.call(this,t,e),this.meshPerAttribute=n||1}function GM(t,e,n,r){this.ray=new _m(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new kd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function qM(t,e){return t.distance-e.distance}function WM(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)WM(r[t],e,n,!0)}}function ZM(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}Object.assign(BM.prototype,{getValue:function(t,e){this.bind();const n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(UM,{Composite:BM,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new UM.Composite(t,e,n):new UM(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(OM,"")},parseTrackName:function(t){const e=kM.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==zM.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}}),Object.assign(UM.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=UM.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const o=t[r];if(void 0===o)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t);let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(UM.prototype,{_getValue_unbound:UM.prototype.getValue,_setValue_unbound:UM.prototype.setValue}),Object.assign((function(){this.uuid=hd.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}).prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let a=void 0,s=t.length,u=this.nCachedObjects_;for(let c=0,l=arguments.length;c!==l;++c){const l=arguments[c],h=l.uuid;let p=e[h];if(void 0===p){p=s++,e[h]=p,t.push(l);for(let t=0,e=o;t!==e;++t)i[t].push(new UM(l,n[t],r[t]))}else if(p<u){a=t[p];const s=--u,c=t[s];e[c.uuid]=p,t[p]=c,e[h]=s,t[s]=l;for(let t=0,e=o;t!==e;++t){const e=i[t];let o=e[p];e[p]=e[s],void 0===o&&(o=new UM(l,n[t],r[t])),e[s]=o}}else t[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u},remove:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,u=e[s];if(void 0!==u&&u>=i){const o=i++,c=t[o];e[c.uuid]=u,t[u]=c,e[s]=o,t[o]=a;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[u];e[u]=e[o],e[o]=r}}}this.nCachedObjects_=i},uncache:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,u=e[s];if(void 0!==u)if(delete e[s],u<i){const a=--i,s=t[a],c=--o,l=t[c];e[s.uuid]=u,t[u]=s,e[l.uuid]=a,t[a]=l,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[c];e[u]=e[a],e[a]=r,e.pop()}}else{const i=--o,a=t[i];e[a.uuid]=u,t[u]=a,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[u]=e[i],e.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){let n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,a=this._parsedPaths,s=this._objects,u=this.nCachedObjects_,c=new Array(s.length);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(c);for(let l=u,h=s.length;l!==h;++l)c[l]=new UM(s[l],t,e);return c},unsubscribe_:function(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(FM.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=n/r;t.warp(1,r/n,e),this.warp(i,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/o,u[1]=e/o,this},stopWarping:function(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;if(r<0||0===n)return;this._startTime=null,e=n*r}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);break;case 2500:default:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,a)}}},_updateWeight:function(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e},_updateTime:function(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=2202===n;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return e-r}return r},_setEndings:function(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),jM.prototype=Object.assign(Object.create(cd.prototype),{constructor:jM,_bindAction:function(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName;let c=u[s];void 0===c&&(c={},u[s]=c);for(let l=0;l!==i;++l){const t=r[l],i=t.name;let u=c[i];if(void 0!==u)o[l]=u;else{if(u=o[l],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,s,i));continue}u=new CM(UM.create(n,i,e&&e._propertyBindings[l].binding.parsedPath),t.ValueTypeName,t.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,i),o[l]=u}a[l].resultBuffer=u.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const t=e[n];0==--t.referenceCount&&this._removeInactiveBinding(t)}},_lendAction:function(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)},_removeInactiveBinding:function(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new jw(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){const r=e||this._root,i=r.uuid;let o="string"==typeof t?Jw.findByName(r,t):t;const a=null!==o?o.uuid:t;let s=this._actionsByClip[a],u=null;if(void 0===n&&(n=null!==o?o.blendMode:2500),void 0!==s){const t=s.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;u=s.knownActions[0],null===o&&(o=u._clip)}if(null===o)return null;const c=new FM(this,o,e,n);return this._bindAction(c,u),this._addInactiveAction(c,a,i),c},existingAction:function(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?Jw.findByName(n,t):t,o=this._actionsByClip[i?i.uuid:t];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this},update:function(t){const e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,i=Math.sign(t),o=this._accuIndex^=1;for(let u=0;u!==n;++u)e[u]._update(r,t,i,o);const a=this._bindings,s=this._nActiveBindings;for(let u=0;u!==s;++u)a[u].apply(o);return this},setTime:function(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}},uncacheRoot:function(t){const e=t.uuid,n=this._actionsByClip;for(const i in n){const t=n[i].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const i in r){const t=r[i];t.restoreOriginalState(),this._removeInactiveBinding(t)}},uncacheAction:function(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),HM.prototype.clone=function(){return new HM(void 0===this.value.clone?this.value:this.value.clone())},VM.prototype=Object.assign(Object.create(px.prototype),{constructor:VM,isInstancedInterleavedBuffer:!0,copy:function(t){return px.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const e=px.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){const e=px.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.assign(GM.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){const r=n||[];return WM(t,this,r,e),r.sort(qM),r},intersectObjects:function(t,e,n){const r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(let i=0,o=t.length;i<o;i++)WM(t[i],this,r,e);return r.sort(qM),r}}),Object.assign(ZM.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(hd.clamp(e/this.radius,-1,1))),this}}),Object.assign((function(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}).prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});const $M=new pd;function YM(t,e){this.min=void 0!==t?t:new pd(1/0,1/0),this.max=void 0!==e?e:new pd(-1/0,-1/0)}Object.assign(YM.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){const n=$M.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new pd),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new pd),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new pd),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new pd),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return $M.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const XM=new Sd,JM=new Sd;function QM(t,e){this.start=void 0!==t?t:new Sd,this.end=void 0!==e?e:new Sd}function KM(t){Xd.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(QM.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Sd),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Sd),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Sd),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){XM.subVectors(t,this.start),JM.subVectors(this.end,this.start);const n=JM.dot(JM);let r=JM.dot(XM)/n;return e&&(r=hd.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){const r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Sd),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(KM.prototype=Object.create(Xd.prototype)).constructor=KM,KM.prototype.isImmediateRenderObject=!0;const tS=new Sd;function eS(t,e){Xd.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new gg,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,s=32;o<s;o++,a++){const t=o/s*Math.PI*2,e=a/s*Math.PI*2;r.push(Math.cos(t),Math.sin(t),1,Math.cos(e),Math.sin(e),1)}n.setAttribute("position",new og(r,3));const i=new Gx({fog:!1,toneMapped:!1});this.cone=new Kx(n,i),this.add(this.cone),this.update()}(eS.prototype=Object.create(Xd.prototype)).constructor=eS,eS.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},eS.prototype.update=function(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),tS.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(tS),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const nS=new Sd,rS=new Pd,iS=new Pd;function oS(t){const e=function t(e){const n=[];e&&e.isBone&&n.push(e);for(let r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new gg,r=[],i=[],o=new jm(0,0,1),a=new jm(0,1,0);for(let u=0;u<e.length;u++){const t=e[u];t.parent&&t.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new og(r,3)),n.setAttribute("color",new og(i,3));const s=new Gx({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Kx.call(this,n,s),this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function aS(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;const r=new hw(e,4,2),i=new $m({wireframe:!0,fog:!1,toneMapped:!1});Ig.call(this,r,i),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}(oS.prototype=Object.create(Kx.prototype)).constructor=oS,oS.prototype.isSkeletonHelper=!0,oS.prototype.updateMatrixWorld=function(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");iS.getInverse(this.root.matrixWorld);for(let i=0,o=0;i<e.length;i++){const t=e[i];t.parent&&t.parent.isBone&&(rS.multiplyMatrices(iS,t.matrixWorld),nS.setFromMatrixPosition(rS),r.setXYZ(o,nS.x,nS.y,nS.z),rS.multiplyMatrices(iS,t.parent.matrixWorld),nS.setFromMatrixPosition(rS),r.setXYZ(o+1,nS.x,nS.y,nS.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Xd.prototype.updateMatrixWorld.call(this,t)},(aS.prototype=Object.create(Ig.prototype)).constructor=aS,aS.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},aS.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const sS=new Sd,uS=new jm,cS=new jm;function lS(t,e,n){Xd.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new bb(e);r.rotateY(.5*Math.PI),this.material=new $m({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Jm(o,3)),this.add(new Ig(r,this.material)),this.update()}function hS(t,e,n,r){t=t||10,e=e||10,n=new jm(void 0!==n?n:4473924),r=new jm(void 0!==r?r:8947848);const i=e/2,o=t/e,a=t/2,s=[],u=[];for(let h=0,p=0,f=-a;h<=e;h++,f+=o){s.push(-a,0,f,a,0,f),s.push(f,0,-a,f,0,a);const t=h===i?n:r;t.toArray(u,p),p+=3,t.toArray(u,p),p+=3,t.toArray(u,p),p+=3,t.toArray(u,p),p+=3}const c=new gg;c.setAttribute("position",new og(s,3)),c.setAttribute("color",new og(u,3));const l=new Gx({vertexColors:!0,toneMapped:!1});Kx.call(this,c,l),this.type="GridHelper"}function pS(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new jm(void 0!==i?i:4473924),o=new jm(void 0!==o?o:8947848);const a=[],s=[];for(let l=0;l<=e;l++){const n=l/e*(2*Math.PI),r=Math.sin(n)*t,u=Math.cos(n)*t;a.push(0,0,0),a.push(r,0,u);const c=1&l?i:o;s.push(c.r,c.g,c.b),s.push(c.r,c.g,c.b)}for(let l=0;l<=n;l++){const e=1&l?i:o,u=t-t/n*l;for(let t=0;t<r;t++){let n=t/r*(2*Math.PI),i=Math.sin(n)*u,o=Math.cos(n)*u;a.push(i,0,o),s.push(e.r,e.g,e.b),n=(t+1)/r*(2*Math.PI),i=Math.sin(n)*u,o=Math.cos(n)*u,a.push(i,0,o),s.push(e.r,e.g,e.b)}}const u=new gg;u.setAttribute("position",new og(a,3)),u.setAttribute("color",new og(s,3));const c=new Gx({vertexColors:!0,toneMapped:!1});Kx.call(this,u,c),this.type="PolarGridHelper"}(lS.prototype=Object.create(Xd.prototype)).constructor=lS,lS.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},lS.prototype.update=function(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");uS.copy(this.light.color),cS.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const r=t<n/2?uS:cS;e.setXYZ(t,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(sS.setFromMatrixPosition(this.light.matrixWorld).negate())},hS.prototype=Object.assign(Object.create(Kx.prototype),{constructor:hS,copy:function(t){return Kx.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),(pS.prototype=Object.create(Kx.prototype)).constructor=pS;const fS=new Sd,dS=new Sd,mS=new Sd;function gS(t,e,n){Xd.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let r=new gg;r.setAttribute("position",new og([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new Gx({fog:!1,toneMapped:!1});this.lightPlane=new Xx(r,i),this.add(this.lightPlane),r=new gg,r.setAttribute("position",new og([0,0,0,0,0,1],3)),this.targetLine=new Xx(r,i),this.add(this.targetLine),this.update()}(gS.prototype=Object.create(Xd.prototype)).constructor=gS,gS.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},gS.prototype.update=function(){fS.setFromMatrixPosition(this.light.matrixWorld),dS.setFromMatrixPosition(this.light.target.matrixWorld),mS.subVectors(dS,fS),this.lightPlane.lookAt(dS),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(dS),this.targetLine.scale.z=mS.length()};const yS=new Sd,vS=new Zg;function xS(t){const e=new gg,n=new Gx({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},a=new jm(16755200),s=new jm(16711680),u=new jm(43775),c=new jm(16777215),l=new jm(3355443);function h(t,e,n){p(t,n),p(e,n)}function p(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",c),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),e.setAttribute("position",new og(r,3)),e.setAttribute("color",new og(i,3)),Kx.call(this,e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function bS(t,e,n,r,i,o,a){yS.set(i,o,a).unproject(r);const s=e[t];if(void 0!==s){const t=n.getAttribute("position");for(let e=0,n=s.length;e<n;e++)t.setXYZ(s[e],yS.x,yS.y,yS.z)}}(xS.prototype=Object.create(Kx.prototype)).constructor=xS,xS.prototype.update=function(){const t=this.geometry,e=this.pointMap;vS.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),bS("c",e,t,vS,0,0,-1),bS("t",e,t,vS,0,0,1),bS("n1",e,t,vS,-1,-1,-1),bS("n2",e,t,vS,1,-1,-1),bS("n3",e,t,vS,-1,1,-1),bS("n4",e,t,vS,1,1,-1),bS("f1",e,t,vS,-1,-1,1),bS("f2",e,t,vS,1,-1,1),bS("f3",e,t,vS,-1,1,1),bS("f4",e,t,vS,1,1,1),bS("u1",e,t,vS,.7,1.1,-1),bS("u2",e,t,vS,-.7,1.1,-1),bS("u3",e,t,vS,0,2,-1),bS("cf1",e,t,vS,-1,0,1),bS("cf2",e,t,vS,1,0,1),bS("cf3",e,t,vS,0,-1,1),bS("cf4",e,t,vS,0,1,1),bS("cn1",e,t,vS,-1,0,-1),bS("cn2",e,t,vS,1,0,-1),bS("cn3",e,t,vS,0,-1,-1),bS("cn4",e,t,vS,0,1,-1),t.getAttribute("position").needsUpdate=!0};const wS=new hm;function _S(t,e){this.object=t,void 0===e&&(e=16776960);const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new gg;i.setIndex(new Jm(n,1)),i.setAttribute("position",new Jm(r,3)),Kx.call(this,i,new Gx({color:e,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function MS(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new gg;r.setIndex(new Jm(n,1)),r.setAttribute("position",new og([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Kx.call(this,r,new Gx({color:e,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function SS(t,e,n){this.plane=t,this.size=void 0===e?1:e;const r=void 0!==n?n:16776960,i=new gg;i.setAttribute("position",new og([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Xx.call(this,i,new Gx({color:r,toneMapped:!1})),this.type="PlaneHelper";const o=new gg;o.setAttribute("position",new og([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Ig(o,new $m({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}(_S.prototype=Object.create(Kx.prototype)).constructor=_S,_S.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&wS.setFromObject(this.object),wS.isEmpty())return;const e=wS.min,n=wS.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()},_S.prototype.setFromObject=function(t){return this.object=t,this.update(),this},_S.prototype.copy=function(t){return Kx.prototype.copy.call(this,t),this.object=t.object,this},_S.prototype.clone=function(){return(new this.constructor).copy(this)},(MS.prototype=Object.create(Kx.prototype)).constructor=MS,MS.prototype.updateMatrixWorld=function(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Xd.prototype.updateMatrixWorld.call(this,t))},(SS.prototype=Object.create(Xx.prototype)).constructor=SS,SS.prototype.updateMatrixWorld=function(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),Xd.prototype.updateMatrixWorld.call(this,t)};const ES=new Sd;let NS,TS;function AS(t,e,n,r,i,o){Xd.call(this),this.type="ArrowHelper",void 0===t&&(t=new Sd(0,0,1)),void 0===e&&(e=new Sd(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===NS&&(NS=new gg,NS.setAttribute("position",new og([0,0,0,0,1,0],3)),TS=new ww(0,.5,1,5,1),TS.translate(0,-.5,0)),this.position.copy(e),this.line=new Xx(NS,new Gx({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ig(TS,new $m({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function CS(t){const e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new gg;n.setAttribute("position",new og(e,3)),n.setAttribute("color",new og([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const r=new Gx({vertexColors:!0,toneMapped:!1});Kx.call(this,n,r),this.type="AxesHelper"}(AS.prototype=Object.create(Xd.prototype)).constructor=AS,AS.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{ES.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(ES,e)}},AS.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},AS.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},AS.prototype.copy=function(t){return Xd.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},AS.prototype.clone=function(){return(new this.constructor).copy(this)},(CS.prototype=Object.create(Kx.prototype)).constructor=CS;const OS=Math.pow(2,8),RS=[.125,.215,.35,.446,.526,.582],PS=5+RS.length,LS={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},IS=new j_,{_lodPlanes:DS,_sizeLods:kS,_sigmas:zS}=function(){const t=[],e=[],n=[];let r=8;for(let i=0;i<PS;i++){const o=Math.pow(2,r);e.push(o);let a=1/o;i>4?a=RS[i-8+4-1]:0==i&&(a=0),n.push(a);const s=1/(o-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],h=6,p=6,f=3,d=2,m=1,g=new Float32Array(f*p*h),y=new Float32Array(d*p*h),v=new Float32Array(m*p*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1;g.set([e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0],f*p*t),y.set(l,d*p*t),v.set([t,t,t,t,t,t],m*p*t)}const x=new gg;x.setAttribute("position",new Jm(g,f)),x.setAttribute("uv",new Jm(y,d)),x.setAttribute("faceIndex",new Jm(v,m)),t.push(x),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}();let BS=null;const US=(1+Math.sqrt(5))/2,FS=1/US,jS=[new Sd(1,1,1),new Sd(-1,1,1),new Sd(1,1,-1),new Sd(-1,1,-1),new Sd(0,US,FS),new Sd(0,US,-FS),new Sd(FS,0,US),new Sd(-FS,0,US),new Sd(US,FS,0),new Sd(-US,FS,0)];function HS(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new Aw({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(20)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new Sd(0,1,0)},inputEncoding:{value:LS[3e3]},outputEncoding:{value:LS[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function VS(t){return void 0!==t&&1009===t.type&&(3e3===t.encoding||3001===t.encoding||3007===t.encoding)}function GS(t){const e=new xd(3*OS,3*OS,t);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function qS(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function WS(){return new Aw({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new pd(1,1)},inputEncoding:{value:LS[3e3]},outputEncoding:{value:LS[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t\n\n#include <common>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv = equirectUv( outputDirection );\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ZS(){return new Aw({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:LS[3e3]},outputEncoding:{value:LS[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $S(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),x_.call(this,t),this.type="catmullrom"}HS.prototype={constructor:HS,fromScene:function(t,e=0,n=.1,r=100){BS=this._renderer.getRenderTarget();const i=this._allocateTargets();return this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},fromEquirectangular:function(t){return this._fromTexture(t)},fromCubemap:function(t){return this._fromTexture(t)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=ZS(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=WS(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<DS.length;t++)DS[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(BS),t.scissorTest=!1,qS(t,0,0,t.width,t.height)},_fromTexture:function(t){BS=this._renderer.getRenderTarget();const e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},_allocateTargets:function(t){const e={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:VS(t)?t.encoding:3002,depthBuffer:!1,stencilBuffer:!1},n=GS(e);return n.depthBuffer=!t,this._pingPongRenderTarget=GS(e),n},_compileMaterial:function(t){const e=new Ig(DS[0],t);this._renderer.compile(e,IS)},_sceneToCubeUV:function(t,e,n,r){const i=new $g(90,1,e,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,u=s.outputEncoding,c=s.toneMapping,l=s.getClearColor(),h=s.getClearAlpha();s.toneMapping=0,s.outputEncoding=3e3;let p=t.background;if(p&&p.isColor){p.convertSRGBToLinear();const e=Math.max(p.r,p.g,p.b),n=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);p=p.multiplyScalar(Math.pow(2,-n)),s.setClearColor(p,(n+128)/255),t.background=null}for(let f=0;f<6;f++){const e=f%3;0==e?(i.up.set(0,o[f],0),i.lookAt(a[f],0,0)):1==e?(i.up.set(0,0,o[f]),i.lookAt(0,a[f],0)):(i.up.set(0,o[f],0),i.lookAt(0,0,a[f])),qS(r,e*OS,f>2?OS:0,OS,OS),s.setRenderTarget(r),s.render(t,i)}s.toneMapping=c,s.outputEncoding=u,s.setClearColor(l,h)},_textureToCubeUV:function(t,e){const n=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=ZS()):null==this._equirectShader&&(this._equirectShader=WS());const r=t.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Ig(DS[0],r),o=r.uniforms;o.envMap.value=t,t.isCubeTexture||o.texelSize.value.set(1/t.image.width,1/t.image.height),o.inputEncoding.value=LS[t.encoding],o.outputEncoding.value=LS[e.texture.encoding],qS(e,0,0,3*OS,2*OS),n.setRenderTarget(e),n.render(i,IS)},_applyPMREM:function(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<PS;r++){const e=Math.sqrt(zS[r]*zS[r]-zS[r-1]*zS[r-1]);this._blur(t,r-1,r,e,jS[(r-1)%jS.length])}e.autoClear=n},_blur:function(t,e,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",i),this._halfBlur(o,t,n,n,r,"longitudinal",i)},_halfBlur:function(t,e,n,r,i,o,a){const s=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Ig(DS[r],u),l=u.uniforms,h=kS[n]-1,p=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/p,d=isFinite(i)?1+Math.floor(3*f):20;d>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${d} samples when the maximum is set to 20`);const m=[];let g=0;for(let v=0;v<20;++v){const t=v/f,e=Math.exp(-t*t/2);m.push(e),0==v?g+=e:v<d&&(g+=2*e)}for(let v=0;v<m.length;v++)m[v]=m[v]/g;l.envMap.value=t.texture,l.samples.value=d,l.weights.value=m,l.latitudinal.value="latitudinal"===o,a&&(l.poleAxis.value=a),l.dTheta.value=p,l.mipInt.value=8-n,l.inputEncoding.value=LS[t.texture.encoding],l.outputEncoding.value=LS[t.texture.encoding];const y=kS[r];qS(e,3*Math.max(0,OS-2*y),(0===r?0:2*OS)+2*y*(r>4?r-8+4:0),3*y,2*y),s.setRenderTarget(e),s.render(c,IS)}},h_.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(h_.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(R_.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=new jg;for(let n=0,r=t.length;n<r;n++){const r=t[n];e.vertices.push(new Sd(r.x,r.y,r.z||0))}return e}}),Object.assign(P_.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Object.create(x_.prototype),Object.create(x_.prototype),$S.prototype=Object.create(x_.prototype),Object.assign($S.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),hS.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},oS.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(n_.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Y_(t)}}),n_.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(tM.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(YM.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(hm.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(dm.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),ty.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},QM.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(hd,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),hd.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),hd.ceilPowerOfTwo(t)}}),Object.assign(fd.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Pd.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Sd).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),Nm.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},wd.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(_m.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(zm.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(zm,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),zm.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),zm.getNormal(t,e,n,r)}}),Object.assign(L_.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new iw(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new gw(this,t)}}),Object.assign(pd.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Sd.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(vd.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(jg.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Xd.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Xd.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Ig.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Ig.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Lx.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(zx.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Ix.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(h_.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),$g.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(I_.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Jm.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(Jm.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(gg.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Jm(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(gg.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(X_.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(GM.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(px.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(px.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ow.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(HM.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Zm.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new jm}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Rw.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Wg.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ux.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ux.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Kv.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(xd.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(_M.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new hM).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),AM.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Yg.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},md.crossOrigin=void 0,md.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new l_;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},md.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new c_;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},md.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},md.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"118"}}));var YS=function(t,e){var n,r,i,o,a,s;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new Sd,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){u.target0.copy(u.target),u.position0.copy(u.object.position),u.zoom0=u.object.zoom},this.reset=function(){u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.zoom=u.zoom0,u.object.updateProjectionMatrix(),u.dispatchEvent(c),u.update(),f=p.NONE},this.update=(n=new Sd,r=(new wd).setFromUnitVectors(t.up,new Sd(0,1,0)),i=r.clone().inverse(),o=new Sd,a=new wd,s=2*Math.PI,function(){var t=u.object.position;n.copy(t).sub(u.target),n.applyQuaternion(r),m.setFromVector3(n),u.autoRotate&&f===p.NONE&&O(2*Math.PI/60/60*u.autoRotateSpeed),u.enableDamping?(m.theta+=g.theta*u.dampingFactor,m.phi+=g.phi*u.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi);var e=u.minAzimuthAngle,l=u.maxAzimuthAngle;return isFinite(e)&&isFinite(l)&&(e<-Math.PI?e+=s:e>Math.PI&&(e-=s),l<-Math.PI?l+=s:l>Math.PI&&(l-=s),m.theta=e<l?Math.max(e,Math.min(l,m.theta)):m.theta>(e+l)/2?Math.max(e,m.theta):Math.min(l,m.theta)),m.phi=Math.max(u.minPolarAngle,Math.min(u.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=y,m.radius=Math.max(u.minDistance,Math.min(u.maxDistance,m.radius)),!0===u.enableDamping?u.target.addScaledVector(v,u.dampingFactor):u.target.add(v),n.setFromSpherical(m),n.applyQuaternion(i),t.copy(u.target).add(n),u.object.lookAt(u.target),!0===u.enableDamping?(g.theta*=1-u.dampingFactor,g.phi*=1-u.dampingFactor,v.multiplyScalar(1-u.dampingFactor)):(g.set(0,0,0),v.set(0,0,0)),y=1,!!(x||o.distanceToSquared(u.object.position)>d||8*(1-a.dot(u.object.quaternion))>d)&&(u.dispatchEvent(c),o.copy(u.object.position),a.copy(u.object.quaternion),x=!1,!0)}),this.dispose=function(){u.domElement.removeEventListener("contextmenu",tt,!1),u.domElement.removeEventListener("mousedown",W,!1),u.domElement.removeEventListener("wheel",Y,!1),u.domElement.removeEventListener("touchstart",J,!1),u.domElement.removeEventListener("touchend",K,!1),u.domElement.removeEventListener("touchmove",Q,!1),u.domElement.ownerDocument.removeEventListener("mousemove",Z,!1),u.domElement.ownerDocument.removeEventListener("mouseup",$,!1),u.domElement.removeEventListener("keydown",X,!1)};var u=this,c={type:"change"},l={type:"start"},h={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=p.NONE,d=1e-6,m=new ZM,g=new ZM,y=1,v=new Sd,x=!1,b=new pd,w=new pd,_=new pd,M=new pd,S=new pd,E=new pd,N=new pd,T=new pd,A=new pd;function C(){return Math.pow(.95,u.zoomSpeed)}function O(t){g.theta-=t}function R(t){g.phi-=t}var P,L=(P=new Sd,function(t,e){P.setFromMatrixColumn(e,0),P.multiplyScalar(-t),v.add(P)}),I=function(){var t=new Sd;return function(e,n){!0===u.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(u.object.up,t)),t.multiplyScalar(e),v.add(t)}}(),D=function(){var t=new Sd;return function(e,n){var r=u.domElement;if(u.object.isPerspectiveCamera){t.copy(u.object.position).sub(u.target);var i=t.length();i*=Math.tan(u.object.fov/2*Math.PI/180),L(2*e*i/r.clientHeight,u.object.matrix),I(2*n*i/r.clientHeight,u.object.matrix)}else u.object.isOrthographicCamera?(L(e*(u.object.right-u.object.left)/u.object.zoom/r.clientWidth,u.object.matrix),I(n*(u.object.top-u.object.bottom)/u.object.zoom/r.clientHeight,u.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),u.enablePan=!1)}}();function k(t){u.object.isPerspectiveCamera?y/=t:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*t)),u.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function z(t){u.object.isPerspectiveCamera?y*=t:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom/t)),u.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function B(t){b.set(t.clientX,t.clientY)}function U(t){M.set(t.clientX,t.clientY)}function F(t){1==t.touches.length?b.set(t.touches[0].pageX,t.touches[0].pageY):b.set(.5*(t.touches[0].pageX+t.touches[1].pageX),.5*(t.touches[0].pageY+t.touches[1].pageY))}function j(t){1==t.touches.length?M.set(t.touches[0].pageX,t.touches[0].pageY):M.set(.5*(t.touches[0].pageX+t.touches[1].pageX),.5*(t.touches[0].pageY+t.touches[1].pageY))}function H(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);N.set(0,r)}function V(t){1==t.touches.length?w.set(t.touches[0].pageX,t.touches[0].pageY):w.set(.5*(t.touches[0].pageX+t.touches[1].pageX),.5*(t.touches[0].pageY+t.touches[1].pageY)),_.subVectors(w,b).multiplyScalar(u.rotateSpeed);var e=u.domElement;O(2*Math.PI*_.x/e.clientHeight),R(2*Math.PI*_.y/e.clientHeight),b.copy(w)}function G(t){1==t.touches.length?S.set(t.touches[0].pageX,t.touches[0].pageY):S.set(.5*(t.touches[0].pageX+t.touches[1].pageX),.5*(t.touches[0].pageY+t.touches[1].pageY)),E.subVectors(S,M).multiplyScalar(u.panSpeed),D(E.x,E.y),M.copy(S)}function q(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);T.set(0,r),A.set(0,Math.pow(T.y/N.y,u.zoomSpeed)),k(A.y),N.copy(T)}function W(t){if(!1!==u.enabled){var e;switch(t.preventDefault(),u.domElement.focus?u.domElement.focus():window.focus(),t.button){case 0:e=u.mouseButtons.LEFT;break;case 1:e=u.mouseButtons.MIDDLE;break;case 2:e=u.mouseButtons.RIGHT;break;default:e=-1}switch(e){case 1:if(!1===u.enableZoom)return;!function(t){N.set(t.clientX,t.clientY)}(t),f=p.DOLLY;break;case 0:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===u.enablePan)return;U(t),f=p.PAN}else{if(!1===u.enableRotate)return;B(t),f=p.ROTATE}break;case 2:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===u.enableRotate)return;B(t),f=p.ROTATE}else{if(!1===u.enablePan)return;U(t),f=p.PAN}break;default:f=p.NONE}f!==p.NONE&&(u.domElement.ownerDocument.addEventListener("mousemove",Z,!1),u.domElement.ownerDocument.addEventListener("mouseup",$,!1),u.dispatchEvent(l))}}function Z(t){if(!1!==u.enabled)switch(t.preventDefault(),f){case p.ROTATE:if(!1===u.enableRotate)return;!function(t){w.set(t.clientX,t.clientY),_.subVectors(w,b).multiplyScalar(u.rotateSpeed);var e=u.domElement;O(2*Math.PI*_.x/e.clientHeight),R(2*Math.PI*_.y/e.clientHeight),b.copy(w),u.update()}(t);break;case p.DOLLY:if(!1===u.enableZoom)return;!function(t){T.set(t.clientX,t.clientY),A.subVectors(T,N),A.y>0?k(C()):A.y<0&&z(C()),N.copy(T),u.update()}(t);break;case p.PAN:if(!1===u.enablePan)return;!function(t){S.set(t.clientX,t.clientY),E.subVectors(S,M).multiplyScalar(u.panSpeed),D(E.x,E.y),M.copy(S),u.update()}(t)}}function $(t){!1!==u.enabled&&(u.domElement.ownerDocument.removeEventListener("mousemove",Z,!1),u.domElement.ownerDocument.removeEventListener("mouseup",$,!1),u.dispatchEvent(h),f=p.NONE)}function Y(t){!1===u.enabled||!1===u.enableZoom||f!==p.NONE&&f!==p.ROTATE||(t.preventDefault(),t.stopPropagation(),u.dispatchEvent(l),function(t){t.deltaY<0?z(C()):t.deltaY>0&&k(C()),u.update()}(t),u.dispatchEvent(h))}function X(t){!1!==u.enabled&&!1!==u.enableKeys&&!1!==u.enablePan&&function(t){var e=!1;switch(t.keyCode){case u.keys.UP:D(0,u.keyPanSpeed),e=!0;break;case u.keys.BOTTOM:D(0,-u.keyPanSpeed),e=!0;break;case u.keys.LEFT:D(u.keyPanSpeed,0),e=!0;break;case u.keys.RIGHT:D(-u.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),u.update())}(t)}function J(t){if(!1!==u.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(u.touches.ONE){case 0:if(!1===u.enableRotate)return;F(t),f=p.TOUCH_ROTATE;break;case 1:if(!1===u.enablePan)return;j(t),f=p.TOUCH_PAN;break;default:f=p.NONE}break;case 2:switch(u.touches.TWO){case 2:if(!1===u.enableZoom&&!1===u.enablePan)return;!function(t){u.enableZoom&&H(t),u.enablePan&&j(t)}(t),f=p.TOUCH_DOLLY_PAN;break;case 3:if(!1===u.enableZoom&&!1===u.enableRotate)return;!function(t){u.enableZoom&&H(t),u.enableRotate&&F(t)}(t),f=p.TOUCH_DOLLY_ROTATE;break;default:f=p.NONE}break;default:f=p.NONE}f!==p.NONE&&u.dispatchEvent(l)}}function Q(t){if(!1!==u.enabled)switch(t.preventDefault(),t.stopPropagation(),f){case p.TOUCH_ROTATE:if(!1===u.enableRotate)return;V(t),u.update();break;case p.TOUCH_PAN:if(!1===u.enablePan)return;G(t),u.update();break;case p.TOUCH_DOLLY_PAN:if(!1===u.enableZoom&&!1===u.enablePan)return;!function(t){u.enableZoom&&q(t),u.enablePan&&G(t)}(t),u.update();break;case p.TOUCH_DOLLY_ROTATE:if(!1===u.enableZoom&&!1===u.enableRotate)return;!function(t){u.enableZoom&&q(t),u.enableRotate&&V(t)}(t),u.update();break;default:f=p.NONE}}function K(t){!1!==u.enabled&&(u.dispatchEvent(h),f=p.NONE)}function tt(t){!1!==u.enabled&&t.preventDefault()}u.domElement.addEventListener("contextmenu",tt,!1),u.domElement.addEventListener("mousedown",W,!1),u.domElement.addEventListener("wheel",Y,!1),u.domElement.addEventListener("touchstart",J,!1),u.domElement.addEventListener("touchend",K,!1),u.domElement.addEventListener("touchmove",Q,!1),u.domElement.addEventListener("keydown",X,!1),-1===u.domElement.tabIndex&&(u.domElement.tabIndex=0),this.update()};(YS.prototype=Object.create(cd.prototype)).constructor=YS;var XS=function(t,e){YS.call(this,t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=2,this.mouseButtons.RIGHT=0,this.touches.ONE=1,this.touches.TWO=3};(XS.prototype=Object.create(cd.prototype)).constructor=XS;var JS=n("AbXl");class QS{constructor(t,e,n){this.d=[t,e,n]}x(){return Number.isFinite(this.d[0])?this.d[0]:0}y(){return Number.isFinite(this.d[1])?this.d[1]:0}z(){return Number.isFinite(this.d[2])?this.d[2]:0}add(t){return new QS(this.d[0]+t.d[0],this.d[1]+t.d[1],this.d[2]+t.d[2])}sub(t){return new QS(this.d[0]-t.d[0],this.d[1]-t.d[1],this.d[2]-t.d[2])}multiplyScalar(t){return new QS(this.d[0]*t,this.d[1]*t,this.d[2]*t)}dotProduct(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}crossProduct(t){return new QS(this.d[1]*t.d[2]-this.d[2]*t.d[1],this.d[2]*t.d[0]-this.d[0]*t.d[2],this.d[0]*t.d[1]-this.d[1]*t.d[0])}magnitude(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}angleRadians(t){let e=this.dotProduct(t);return e/=this.magnitude()*t.magnitude(),Math.abs(Math.acos(e))}unit(){let t=this.magnitude();return this.multiplyScalar(1/t)}valueOf(){return this.d}toObject(){return{x:this.x(),y:this.y(),z:this.z()}}perpendicular(t){return this.crossProduct(t).unit()}}class KS{constructor(t,e){this.canvas=t,this.sim=e,this.width=30,this.init(),this.renderLoop()}init(){this.camera=new $g(70,this.canvas.width/this.canvas.height,.01,100),this.camera.position.z=20,this.camera.position.y=10,this.scene=new Jd,this.renderer=new ux({antialias:!0,canvas:this.canvas}),this.controls=new YS(this.camera,this.renderer.domElement),this.controls.autoRotateSpeed=5,this.controls.autoRotate=!0,this.drawGrid(),this.testPointCount=1e3,this.stats=new JS,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)}resize(t,e){console.log("resize",t,e),this.renderer.setSize(t,e)}drawGrid(){var t=new hS(this.width,this.width);this.scene.add(t)}addPoint(t){let e=16711680;t.charge>0&&(e=255);let n=new Ig(new lw(.1),new $m({color:e}));n.position.x=t.position.x(),n.position.y=t.position.y(),n.position.z=t.position.z(),n.name=t.name,this.scene.add(n)}drawSphere(t,e){let n=new Ig(new lw(.1),new $m({color:e}));n.position.x=t.x(),n.position.y=t.y(),n.position.z=t.z(),this.scene.add(n)}drawVector(t,e,n){var r=e.unit(),i=new Sd(r.x(),r.y(),r.z()),o=e.magnitude();n||(n=16777215*Math.random());var a=new AS(i,new Sd(t.x(),t.y(),t.z()),o,n);return this.scene.add(a),a}drawVectorField(t,e,n){e||(e=16711680),n||(n=1);let r=this.width/(2*n),i=-1e8;for(let o=-r;o<r;o+=1)for(let e=-r;e<r;e+=1)for(let n=-r;n<r;n+=1){let r=t.evaluate(o,e,n);r.magnitude()>i&&(i=r.magnitude())}for(let o=-r;o<r;o+=1)for(let n=-r;n<r;n+=1)for(let a=-r;a<r;a+=1){let r=t.evaluate(o,n,a);if(r.magnitude()/i<.05)continue;let s=this.drawVector(new QS(o,n,a),r.multiplyScalar(1/i),e);s.scale.x=5,s.scale.z=5}}drawTestPoints(){for(var t=[],e=0;e<this.testPointCount;e++){var n=hd.randFloatSpread(this.width),r=hd.randFloatSpread(this.width),i=hd.randFloatSpread(this.width);t.push(n,r,i)}var o=new gg;o.setAttribute("position",new og(t,3));var a=new ab(o,new eb({color:12255232,size:.2}));a.userData.type="testPoint",this.scene.add(a)}updateTestPoints(){let t=this.sim.E();for(let n=0;n<this.scene.children.length;n++)if("testPoint"==this.scene.children[n].userData.type){var e=this.scene.children[n].geometry.attributes.position;for(let n=0;n<e.count;n++){Math.random()<.01&&e.setXYZ(n,hd.randFloatSpread(this.width),hd.randFloatSpread(this.width),hd.randFloatSpread(this.width));let r=new QS(e.getX(n),e.getY(n),e.getZ(n)),i=r.add(t.evaluate(r.x(),r.y(),r.z()).multiplyScalar(1));e.setXYZ(n,i.x(),i.y(),i.z())}e.needsUpdate=!0}}renderLoop(){this.stats.begin(),this.controls.update(),this.animate(),this.renderer.render(this.scene,this.camera),this.stats.end(),this.animationID=requestAnimationFrame(()=>this.renderLoop())}destroy(){cancelAnimationFrame(this.animationID),this.scene.dispose()}animate(){this.updateTestPoints();for(let t of this.sim.points){let e=this.scene.getObjectByName(t.name);e?(e.position.x=t.position.x(),e.position.y=t.position.y(),e.position.z=t.position.z()):(console.log("point doesn't exist"),this.addPoint(t))}}}class tE{constructor(t,e,n){this.d=[t,e,n]}x(){return this.d[0]}y(){return this.d[1]}z(){return this.d[2]}evaluate(t,e,n){let r={x:t,y:e,z:n};return new QS(this.d[0].evaluate(r),this.d[1].evaluate(r),this.d[2].evaluate(r))}multiply(t){return new tE(this.x().multiply(t),this.y().multiply(t),this.z().multiply(t))}add(t){return new tE(this.x().add(t.x()),this.y().add(t.y()),this.z().add(t.z()))}dotProduct(t){let e=this.d[0].multiply(t.d[0]),n=this.d[1].multiply(t.d[1]),r=this.d[2].multiply(t.d[2]);return e.add(n).add(r)}crossProduct(t){return new tE(this.d[1].multiply(t.d[2]).sub(this.d[2].multiply(t.d[1])),this.d[2].multiply(t.d[0]).sub(this.d[0].multiply(t.d[2])),this.d[0].multiply(t.d[1]).sub(this.d[1].multiply(t.d[0])))}}var eE={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function nE(t){return(nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rE(t){return"number"==typeof t}function iE(t){return t&&!0===t.constructor.prototype.isBigNumber||!1}function oE(t){return t&&"object"===nE(t)&&!0===Object.getPrototypeOf(t).isComplex||!1}function aE(t){return t&&"object"===nE(t)&&!0===Object.getPrototypeOf(t).isFraction||!1}function sE(t){return t&&!0===t.constructor.prototype.isUnit||!1}function uE(t){return"string"==typeof t}var cE=Array.isArray;function lE(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function hE(t){return Array.isArray(t)||lE(t)}function pE(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function fE(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function dE(t){return t&&!0===t.constructor.prototype.isRange||!1}function mE(t){return t&&!0===t.constructor.prototype.isIndex||!1}function gE(t){return"boolean"==typeof t}function yE(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function vE(t){return t&&!0===t.constructor.prototype.isHelp||!1}function xE(t){return"function"==typeof t}function bE(t){return t instanceof Date}function wE(t){return t instanceof RegExp}function _E(t){return!(!t||"object"!==nE(t)||t.constructor!==Object||oE(t)||aE(t))}function ME(t){return null===t}function SE(t){return void 0===t}function EE(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function NE(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function TE(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function AE(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function CE(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function OE(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function RE(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function PE(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function LE(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function IE(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function DE(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function kE(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function zE(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function BE(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function UE(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function FE(t){return t&&!0===t.constructor.prototype.isChain||!1}function jE(t){var e=nE(t);return"object"===e?null===t?"null":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":iE(t)?"BigNumber":oE(t)?"Complex":aE(t)?"Fraction":lE(t)?"Matrix":sE(t)?"Unit":mE(t)?"Index":dE(t)?"Range":yE(t)?"ResultSet":IE(t)?t.type:FE(t)?"Chain":vE(t)?"Help":"Object":"function"===e?"Function":e}function HE(t){return(HE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VE(t){var e=HE(t);if("number"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return VE(t)}));if(t instanceof Date)return new Date(t.valueOf());if(iE(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return function(t,e){var n={};for(var r in t)WE(t,r)&&(n[r]=e(t[r]));return n}(t,VE)}function GE(t,e){for(var n in e)WE(e,n)&&(t[n]=e[n]);return t}function qE(t,e){var n,r,i;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(r=0,i=t.length;r<i;r++)if(!qE(t[r],e[r]))return!1;return!0}if("function"==typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(n in t)if(!(n in e)||!qE(t[n],e[n]))return!1;for(n in e)if(!(n in t)||!qE(t[n],e[n]))return!1;return!0}return t===e}function WE(t,e){return t&&Object.hasOwnProperty.call(t,e)}function ZE(){return(ZE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var $E=function(t){if(t)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(eE)};ZE($E,eE,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});var YE={end:!0};function XE(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}var JE=Math.sign||function(t){return t>0?1:t<0?-1:0},QE=Math.log2||function(t){return Math.log(t)/Math.LN2},KE=Math.log10||function(t){return Math.log(t)/Math.LN10},tN=Math.log1p||function(t){return Math.log(t+1)},eN=Math.cbrt||function(t){if(0===t)return t;var e,n=t<0;return n&&(t=-t),e=isFinite(t)?(t/((e=Math.exp(Math.log(t)/3))*e)+2*e)/3:t,n?-e:e},nN=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function rN(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var n,r="auto";switch(e&&(e.notation&&(r=e.notation),rE(e)?n=e:rE(e.precision)&&(n=e.precision)),r){case"fixed":return oN(t,n);case"exponential":return aN(t,n);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=sN(iN(t),e),r=n.exponent,i=n.coefficients,o=r%3==0?r:r<0?r-3-r%3:r-r%3;if(rE(e))for(;e>i.length||r-o+1>i.length;)i.push(0);else for(var a=Math.abs(r-o)-(i.length-1),s=0;s<a;s++)i.push(0);for(var u=Math.abs(r-o),c=1;u>0;)c++,u--;var l=i.slice(c).join(""),h=rE(e)&&l.length||l.match(/[1-9]/)?"."+l:"",p=i.slice(0,c).join("")+h+"e"+(r>=0?"+":"")+o.toString();return n.sign+p}(t,n);case"auto":return function(t,e,n){if(isNaN(t)||!isFinite(t))return String(t);var r=n&&void 0!==n.lowerExp?n.lowerExp:-3,i=n&&void 0!==n.upperExp?n.upperExp:5,o=iN(t),a=e?sN(o,e):o;if(a.exponent<r||a.exponent>=i)return aN(t,e);var s=a.coefficients,u=a.exponent;s.length<e&&(s=s.concat(uN(e-s.length))),s=s.concat(uN(u-s.length+1+(s.length<e?e-s.length:0)));var c=u>0?u:0;return c<(s=uN(-u).concat(s)).length-1&&s.splice(c+1,0,"."),a.sign+s.join("")}(t,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}}function iN(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var n=e[1],r=e[2],i=parseFloat(e[4]||"0"),o=r.indexOf(".");i+=-1!==o?o-1:r.length-1;var a=r.replace(".","").replace(/^0*/,(function(t){return i-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===a.length&&(a.push(0),i++),{sign:n,coefficients:a,exponent:i}}function oN(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=iN(t),r="number"==typeof e?sN(n,n.exponent+1+e):n,i=r.coefficients,o=r.exponent+1,a=o+(e||0);return i.length<a&&(i=i.concat(uN(a-i.length))),o<0&&(i=uN(1-o).concat(i),o=1),o<i.length&&i.splice(o,0,0===o?"0.":"."),r.sign+i.join("")}function aN(t,e){if(isNaN(t)||!isFinite(t))return String(t);var n=iN(t),r=e?sN(n,e):n,i=r.coefficients,o=r.exponent;i.length<e&&(i=i.concat(uN(e-i.length)));var a=i.shift();return r.sign+a+(i.length>0?"."+i.join(""):"")+"e"+(o>=0?"+":"")+o}function sN(t,e){for(var n={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},r=n.coefficients;e<=0;)r.unshift(0),n.exponent++,e++;if(r.length>e&&r.splice(e,r.length-e)[0]>=5){var i=e-1;for(r[i]++;10===r[i];)r.pop(),0===i&&(r.unshift(0),n.exponent++,i++),r[--i]++}return n}function uN(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}var cN=Number.EPSILON||2220446049250313e-31;function lN(t,e,n){if(null==n)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var r=Math.abs(t-e);return r<cN||r<=Math.max(Math.abs(t),Math.abs(e))*n}return!1}var hN=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)},pN=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},fN=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},dN=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2},mN=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2},gN=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};function yN(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function vN(t){return(vN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xN(t,e){return t.substring(t.length-e.length,t.length)===e}function bN(t,e){return"number"==typeof t?rN(t,e):iE(t)?function(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var n,r="auto";switch(void 0!==e&&(e.notation&&(r=e.notation),"number"==typeof e?n=e:e.precision&&(n=e.precision)),r){case"fixed":return function(t,e){return t.toFixed(e)}(t,n);case"exponential":return yN(t,n);case"engineering":return function(t,e){var n=t.e,r=n%3==0?n:n<0?n-3-n%3:n-n%3,i=t.mul(Math.pow(10,-r)),o=i.toPrecision(e);return-1!==o.indexOf("e")&&(o=i.toString()),o+"e"+(n>=0?"+":"")+r.toString()}(t,n);case"auto":var i=e&&void 0!==e.lowerExp?e.lowerExp:-3,o=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var a=t.toSignificantDigits(n),s=a.e;return(s>=i&&s<o?a.toFixed():yN(t,n)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}}(t,e):function(t){return t&&"object"===vN(t)&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t)?e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d:Array.isArray(t)?function t(e,n){if(Array.isArray(e)){for(var r="[",i=e.length,o=0;o<i;o++)0!==o&&(r+=", "),r+=t(e[o],n);return r+"]"}return bN(e,n)}(t,e):uE(t)?'"'+t+'"':"function"==typeof t?t.syntax?String(t.syntax):"function":t&&"object"===vN(t)?"function"==typeof t.format?t.format(e):t&&t.toString(e)!=={}.toString()?t.toString(e):"{"+Object.keys(t).map((function(n){return'"'+n+'": '+bN(t[n],e)})).join(", ")+"}":String(t)}function wN(t){for(var e=String(t),n="",r=0;r<e.length;){var i=e.charAt(r);"\\"===i?(n+=i,r++,""!==(i=e.charAt(r))&&-1!=='"\\/bfnrtu'.indexOf(i)||(n+="\\"),n+=i):n+='"'===i?'\\"':i,r++}return'"'+n+'"'}function _N(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function MN(t,e){if(!uE(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+jE(t)+", index: 0)");if(!uE(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+jE(e)+", index: 1)");return t===e?0:t>e?1:-1}function SN(t,e,n){if(!(this instanceof SN))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function EN(t,e,n){if(!(this instanceof EN))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=n),this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")",this.stack=(new Error).stack}function NN(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function TN(t,e){if(0===e.length){if(Array.isArray(t))throw new SN(t.length,0)}else!function t(e,n,r){var i,o=e.length;if(o!==n[r])throw new SN(o,n[r]);if(r<n.length-1){var a=r+1;for(i=0;i<o;i++){if(!Array.isArray(e[i]))throw new SN(n.length-1,n.length,"<");t(e[i],n,a)}}else for(i=0;i<o;i++)if(Array.isArray(e[i]))throw new SN(n.length+1,n.length,">")}(t,e,0)}function AN(t,e){if(!rE(t)||!XE(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new EN(t,e)}function CN(t,e,n){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(t){if(!rE(t)||!XE(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+bN(e)+")")})),function t(e,n,r,i){var o,a,s=n[r],u=Math.min(e.length,s);if(e.length=s,r<n.length-1){var c=r+1;for(o=0;o<u;o++)a=e[o],Array.isArray(a)||(e[o]=a=[a]),t(a,n,c,i);for(o=u;o<s;o++)e[o]=a=[],t(a,n,c,i)}else{for(o=0;o<u;o++)for(;Array.isArray(e[o]);)e[o]=e[o][0];for(o=u;o<s;o++)e[o]=i}}(t,e,0,void 0!==n?n:0),t}function ON(t,e){var n,r=LN(t);function i(t){return t.reduce((function(t,e){return t*e}))}if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new SN(0,i(NN(t)),"!=");for(var o=1,a=0;a<e.length;a++)o*=e[a];if(r.length!==o)throw new SN(i(e),i(NN(t)),"!=");try{n=function(t,e){for(var n,r=t,i=e.length-1;i>0;i--){var o=e[i];n=[];for(var a=r.length/o,s=0;s<a;s++)n.push(r.slice(s*o,(s+1)*o));r=n}return r}(r,e)}catch(s){if(s instanceof SN)throw new SN(i(e),i(NN(t)),"!=");throw s}return n}function RN(t,e){for(var n=e||NN(t);Array.isArray(t)&&1===t.length;)t=t[0],n.shift();for(var r=n.length;1===n[r-1];)r--;return r<n.length&&(t=function t(e,n,r){var i,o;if(r<n){var a=r+1;for(i=0,o=e.length;i<o;i++)e[i]=t(e[i],n,a)}else for(;Array.isArray(e);)e=e[0];return e}(t,r,0),n.length=r),t}function PN(t,e,n,r){var i=r||NN(t);if(n)for(var o=0;o<n;o++)t=[t],i.unshift(1);for(t=function t(e,n,r){var i,o;if(Array.isArray(e)){var a=r+1;for(i=0,o=e.length;i<o;i++)e[i]=t(e[i],n,a)}else for(var s=r;s<n;s++)e=[e];return e}(t,e,0);i.length<e;)i.push(1);return t}function LN(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(n){Array.isArray(n)?n.forEach(t):e.push(n)})),e}function IN(t,e){return Array.prototype.map.call(t,e)}function DN(t,e){Array.prototype.forEach.call(t,e)}function kN(t,e){if(1!==NN(t).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,e)}function zN(t,e){if(1!==NN(t).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,(function(t){return e.test(t)}))}function BN(t,e){return Array.prototype.join.call(t,e)}function UN(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(0===t.length)return t;var e=[],n=0;e[0]={value:t[0],identifier:0};for(var r=1;r<t.length;r++)t[r]===t[r-1]?n++:n=0,e.push({value:t[r],identifier:n});return e}function FN(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(0===t.length)return t;for(var e=[],n=0;n<t.length;n++)e.push(t[n].value);return e}function jN(t,e){for(var n,r=0,i=0;i<t.length;i++){var o=t[i],a=Array.isArray(o);if(0===i&&a&&(r=o.length),a&&o.length!==r)return;var s=a?jN(o,e):e(o);if(void 0===n)n=s;else if(n!==s)return"mixed"}return n}function HN(t,e,n,r){function i(r){var i=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r],o=t[i];void 0!==o&&(n[i]=o)}return n}(r,e.map(VN));return function(t,e,n){if(!e.filter((function(t){return!function(t){return t&&"?"===t[0]}(t)})).every((function(t){return void 0!==n[t]}))){var r=e.filter((function(t){return void 0===n[t]}));throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(r.map((function(t){return'"'.concat(t,'"')})).join(", "),"."))}}(t,e,r),n(i)}return i.isFactory=!0,i.fn=t,i.dependencies=e.slice().sort(),r&&(i.meta=r),i}function VN(t){return t&&"?"===t[0]?t.slice(1):t}function GN(t){return(GN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(SN.prototype=new RangeError).constructor=RangeError,SN.prototype.name="DimensionError",SN.prototype.isDimensionError=!0,(EN.prototype=new RangeError).constructor=RangeError,EN.prototype.name="IndexError",EN.prototype.isIndexError=!0;var qN=HN("Node",["mathWithTransform"],(function(t){var e=t.mathWithTransform;function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}return n.prototype.evaluate=function(t){return this.compile().evaluate(t)},n.prototype.type="Node",n.prototype.isNode=!0,n.prototype.comment="",n.prototype.compile=function(){var t=this._compile(e,{}),n={};return{evaluate:function(e){var r=e||{};return function(t){for(var e in t)if(WE(t,e)&&e in YE)throw new Error('Scope contains an illegal symbol, "'+e+'" is a reserved keyword')}(r),t(r,n,null)}}},n.prototype._compile=function(t,e){throw new Error("Method _compile should be implemented by type "+this.type)},n.prototype.forEach=function(t){throw new Error("Cannot run forEach on a Node interface")},n.prototype.map=function(t){throw new Error("Cannot run map on a Node interface")},n.prototype._ifNode=function(t){if(!IE(t))throw new TypeError("Callback function must return a Node");return t},n.prototype.traverse=function(t){t(this,null,null),function t(e,n){e.forEach((function(e,r,i){n(e,r,i),t(e,n)}))}(this,t)},n.prototype.transform=function(t){return function e(n,r,i){var o=t(n,r,i);return o!==n?o:n.map(e)}(this,null,null)},n.prototype.filter=function(t){var e=[];return this.traverse((function(n,r,i){t(n,r,i)&&e.push(n)})),e},n.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},n.prototype.cloneDeep=function(){return this.map((function(t){return t.cloneDeep()}))},n.prototype.equals=function(t){return!!t&&qE(this,t)},n.prototype.toString=function(t){var e;if(t&&"object"===GN(t))switch(GN(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this._toString(t)},n.prototype.toJSON=function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)},n.prototype.toHTML=function(t){var e;if(t&&"object"===GN(t))switch(GN(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this.toHTML(t)},n.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},n.prototype.toTex=function(t){var e;if(t&&"object"===GN(t))switch(GN(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this._toTex(t)},n.prototype._toTex=function(t){throw new Error("_toTex not implemented for "+this.type)},n.prototype.getIdentifier=function(){return this.type},n.prototype.getContent=function(){return this},n}),{isClass:!0,isNode:!0}),WN=HN("ArrayNode",["Node"],(function(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=t||[],!Array.isArray(this.items)||!this.items.every(IE))throw new TypeError("Array containing Nodes expected")}return(e.prototype=new(0,t.Node)).type="ArrayNode",e.prototype.isArrayNode=!0,e.prototype._compile=function(t,e){var n=IN(this.items,(function(n){return n._compile(t,e)}));if("Array"!==t.config.matrix){var r=t.matrix;return function(t,e,i){return r(IN(n,(function(n){return n(t,e,i)})))}}return function(t,e,r){return IN(n,(function(n){return n(t,e,r)}))}},e.prototype.forEach=function(t){for(var e=0;e<this.items.length;e++)t(this.items[e],"items["+e+"]",this)},e.prototype.map=function(t){for(var n=[],r=0;r<this.items.length;r++)n[r]=this._ifNode(t(this.items[r],"items["+r+"]",this));return new e(n)},e.prototype.clone=function(){return new e(this.items.slice(0))},e.prototype._toString=function(t){return"["+this.items.map((function(e){return e.toString(t)})).join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ArrayNode",items:this.items}},e.fromJSON=function(t){return new e(t.items)},e.prototype.toHTML=function(t){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(e){return e.toHTML(t)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},e.prototype._toTex=function(t){var e="\\begin{bmatrix}";return this.items.forEach((function(n){e+=n.items?n.items.map((function(e){return e.toTex(t)})).join("&"):n.toTex(t),e+="\\\\"})),e+="\\end{bmatrix}"},e}),{isClass:!0,isNode:!0}),ZN=HN("BlockNode",["ResultSet","Node"],(function(t){var e=t.ResultSet;function n(t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new Error("Array expected");this.blocks=t.map((function(t){var e=t&&t.node,n=!t||void 0===t.visible||t.visible;if(!IE(e))throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:e,visible:n}}))}return(n.prototype=new(0,t.Node)).type="BlockNode",n.prototype.isBlockNode=!0,n.prototype._compile=function(t,n){var r=IN(this.blocks,(function(e){return{evaluate:e.node._compile(t,n),visible:e.visible}}));return function(t,n,i){var o=[];return DN(r,(function(e){var r=e.evaluate(t,n,i);e.visible&&o.push(r)})),new e(o)}},n.prototype.forEach=function(t){for(var e=0;e<this.blocks.length;e++)t(this.blocks[e].node,"blocks["+e+"].node",this)},n.prototype.map=function(t){for(var e=[],r=0;r<this.blocks.length;r++){var i=this.blocks[r],o=this._ifNode(t(i.node,"blocks["+r+"].node",this));e[r]={node:o,visible:i.visible}}return new n(e)},n.prototype.clone=function(){return new n(this.blocks.map((function(t){return{node:t.node,visible:t.visible}})))},n.prototype._toString=function(t){return this.blocks.map((function(e){return e.node.toString(t)+(e.visible?"":";")})).join("\n")},n.prototype.toJSON=function(){return{mathjs:"BlockNode",blocks:this.blocks}},n.fromJSON=function(t){return new n(t.blocks)},n.prototype.toHTML=function(t){return this.blocks.map((function(e){return e.node.toHTML(t)+(e.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')},n.prototype._toTex=function(t){return this.blocks.map((function(e){return e.node.toTex(t)+(e.visible?"":";")})).join("\\;\\;\n")},n}),{isClass:!0,isNode:!0}),$N=n("sgX0"),YN=n.n($N),XN={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},JN={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},QN={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(JN.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(JN.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(JN.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(JN.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(JN.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(JN.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(JN.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(JN.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(JN.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(JN.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(JN.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(JN.bitAnd,"${args[1]}\\right)")},bitNot:{1:JN.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(JN.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(JN.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(JN.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(JN.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(JN.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(JN.and,"${args[1]}\\right)")},not:{1:JN.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(JN.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(JN.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(JN.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},sqrtm:{1:"{${args[0]}}".concat(JN.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(JN.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(JN.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(JN.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(JN.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(JN.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(JN.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(JN.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(JN.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(JN.to,"${args[1]}\\right)")},numeric:function(t,e){return t.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(XN.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},KN={deg:"^\\circ"};function tT(t){return YN()(t,{preserveFormatting:!0})}function eT(t,e){return(e=void 0!==e&&e)?WE(KN,t)?KN[t]:"\\mathrm{"+tT(t)+"}":WE(XN,t)?XN[t]:tT(t)}var nT=HN("ConstantNode",["Node"],(function(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.value=t}return(e.prototype=new(0,t.Node)).type="ConstantNode",e.prototype.isConstantNode=!0,e.prototype._compile=function(t,e){var n=this.value;return function(){return n}},e.prototype.forEach=function(t){},e.prototype.map=function(t){return this.clone()},e.prototype.clone=function(){return new e(this.value)},e.prototype._toString=function(t){return bN(this.value,t)},e.prototype.toHTML=function(t){var e=this._toString(t);switch(jE(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+e+"</span>";case"string":return'<span class="math-string">'+e+"</span>";case"boolean":return'<span class="math-boolean">'+e+"</span>";case"null":return'<span class="math-null-symbol">'+e+"</span>";case"undefined":return'<span class="math-undefined">'+e+"</span>";default:return'<span class="math-symbol">'+e+"</span>"}},e.prototype.toJSON=function(){return{mathjs:"ConstantNode",value:this.value}},e.fromJSON=function(t){return new e(t.value)},e.prototype._toTex=function(t){var e=this._toString(t);switch(jE(this.value)){case"string":return"\\mathtt{"+tT(e)+"}";case"number":case"BigNumber":if(!isFinite(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var n=e.toLowerCase().indexOf("e");return-1!==n?e.substring(0,n)+"\\cdot10^{"+e.substring(n+1)+"}":e;case"Fraction":return this.value.toLatex();default:return e}},e}),{isClass:!0,isNode:!0});function rT(t){return(rT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iT(t,e){if(uT(t)&&aT(t,e))return t[e];if("function"==typeof t[e]&&sT(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}function oT(t,e,n){if(uT(t)&&aT(t,e))return t[e]=n,n;throw new Error('No access to property "'+e+'"')}function aT(t,e){return!(!t||"object"!==rT(t)||!WE(cT,e)&&(e in Object.prototype||e in Function.prototype))}function sT(t,e){return!(null==t||"function"!=typeof t[e]||WE(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t)||!WE(lT,e)&&(e in Object.prototype||e in Function.prototype))}function uT(t){return"object"===rT(t)&&t&&t.constructor===Object}var cT={length:!0,name:!0},lT={toString:!0,valueOf:!0,toLocaleString:!0};function hT(t){return(hT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var pT=HN("ObjectNode",["Node"],(function(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=t||{},t&&("object"!==hT(t)||!Object.keys(t).every((function(e){return IE(t[e])}))))throw new TypeError("Object containing Nodes expected")}return(e.prototype=new(0,t.Node)).type="ObjectNode",e.prototype.isObjectNode=!0,e.prototype._compile=function(t,e){var n={};for(var r in this.properties)if(WE(this.properties,r)){var i=wN(r),o=JSON.parse(i);if(!aT(this.properties,o))throw new Error('No access to property "'+o+'"');n[o]=this.properties[r]._compile(t,e)}return function(t,e,r){var i={};for(var o in n)WE(n,o)&&(i[o]=n[o](t,e,r));return i}},e.prototype.forEach=function(t){for(var e in this.properties)WE(this.properties,e)&&t(this.properties[e],"properties["+wN(e)+"]",this)},e.prototype.map=function(t){var n={};for(var r in this.properties)WE(this.properties,r)&&(n[r]=this._ifNode(t(this.properties[r],"properties["+wN(r)+"]",this)));return new e(n)},e.prototype.clone=function(){var t={};for(var n in this.properties)WE(this.properties,n)&&(t[n]=this.properties[n]);return new e(t)},e.prototype._toString=function(t){var e=[];for(var n in this.properties)WE(this.properties,n)&&e.push(wN(n)+": "+this.properties[n].toString(t));return"{"+e.join(", ")+"}"},e.prototype.toJSON=function(){return{mathjs:"ObjectNode",properties:this.properties}},e.fromJSON=function(t){return new e(t.properties)},e.prototype.toHTML=function(t){var e=[];for(var n in this.properties)WE(this.properties,n)&&e.push('<span class="math-symbol math-property">'+_N(n)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[n].toHTML(t));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'},e.prototype._toTex=function(t){var e=[];for(var n in this.properties)WE(this.properties,n)&&e.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(t)+"\\\\");return"\\left\\{\\begin{array}{ll}".concat(e.join("\n"),"\\end{array}\\right\\}")},e}),{isClass:!0,isNode:!0}),fT=HN("ParenthesisNode",["Node"],(function(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(!IE(t))throw new TypeError('Node expected for parameter "content"');this.content=t}return(e.prototype=new(0,t.Node)).type="ParenthesisNode",e.prototype.isParenthesisNode=!0,e.prototype._compile=function(t,e){return this.content._compile(t,e)},e.prototype.getContent=function(){return this.content.getContent()},e.prototype.forEach=function(t){t(this.content,"content",this)},e.prototype.map=function(t){return new e(t(this.content,"content",this))},e.prototype.clone=function(){return new e(this.content)},e.prototype._toString=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"("+this.content.toString(t)+")":this.content.toString(t)},e.prototype.toJSON=function(){return{mathjs:"ParenthesisNode",content:this.content}},e.fromJSON=function(t){return new e(t.content)},e.prototype.toHTML=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(t)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(t)},e.prototype._toTex=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"\\left(".concat(this.content.toTex(t),"\\right)"):this.content.toTex(t)},e}),{isClass:!0,isNode:!0}),dT=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];function mT(t,e){var n=t;"keep"!==e&&(n=t.getContent());for(var r=n.getIdentifier(),i=0;i<dT.length;i++)if(r in dT[i])return i;return null}function gT(t,e){var n=t;"keep"!==e&&(n=t.getContent());var r=n.getIdentifier(),i=mT(n,e);if(null===i)return null;var o=dT[i][r];if(WE(o,"associativity")){if("left"===o.associativity)return"left";if("right"===o.associativity)return"right";throw Error("'"+r+"' has the invalid associativity '"+o.associativity+"'.")}return null}function yT(t,e,n){var r="keep"!==n?t.getContent():t,i="keep"!==n?t.getContent():e,o=r.getIdentifier(),a=i.getIdentifier(),s=mT(r,n);if(null===s)return null;var u=dT[s][o];if(WE(u,"associativeWith")&&u.associativeWith instanceof Array){for(var c=0;c<u.associativeWith.length;c++)if(u.associativeWith[c]===a)return!0;return!1}return null}var vT=HN("RelationalNode",["Node"],(function(t){function e(t,n){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(n))throw new TypeError("Parameter params must be an array");if(t.length!==n.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=t,this.params=n}return(e.prototype=new(0,t.Node)).type="RelationalNode",e.prototype.isRelationalNode=!0,e.prototype._compile=function(t,e){var n=this,r=this.params.map((function(n){return n._compile(t,e)}));return function(e,i,o){for(var a,s=r[0](e,i,o),u=0;u<n.conditionals.length;u++)if(a=s,s=r[u+1](e,i,o),!iT(t,n.conditionals[u])(a,s))return!1;return!0}},e.prototype.forEach=function(t){var e=this;this.params.forEach((function(n,r){return t(n,"params["+r+"]",e)}),this)},e.prototype.map=function(t){var n=this;return new e(this.conditionals.slice(),this.params.map((function(e,r){return n._ifNode(t(e,"params["+r+"]",n))}),this))},e.prototype.clone=function(){return new e(this.conditionals,this.params)},e.prototype._toString=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=mT(this,e),r=this.params.map((function(r,i){var o=mT(r,e);return"all"===e||null!==o&&o<=n?"("+r.toString(t)+")":r.toString(t)})),i={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},o=r[0],a=0;a<this.conditionals.length;a++)o+=" "+i[this.conditionals[a]]+" "+r[a+1];return o},e.prototype.toJSON=function(){return{mathjs:"RelationalNode",conditionals:this.conditionals,params:this.params}},e.fromJSON=function(t){return new e(t.conditionals,t.params)},e.prototype.toHTML=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=mT(this,e),r=this.params.map((function(r,i){var o=mT(r,e);return"all"===e||null!==o&&o<=n?'<span class="math-parenthesis math-round-parenthesis">(</span>'+r.toHTML(t)+'<span class="math-parenthesis math-round-parenthesis">)</span>':r.toHTML(t)})),i={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},o=r[0],a=0;a<this.conditionals.length;a++)o+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+_N(i[this.conditionals[a]])+"</span>"+r[a+1];return o},e.prototype._toTex=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=mT(this,e),r=this.params.map((function(r,i){var o=mT(r,e);return"all"===e||null!==o&&o<=n?"\\left("+r.toTex(t)+"\right)":r.toTex(t)})),i=r[0],o=0;o<this.conditionals.length;o++)i+=JN[this.conditionals[o]]+r[o+1];return i},e}),{isClass:!0,isNode:!0}),xT=HN("Chain",["?on","math"],(function(t){var e=t.on,n=t.math;function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.value=FE(t)?t.value:t}function i(t,e){var n,i,a;n=function(){var t=e();if("function"==typeof t)return o(t)},a=!0,Object.defineProperty(r.prototype,t,{get:function(){return a&&(i=n(),a=!1),i},set:function(t){i=t,a=!1},configurable:!0,enumerable:!0})}function o(t){return function(){for(var e=[this.value],n=0;n<arguments.length;n++)e[n+1]=arguments[n];return new r(t.apply(t,e))}}r.prototype.type="Chain",r.prototype.isChain=!0,r.prototype.done=function(){return this.value},r.prototype.valueOf=function(){return this.value},r.prototype.toString=function(){return bN(this.value)},r.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},r.fromJSON=function(t){return new r(t.value)},r.createProxy=function(t,e){if("string"==typeof t)"function"==typeof(u=e)&&(r.prototype[t]=o(u));else{var n=function(e){WE(t,e)&&void 0===a[e]&&i(e,(function(){return t[e]}))};for(var s in t)n(s)}var u};var a={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return r.createProxy(n),e&&e("import",(function(t,e,n){n||i(t,e)})),r}),{isClass:!0}),bT=HN("reviver",["classes"],(function(t){var e=t.classes;return function(t,n){var r=e[n&&n.mathjs];return r&&"function"==typeof r.fromJSON?r.fromJSON(n):n}})),wT=HN("ConditionalNode",["Node"],(function(t){function e(t,n,r){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(!IE(t))throw new TypeError("Parameter condition must be a Node");if(!IE(n))throw new TypeError("Parameter trueExpr must be a Node");if(!IE(r))throw new TypeError("Parameter falseExpr must be a Node");this.condition=t,this.trueExpr=n,this.falseExpr=r}return(e.prototype=new(0,t.Node)).type="ConditionalNode",e.prototype.isConditionalNode=!0,e.prototype._compile=function(t,e){var n=this.condition._compile(t,e),r=this.trueExpr._compile(t,e),i=this.falseExpr._compile(t,e);return function(t,e,o){return function(t){if("number"==typeof t||"boolean"==typeof t||"string"==typeof t)return!!t;if(t){if(iE(t))return!t.isZero();if(oE(t))return!(!t.re&&!t.im);if(sE(t))return!!t.value}if(null==t)return!1;throw new TypeError('Unsupported type of condition "'+jE(t)+'"')}(n(t,e,o))?r(t,e,o):i(t,e,o)}},e.prototype.forEach=function(t){t(this.condition,"condition",this),t(this.trueExpr,"trueExpr",this),t(this.falseExpr,"falseExpr",this)},e.prototype.map=function(t){return new e(this._ifNode(t(this.condition,"condition",this)),this._ifNode(t(this.trueExpr,"trueExpr",this)),this._ifNode(t(this.falseExpr,"falseExpr",this)))},e.prototype.clone=function(){return new e(this.condition,this.trueExpr,this.falseExpr)},e.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=mT(this,e),r=this.condition.toString(t),i=mT(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r="("+r+")");var o=this.trueExpr.toString(t),a=mT(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(o="("+o+")");var s=this.falseExpr.toString(t),u=mT(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s="("+s+")"),r+" ? "+o+" : "+s},e.prototype.toJSON=function(){return{mathjs:"ConditionalNode",condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}},e.fromJSON=function(t){return new e(t.condition,t.trueExpr,t.falseExpr)},e.prototype.toHTML=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=mT(this,e),r=this.condition.toHTML(t),i=mT(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var o=this.trueExpr.toHTML(t),a=mT(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(t),u=mT(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r+'<span class="math-operator math-conditional-operator">?</span>'+o+'<span class="math-operator math-conditional-operator">:</span>'+s},e.prototype._toTex=function(t){return"\\begin{cases} {"+this.trueExpr.toTex(t)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(t)+"}\\\\{"+this.falseExpr.toTex(t)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},e}),{isClass:!0,isNode:!0}),_T=HN("OperatorNode",["Node"],(function(t){function e(t,n,r,i){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('string expected for parameter "op"');if("string"!=typeof n)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(IE))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===i,this.op=t,this.fn=n,this.args=r||[]}function n(t,e,n,r,i){var o,a=mT(t,e),s=gT(t,e);if("all"===e||r.length>2&&"OperatorNode:add"!==t.getIdentifier()&&"OperatorNode:multiply"!==t.getIdentifier())return r.map((function(t){switch(t.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(r.length){case 0:o=[];break;case 1:var u=mT(r[0],e);if(i&&null!==u){var c,l;if("keep"===e?(c=r[0].getIdentifier(),l=t.getIdentifier()):(c=r[0].getContent().getIdentifier(),l=t.getContent().getIdentifier()),!1===dT[a][l].latexLeftParens){o=[!1];break}if(!1===dT[u][c].latexParens){o=[!1];break}}if(null===u){o=[!1];break}if(u<=a){o=[!0];break}o=[!1];break;case 2:var h,p,f=mT(r[0],e),d=yT(t,r[0],e);h=null!==f&&(f===a&&"right"===s&&!d||f<a);var m,g,y,v=mT(r[1],e),x=yT(t,r[1],e);p=null!==v&&(v===a&&"left"===s&&!x||v<a),i&&("keep"===e?(m=t.getIdentifier(),g=t.args[0].getIdentifier(),y=t.args[1].getIdentifier()):(m=t.getContent().getIdentifier(),g=t.args[0].getContent().getIdentifier(),y=t.args[1].getContent().getIdentifier()),null!==f&&(!1===dT[a][m].latexLeftParens&&(h=!1),!1===dT[f][g].latexParens&&(h=!1)),null!==v&&(!1===dT[a][m].latexRightParens&&(p=!1),!1===dT[v][y].latexParens&&(p=!1))),o=[h,p];break;default:"OperatorNode:add"!==t.getIdentifier()&&"OperatorNode:multiply"!==t.getIdentifier()||(o=r.map((function(n){var r=mT(n,e),i=yT(t,n,e),o=gT(n,e);return null!==r&&(a===r&&s===o&&!i||r<a)})))}return r.length>=2&&"OperatorNode:multiply"===t.getIdentifier()&&t.implicit&&"auto"===e&&"hide"===n&&(o=r.map((function(t,e){var n="ParenthesisNode"===t.getIdentifier();return!(!o[e]&&!n)}))),o}return(e.prototype=new(0,t.Node)).type="OperatorNode",e.prototype.isOperatorNode=!0,e.prototype._compile=function(t,e){if("string"!=typeof this.fn||!sT(t,this.fn))throw t[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var n=iT(t,this.fn),r=IN(this.args,(function(n){return n._compile(t,e)}));if(1===r.length){var i=r[0];return function(t,e,r){return n(i(t,e,r))}}if(2===r.length){var o=r[0],a=r[1];return function(t,e,r){return n(o(t,e,r),a(t,e,r))}}return function(t,e,i){return n.apply(null,IN(r,(function(n){return n(t,e,i)})))}},e.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},e.prototype.map=function(t){for(var n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(t(this.args[r],"args["+r+"]",this));return new e(this.op,this.fn,n,this.implicit)},e.prototype.clone=function(){return new e(this.op,this.fn,this.args.slice(0),this.implicit)},e.prototype.isUnary=function(){return 1===this.args.length},e.prototype.isBinary=function(){return 2===this.args.length},e.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,o=n(this,e,r,i,!1);if(1===i.length){var a=gT(this,e),s=i[0].toString(t);o[0]&&(s="("+s+")");var u=/[a-zA-Z]+/.test(this.op);return"right"===a?this.op+(u?" ":"")+s:"left"===a?s+(u?" ":"")+this.op:s+this.op}if(2===i.length){var c=i[0].toString(t),l=i[1].toString(t);return o[0]&&(c="("+c+")"),o[1]&&(l="("+l+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?c+" "+l:c+" "+this.op+" "+l}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var h=i.map((function(e,n){return e=e.toString(t),o[n]&&(e="("+e+")"),e}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?h.join(" "):h.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"},e.prototype.toJSON=function(){return{mathjs:"OperatorNode",op:this.op,fn:this.fn,args:this.args,implicit:this.implicit}},e.fromJSON=function(t){return new e(t.op,t.fn,t.args,t.implicit)},e.prototype.toHTML=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,o=n(this,e,r,i,!1);if(1===i.length){var a=gT(this,e),s=i[0].toHTML(t);return o[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===a?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+_N(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+_N(this.op)+"</span>"}if(2===i.length){var u=i[0].toHTML(t),c=i[1].toHTML(t);return o[0]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),o[1]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?u+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+c:u+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+_N(this.op)+"</span>"+c}var l=i.map((function(e,n){return e=e.toHTML(t),o[n]&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e}));return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?l.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):l.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+_N(this.op)+"</span>"):'<span class="math-function">'+_N(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'},e.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",r=t&&t.implicit?t.implicit:"hide",i=this.args,o=n(this,e,r,i,!0),a=JN[this.fn];if(a=void 0===a?this.op:a,1===i.length){var s=gT(this,e),u=i[0].toTex(t);return o[0]&&(u="\\left(".concat(u,"\\right)")),"right"===s?a+u:u+a}if(2===i.length){var c=i[0],l=c.toTex(t);o[0]&&(l="\\left(".concat(l,"\\right)"));var h,p=i[1].toTex(t);switch(o[1]&&(p="\\left(".concat(p,"\\right)")),h="keep"===e?c.getIdentifier():c.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return a+"{"+l+"}{"+p+"}";case"OperatorNode:pow":switch(l="{"+l+"}",p="{"+p+"}",h){case"ConditionalNode":case"OperatorNode:divide":l="\\left(".concat(l,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===r)return l+"~"+p}return l+a+p}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var f=i.map((function(e,n){return e=e.toTex(t),o[n]&&(e="\\left(".concat(e,"\\right)")),e}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit?f.join("~"):f.join(a)}return"\\mathrm{"+this.fn+"}\\left("+i.map((function(e){return e.toTex(t)})).join(",")+"\\right)"},e.prototype.getIdentifier=function(){return this.type+":"+this.fn},e}),{isClass:!0,isNode:!0}),MT=HN("RangeNode",["Node"],(function(t){function e(t,n,r){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(!IE(t))throw new TypeError("Node expected");if(!IE(n))throw new TypeError("Node expected");if(r&&!IE(r))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=t,this.end=n,this.step=r||null}function n(t,e){var n=mT(t,e),r={},i=mT(t.start,e);if(r.start=null!==i&&i<=n||"all"===e,t.step){var o=mT(t.step,e);r.step=null!==o&&o<=n||"all"===e}var a=mT(t.end,e);return r.end=null!==a&&a<=n||"all"===e,r}return(e.prototype=new(0,t.Node)).type="RangeNode",e.prototype.isRangeNode=!0,e.prototype.needsEnd=function(){return this.filter((function(t){return UE(t)&&"end"===t.name})).length>0},e.prototype._compile=function(t,e){var n=t.range,r=this.start._compile(t,e),i=this.end._compile(t,e);if(this.step){var o=this.step._compile(t,e);return function(t,e,a){return n(r(t,e,a),i(t,e,a),o(t,e,a))}}return function(t,e,o){return n(r(t,e,o),i(t,e,o))}},e.prototype.forEach=function(t){t(this.start,"start",this),t(this.end,"end",this),this.step&&t(this.step,"step",this)},e.prototype.map=function(t){return new e(this._ifNode(t(this.start,"start",this)),this._ifNode(t(this.end,"end",this)),this.step&&this._ifNode(t(this.step,"step",this)))},e.prototype.clone=function(){return new e(this.start,this.end,this.step&&this.step)},e.prototype._toString=function(t){var e,r=n(this,t&&t.parenthesis?t.parenthesis:"keep"),i=this.start.toString(t);if(r.start&&(i="("+i+")"),e=i,this.step){var o=this.step.toString(t);r.step&&(o="("+o+")"),e+=":"+o}var a=this.end.toString(t);return r.end&&(a="("+a+")"),e+":"+a},e.prototype.toJSON=function(){return{mathjs:"RangeNode",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e.prototype.toHTML=function(t){var e,r=n(this,t&&t.parenthesis?t.parenthesis:"keep"),i=this.start.toHTML(t);if(r.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e=i,this.step){var o=this.step.toHTML(t);r.step&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+='<span class="math-operator math-range-operator">:</span>'+o}var a=this.end.toHTML(t);return r.end&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+'<span class="math-operator math-range-operator">:</span>'+a},e.prototype._toTex=function(t){var e=n(this,t&&t.parenthesis?t.parenthesis:"keep"),r=this.start.toTex(t);if(e.start&&(r="\\left(".concat(r,"\\right)")),this.step){var i=this.step.toTex(t);e.step&&(i="\\left(".concat(i,"\\right)")),r+=":"+i}var o=this.end.toTex(t);return e.end&&(o="\\left(".concat(o,"\\right)")),r+":"+o},e}),{isClass:!0,isNode:!0}),ST=HN("FunctionAssignmentNode",["typed","Node"],(function(t){var e=t.typed;function n(t,e,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(e))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!IE(r))throw new TypeError('Node expected for parameter "expr"');if(t in YE)throw new Error('Illegal function name, "'+t+'" is a reserved keyword');this.name=t,this.params=e.map((function(t){return t&&t.name||t})),this.types=e.map((function(t){return t&&t.type||"any"})),this.expr=r}function r(t,e){var n=mT(t,e),r=mT(t.expr,e);return"all"===e||null!==r&&r<=n}return(n.prototype=new(0,t.Node)).type="FunctionAssignmentNode",n.prototype.isFunctionAssignmentNode=!0,n.prototype._compile=function(t,n){var r=Object.create(n);DN(this.params,(function(t){r[t]=!0}));var i=this.expr._compile(t,r),o=this.name,a=this.params,s=BN(this.types,","),u=o+"("+BN(this.params,", ")+")";return function(t,n,r){var c={};c[s]=function(){for(var e=Object.create(n),o=0;o<a.length;o++)e[a[o]]=arguments[o];return i(t,e,r)};var l=e(o,c);return l.syntax=u,oT(t,o,l),l}},n.prototype.forEach=function(t){t(this.expr,"expr",this)},n.prototype.map=function(t){var e=this._ifNode(t(this.expr,"expr",this));return new n(this.name,this.params.slice(0),e)},n.prototype.clone=function(){return new n(this.name,this.params.slice(0),this.expr)},n.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toString(t);return r(this,e)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n},n.prototype.toJSON=function(){var t=this.types;return{mathjs:"FunctionAssignmentNode",name:this.name,params:this.params.map((function(e,n){return{name:e,type:t[n]}})),expr:this.expr}},n.fromJSON=function(t){return new n(t.name,t.params,t.expr)},n.prototype.toHTML=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=[],i=0;i<this.params.length;i++)n.push('<span class="math-symbol math-parameter">'+_N(this.params[i])+"</span>");var o=this.expr.toHTML(t);return r(this,e)&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+_N(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+o},n.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toTex(t);return r(this,e)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(eT).join(",")+"\\right):="+n},n}),{isClass:!0,isNode:!0}),ET=HN("chain",["typed","Chain"],(function(t){var e=t.Chain;return(0,t.typed)("chain",{"":function(){return new e},any:function(t){return new e(t)}})}));function NT(t){return t&&t.isIndexError?new EN(t.index+1,t.min+1,void 0!==t.max?t.max+1:void 0):t}function TT(t){return(TT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AT(t){var e=t.subset;return function(t,n){try{if(Array.isArray(t))return e(t,n);if(t&&"function"==typeof t.subset)return t.subset(n);if("string"==typeof t)return e(t,n);if("object"===TT(t)){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return iT(t,n.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r){throw NT(r)}}}var CT=HN("AccessorNode",["subset","Node"],(function(t){var e=t.Node,n=AT({subset:t.subset});function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!IE(t))throw new TypeError('Node expected for parameter "object"');if(!LE(e))throw new TypeError('IndexNode expected for parameter "index"');this.object=t||null,this.index=e,Object.defineProperty(this,"name",{get:(function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}).bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function i(t){return!(EE(t)||NE(t)||OE(t)||PE(t)||DE(t)||zE(t)||UE(t))}return(r.prototype=new e).type="AccessorNode",r.prototype.isAccessorNode=!0,r.prototype._compile=function(t,e){var r=this.object._compile(t,e),i=this.index._compile(t,e);if(this.index.isObjectProperty()){var o=this.index.getObjectProperty();return function(t,e,n){return iT(r(t,e,n),o)}}return function(t,e,o){var a=r(t,e,o),s=i(t,e,a);return n(a,s)}},r.prototype.forEach=function(t){t(this.object,"object",this),t(this.index,"index",this)},r.prototype.map=function(t){return new r(this._ifNode(t(this.object,"object",this)),this._ifNode(t(this.index,"index",this)))},r.prototype.clone=function(){return new r(this.object,this.index)},r.prototype._toString=function(t){var e=this.object.toString(t);return i(this.object)&&(e="("+e+")"),e+this.index.toString(t)},r.prototype.toHTML=function(t){var e=this.object.toHTML(t);return i(this.object)&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+this.index.toHTML(t)},r.prototype._toTex=function(t){var e=this.object.toTex(t);return i(this.object)&&(e="\\left(' + object + '\\right)"),e+this.index.toTex(t)},r.prototype.toJSON=function(){return{mathjs:"AccessorNode",object:this.object,index:this.index}},r.fromJSON=function(t){return new r(t.object,t.index)},r}),{isClass:!0,isNode:!0});function OT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var RT=HN("IndexNode",["Range","Node","size"],(function(t){var e=t.Range,n=t.size;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=t,this.dotNotation=e||!1,!Array.isArray(t)||!t.every(IE))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}function i(t,n,r){return new e(iE(t)?t.toNumber():t,iE(n)?n.toNumber():n,iE(r)?r.toNumber():r)}return(r.prototype=new(0,t.Node)).type="IndexNode",r.prototype.isIndexNode=!0,r.prototype._compile=function(t,e){var r=IN(this.dimensions,(function(r,o){if(BE(r)){if(r.needsEnd()){var a=Object.create(e);a.end=!0;var s=r.start._compile(t,a),u=r.end._compile(t,a),c=r.step?r.step._compile(t,a):function(){return 1};return function(t,e,r){var a=n(r).valueOf(),l=Object.create(e);return l.end=a[o],i(s(t,l,r),u(t,l,r),c(t,l,r))}}var l=r.start._compile(t,e),h=r.end._compile(t,e),p=r.step?r.step._compile(t,e):function(){return 1};return function(t,e,n){return i(l(t,e,n),h(t,e,n),p(t,e,n))}}if(UE(r)&&"end"===r.name){var f=Object.create(e);f.end=!0;var d=r._compile(t,f);return function(t,e,r){var i=n(r).valueOf(),a=Object.create(e);return a.end=i[o],d(t,a,r)}}var m=r._compile(t,e);return function(t,e,n){return m(t,e,n)}})),o=iT(t,"index");return function(t,e,n){var i,a=IN(r,(function(r){return r(t,e,n)}));return o.apply(void 0,function(t){if(Array.isArray(t))return OT(t)}(i=a)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return OT(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OT(t,void 0):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}},r.prototype.forEach=function(t){for(var e=0;e<this.dimensions.length;e++)t(this.dimensions[e],"dimensions["+e+"]",this)},r.prototype.map=function(t){for(var e=[],n=0;n<this.dimensions.length;n++)e[n]=this._ifNode(t(this.dimensions[n],"dimensions["+n+"]",this));return new r(e,this.dotNotation)},r.prototype.clone=function(){return new r(this.dimensions.slice(0),this.dotNotation)},r.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&OE(this.dimensions[0])&&"string"==typeof this.dimensions[0].value},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},r.prototype._toString=function(t){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"IndexNode",dimensions:this.dimensions,dotNotation:this.dotNotation}},r.fromJSON=function(t){return new r(t.dimensions,t.dotNotation)},r.prototype.toHTML=function(t){for(var e=[],n=0;n<this.dimensions.length;n++)e[n]=this.dimensions[n].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+_N(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},r.prototype._toTex=function(t){var e=this.dimensions.map((function(e){return e.toTex(t)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"},r}),{isClass:!0,isNode:!0}),PT=HN("SymbolNode",["math","?Unit","Node"],(function(t){var e=t.math,n=t.Unit;function r(t){return!!n&&n.isValuelessUnit(t)}function i(t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');this.name=t}return(i.prototype=new(0,t.Node)).type="SymbolNode",i.prototype.isSymbolNode=!0,i.prototype._compile=function(t,e){var i=this.name;if(!0===e[i])return function(t,e,n){return e[i]};if(i in t)return function(e,n,r){return iT(i in e?e:t,i)};var o=r(i);return function(t,e,r){return i in t?iT(t,i):o?new n(null,i):function(t){throw new Error("Undefined symbol "+t)}(i)}},i.prototype.forEach=function(t){},i.prototype.map=function(t){return this.clone()},i.prototype.clone=function(){return new i(this.name)},i.prototype._toString=function(t){return this.name},i.prototype.toHTML=function(t){var e=_N(this.name);return"true"===e||"false"===e?'<span class="math-symbol math-boolean">'+e+"</span>":"i"===e?'<span class="math-symbol math-imaginary-symbol">'+e+"</span>":"Infinity"===e?'<span class="math-symbol math-infinity-symbol">'+e+"</span>":"NaN"===e?'<span class="math-symbol math-nan-symbol">'+e+"</span>":"null"===e?'<span class="math-symbol math-null-symbol">'+e+"</span>":"undefined"===e?'<span class="math-symbol math-undefined-symbol">'+e+"</span>":'<span class="math-symbol">'+e+"</span>"},i.prototype.toJSON=function(){return{mathjs:"SymbolNode",name:this.name}},i.fromJSON=function(t){return new i(t.name)},i.prototype._toTex=function(t){var n=!1;void 0===e[this.name]&&r(this.name)&&(n=!0);var i=eT(this.name,n);return"\\"===i[0]?i:" "+i},i}),{isClass:!0,isNode:!0});function LT(t){return(LT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var IT=HN("AssignmentNode",["subset","?matrix","Node"],(function(t){var e=t.subset,n=t.matrix,r=t.Node,i=AT({subset:e}),o=function(t){var e=t.subset,n=t.matrix;return function(t,r,i){try{if(Array.isArray(t))return n(t).subset(r,i).valueOf();if(t&&"function"==typeof t.subset)return t.subset(r,i);if("string"==typeof t)return e(t,r,i);if("object"===LT(t)){if(!r.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return oT(t,r.getObjectProperty(),i),t}throw new TypeError("Cannot apply index: unsupported type of object")}catch(o){throw NT(o)}}}({subset:e,matrix:n});function a(t,e,n){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=t,this.index=n?e:null,this.value=n||e,!UE(t)&&!EE(t))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(UE(t)&&"end"===t.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!LE(this.index))throw new TypeError('IndexNode expected as "index"');if(!IE(this.value))throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:(function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}).bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function s(t,e){e||(e="keep");var n=mT(t,e),r=mT(t.value,e);return"all"===e||null!==r&&r<=n}return(a.prototype=new r).type="AssignmentNode",a.prototype.isAssignmentNode=!0,a.prototype._compile=function(t,e){var n=this.object._compile(t,e),r=this.index?this.index._compile(t,e):null,a=this.value._compile(t,e),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var u=this.index.getObjectProperty();return function(t,e,r){var i=n(t,e,r),o=a(t,e,r);return oT(i,u,o)}}if(UE(this.object))return function(t,e,i){var u=n(t,e,i),c=a(t,e,i),l=r(t,e,u);return oT(t,s,o(u,l,c)),c};var c=this.object.object._compile(t,e);if(this.object.index.isObjectProperty()){var l=this.object.index.getObjectProperty();return function(t,e,n){var i=c(t,e,n),s=iT(i,l),u=r(t,e,s),h=a(t,e,n);return oT(i,l,o(s,u,h)),h}}var h=this.object.index._compile(t,e);return function(t,e,n){var s=c(t,e,n),u=h(t,e,s),l=i(s,u),p=r(t,e,l),f=a(t,e,n);return o(s,u,o(l,p,f)),f}}if(!UE(this.object))throw new TypeError("SymbolNode expected as object");return function(t,e,n){return oT(t,s,a(t,e,n))}},a.prototype.forEach=function(t){t(this.object,"object",this),this.index&&t(this.index,"index",this),t(this.value,"value",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.object,"object",this)),this.index?this._ifNode(t(this.index,"index",this)):null,this._ifNode(t(this.value,"value",this)))},a.prototype.clone=function(){return new a(this.object,this.index,this.value)},a.prototype._toString=function(t){var e=this.object.toString(t),n=this.index?this.index.toString(t):"",r=this.value.toString(t);return s(this,t&&t.parenthesis)&&(r="("+r+")"),e+n+" = "+r},a.prototype.toJSON=function(){return{mathjs:"AssignmentNode",object:this.object,index:this.index,value:this.value}},a.fromJSON=function(t){return new a(t.object,t.index,t.value)},a.prototype.toHTML=function(t){var e=this.object.toHTML(t),n=this.index?this.index.toHTML(t):"",r=this.value.toHTML(t);return s(this,t&&t.parenthesis)&&(r='<span class="math-paranthesis math-round-parenthesis">(</span>'+r+'<span class="math-paranthesis math-round-parenthesis">)</span>'),e+n+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r},a.prototype._toTex=function(t){var e=this.object.toTex(t),n=this.index?this.index.toTex(t):"",r=this.value.toTex(t);return s(this,t&&t.parenthesis)&&(r="\\left(".concat(r,"\\right)")),e+n+":="+r},a}),{isClass:!0,isNode:!0});function DT(t){return(DT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kT(){return(kT=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var zT=HN("FunctionNode",["math","Node","SymbolNode"],(function(t){var e=t.math,n=t.SymbolNode;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof t&&(t=new n(t)),!IE(t))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(e)||!e.every(IE))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=t,this.args=e||[],Object.defineProperty(this,"name",{get:(function(){return this.fn.name||""}).bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}(r.prototype=new(0,t.Node)).type="FunctionNode",r.prototype.isFunctionNode=!0,r.prototype._compile=function(t,e){if(!(this instanceof r))throw new TypeError("No valid FunctionNode");var n=IN(this.args,(function(n){return n._compile(t,e)}));if(UE(this.fn)){var i=this.fn.name,o=i in t?iT(t,i):void 0;if("function"==typeof o&&!0===o.rawArgs){var a=this.args;return function(e,n,r){return(i in e?iT(e,i):o)(a,t,kT({},e,n))}}if(1===n.length){var s=n[0];return function(t,e,n){return(i in t?iT(t,i):o)(s(t,e,n))}}if(2===n.length){var u=n[0],c=n[1];return function(t,e,n){return(i in t?iT(t,i):o)(u(t,e,n),c(t,e,n))}}return function(t,e,r){return(i in t?iT(t,i):o).apply(null,IN(n,(function(n){return n(t,e,r)})))}}if(EE(this.fn)&&LE(this.fn.index)&&this.fn.index.isObjectProperty()){var l=this.fn.object._compile(t,e),h=this.fn.index.getObjectProperty(),p=this.args;return function(e,r,i){var o=l(e,r,i);return function(t,e){if(!sT(t,e))throw new Error('No access to method "'+e+'"')}(o,h),o[h]&&o[h].rawArgs?o[h](p,t,kT({},e,r)):o[h].apply(o,IN(n,(function(t){return t(e,r,i)})))}}var f=this.fn._compile(t,e),d=this.args;return function(e,r,i){var o=f(e,r,i);return o&&o.rawArgs?o(d,t,kT({},e,r)):o.apply(o,IN(n,(function(t){return t(e,r,i)})))}},r.prototype.forEach=function(t){t(this.fn,"fn",this);for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},r.prototype.map=function(t){for(var e=this._ifNode(t(this.fn,"fn",this)),n=[],i=0;i<this.args.length;i++)n[i]=this._ifNode(t(this.args[i],"args["+i+"]",this));return new r(e,n)},r.prototype.clone=function(){return new r(this.fn,this.args.slice(0))};var i=r.prototype.toString;function o(t,e,n){for(var r,i="",o=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),a=0;null!==(r=o.exec(t));)if(i+=t.substring(a,r.index),a=r.index,"$$"===r[0])i+="$",a++;else{a+=r[0].length;var s=e[r[1]];if(!s)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(DT(s)){case"string":i+=s;break;case"object":if(IE(s))i+=s.toTex(n);else{if(!Array.isArray(s))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");i+=s.map((function(t,e){if(IE(t))return t.toTex(n);throw new TypeError("Template: "+r[1]+"["+e+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!IE(s[r[2]]&&s[r[2]]))throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");i+=s[r[2]].toTex(n)}}return i+t.slice(a)}r.prototype.toString=function(t){var e,n=this.fn.toString(t);return t&&"object"===DT(t.handler)&&WE(t.handler,n)&&(e=t.handler[n](this,t)),void 0!==e?e:i.call(this,t)},r.prototype._toString=function(t){var e=this.args.map((function(e){return e.toString(t)}));return(RE(this.fn)?"("+this.fn.toString(t)+")":this.fn.toString(t))+"("+e.join(", ")+")"},r.prototype.toJSON=function(){return{mathjs:"FunctionNode",fn:this.fn,args:this.args}},r.fromJSON=function(t){return new r(t.fn,t.args)},r.prototype.toHTML=function(t){var e=this.args.map((function(e){return e.toHTML(t)}));return'<span class="math-function">'+_N(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'};var a=r.prototype.toTex;return r.prototype.toTex=function(t){var e;return t&&"object"===DT(t.handler)&&WE(t.handler,this.name)&&(e=t.handler[this.name](this,t)),void 0!==e?e:a.call(this,t)},r.prototype._toTex=function(t){var n,r,i=this.args.map((function(e){return e.toTex(t)}));switch(QN[this.name]&&(n=QN[this.name]),!e[this.name]||"function"!=typeof e[this.name].toTex&&"object"!==DT(e[this.name].toTex)&&"string"!=typeof e[this.name].toTex||(n=e[this.name].toTex),DT(n)){case"function":r=n(this,t);break;case"string":r=o(n,this,t);break;case"object":switch(DT(n[i.length])){case"function":r=n[i.length](this,t);break;case"string":r=o(n[i.length],this,t)}}return void 0!==r?r:o("\\mathrm{${name}}\\left(${args}\\right)",this,t)},r.prototype.getIdentifier=function(){return this.type+":"+this.name},r}),{isClass:!0,isNode:!0});function BT(t){for(var e=0;e<t.length;e++)if(hE(t[e]))return!0;return!1}function UT(t,e){lE(t)&&(t=t.valueOf());for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?UT(i,e):e(i)}}function FT(t,e,n){return t&&"function"==typeof t.map?t.map((function(t){return FT(t,e,n)})):e(t)}function jT(t,e,n){var r=Array.isArray(t)?NN(t):t.size();if(e<0||e>=r.length)throw new EN(e,r.length);return lE(t)?t.create(HT(t.valueOf(),e,n)):HT(t,e,n)}function HT(t,e,n){var r,i,o,a;if(e<=0){if(Array.isArray(t[0])){for(a=function(t){var e,n,r=t.length,i=t[0].length,o=[];for(n=0;n<i;n++){var a=[];for(e=0;e<r;e++)a.push(t[e][n]);o.push(a)}return o}(t),i=[],r=0;r<a.length;r++)i[r]=HT(a[r],e-1,n);return i}for(o=t[0],r=1;r<t.length;r++)o=n(o,t[r]);return o}for(i=[],r=0;r<t.length;r++)i[r]=HT(t[r],e-1,n);return i}function VT(t,e,n,r,i,o,a,s,u,c,l){var h,p,f,d=t._values,m=t._index,g=t._ptr;if(r)for(p=g[e+1],h=g[e];h<p;h++)n[f=m[h]]!==o?(n[f]=o,a.push(f),c?(r[f]=u?s(d[h],l):s(l,d[h]),i[f]=o):r[f]=d[h]):(r[f]=u?s(d[h],r[f]):s(r[f],d[h]),i[f]=o);else for(p=g[e+1],h=g[e];h<p;h++)n[f=m[h]]!==o?(n[f]=o,a.push(f)):i[f]=o}function GT(){return(GT=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var qT=HN("parse",["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(function(t){var e=t.numeric,n=t.config,r=t.AccessorNode,i=t.ArrayNode,o=t.AssignmentNode,a=t.BlockNode,s=t.ConditionalNode,u=t.ConstantNode,c=t.FunctionAssignmentNode,l=t.FunctionNode,h=t.IndexNode,p=t.ObjectNode,f=t.OperatorNode,d=t.ParenthesisNode,m=t.RangeNode,g=t.RelationalNode,y=t.SymbolNode,v=(0,t.typed)("parse",{string:function(t){return L(t,{})},"Array | Matrix":function(t){return x(t,{})},"string, Object":function(t,e){return L(t,void 0!==e.nodes?e.nodes:{})},"Array | Matrix, Object":x});function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==e.nodes?e.nodes:{};return FT(t,(function(t){if("string"!=typeof t)throw new TypeError("String expected");return L(t,n)}))}var b={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},w={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},_={true:!0,false:!1,null:null,undefined:void 0},M=["NaN","Infinity"];function S(t,e){return t.expression.substr(t.index,e)}function E(t){return S(t,1)}function N(t){t.index++}function T(t){return t.expression.charAt(t.index-1)}function A(t){return t.expression.charAt(t.index+1)}function C(t){for(t.tokenType=0,t.token="",t.comment="";v.isWhitespace(E(t),t.nestingLevel);)N(t);if("#"===E(t))for(;"\n"!==E(t)&&""!==E(t);)t.comment+=E(t),N(t);if(""!==E(t)){if("\n"===E(t)&&!t.nestingLevel)return t.tokenType=1,t.token=E(t),void N(t);var e=E(t),n=S(t,2),r=S(t,3);if(3===r.length&&b[r])return t.tokenType=1,t.token=r,N(t),N(t),void N(t);if(2===n.length&&b[n])return t.tokenType=1,t.token=n,N(t),void N(t);if(b[e])return t.tokenType=1,t.token=e,void N(t);if(v.isDigitDot(e)){if(t.tokenType=2,"."===E(t))t.token+=E(t),N(t),v.isDigit(E(t))||(t.tokenType=1);else{for(;v.isDigit(E(t));)t.token+=E(t),N(t);v.isDecimalMark(E(t),A(t))&&(t.token+=E(t),N(t))}for(;v.isDigit(E(t));)t.token+=E(t),N(t);if("E"===E(t)||"e"===E(t))if(v.isDigit(A(t))||"-"===A(t)||"+"===A(t)){if(t.token+=E(t),N(t),"+"!==E(t)&&"-"!==E(t)||(t.token+=E(t),N(t)),!v.isDigit(E(t)))throw tt(t,'Digit expected, got "'+E(t)+'"');for(;v.isDigit(E(t));)t.token+=E(t),N(t);if(v.isDecimalMark(E(t),A(t)))throw tt(t,'Digit expected, got "'+E(t)+'"')}else if("."===A(t))throw N(t),tt(t,'Digit expected, got "'+E(t)+'"')}else{if(!v.isAlpha(E(t),T(t),A(t))){for(t.tokenType=4;""!==E(t);)t.token+=E(t),N(t);throw tt(t,'Syntax error in part "'+t.token+'"')}for(;v.isAlpha(E(t),T(t),A(t))||v.isDigit(E(t));)t.token+=E(t),N(t);t.tokenType=WE(w,t.token)?1:3}}else t.tokenType=1}function O(t){do{C(t)}while("\n"===t.token)}function R(t){t.nestingLevel++}function P(t){t.nestingLevel--}function L(t,e){var n={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:0,nestingLevel:0,conditionalLevel:null};GT(n,{expression:t,extraNodes:e}),C(n);var r=function(t){var e,n=[];for(""!==t.token&&"\n"!==t.token&&";"!==t.token&&((e=I(t)).comment=t.comment);"\n"===t.token||";"===t.token;)0===n.length&&e&&n.push({node:e,visible:";"!==t.token}),C(t),"\n"!==t.token&&";"!==t.token&&""!==t.token&&((e=I(t)).comment=t.comment,n.push({node:e,visible:";"!==t.token}));return n.length>0?new a(n):(e||((e=new u(void 0)).comment=t.comment),e)}(n);if(""!==n.token)throw 1===n.tokenType?et(n,"Unexpected operator "+n.token):tt(n,'Unexpected part "'+n.token+'"');return r}function I(t){var e,n,r,i,a=function(t){for(var e=function(t){for(var e=D(t);"or"===t.token;)O(t),e=new f("or","or",[e,D(t)]);return e}(t);"?"===t.token;){var n=t.conditionalLevel;t.conditionalLevel=t.nestingLevel,O(t);var r=e,i=I(t);if(":"!==t.token)throw tt(t,"False part of conditional expression expected");t.conditionalLevel=null,O(t);var o=I(t);e=new s(r,i,o),t.conditionalLevel=n}return e}(t);if("="===t.token){if(UE(a))return e=a.name,O(t),r=I(t),new o(new y(e),r);if(EE(a))return O(t),r=I(t),new o(a.object,a.index,r);if(PE(a)&&UE(a.fn)&&(i=!0,n=[],e=a.name,a.args.forEach((function(t,e){UE(t)?n[e]=t.name:i=!1})),i))return O(t),r=I(t),new c(e,n,r);throw tt(t,"Invalid left hand side of assignment operator =")}return a}function D(t){for(var e=k(t);"xor"===t.token;)O(t),e=new f("xor","xor",[e,k(t)]);return e}function k(t){for(var e=z(t);"and"===t.token;)O(t),e=new f("and","and",[e,z(t)]);return e}function z(t){for(var e=B(t);"|"===t.token;)O(t),e=new f("|","bitOr",[e,B(t)]);return e}function B(t){for(var e=U(t);"^|"===t.token;)O(t),e=new f("^|","bitXor",[e,U(t)]);return e}function U(t){for(var e=F(t);"&"===t.token;)O(t),e=new f("&","bitAnd",[e,F(t)]);return e}function F(t){for(var e=[j(t)],n=[],r={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};WE(r,t.token);)n.push({name:t.token,fn:r[t.token]}),O(t),e.push(j(t));return 1===e.length?e[0]:2===e.length?new f(n[0].name,n[0].fn,e):new g(n.map((function(t){return t.fn})),e)}function j(t){var e,n,r,i;e=H(t);for(var o={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};WE(o,t.token);)r=o[n=t.token],O(t),i=[e,H(t)],e=new f(n,r,i);return e}function H(t){var e,n,r,i;e=V(t);for(var o={to:"to",in:"to"};WE(o,t.token);)r=o[n=t.token],O(t),"in"===n&&""===t.token?e=new f("*","multiply",[e,new y("in")],!0):(i=[e,V(t)],e=new f(n,r,i));return e}function V(t){var e,n=[];if(e=":"===t.token?new u(1):G(t),":"===t.token&&t.conditionalLevel!==t.nestingLevel){for(n.push(e);":"===t.token&&n.length<3;)O(t),n.push(")"===t.token||"]"===t.token||","===t.token||""===t.token?new y("end"):G(t));e=3===n.length?new m(n[0],n[2],n[1]):new m(n[0],n[1])}return e}function G(t){var e,n,r,i;e=q(t);for(var o={"+":"add","-":"subtract"};WE(o,t.token);)r=o[n=t.token],O(t),i=[e,q(t)],e=new f(n,r,i);return e}function q(t){var e,n,r,i;n=e=W(t);for(var o={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};WE(o,t.token);)i=o[r=t.token],O(t),n=W(t),e=new f(r,i,[e,n]);return e}function W(t){var e,n;for(n=e=Z(t);3===t.tokenType||"in"===t.token&&OE(e)||!(2!==t.tokenType||OE(n)||kE(n)&&"!"!==n.op)||"("===t.token;)n=Z(t),e=new f("*","multiply",[e,n],!0);return e}function Z(t){for(var e=$(t),n=e,r=[];"/"===t.token&&OE(n);){if(r.push(GT({},t)),O(t),2!==t.tokenType){GT(t,r.pop());break}if(r.push(GT({},t)),O(t),3!==t.tokenType&&"("!==t.token){r.pop(),GT(t,r.pop());break}GT(t,r.pop()),r.pop(),n=$(t),e=new f("/","divide",[e,n])}return e}function $(t){var r,o,a,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return WE(s,t.token)?(a=s[t.token],r=t.token,O(t),o=[$(t)],new f(r,a,o)):function(t){var r,o,a,s;return r=function(t){var r,o,a;r=function(t){var r=[];if(3===t.tokenType&&WE(t.extraNodes,t.token)){var o=t.extraNodes[t.token];if(C(t),"("===t.token){if(r=[],R(t),C(t),")"!==t.token)for(r.push(I(t));","===t.token;)C(t),r.push(I(t));if(")"!==t.token)throw tt(t,"Parenthesis ) expected");P(t),C(t)}return new o(r)}return function(t){var r;return 3===t.tokenType||1===t.tokenType&&t.token in w?(r=t.token,C(t),Y(t,WE(_,r)?new u(_[r]):-1!==M.indexOf(r)?new u(e(r,"number")):new y(r))):function(t){var r;return'"'===t.token?(r=X(t),Y(t,new u(r))):function(t){var r;return"'"===t.token?(r=J(t),Y(t,new u(r))):function(t){var r,o,a,s;if("["===t.token){if(R(t),C(t),"]"!==t.token){var c=Q(t);if(";"===t.token){for(a=1,o=[c];";"===t.token;)C(t),o[a]=Q(t),a++;if("]"!==t.token)throw tt(t,"End of matrix ] expected");P(t),C(t),s=o[0].items.length;for(var l=1;l<a;l++)if(o[l].items.length!==s)throw et(t,"Column dimensions mismatch ("+o[l].items.length+" !== "+s+")");r=new i(o)}else{if("]"!==t.token)throw tt(t,"End of matrix ] expected");P(t),C(t),r=c}}else P(t),C(t),r=new i([]);return Y(t,r)}return function(t){if("{"===t.token){var r;R(t);var i={};do{if(C(t),"}"!==t.token){if('"'===t.token)r=X(t);else if("'"===t.token)r=J(t);else{if(!(3===t.tokenType||1===t.tokenType&&t.token in w))throw tt(t,"Symbol or string expected as object key");r=t.token,C(t)}if(":"!==t.token)throw tt(t,"Colon : expected after object key");C(t),i[r]=I(t)}}while(","===t.token);if("}"!==t.token)throw tt(t,"Comma , or bracket } expected after object value");return P(t),C(t),Y(t,new p(i))}return function(t){var r;return 2===t.tokenType?(r=t.token,C(t),new u(e(r,n.number))):function(t){var e;if("("===t.token){if(R(t),C(t),e=I(t),")"!==t.token)throw tt(t,"Parenthesis ) expected");return P(t),C(t),Y(t,e=new d(e))}return function(t){throw tt(t,""===t.token?"Unexpected end of expression":"Value expected")}(t)}(t)}(t)}(t)}(t)}(t)}(t)}(t)}(t);for(var s={"!":"factorial","'":"ctranspose"};WE(s,t.token);)a=s[o=t.token],C(t),r=Y(t,r=new f(o,a,[r]));return r}(t),("^"===t.token||".^"===t.token)&&(a="^"===(o=t.token)?"pow":"dotPow",O(t),s=[r,$(t)],r=new f(o,a,s)),r}(t)}function Y(t,e,n){for(var i;!("("!==t.token&&"["!==t.token&&"."!==t.token||n&&-1===n.indexOf(t.token));)if(i=[],"("===t.token){if(!UE(e)&&!EE(e))return e;if(R(t),C(t),")"!==t.token)for(i.push(I(t));","===t.token;)C(t),i.push(I(t));if(")"!==t.token)throw tt(t,"Parenthesis ) expected");P(t),C(t),e=new l(e,i)}else if("["===t.token){if(R(t),C(t),"]"!==t.token)for(i.push(I(t));","===t.token;)C(t),i.push(I(t));if("]"!==t.token)throw tt(t,"Parenthesis ] expected");P(t),C(t),e=new r(e,new h(i))}else{if(C(t),3!==t.tokenType)throw tt(t,"Property name expected after dot");i.push(new u(t.token)),C(t),e=new r(e,new h(i,!0))}return e}function X(t){for(var e="";""!==E(t)&&'"'!==E(t);)"\\"===E(t)&&(e+=E(t),N(t)),e+=E(t),N(t);if(C(t),'"'!==t.token)throw tt(t,'End of string " expected');return C(t),JSON.parse('"'+e+'"')}function J(t){for(var e="";""!==E(t)&&"'"!==E(t);)"\\"===E(t)&&(e+=E(t),N(t)),e+=E(t),N(t);if(C(t),"'"!==t.token)throw tt(t,"End of string ' expected");return C(t),JSON.parse('"'+e+'"')}function Q(t){for(var e=[I(t)],n=1;","===t.token;)C(t),e[n]=I(t),n++;return new i(e)}function K(t){return t.index-t.token.length+1}function tt(t,e){var n=K(t),r=new SyntaxError(e+" (char "+n+")");return r.char=n,r}function et(t,e){var n=K(t),r=new SyntaxError(e+" (char "+n+")");return r.char=n,r}return v.isAlpha=function(t,e,n){return v.isValidLatinOrGreek(t)||v.isValidMathSymbol(t,n)||v.isValidMathSymbol(e,t)},v.isValidLatinOrGreek=function(t){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(t)},v.isValidMathSymbol=function(t,e){return/^[\uD835]$/.test(t)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)},v.isWhitespace=function(t,e){return" "===t||"\t"===t||"\n"===t&&e>0},v.isDecimalMark=function(t,e){return"."===t&&"/"!==e&&"*"!==e&&"^"!==e},v.isDigitDot=function(t){return t>="0"&&t<="9"||"."===t},v.isDigit=function(t){return t>="0"&&t<="9"},v})),WT=HN("evaluate",["typed","parse"],(function(t){var e=t.parse;return(0,t.typed)("evaluate",{string:function(t){return e(t).compile().evaluate({})},"string, Object":function(t,n){return e(t).compile().evaluate(n)},"Array | Matrix":function(t){var n={};return FT(t,(function(t){return e(t).compile().evaluate(n)}))},"Array | Matrix, Object":function(t,n){return FT(t,(function(t){return e(t).compile().evaluate(n)}))}})})),ZT=HN("Help",["parse"],(function(t){var e=t.parse;function n(t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!t)throw new Error('Argument "doc" missing');this.doc=t}return n.prototype.type="Help",n.prototype.isHelp=!0,n.prototype.toString=function(){var t=this.doc||{},n="\n";if(t.name&&(n+="Name: "+t.name+"\n\n"),t.category&&(n+="Category: "+t.category+"\n\n"),t.description&&(n+="Description:\n    "+t.description+"\n\n"),t.syntax&&(n+="Syntax:\n    "+t.syntax.join("\n    ")+"\n\n"),t.examples){n+="Examples:\n";for(var r={},i=0;i<t.examples.length;i++){var o=t.examples[i];n+="    "+o+"\n";var a=void 0;try{a=e(o).compile().evaluate(r)}catch(s){a=s}void 0===a||vE(a)||(n+="        "+bN(a,{precision:14})+"\n")}n+="\n"}return t.seealso&&t.seealso.length&&(n+="See also: "+t.seealso.join(", ")+"\n"),n},n.prototype.toJSON=function(){var t=VE(this.doc);return t.mathjs="Help",t},n.fromJSON=function(t){var e={};return Object.keys(t).filter((function(t){return"mathjs"!==t})).forEach((function(n){e[n]=t[n]})),new n(e)},n.prototype.valueOf=n.prototype.toString,n}),{isClass:!0}),$T=HN("compile",["typed","parse"],(function(t){var e=t.parse;return(0,t.typed)("compile",{string:function(t){return e(t).compile()},"Array | Matrix":function(t){return FT(t,(function(t){return e(t).compile()}))}})})),YT={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},XT={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},JT={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:XT,E:XT,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:YT,PI:YT,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant",examples:["coulomb"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Borh magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Borh radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["derivative","parse","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[1, 2], [3, 4]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(" + 4 + ")")'],seealso:[]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and eigenvectors of a real symmetric matrix",examples:["eigs([[5, 2.3], [2.3, 1]])"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], square)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])"],seealso:["size","squeeze","resize"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "BigNumber")','numeric("4", "Fraction)','numeric(4, "Fraction")','numeric(fraction(2, 5), "number)'],seealso:["number","fraction","bignumber","string","format"]}},QT=HN("help",["typed","mathWithTransform","Help"],(function(t){var e=t.mathWithTransform,n=t.Help;return(0,t.typed)("help",{any:function(t){var r,i=t;if("string"!=typeof t)for(r in e)if(WE(e,r)&&t===e[r]){i=r;break}var o=iT(JT,i);if(!o)throw new Error('No documentation found on "'+("function"==typeof i?i.name:i)+'"');return new n(o)}})})),KT=HN("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(function(t){var e=t.FunctionNode,n=t.OperatorNode,r=t.SymbolNode,i={add:!0,multiply:!0},o={add:!0,multiply:!0};function a(t,e){if(!kE(t))return!1;var n=t.fn.toString();return e&&WE(e,n)&&WE(e[n],"associative")?e[n].associative:o[n]||!1}function s(t){var e,n=[];return a(t)?(e=t.op,function t(r){for(var i=0;i<r.args.length;i++){var o=r.args[i];kE(o)&&e===o.op?t(o):n.push(o)}}(t),n):t.args}function u(t){return kE(t)?function(e){try{return new n(t.op,t.fn,e,t.implicit)}catch(r){return console.error(r),[]}}:function(n){return new e(new r(t.name),n)}}return{createMakeNodeFunction:u,isCommutative:function(t,e){if(!kE(t))return!0;var n=t.fn.toString();return e&&WE(e,n)&&WE(e[n],"commutative")?e[n].commutative:i[n]||!1},isAssociative:a,flatten:function t(e){if(!e.args||0===e.args.length)return e;e.args=s(e);for(var n=0;n<e.args.length;n++)t(e.args[n])},allChildren:s,unflattenr:function t(e){if(e.args&&0!==e.args.length){for(var n=u(e),r=e.args.length,i=0;i<r;i++)t(e.args[i]);if(r>2&&a(e)){for(var o=e.args.pop();e.args.length>0;)o=n([e.args.pop(),o]);e.args=o.args}}},unflattenl:function t(e){if(e.args&&0!==e.args.length){for(var n=u(e),r=e.args.length,i=0;i<r;i++)t(e.args[i]);if(r>2&&a(e)){for(var o=e.args.shift();e.args.length>0;)o=n([o,e.args.shift()]);e.args=o.args}}}}})),tA=HN("simplifyCore",["equal","isZero","add","subtract","multiply","divide","pow","ConstantNode","OperatorNode","FunctionNode","ParenthesisNode"],(function(t){var e=t.equal,n=t.isZero,r=t.add,i=t.subtract,o=t.multiply,a=t.divide,s=t.pow,u=t.ConstantNode,c=t.OperatorNode,l=t.FunctionNode,h=t.ParenthesisNode,p=new u(0),f=new u(1);return function t(d){if(kE(d)&&d.isUnary()){var m=t(d.args[0]);if("+"===d.op)return m;if("-"===d.op){if(kE(m)){if(m.isUnary()&&"-"===m.op)return m.args[0];if(m.isBinary()&&"subtract"===m.fn)return new c("-","subtract",[m.args[1],m.args[0]])}return new c(d.op,d.fn,[m])}}else if(kE(d)&&d.isBinary()){var g=t(d.args[0]),y=t(d.args[1]);if("+"===d.op){if(OE(g)){if(n(g.value))return y;if(OE(y))return new u(r(g.value,y.value))}return OE(y)&&n(y.value)?g:kE(y)&&y.isUnary()&&"-"===y.op?new c("-","subtract",[g,y.args[0]]):new c(d.op,d.fn,y?[g,y]:[g])}if("-"===d.op){if(OE(g)&&y){if(OE(y))return new u(i(g.value,y.value));if(n(g.value))return new c("-","unaryMinus",[y])}if("subtract"===d.fn)return OE(y)&&n(y.value)?g:kE(y)&&y.isUnary()&&"-"===y.op?t(new c("+","add",[g,y.args[0]])):new c(d.op,d.fn,[g,y])}else{if("*"===d.op){if(OE(g)){if(n(g.value))return p;if(e(g.value,1))return y;if(OE(y))return new u(o(g.value,y.value))}if(OE(y)){if(n(y.value))return p;if(e(y.value,1))return g;if(kE(g)&&g.isBinary()&&g.op===d.op){var v=g.args[0];if(OE(v)){var x=new u(o(v.value,y.value));return new c(d.op,d.fn,[x,g.args[1]],d.implicit)}}return new c(d.op,d.fn,[y,g],d.implicit)}return new c(d.op,d.fn,[g,y],d.implicit)}if("/"===d.op){if(OE(g)){if(n(g.value))return p;if(OE(y)&&(e(y.value,1)||e(y.value,2)||e(y.value,4)))return new u(a(g.value,y.value))}return new c(d.op,d.fn,[g,y])}if("^"===d.op){if(OE(y)){if(n(y.value))return f;if(e(y.value,1))return g;if(OE(g))return new u(s(g.value,y.value));if(kE(g)&&g.isBinary()&&"^"===g.op){var b=g.args[1];if(OE(b))return new c(d.op,d.fn,[g.args[0],new u(o(b.value,y.value))])}}return new c(d.op,d.fn,[g,y])}}}else{if(zE(d)){var w=t(d.content);return zE(w)||UE(w)||OE(w)?w:new h(w)}if(PE(d)){var _=d.args.map(t).map((function(t){return zE(t)?t.content:t}));return new l(t(d.fn),_)}}return d}}));function eA(){throw new Error('No "bignumber" implementation available')}function nA(){throw new Error('No "fraction" implementation available')}function rA(){throw new Error('No "matrix" implementation available')}var iA=HN("simplifyConstant",["typed","config","mathWithTransform","?fraction","?bignumber","ConstantNode","OperatorNode","FunctionNode","SymbolNode"],(function(t){var e=t.typed,n=t.config,r=t.mathWithTransform,i=t.fraction,o=t.bignumber,a=t.ConstantNode,s=t.OperatorNode,u=t.FunctionNode,c=KT({FunctionNode:u,OperatorNode:s,SymbolNode:t.SymbolNode}),l=c.isCommutative,h=c.isAssociative,p=c.allChildren,f=c.createMakeNodeFunction;function d(t,e,n){try{return y(r[t].apply(null,e),n)}catch(i){return e=e.map((function(t){return aE(t)?t.valueOf():t})),y(r[t].apply(null,e),n)}}var m=e({Fraction:function(t){var e,n=t.s*t.n;return e=n<0?new s("-","unaryMinus",[new a(-n)]):new a(n),1===t.d?e:new s("/","divide",[e,new a(t.d)])},number:function(t){return t<0?v(new a(-t)):new a(t)},BigNumber:function(t){return t<0?v(new a(-t)):new a(t)},Complex:function(t){throw new Error("Cannot convert Complex number to Node")}});function g(t,e){if(e&&!1!==e.exactFractions&&isFinite(t)&&i){var n=i(t);if(n.valueOf()===t)return n}return t}var y=e({"string, Object":function(t,e){return"BigNumber"===n.number?(void 0===o&&eA(),o(t)):"Fraction"===n.number?(void 0===i&&nA(),i(t)):g(parseFloat(t),e)},"Fraction, Object":function(t,e){return t},"BigNumber, Object":function(t,e){return t},"number, Object":function(t,e){return g(t,e)},"Complex, Object":function(t,e){return 0!==t.im?t:g(t.re,e)}});function v(t){return new s("-","unaryMinus",[t])}function x(t,e,n,r){return e.reduce((function(e,i){if(IE(e)||IE(i))IE(e)?IE(i)||(i=m(i)):e=m(e);else{try{return d(t,[e,i],r)}catch(o){}e=m(e),i=m(i)}return n([e,i])}))}return function(t,e){var n=function t(e,n){switch(e.type){case"SymbolNode":return e;case"ConstantNode":return"number"!=typeof e.value&&isNaN(e.value)?e:y(e.value,n);case"FunctionNode":if(r[e.name]&&r[e.name].rawArgs)return e;if(-1===["add","multiply"].indexOf(e.name)){var i=e.args.map((function(e){return t(e,n)}));if(!i.some(IE))try{return d(e.name,i,n)}catch(w){}return i=i.map((function(t){return IE(t)?t:m(t)})),new u(e.name,i)}case"OperatorNode":var o,a,s=e.fn.toString(),c=f(e);if(kE(e)&&e.isUnary())a=IE((o=[t(e.args[0],n)])[0])?c(o):d(s,o,n);else if(h(e))if(o=(o=p(e)).map((function(e){return t(e,n)})),l(s)){for(var g=[],v=[],b=0;b<o.length;b++)IE(o[b])?v.push(o[b]):g.push(o[b]);g.length>1?(a=x(s,g,c,n),v.unshift(a),a=x(s,v,c,n)):a=x(s,o,c,n)}else a=x(s,o,c,n);else a=x(s,o=e.args.map((function(e){return t(e,n)})),c,n);return a;case"ParenthesisNode":return t(e.content,n);case"AccessorNode":case"ArrayNode":case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"IndexNode":case"ObjectNode":case"RangeNode":case"ConditionalNode":default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}(t,e);return IE(n)?n:m(n)}})),oA=HN("resolve",["parse","FunctionNode","OperatorNode","ParenthesisNode"],(function(t){var e=t.parse,n=t.FunctionNode,r=t.OperatorNode,i=t.ParenthesisNode;return function t(o,a){if(!a)return o;if(UE(o)){var s=a[o.name];if(IE(s))return t(s,a);if("number"==typeof s)return e(String(s))}else{if(kE(o)){var u=o.args.map((function(e){return t(e,a)}));return new r(o.op,o.fn,u,o.implicit)}if(zE(o))return new i(t(o.content,a));if(PE(o)){var c=o.args.map((function(e){return t(e,a)}));return new n(o.name,c)}}return o}}));function aA(t){return(aA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var sA=HN("simplify",["config","typed","parse","add","subtract","multiply","divide","pow","isZero","equal","?fraction","?bignumber","mathWithTransform","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(function(t){var e=t.typed,n=t.parse,r=t.add,i=t.subtract,o=t.multiply,a=t.divide,s=t.pow,u=t.isZero,c=t.equal,l=t.ConstantNode,h=t.FunctionNode,p=t.OperatorNode,f=t.ParenthesisNode,d=t.SymbolNode,m=iA({typed:e,config:t.config,mathWithTransform:t.mathWithTransform,fraction:t.fraction,bignumber:t.bignumber,ConstantNode:l,OperatorNode:p,FunctionNode:h,SymbolNode:d}),g=tA({equal:c,isZero:u,add:r,subtract:i,multiply:o,divide:a,pow:s,ConstantNode:l,OperatorNode:p,FunctionNode:h,ParenthesisNode:f}),y=oA({parse:n,FunctionNode:h,OperatorNode:p,ParenthesisNode:f}),v=KT({FunctionNode:h,OperatorNode:p,SymbolNode:d}),x=v.isCommutative,b=v.isAssociative,w=v.flatten,_=v.unflattenr,M=v.unflattenl,S=v.createMakeNodeFunction,E=e("simplify",{string:function(t){return this(n(t),this.rules,{},{})},"string, Object":function(t,e){return this(n(t),this.rules,e,{})},"string, Object, Object":function(t,e,r){return this(n(t),this.rules,e,r)},"string, Array":function(t,e){return this(n(t),e,{},{})},"string, Array, Object":function(t,e,r){return this(n(t),e,r,{})},"string, Array, Object, Object":function(t,e,r,i){return this(n(t),e,r,i)},"Node, Object":function(t,e){return this(t,this.rules,e,{})},"Node, Object, Object":function(t,e,n){return this(t,this.rules,e,n)},Node:function(t){return this(t,this.rules,{},{})},"Node, Array":function(t,e){return this(t,e,{},{})},"Node, Array, Object":function(t,e,n){return this(t,e,n,{})},"Node, Array, Object, Object":function(t,e,r,i){e=function(t){for(var e=[],r=0;r<t.length;r++){var i=t[r],o=void 0,a=aA(i);switch(a){case"string":var s=i.split("->");if(2!==s.length)throw SyntaxError("Could not parse rule: "+i);i={l:s[0],r:s[1]};case"object":if(o={l:N(n(i.l)),r:N(n(i.r))},i.context&&(o.evaluate=i.context),i.evaluate&&(o.evaluate=n(i.evaluate)),b(o.l)){var u=S(o.l),c=new d("_p"+A++);o.expanded={},o.expanded.l=u([o.l.clone(),c]),w(o.expanded.l),_(o.expanded.l),o.expanded.r=u([o.r,c])}break;case"function":o=i;break;default:throw TypeError("Unsupported type of rule: "+a)}e.push(o)}return e}(e);for(var o=y(t,r),a={},s=(o=N(o)).toString({parenthesis:"all"});!a[s];){a[s]=!0,A=0;for(var u=0;u<e.length;u++)"function"==typeof e[u]?o=e[u](o,i):(w(o),o=C(o,e[u])),M(o);s=o.toString({parenthesis:"all"})}return o}});function N(t){return t.transform((function(t,e,n){return zE(t)?N(t.content):t}))}E.simplifyCore=g,E.resolve=y;var T={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};E.rules=[g,{l:"log(e)",r:"1"},{l:"n-n1",r:"n+-n1"},{l:"-(c*v)",r:"(-c) * v"},{l:"-v",r:"(-1) * v"},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{l:"(n ^ n1) ^ n2",r:"n ^ (n1 * n2)"},{l:"n*n",r:"n^2"},{l:"n * n^n1",r:"n^(n1+1)"},{l:"n^n1 * n^n2",r:"n^(n1+n2)"},{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},{l:"n1*n2 + n2",r:"(n1+1)*n2"},{l:"n1*n3 + n2*n3",r:"(n1+n2)*n3"},{l:"n1 + -1 * (n2 + n3)",r:"n1 + -1 * n2 + -1 * n3"},m,{l:"(-n)*n1",r:"-(n*n1)"},{l:"c+v",r:"v+c",context:{add:{commutative:!1}}},{l:"v*c",r:"c*v",context:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"n-(n1+n2)",r:"n-n1-n2"},{l:"1*n",r:"n"},{l:"n1/(n2/n3)",r:"(n1*n3)/n2"}];var A=0,C=e("applyRule",{"Node, Object":function(t,e){var n=t;if(n instanceof p||n instanceof h){if(n.args)for(var r=0;r<n.args.length;r++)n.args[r]=C(n.args[r],e)}else n instanceof f&&n.content&&(n.content=C(n.content,e));var i=e.r,o=P(e.l,n)[0];if(!o&&e.expanded&&(i=e.expanded.r,o=P(e.expanded.l,n)[0]),o){var a=n.implicit;n=i.clone(),a&&"implicit"in i&&(n.implicit=!0),n=n.transform((function(t){return t.isSymbolNode&&WE(o.placeholders,t.name)?o.placeholders[t.name].clone():t}))}return n}});function O(t,e){var n={placeholders:{}};if(!t.placeholders&&!e.placeholders)return n;if(!t.placeholders)return e;if(!e.placeholders)return t;for(var r in t.placeholders)if(WE(t.placeholders,r)&&(n.placeholders[r]=t.placeholders[r],WE(e.placeholders,r)&&!L(t.placeholders[r],e.placeholders[r])))return null;for(var i in e.placeholders)WE(e.placeholders,i)&&(n.placeholders[i]=e.placeholders[i]);return n}function R(t,e){var n,r=[];if(0===t.length||0===e.length)return r;for(var i=0;i<t.length;i++)for(var o=0;o<e.length;o++)(n=O(t[i],e[o]))&&r.push(n);return r}function P(t,e,n){var r=[{placeholders:{}}];if(t instanceof p&&e instanceof p||t instanceof h&&e instanceof h){if(t instanceof p){if(t.op!==e.op||t.fn!==e.fn)return[]}else if(t instanceof h&&t.name!==e.name)return[];if((1!==e.args.length||1!==t.args.length)&&b(e)&&!n){if(e.args.length>=2&&2===t.args.length){for(var i=function(t,e){var n,r,i=[],o=S(t);if(x(t,e))for(var a=0;a<t.args.length;a++)(r=t.args.slice(0)).splice(a,1),n=1===r.length?r[0]:o(r),i.push(o([t.args[a],n]));else n=1===(r=t.args.slice(1)).length?r[0]:o(r),i.push(o([t.args[0],n]));return i}(e,t.context),o=[],a=0;a<i.length;a++){var s=P(t,i[a],!0);o=o.concat(s)}return o}if(t.args.length>2)throw Error("Unexpected non-binary associative function: "+t.toString());return[]}for(var u=[],f=0;f<t.args.length;f++){var m=P(t.args[f],e.args[f]);if(0===m.length)return[];u.push(m)}r=function(t){if(0===t.length)return t;for(var e=t.reduce(R),n=[],r={},i=0;i<e.length;i++){var o=JSON.stringify(e[i]);r[o]||(r[o]=!0,n.push(e[i]))}return n}(u)}else if(t instanceof d){if(0===t.name.length)throw new Error("Symbol in rule has 0 length...!?");if(T[t.name]){if(t.name!==e.name)return[]}else if("n"===t.name[0]||"_p"===t.name.substring(0,2))r[0].placeholders[t.name]=e;else if("v"===t.name[0]){if(OE(e))return[];r[0].placeholders[t.name]=e}else{if("c"!==t.name[0])throw new Error("Invalid symbol in rule: "+t.name);if(!(e instanceof l))return[];r[0].placeholders[t.name]=e}}else{if(!(t instanceof l))return[];if(!c(t.value,e.value))return[]}return r}function L(t,e){if(t instanceof l&&e instanceof l){if(!c(t.value,e.value))return!1}else if(t instanceof d&&e instanceof d){if(t.name!==e.name)return!1}else{if(!(t instanceof p&&e instanceof p||t instanceof h&&e instanceof h))return!1;if(t instanceof p){if(t.op!==e.op||t.fn!==e.fn)return!1}else if(t instanceof h&&t.name!==e.name)return!1;if(t.args.length!==e.args.length)return!1;for(var n=0;n<t.args.length;n++)if(!L(t.args[n],e.args[n]))return!1}return!0}return E})),uA=HN("rationalize",["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplify","?bignumber","?fraction","mathWithTransform","ConstantNode","OperatorNode","FunctionNode","SymbolNode","ParenthesisNode"],(function(t){var e=t.typed,n=t.equal,r=t.isZero,i=t.add,o=t.subtract,a=t.multiply,s=t.divide,u=t.pow,c=t.parse,l=t.simplify,h=t.ConstantNode,p=t.OperatorNode,f=t.FunctionNode,d=t.SymbolNode,m=t.ParenthesisNode,g=iA({typed:e,config:t.config,mathWithTransform:t.mathWithTransform,fraction:t.fraction,bignumber:t.bignumber,ConstantNode:h,OperatorNode:p,FunctionNode:f,SymbolNode:d}),y=tA({equal:n,isZero:r,add:i,subtract:o,multiply:a,divide:s,pow:u,ConstantNode:h,OperatorNode:p,FunctionNode:f,ParenthesisNode:m});return e("rationalize",{string:function(t){return this(c(t),{},!1)},"string, boolean":function(t,e){return this(c(t),{},e)},"string, Object":function(t,e){return this(c(t),e,!1)},"string, Object, boolean":function(t,e,n){return this(c(t),e,n)},Node:function(t){return this(t,{},!1)},"Node, boolean":function(t,e){return this(t,{},e)},"Node, Object":function(t,e){return this(t,e,!1)},"Node, Object, boolean":function(t,e,n){var r=function(){var t=[y,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},g,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],e=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],n=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],r={};return r.firstRules=t.concat(e,n),r.distrDivRules=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],r.sucDivRules=n,r.firstRulesAgain=t.concat(e),r.finalRules=[y,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},g,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],r}(),i=function(t,e,n,r){var i=[],o=l(t,r,e,{exactFractions:!1}),a="+-*"+((n=!!n)?"/":"");!function t(e){var n=e.type;if("FunctionNode"===n)throw new Error("There is an unsolved function call");if("OperatorNode"===n)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!XE(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");t(e.args[0])}else{if(-1===a.indexOf(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var r=0;r<e.args.length;r++)t(e.args[r])}else if("SymbolNode"===n){var o=e.name;-1===i.indexOf(o)&&i.push(o)}else if("ParenthesisNode"===n)t(e.content);else if("ConstantNode"!==n)throw new Error("type "+n+" is not allowed in polynomial expression")}(o);var s={};return s.expression=o,s.variables=i,s}(t,e,!0,r.firstRules),o=i.variables.length;if(t=i.expression,o>=1){var a,s;t=function t(e,n,r){var i=e.type,o=arguments.length>1;if("OperatorNode"===i&&e.isBinary()){var a,s=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(s=(a=parseFloat(e.args[1].value))>=2&&XE(a))),s){if(a>2){var u=e.args[0],c=new p("^","pow",[e.args[0].cloneDeep(),new h(a-1)]);e=new p("*","multiply",[u,c])}else e=new p("*","multiply",[e.args[0],e.args[0].cloneDeep()]);o&&("content"===r?n.content=e:n.args[r]=e)}}if("ParenthesisNode"===i)t(e.content,e,"content");else if("ConstantNode"!==i&&"SymbolNode"!==i)for(var l=0;l<e.args.length;l++)t(e.args[l],e,l);if(!o)return e}(t);var u,c=!0,f=!1;for(t=l(t,r.firstRules,{},{exactFractions:!1});s=c?r.distrDivRules:r.sucDivRules,c=!c,(u=(t=l(t,s)).toString())!==a;)f=!0,a=u;f&&(t=l(t,r.firstRulesAgain,{},{exactFractions:!1})),t=l(t,r.finalRules,{},{exactFractions:!1})}var d=[],m={};return"OperatorNode"===t.type&&t.isBinary()&&"/"===t.op?(1===o&&(t.args[0]=v(t.args[0],d),t.args[1]=v(t.args[1])),n&&(m.numerator=t.args[0],m.denominator=t.args[1])):(1===o&&(t=v(t,d)),n&&(m.numerator=t,m.denominator=null)),n?(m.coefficients=d,m.variables=i.variables,m.expression=t,m):t}});function v(t,e){void 0===e&&(e=[]),e[0]=0;var n=0,r="";!function t(i,o,a){var s=i.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(-1==="+-*^".indexOf(i.op))throw new Error("Operator "+i.op+" invalid");if(null!==o){if(("unaryMinus"===i.fn||"pow"===i.fn)&&"add"!==o.fn&&"subtract"!==o.fn&&"multiply"!==o.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"multiply"===i.fn)&&"add"!==o.fn&&"subtract"!==o.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"unaryMinus"===i.fn)&&0!==a.noFil)throw new Error("Invalid "+i.op+" placing")}"^"!==i.op&&"*"!==i.op||(a.fire=i.op);for(var u=0;u<i.args.length;u++)"unaryMinus"===i.fn&&(a.oper="-"),"+"!==i.op&&"subtract"!==i.fn||(a.fire="",a.cte=1,a.oper=0===u?"+":i.op),a.noFil=u,t(i.args[u],i,a)}else if("SymbolNode"===s){if(i.name!==r&&""!==r)throw new Error("There is more than one variable");if(r=i.name,null===o)return void(e[1]=1);if("^"===o.op&&0!==a.noFil)throw new Error("In power the variable should be the first parameter");if("*"===o.op&&1!==a.noFil)throw new Error("In multiply the variable should be the second parameter");""!==a.fire&&"*"!==a.fire||(n<1&&(e[1]=0),e[1]+=a.cte*("+"===a.oper?1:-1),n=Math.max(1,n))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var c=parseFloat(i.value);if(null===o)return void(e[0]=c);if("^"===o.op){if(1!==a.noFil)throw new Error("Constant cannot be powered");if(!XE(c)||c<=0)throw new Error("Non-integer exponent is not allowed");for(var l=n+1;l<c;l++)e[l]=0;return c>n&&(e[c]=0),e[c]+=a.cte*("+"===a.oper?1:-1),void(n=Math.max(c,n))}a.cte=c,""===a.fire&&(e[0]+=a.cte*("+"===a.oper?1:-1))}}(t,null,{cte:1,oper:"+",fire:""});for(var i,o=!0,a=n=e.length-1;a>=0;a--)if(0!==e[a]){var s=new h(o?e[a]:Math.abs(e[a])),u=e[a]<0?"-":"+";if(a>0){var c=new d(r);if(a>1){var l=new h(a);c=new p("^","pow",[c,l])}s=-1===e[a]&&o?new p("-","unaryMinus",[c]):1===Math.abs(e[a])?c:new p("*","multiply",[s,c])}i=o?s:"+"===u?new p("+","add",[i,s]):new p("-","subtract",[i,s]),o=!1}return o?new h(0):i}})),cA=HN("Parser",["parse"],(function(t){var e=t.parse;function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}return n.prototype.type="Parser",n.prototype.isParser=!0,n.prototype.evaluate=function(t){return e(t).compile().evaluate(this.scope)},n.prototype.get=function(t){return t in this.scope?iT(this.scope,t):void 0},n.prototype.getAll=function(){return GE({},this.scope)},n.prototype.set=function(t,e){return oT(this.scope,t,e)},n.prototype.remove=function(t){delete this.scope[t]},n.prototype.clear=function(){for(var t in this.scope)WE(this.scope,t)&&delete this.scope[t]},n}),{isClass:!0}),lA=HN("parser",["typed","Parser"],(function(t){var e=t.Parser;return(0,t.typed)("parser",{"":function(){return new e}})})),hA=HN("derivative",["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(function(t){var e=t.typed,n=t.config,r=t.parse,i=t.simplify,o=t.equal,a=t.isZero,s=t.numeric,u=t.ConstantNode,c=t.FunctionNode,l=t.OperatorNode,h=t.ParenthesisNode,p=t.SymbolNode,f=e("derivative",{"Node, SymbolNode, Object":function(t,e,n){var r={};m(r,t,e.name);var o=g(t,r);return n.simplify?i(o):o},"Node, SymbolNode":function(t,e){return this(t,e,{simplify:!0})},"string, SymbolNode":function(t,e){return this(r(t),e)},"string, SymbolNode, Object":function(t,e,n){return this(r(t),e,n)},"string, string":function(t,e){return this(r(t),r(e))},"string, string, Object":function(t,e,n){return this(r(t),r(e),n)},"Node, string":function(t,e){return this(t,r(e))},"Node, string, Object":function(t,e,n){return this(t,r(e),n)}});f._simplify=!0,f.toTex=function(t){return d.apply(null,t.args)};var d=e("_derivTex",{"Node, SymbolNode":function(t,e){return OE(t)&&"string"===jE(t.value)?d(r(t.value).toString(),e.toString(),1):d(t.toString(),e.toString(),1)},"Node, ConstantNode":function(t,e){if("string"===jE(e.value))return d(t,r(e.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(t,e,n){return d(t.toString(),e.name,n.value)},"string, string, number":function(t,e,n){return(1===n?"{d\\over d"+e+"}":"{d^{"+n+"}\\over d"+e+"^{"+n+"}}")+"\\left[".concat(t,"\\right]")}}),m=e("constTag",{"Object, ConstantNode, string":function(t,e){return t[e]=!0,!0},"Object, SymbolNode, string":function(t,e,n){return e.name!==n&&(t[e]=!0,!0)},"Object, ParenthesisNode, string":function(t,e,n){return m(t,e.content,n)},"Object, FunctionAssignmentNode, string":function(t,e,n){return-1===e.params.indexOf(n)?(t[e]=!0,!0):m(t,e.expr,n)},"Object, FunctionNode | OperatorNode, string":function(t,e,n){if(e.args.length>0){for(var r=m(t,e.args[0],n),i=1;i<e.args.length;++i)r=m(t,e.args[i],n)&&r;if(r)return t[e]=!0,!0}return!1}}),g=e("_derivative",{"ConstantNode, Object":function(t){return y(0)},"SymbolNode, Object":function(t,e){return y(void 0!==e[t]?0:1)},"ParenthesisNode, Object":function(t,e){return new h(g(t.content,e))},"FunctionAssignmentNode, Object":function(t,e){return void 0!==e[t]?y(0):g(t.expr,e)},"FunctionNode, Object":function(t,e){if(1!==t.args.length&&function(t){if("log"!==t.name&&"nthRoot"!==t.name&&"pow"!==t.name||2!==t.args.length){for(var e=0;e<t.args.length;++e)t.args[e]=y(0);throw t.compile().evaluate(),new Error("Expected TypeError, but none found")}}(t),void 0!==e[t])return y(0);var n,r,i,o,a=t.args[0],s=!1,u=!1;switch(t.name){case"cbrt":s=!0,r=new l("*","multiply",[y(3),new l("^","pow",[a,new l("/","divide",[y(2),y(3)])])]);break;case"sqrt":case"nthRoot":if(1===t.args.length)s=!0,r=new l("*","multiply",[y(2),new c("sqrt",[a])]);else if(2===t.args.length)return e[n=new l("/","divide",[y(1),t.args[1]])]=e[t.args[1]],g(new l("^","pow",[a,n]),e);break;case"log10":n=y(10);case"log":if(n||1!==t.args.length){if(1===t.args.length&&n||2===t.args.length&&void 0!==e[t.args[1]])r=new l("*","multiply",[a.clone(),new c("log",[n||t.args[1]])]),s=!0;else if(2===t.args.length)return g(new l("/","divide",[new c("log",[a]),new c("log",[t.args[1]])]),e)}else r=a.clone(),s=!0;break;case"pow":return e[n]=e[t.args[1]],g(new l("^","pow",[a,t.args[1]]),e);case"exp":r=new c("exp",[a.clone()]);break;case"sin":r=new c("cos",[a.clone()]);break;case"cos":r=new l("-","unaryMinus",[new c("sin",[a.clone()])]);break;case"tan":r=new l("^","pow",[new c("sec",[a.clone()]),y(2)]);break;case"sec":r=new l("*","multiply",[t,new c("tan",[a.clone()])]);break;case"csc":u=!0,r=new l("*","multiply",[t,new c("cot",[a.clone()])]);break;case"cot":u=!0,r=new l("^","pow",[new c("csc",[a.clone()]),y(2)]);break;case"asin":s=!0,r=new c("sqrt",[new l("-","subtract",[y(1),new l("^","pow",[a.clone(),y(2)])])]);break;case"acos":s=!0,u=!0,r=new c("sqrt",[new l("-","subtract",[y(1),new l("^","pow",[a.clone(),y(2)])])]);break;case"atan":s=!0,r=new l("+","add",[new l("^","pow",[a.clone(),y(2)]),y(1)]);break;case"asec":s=!0,r=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),y(2)]),y(1)])])]);break;case"acsc":s=!0,u=!0,r=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),y(2)]),y(1)])])]);break;case"acot":s=!0,u=!0,r=new l("+","add",[new l("^","pow",[a.clone(),y(2)]),y(1)]);break;case"sinh":r=new c("cosh",[a.clone()]);break;case"cosh":r=new c("sinh",[a.clone()]);break;case"tanh":r=new l("^","pow",[new c("sech",[a.clone()]),y(2)]);break;case"sech":u=!0,r=new l("*","multiply",[t,new c("tanh",[a.clone()])]);break;case"csch":u=!0,r=new l("*","multiply",[t,new c("coth",[a.clone()])]);break;case"coth":u=!0,r=new l("^","pow",[new c("csch",[a.clone()]),y(2)]);break;case"asinh":s=!0,r=new c("sqrt",[new l("+","add",[new l("^","pow",[a.clone(),y(2)]),y(1)])]);break;case"acosh":s=!0,r=new c("sqrt",[new l("-","subtract",[new l("^","pow",[a.clone(),y(2)]),y(1)])]);break;case"atanh":s=!0,r=new l("-","subtract",[y(1),new l("^","pow",[a.clone(),y(2)])]);break;case"asech":s=!0,u=!0,r=new l("*","multiply",[a.clone(),new c("sqrt",[new l("-","subtract",[y(1),new l("^","pow",[a.clone(),y(2)])])])]);break;case"acsch":s=!0,u=!0,r=new l("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new l("+","add",[new l("^","pow",[a.clone(),y(2)]),y(1)])])]);break;case"acoth":s=!0,u=!0,r=new l("-","subtract",[y(1),new l("^","pow",[a.clone(),y(2)])]);break;case"abs":r=new l("/","divide",[new c(new p("abs"),[a.clone()]),a.clone()]);break;case"gamma":default:throw new Error('Function "'+t.name+'" is not supported by derivative, or a wrong number of arguments is passed')}s?(i="/",o="divide"):(i="*",o="multiply");var h=g(a,e);return u&&(h=new l("-","unaryMinus",[h])),new l(i,o,[h,r])},"OperatorNode, Object":function(t,e){if(void 0!==e[t])return y(0);if("+"===t.op)return new l(t.op,t.fn,t.args.map((function(t){return g(t,e)})));if("-"===t.op){if(t.isUnary())return new l(t.op,t.fn,[g(t.args[0],e)]);if(t.isBinary())return new l(t.op,t.fn,[g(t.args[0],e),g(t.args[1],e)])}if("*"===t.op){var n=t.args.filter((function(t){return void 0!==e[t]}));if(n.length>0){var r=t.args.filter((function(t){return void 0===e[t]})),i=1===r.length?r[0]:new l("*","multiply",r),s=n.concat(g(i,e));return new l("*","multiply",s)}return new l("+","add",t.args.map((function(n){return new l("*","multiply",t.args.map((function(t){return t===n?g(t,e):t.clone()})))})))}if("/"===t.op&&t.isBinary()){var u=t.args[0],h=t.args[1];return void 0!==e[h]?new l("/","divide",[g(u,e),h]):void 0!==e[u]?new l("*","multiply",[new l("-","unaryMinus",[u]),new l("/","divide",[g(h,e),new l("^","pow",[h.clone(),y(2)])])]):new l("/","divide",[new l("-","subtract",[new l("*","multiply",[g(u,e),h.clone()]),new l("*","multiply",[u.clone(),g(h,e)])]),new l("^","pow",[h.clone(),y(2)])])}if("^"===t.op&&t.isBinary()){var p=t.args[0],f=t.args[1];if(void 0!==e[p])return OE(p)&&(a(p.value)||o(p.value,1))?y(0):new l("*","multiply",[t,new l("*","multiply",[new c("log",[p.clone()]),g(f.clone(),e)])]);if(void 0!==e[f]){if(OE(f)){if(a(f.value))return y(0);if(o(f.value,1))return g(p,e)}var d=new l("^","pow",[p.clone(),new l("-","subtract",[f,y(1)])]);return new l("*","multiply",[f.clone(),new l("*","multiply",[g(p,e),d])])}return new l("*","multiply",[new l("^","pow",[p.clone(),f.clone()]),new l("+","add",[new l("*","multiply",[g(p,e),new l("/","divide",[f.clone(),p.clone()])]),new l("*","multiply",[g(f,e),new c("log",[p.clone()])])])])}throw new Error('Operator "'+t.op+'" is not supported by derivative, or a wrong number of arguments is passed')}});function y(t,e){return new u(s(t,e||n.number))}return f})),pA=HN("apply",["typed","isInteger"],(function(t){var e=t.isInteger;return(0,t.typed)("apply",{"Array | Matrix, number | BigNumber, function":function(t,n,r){if(!e(n))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(t)?NN(t):t.size();if(n<0||n>=i.length)throw new EN(n,i.length);return lE(t)?t.create(fA(t.valueOf(),n,r)):fA(t,n,r)}})}));function fA(t,e,n){var r,i,o;if(e<=0){if(Array.isArray(t[0])){for(o=function(t){var e,n,r=t.length,i=t[0].length,o=[];for(n=0;n<i;n++){var a=[];for(e=0;e<r;e++)a.push(t[e][n]);o.push(a)}return o}(t),i=[],r=0;r<o.length;r++)i[r]=fA(o[r],e-1,n);return i}return n(t)}for(i=[],r=0;r<t.length;r++)i[r]=fA(t[r],e-1,n);return i}var dA=HN("apply",["typed","isInteger"],(function(t){var e=t.typed,n=pA({typed:e,isInteger:t.isInteger});return e("apply",{"...any":function(t){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1));try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0});function mA(t){return(mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gA(t,e){return function n(){"object"!==mA(n.cache)&&(n.cache={});for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e(r):JSON.stringify(r);return o in n.cache||(n.cache[o]=t.apply(t,r)),n.cache[o]}}function yA(t){return Object.keys(t.signatures||{}).reduce((function(t,e){var n=(e.match(/,/g)||[]).length+1;return Math.max(t,n)}),-1)}function vA(t,e,n){var r=t.filter((function(t){return UE(t)&&!(t.name in e)&&!(t.name in n)}))[0];if(!r)throw new Error('No undefined variable found in inline expression "'+t+'"');var i=r.name,o=Object.create(n),a=t.compile();return function(t){return o[i]=t,a.evaluate(o)}}var xA=HN("filter",["typed"],(function(t){var e=t.typed;function n(t,e,n){var i,o;return t[0]&&(i=t[0].compile().evaluate(n)),t[1]&&(o=UE(t[1])||RE(t[1])?t[1].compile().evaluate(n):vA(t[1],e,n)),r(i,o)}n.rawArgs=!0;var r=e("filter",{"Array, function":bA,"Matrix, function":function(t,e){return t.create(bA(t.toArray(),e))},"Array, RegExp":zN,"Matrix, RegExp":function(t,e){return t.create(zN(t.toArray(),e))}});return n}),{isTransformFunction:!0});function bA(t,e){var n=yA(e);return kN(t,(function(t,r,i){return 1===n?e(t):2===n?e(t,[r+1]):e(t,[r+1],i)}))}var wA=HN("map",["typed"],(function(t){var e=t.typed;function n(t,e,n){var i,o;return t[0]&&(i=t[0].compile().evaluate(n)),t[1]&&(o=UE(t[1])||RE(t[1])?t[1].compile().evaluate(n):vA(t[1],e,n)),r(i,o)}n.rawArgs=!0;var r=e("map",{"Array, function":function(t,e){return _A(t,e,t)},"Matrix, function":function(t,e){return t.create(_A(t.valueOf(),e,t))}});return n}),{isTransformFunction:!0});function _A(t,e,n){var r=yA(e);return function t(i,o){return Array.isArray(i)?IN(i,(function(e,n){return t(e,o.concat(n+1))})):1===r?e(i):2===r?e(i,o):e(i,o,n)}(t,[])}var MA=HN("forEach",["typed"],(function(t){var e=t.typed;function n(t,e,n){var i,o;return t[0]&&(i=t[0].compile().evaluate(n)),t[1]&&(o=UE(t[1])||RE(t[1])?t[1].compile().evaluate(n):vA(t[1],e,n)),r(i,o)}n.rawArgs=!0;var r=e("forEach",{"Array | Matrix, function":function(t,e){var n=yA(e);!function r(i,o){Array.isArray(i)?DN(i,(function(t,e){r(t,o.concat(e+1))})):1===n?e(i):2===n?e(i,o):e(i,o,t)}(t.valueOf(),[])}});return n}),{isTransformFunction:!0}),SA=HN("subset",["typed","matrix"],(function(t){var e=t.matrix;return(0,t.typed)("subset",{"Array, Index":function(t,n){var r=e(t).subset(n);return n.isScalar()?r:r.valueOf()},"Matrix, Index":function(t,e){return t.subset(e)},"Object, Index":TA,"string, Index":EA,"Array, Index, any":function(t,n,r){return e(VE(t)).subset(n,r,void 0).valueOf()},"Array, Index, any, any":function(t,n,r,i){return e(VE(t)).subset(n,r,i).valueOf()},"Matrix, Index, any":function(t,e,n){return t.clone().subset(e,n)},"Matrix, Index, any, any":function(t,e,n,r){return t.clone().subset(e,n,r)},"string, Index, string":NA,"string, Index, string, string":NA,"Object, Index, any":AA})}));function EA(t,e){if(!mE(e))throw new TypeError("Index expected");if(1!==e.size().length)throw new SN(e.size().length,1);var n=t.length;AN(e.min()[0],n),AN(e.max()[0],n);var r=e.dimension(0),i="";return r.forEach((function(e){i+=t.charAt(e)})),i}function NA(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Index expected");if(1!==e.size().length)throw new SN(e.size().length,1);if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=e.dimension(0);if(i.size()[0]!==n.length)throw new SN(i.size()[0],n.length);var o=t.length;AN(e.min()[0]),AN(e.max()[0]);for(var a=[],s=0;s<o;s++)a[s]=t.charAt(s);if(i.forEach((function(t,e){a[t]=n.charAt(e[0])})),a.length>o)for(var u=o-1,c=a.length;u<c;u++)a[u]||(a[u]=r);return a.join("")}function TA(t,e){if(1!==e.size().length)throw new SN(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");return iT(t,n)}function AA(t,e,n){if(1!==e.size().length)throw new SN(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");var i=VE(t);return oT(i,r,n),i}var CA=HN("subset",["typed","matrix"],(function(t){var e=t.typed,n=SA({typed:e,matrix:t.matrix});return e("subset",{"...any":function(t){try{return n.apply(null,t)}catch(e){throw NT(e)}}})}),{isTransformFunction:!0}),OA=HN("index",["Index"],(function(t){var e=t.Index;return function(){for(var t=[],n=0,r=arguments.length;n<r;n++){var i=arguments[n];if(dE(i))i.start--,i.end-=i.step>0?0:2;else if(i&&!0===i.isSet)i=i.map((function(t){return t-1}));else if(cE(i)||lE(i))i=i.map((function(t){return t-1}));else if(rE(i))i--;else if(iE(i))i=i.toNumber()-1;else if("string"!=typeof i)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");t[n]=i}var o=new e;return e.apply(o,t),o}}),{isTransformFunction:!0}),RA=HN("concat",["typed","matrix","isInteger"],(function(t){var e=t.matrix,n=t.isInteger;return(0,t.typed)("concat",{"...Array | Matrix | number | BigNumber":function(t){var r,i,o=t.length,a=-1,s=!1,u=[];for(r=0;r<o;r++){var c=t[r];if(lE(c)&&(s=!0),rE(c)||iE(c)){if(r!==o-1)throw new Error("Dimension must be specified as last argument");if(i=a,a=c.valueOf(),!n(a))throw new TypeError("Integer number expected for dimension");if(a<0||r>0&&a>i)throw new EN(a,i+1)}else{var l=VE(c).valueOf(),h=NN(l);if(u[r]=l,i=a,a=h.length-1,r>0&&a!==i)throw new SN(i+1,a+1)}}if(0===u.length)throw new SyntaxError("At least one matrix expected");for(var p=u.shift();u.length;)p=PA(p,u.shift(),a,0);return s?e(p):p},"...string":function(t){return t.join("")}})}));function PA(t,e,n,r){if(r<n){if(t.length!==e.length)throw new SN(t.length,e.length);for(var i=[],o=0;o<t.length;o++)i[o]=PA(t[o],e[o],n,r+1);return i}return t.concat(e)}var LA=HN("concat",["typed","matrix","isInteger"],(function(t){var e=t.typed,n=RA({typed:e,matrix:t.matrix,isInteger:t.isInteger});return e("concat",{"...any":function(t){var e=t.length-1,r=t[e];rE(r)?t[e]=r-1:iE(r)&&(t[e]=r.minus(1));try{return n.apply(null,t)}catch(i){throw NT(i)}}})}),{isTransformFunction:!0});function IA(t,e,n){var r;return-1!==String(t).indexOf("Unexpected type")?(r=arguments.length>2?" (type: "+jE(n)+", value: "+JSON.stringify(n)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+r)):-1!==String(t).indexOf("complex numbers")?(r=arguments.length>2?" (type: "+jE(n)+", value: "+JSON.stringify(n)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+r)):t}var DA=HN("max",["typed","config","numeric","larger"],(function(t){var e=t.config,n=t.numeric,r=t.larger;return(0,t.typed)("max",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(t,e){return jT(t,e.valueOf(),i)},"...":function(t){if(BT(t))throw new TypeError("Scalar values expected in function max");return o(t)}});function i(t,e){try{return r(t,e)?t:e}catch(n){throw IA(n,"max",e)}}function o(t){var i;if(UT(t,(function(t){try{isNaN(t)&&"number"==typeof t?i=NaN:(void 0===i||r(t,i))&&(i=t)}catch(e){throw IA(e,"max",t)}})),void 0===i)throw new Error("Cannot calculate max of an empty array");return"string"==typeof i&&(i=n(i,e.number)),i}})),kA=HN("max",["typed","config","numeric","larger"],(function(t){var e=t.typed,n=DA({typed:e,config:t.config,numeric:t.numeric,larger:t.larger});return e("max",{"...any":function(t){if(2===t.length&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),zA=HN("min",["typed","config","numeric","smaller"],(function(t){var e=t.config,n=t.numeric,r=t.smaller;return(0,t.typed)("min",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(t,e){return jT(t,e.valueOf(),i)},"...":function(t){if(BT(t))throw new TypeError("Scalar values expected in function min");return o(t)}});function i(t,e){try{return r(t,e)?t:e}catch(n){throw IA(n,"min",e)}}function o(t){var i;if(UT(t,(function(t){try{isNaN(t)&&"number"==typeof t?i=NaN:(void 0===i||r(t,i))&&(i=t)}catch(e){throw IA(e,"min",t)}})),void 0===i)throw new Error("Cannot calculate min of an empty array");return"string"==typeof i&&(i=n(i,e.number)),i}})),BA=HN("min",["typed","config","numeric","smaller"],(function(t){var e=t.typed,n=zA({typed:e,config:t.config,numeric:t.numeric,smaller:t.smaller});return e("min",{"...any":function(t){if(2===t.length&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),UA=HN("sum",["typed","config","add","numeric"],(function(t){var e=t.config,n=t.add,r=t.numeric;return(0,t.typed)("sum",{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(t,e){try{return jT(t,e,n)}catch(r){throw IA(r,"sum")}},"...":function(t){if(BT(t))throw new TypeError("Scalar values expected in function sum");return i(t)}});function i(t){var i;return UT(t,(function(t){try{i=void 0===i?t:n(i,t)}catch(e){throw IA(e,"sum",t)}})),void 0===i&&(i=r(0,e.number)),"string"==typeof i&&(i=r(i,e.number)),i}})),FA=HN("sum",["typed","config","add","numeric"],(function(t){var e=t.typed,n=UA({typed:e,config:t.config,add:t.add,numeric:t.numeric});return e("sum",{"...any":function(t){if(2===t.length&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),jA=HN("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq"],(function(t){var e=t.config,n=t.matrix,r=t.bignumber,i=t.smaller,o=t.smallerEq,a=t.larger,s=t.largerEq;return(0,t.typed)("range",{string:c,"string, boolean":c,"number, number":function(t,e){return u(l(t,e,1))},"number, number, number":function(t,e,n){return u(l(t,e,n))},"number, number, boolean":function(t,e,n){return u(n?h(t,e,1):l(t,e,1))},"number, number, number, boolean":function(t,e,n,r){return u(r?h(t,e,n):l(t,e,n))},"BigNumber, BigNumber":function(t,e){return u(p(t,e,new(0,t.constructor)(1)))},"BigNumber, BigNumber, BigNumber":function(t,e,n){return u(p(t,e,n))},"BigNumber, BigNumber, boolean":function(t,e,n){var r=t.constructor;return u(n?f(t,e,new r(1)):p(t,e,new r(1)))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,n,r){return u(r?f(t,e,n):p(t,e,n))}});function u(t){return"Matrix"===e.matrix?n?n(t):rA():t}function c(t,n){var i=function(t){var e=t.split(":").map((function(t){return Number(t)}));if(e.some((function(t){return isNaN(t)})))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(t);if(!i)throw new SyntaxError('String "'+t+'" is no valid range');return"BigNumber"===e.number?(void 0===r&&eA(),u((n?f:p)(r(i.start),r(i.end),r(i.step)))):u((n?h:l)(i.start,i.end,i.step))}function l(t,e,n){var r=[],o=t;if(n>0)for(;i(o,e);)r.push(o),o+=n;else if(n<0)for(;a(o,e);)r.push(o),o+=n;return r}function h(t,e,n){var r=[],i=t;if(n>0)for(;o(i,e);)r.push(i),i+=n;else if(n<0)for(;s(i,e);)r.push(i),i+=n;return r}function p(t,e,n){var o=r(0),s=[],u=t;if(n.gt(o))for(;i(u,e);)s.push(u),u=u.plus(n);else if(n.lt(o))for(;a(u,e);)s.push(u),u=u.plus(n);return s}function f(t,e,n){var i=r(0),a=[],u=t;if(n.gt(i))for(;o(u,e);)a.push(u),u=u.plus(n);else if(n.lt(i))for(;s(u,e);)a.push(u),u=u.plus(n);return a}})),HA=HN("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq"],(function(t){var e=t.typed,n=jA({typed:e,config:t.config,matrix:t.matrix,bignumber:t.bignumber,smaller:t.smaller,smallerEq:t.smallerEq,larger:t.larger,largerEq:t.largerEq});return e("range",{"...any":function(t){return"boolean"!=typeof t[t.length-1]&&t.push(!0),n.apply(null,t)}})}),{isTransformFunction:!0}),VA=HN("column",["typed","Index","matrix","range"],(function(t){var e=t.Index,n=t.matrix,r=t.range;return(0,t.typed)("column",{"Matrix, number":i,"Array, number":function(t,e){return i(n(VE(t)),e).valueOf()}});function i(t,n){if(2!==t.size().length)throw new Error("Only two dimensional matrix is supported");AN(n,t.size()[1]);var i=r(0,t.size()[0]),o=new e(i,n);return t.subset(o)}})),GA=HN("column",["typed","Index","matrix","range"],(function(t){var e=t.typed,n=VA({typed:e,Index:t.Index,matrix:t.matrix,range:t.range});return e("column",{"...any":function(t){var e=t.length-1,r=t[e];rE(r)&&(t[e]=r-1);try{return n.apply(null,t)}catch(i){throw NT(i)}}})}),{isTransformFunction:!0}),qA=HN("row",["typed","Index","matrix","range"],(function(t){var e=t.Index,n=t.matrix,r=t.range;return(0,t.typed)("row",{"Matrix, number":i,"Array, number":function(t,e){return i(n(VE(t)),e).valueOf()}});function i(t,n){if(2!==t.size().length)throw new Error("Only two dimensional matrix is supported");AN(n,t.size()[0]);var i=r(0,t.size()[1]),o=new e(n,i);return t.subset(o)}})),WA=HN("row",["typed","Index","matrix","range"],(function(t){var e=t.typed,n=qA({typed:e,Index:t.Index,matrix:t.matrix,range:t.range});return e("row",{"...any":function(t){var e=t.length-1,r=t[e];rE(r)&&(t[e]=r-1);try{return n.apply(null,t)}catch(i){throw NT(i)}}})}),{isTransformFunction:!0}),ZA=HN("std",["typed","sqrt","variance"],(function(t){var e=t.sqrt,n=t.variance;return(0,t.typed)("std",{"Array | Matrix":r,"Array | Matrix, string":r,"Array | Matrix, number | BigNumber":r,"Array | Matrix, number | BigNumber, string":r,"...":function(t){return r(t)}});function r(t,r){if(0===t.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{return e(n.apply(null,arguments))}catch(i){throw i instanceof TypeError&&-1!==i.message.indexOf(" variance")?new TypeError(i.message.replace(" variance"," std")):i}}})),$A=HN("std",["typed","sqrt","variance"],(function(t){var e=t.typed,n=ZA({typed:e,sqrt:t.sqrt,variance:t.variance});return e("std",{"...any":function(t){if(t.length>=2&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),YA=HN("mean",["typed","add","divide"],(function(t){var e=t.add,n=t.divide;return(0,t.typed)("mean",{"Array | Matrix":r,"Array | Matrix, number | BigNumber":function(t,r){try{var i=jT(t,r,e),o=Array.isArray(t)?NN(t):t.size();return n(i,o[r])}catch(a){throw IA(a,"mean")}},"...":function(t){if(BT(t))throw new TypeError("Scalar values expected in function mean");return r(t)}});function r(t){var r,i=0;if(UT(t,(function(t){try{r=void 0===r?t:e(r,t),i++}catch(n){throw IA(n,"mean",t)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return n(r,i)}})),XA=HN("mean",["typed","add","divide"],(function(t){var e=t.typed,n=YA({typed:e,add:t.add,divide:t.divide});return e("mean",{"...any":function(t){if(2===t.length&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),JA=HN("variance",["typed","add","subtract","multiply","divide","apply","isNaN"],(function(t){var e=t.add,n=t.subtract,r=t.multiply,i=t.divide,o=t.apply,a=t.isNaN;return(0,t.typed)("variance",{"Array | Matrix":function(t){return s(t,"unbiased")},"Array | Matrix, string":s,"Array | Matrix, number | BigNumber":function(t,e){return u(t,e,"unbiased")},"Array | Matrix, number | BigNumber, string":u,"...":function(t){return s(t,"unbiased")}});function s(t,o){var s=0,u=0;if(0===t.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(UT(t,(function(t){try{s=e(s,t),u++}catch(n){throw IA(n,"variance",t)}})),0===u)throw new Error("Cannot calculate variance of an empty array");var c=i(s,u);if(s=0,UT(t,(function(t){var i=n(t,c);s=e(s,r(i,i))})),a(s))return s;switch(o){case"uncorrected":return i(s,u);case"biased":return i(s,u+1);case"unbiased":var l=iE(s)?s.mul(0):0;return 1===u?l:i(s,u-1);default:throw new Error('Unknown normalization "'+o+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(t,e,n){try{if(0===t.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return o(t,e,(function(t){return s(t,n)}))}catch(r){throw IA(r,"variance")}}})),QA=HN("variance",["typed","add","subtract","multiply","divide","apply","isNaN"],(function(t){var e=t.typed,n=JA({typed:e,add:t.add,subtract:t.subtract,multiply:t.multiply,divide:t.divide,apply:t.apply,isNaN:t.isNaN});return e("variance",{"...any":function(t){if(t.length>=2&&hE(t[0])){var e=t[1];rE(e)?t[1]=e-1:iE(e)&&(t[1]=e.minus(1))}try{return n.apply(null,t)}catch(r){throw NT(r)}}})}),{isTransformFunction:!0}),KA=HN("ResultSet",[],(function(){function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return t.prototype.type="ResultSet",t.prototype.isResultSet=!0,t.prototype.valueOf=function(){return this.entries},t.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},t.fromJSON=function(e){return new t(e.entries)},t}),{isClass:!0}),tC=n("50bv"),eC=n.n(tC);function nC(t){return(nC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var rC=HN("Complex",[],(function(){return eC.a.prototype.type="Complex",eC.a.prototype.isComplex=!0,eC.a.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},eC.a.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},eC.a.prototype.format=function(t){var e=this.im,n=this.re,r=rN(this.re,t),i=rN(this.im,t),o=rE(t)?t:t?t.precision:null;if(null!==o){var a=Math.pow(10,-o);Math.abs(n/e)<a&&(n=0),Math.abs(e/n)<a&&(e=0)}return 0===e?r:0===n?1===e?"i":-1===e?"-i":i+"i":e<0?-1===e?r+" - i":r+" - "+i.substring(1)+"i":1===e?r+" + i":r+" + "+i+"i"},eC.a.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"===nC(e))return eC()(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(rE(n)){if(sE(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),rE(r))return new eC.a({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},eC.a.prototype.valueOf=eC.a.prototype.toString,eC.a.fromJSON=function(t){return new eC.a(t)},eC.a.compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},eC.a}),{isClass:!0}),iC=HN("Range",[],(function(){function t(e,n,r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");var i=null!=e,o=null!=n,a=null!=r;if(i)if(iE(e))e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter start must be a number");if(o)if(iE(n))n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter end must be a number");if(a)if(iE(r))r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter step must be a number");this.start=i?parseFloat(e):0,this.end=o?parseFloat(n):0,this.step=a?parseFloat(r):1}return t.prototype.type="Range",t.prototype.isRange=!0,t.parse=function(e){if("string"!=typeof e)return null;var n=e.split(":").map((function(t){return parseFloat(t)}));if(n.some((function(t){return isNaN(t)})))return null;switch(n.length){case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[2],n[1]);default:return null}},t.prototype.clone=function(){return new t(this.start,this.end,this.step)},t.prototype.size=function(){var t=0,e=this.step,n=this.end-this.start;return JE(e)===JE(n)?t=Math.ceil(n/e):0===n&&(t=0),isNaN(t)&&(t=0),[t]},t.prototype.min=function(){var t=this.size()[0];return t>0?this.step>0?this.start:this.start+(t-1)*this.step:void 0},t.prototype.max=function(){var t=this.size()[0];return t>0?this.step>0?this.start+(t-1)*this.step:this.start:void 0},t.prototype.forEach=function(t){var e=this.start,n=this.step,r=this.end,i=0;if(n>0)for(;e<r;)t(e,[i],this),e+=n,i++;else if(n<0)for(;e>r;)t(e,[i],this),e+=n,i++},t.prototype.map=function(t){var e=[];return this.forEach((function(n,r,i){e[r[0]]=t(n,r,i)})),e},t.prototype.toArray=function(){var t=[];return this.forEach((function(e,n){t[n[0]]=e})),t},t.prototype.valueOf=function(){return this.toArray()},t.prototype.format=function(t){var e=rN(this.start,t);return 1!==this.step&&(e+=":"+rN(this.step,t)),e+":"+rN(this.end,t)},t.prototype.toString=function(){return this.format()},t.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},t.fromJSON=function(e){return new t(e.start,e.end,e.step)},t}),{isClass:!0}),oC=gA((function(t){return new t(1).exp()}),cC),aC=gA((function(t){return new t(1).plus(new t(5).sqrt()).div(2)}),cC),sC=gA((function(t){return t.acos(-1)}),cC),uC=gA((function(t){return sC(t).times(2)}),cC);function cC(t){return t[0].precision}var lC=Math.PI,hC=2*Math.PI,pC=Math.E,fC=HN("true",[],(function(){return!0})),dC=HN("false",[],(function(){return!1})),mC=HN("null",[],(function(){return null})),gC=OC("Infinity",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(1/0):1/0})),yC=OC("NaN",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(NaN):NaN})),vC=OC("pi",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?sC(t.BigNumber):lC})),xC=OC("tau",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?uC(t.BigNumber):hC})),bC=OC("e",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?oC(t.BigNumber):pC})),wC=OC("phi",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?aC(t.BigNumber):1.618033988749895})),_C=OC("LN2",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(2).ln():Math.LN2})),MC=OC("LN10",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(10).ln():Math.LN10})),SC=OC("LOG2E",["config","?BigNumber"],(function(t){var e=t.BigNumber;return"BigNumber"===t.config.number?new e(1).div(new e(2).ln()):Math.LOG2E})),EC=OC("LOG10E",["config","?BigNumber"],(function(t){var e=t.BigNumber;return"BigNumber"===t.config.number?new e(1).div(new e(10).ln()):Math.LOG10E})),NC=OC("SQRT1_2",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)("0.5").sqrt():Math.SQRT1_2})),TC=OC("SQRT2",["config","?BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(2).sqrt():Math.SQRT2})),AC=OC("i",["Complex"],(function(t){return t.Complex.I})),CC=HN("version",[],(function(){return"7.1.0"}));function OC(t,e,n){return HN(t,e,n,{recreateOnConfigChange:!0})}var RC=n("oeuD"),PC=n.n(RC),LC=HN("BigNumber",["?on","config"],(function(t){var e=t.on,n=PC.a.clone({precision:t.config.precision});return n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(t){return new n(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&n.config({precision:t.precision})})),n}),{isClass:!0}),IC=HN("Matrix",[],(function(){function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,n){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,n){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t}),{isClass:!0}),DC=HN("replacer",[],(function(){return function(t,e){return"number"!=typeof e||isFinite(e)&&!isNaN(e)?e:{mathjs:"number",value:String(e)}}})),kC=PO("speedOfLight","299792458","m s^-1"),zC=PO("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),BC=PO("planckConstant","6.62607015e-34","J s"),UC=PO("reducedPlanckConstant","1.0545718176461565e-34","J s"),FC=PO("magneticConstant","1.25663706212e-6","N A^-2"),jC=PO("electricConstant","8.8541878128e-12","F m^-1"),HC=PO("vacuumImpedance","376.730313667","ohm"),VC=PO("coulomb","8.987551792261171e9","N m^2 C^-2"),GC=PO("elementaryCharge","1.602176634e-19","C"),qC=PO("bohrMagneton","9.2740100783e-24","J T^-1"),WC=PO("conductanceQuantum","7.748091729863649e-5","S"),ZC=PO("inverseConductanceQuantum","12906.403729652257","ohm"),$C=PO("magneticFluxQuantum","2.0678338484619295e-15","Wb"),YC=PO("nuclearMagneton","5.0507837461e-27","J T^-1"),XC=PO("klitzing","25812.807459304513","ohm"),JC=PO("bohrRadius","5.29177210903e-11","m"),QC=PO("classicalElectronRadius","2.8179403262e-15","m"),KC=PO("electronMass","9.1093837015e-31","kg"),tO=PO("fermiCoupling","1.1663787e-5","GeV^-2"),eO=LO("fineStructure",.0072973525693),nO=PO("hartreeEnergy","4.3597447222071e-18","J"),rO=PO("protonMass","1.67262192369e-27","kg"),iO=PO("deuteronMass","3.3435830926e-27","kg"),oO=PO("neutronMass","1.6749271613e-27","kg"),aO=PO("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),sO=PO("rydberg","10973731.568160","m^-1"),uO=PO("thomsonCrossSection","6.6524587321e-29","m^2"),cO=LO("weakMixingAngle",.2229),lO=LO("efimovFactor",22.7),hO=PO("atomicMass","1.66053906660e-27","kg"),pO=PO("avogadro","6.02214076e23","mol^-1"),fO=PO("boltzmann","1.380649e-23","J K^-1"),dO=PO("faraday","96485.33212331001","C mol^-1"),mO=PO("firstRadiation","3.7417718521927573e-16","W m^2"),gO=PO("loschmidt","2.686780111798444e25","m^-3"),yO=PO("gasConstant","8.31446261815324","J K^-1 mol^-1"),vO=PO("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),xO=PO("molarVolume","0.022413969545014137","m^3 mol^-1"),bO=LO("sackurTetrode",-1.16487052358),wO=PO("secondRadiation","0.014387768775039337","m K"),_O=PO("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),MO=PO("wienDisplacement","2.897771955e-3","m K"),SO=PO("molarMass","0.99999999965e-3","kg mol^-1"),EO=PO("molarMassC12","11.9999999958e-3","kg mol^-1"),NO=PO("gravity","9.80665","m s^-2"),TO=PO("planckLength","1.616255e-35","m"),AO=PO("planckMass","2.176435e-8","kg"),CO=PO("planckTime","5.391245e-44","s"),OO=PO("planckCharge","1.87554603778e-18","C"),RO=PO("planckTemperature","1.416785e+32","K");function PO(t,e,n){return HN(t,["config","Unit","BigNumber"],(function(t){var r=new(0,t.Unit)("BigNumber"===t.config.number?new(0,t.BigNumber)(e):parseFloat(e),n);return r.fixPrefix=!0,r}))}function LO(t,e){return HN(t,["config","BigNumber"],(function(t){return"BigNumber"===t.config.number?new(0,t.BigNumber)(e):e}))}var IO=n("QPvx"),DO=n.n(IO),kO=HN("Fraction",[],(function(){return DO.a.prototype.type="Fraction",DO.a.prototype.isFraction=!0,DO.a.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},DO.a.fromJSON=function(t){return new DO.a(t)},DO.a}),{isClass:!0}),zO=HN("DenseMatrix",["Matrix"],(function(t){function e(t,n){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!uE(n))throw new Error("Invalid datatype: "+n);if(lE(t))"DenseMatrix"===t.type?(this._data=VE(t._data),this._size=VE(t._size),this._datatype=n||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=n||t._datatype);else if(t&&cE(t.data)&&cE(t.size))this._data=t.data,this._size=t.size,TN(this._data,this._size),this._datatype=n||t.datatype;else if(cE(t))this._data=function t(e){for(var n=0,r=e.length;n<r;n++){var i=e[n];cE(i)?e[n]=t(i):i&&!0===i.isMatrix&&(e[n]=t(i.valueOf()))}return e}(t),this._size=NN(this._data),TN(this._data,this._size),this._datatype=n;else{if(t)throw new TypeError("Unsupported type of data ("+jE(t)+")");this._data=[],this._size=[0],this._datatype=n}}function n(t,n){if(!mE(n))throw new TypeError("Invalid index");if(n.isScalar())return t.get(n.min());var r=n.size();if(r.length!==t._size.length)throw new SN(r.length,t._size.length);for(var i=n.min(),o=n.max(),a=0,s=t._size.length;a<s;a++)AN(i[a],t._size[a]),AN(o[a],t._size[a]);return new e(function t(e,n,r,i){var o=i===r-1,a=n.dimension(i);return o?a.map((function(t){return AN(t,e.length),e[t]})).valueOf():a.map((function(o){return AN(o,e.length),t(e[o],n,r,i+1)})).valueOf()}(t._data,n,r.length,0),t._datatype)}function r(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,a=e.size(),s=e.isScalar();if(lE(n)?(i=n.size(),n=n.valueOf()):i=NN(n),s){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(a.length<t._size.length)throw new SN(a.length,t._size.length,"<");if(i.length<a.length){for(var u=0,c=0;1===a[u]&&1===i[u];)u++;for(;1===a[u];)c++,u++;n=PN(n,a.length,c,i)}if(!qE(a,i))throw new SN(a,i,">");o(t,e.max().map((function(t){return t+1})),r),function t(e,n,r,i,o){var a=o===i-1;n.dimension(o).forEach(a?function(t,n){AN(t),e[t]=r[n[0]]}:function(a,s){AN(a),t(e[a],n,r[s[0]],i,o+1)})}(t._data,e,n,a.length,0)}return t}function i(t,e,n){if(0===e.length){for(var r=t._data;cE(r);)r=r[0];return r}return t._size=e.slice(0),t._data=CN(t._data,t._size,n),t}function o(t,e,n){for(var r=t._size.slice(0),o=!1;r.length<e.length;)r.push(0),o=!0;for(var a=0,s=e.length;a<s;a++)e[a]>r[a]&&(r[a]=e[a],o=!0);o&&i(t,r,n)}return(e.prototype=new(0,t.Matrix)).createDenseMatrix=function(t,n){return new e(t,n)},e.prototype.type="DenseMatrix",e.prototype.isDenseMatrix=!0,e.prototype.getDataType=function(){return jN(this._data,jE)},e.prototype.storage=function(){return"dense"},e.prototype.datatype=function(){return this._datatype},e.prototype.create=function(t,n){return new e(t,n)},e.prototype.subset=function(t,e,i){switch(arguments.length){case 1:return n(this,t);case 2:case 3:return r(this,t,e,i);default:throw new SyntaxError("Wrong number of arguments")}},e.prototype.get=function(t){if(!cE(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new SN(t.length,this._size.length);for(var e=0;e<t.length;e++)AN(t[e],this._size[e]);for(var n=this._data,r=0,i=t.length;r<i;r++){var o=t[r];AN(o,n.length),n=n[o]}return n},e.prototype.set=function(t,e,n){if(!cE(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new SN(t.length,this._size.length,"<");var r,i,a;o(this,t.map((function(t){return t+1})),n);var s=this._data;for(r=0,i=t.length-1;r<i;r++)AN(a=t[r],s.length),s=s[a];return AN(a=t[t.length-1],s.length),s[a]=e,this},e.prototype.resize=function(t,e,n){if(!hE(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map((function(t){return Array.isArray(t)&&1===t.length?t[0]:t}));return i(n?this.clone():this,r,e)},e.prototype.reshape=function(t,e){var n=e?this.clone():this;return n._data=ON(n._data,t),n._size=t.slice(0),n},e.prototype.clone=function(){return new e({data:VE(this._data),size:VE(this._size),datatype:this._datatype})},e.prototype.size=function(){return this._size.slice(0)},e.prototype.map=function(t){var n=this,r=function e(r,i){return cE(r)?r.map((function(t,n){return e(t,i.concat(n))})):t(r,i,n)}(this._data,[]);return new e(r,void 0!==this._datatype?jN(r,jE):void 0)},e.prototype.forEach=function(t){var e=this;!function n(r,i){cE(r)?r.forEach((function(t,e){n(t,i.concat(e))})):t(r,i,e)}(this._data,[])},e.prototype.toArray=function(){return VE(this._data)},e.prototype.valueOf=function(){return this._data},e.prototype.format=function(t){return bN(this._data,t)},e.prototype.toString=function(){return bN(this._data)},e.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},e.prototype.diagonal=function(t){if(t){if(iE(t)&&(t=t.toNumber()),!rE(t)||!XE(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var n=t>0?t:0,r=t<0?-t:0,i=Math.min(this._size[0]-r,this._size[1]-n),o=[],a=0;a<i;a++)o[a]=this._data[a+r][a+n];return new e({data:o,size:[i],datatype:this._datatype})},e.diagonal=function(t,n,r,i){if(!cE(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(iE(t)&&(t=t.toNumber()),!rE(t)||!XE(t)||t<1)throw new Error("Size values must be positive integers");return t})),r){if(iE(r)&&(r=r.toNumber()),!rE(r)||!XE(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var o,a=r>0?r:0,s=r<0?-r:0,u=t[0],c=t[1],l=Math.min(u-s,c-a);if(cE(n)){if(n.length!==l)throw new Error("Invalid value array length");o=function(t){return n[t]}}else if(lE(n)){var h=n.size();if(1!==h.length||h[0]!==l)throw new Error("Invalid matrix length");o=function(t){return n.get([t])}}else o=function(){return n};i||(i=iE(o(0))?o(0).mul(0):0);var p=[];if(t.length>0){p=CN(p,t,i);for(var f=0;f<l;f++)p[f+s][f+a]=o(f)}return new e({data:p,size:[u,c]})},e.fromJSON=function(t){return new e(t)},e.prototype.swapRows=function(t,n){if(!(rE(t)&&XE(t)&&rE(n)&&XE(n)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return AN(t,this._size[0]),AN(n,this._size[0]),e._swapRows(t,n,this._data),this},e._swapRows=function(t,e,n){var r=n[t];n[t]=n[e],n[e]=r},e}),{isClass:!0}),BO=n("VRvs"),UO=n.n(BO),FO=function(){return FO=UO.a.create,UO.a},jO=HN("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(t){var e=t.BigNumber,n=t.Complex,r=t.DenseMatrix,i=t.Fraction,o=FO();return o.types=[{name:"number",test:rE},{name:"Complex",test:oE},{name:"BigNumber",test:iE},{name:"Fraction",test:aE},{name:"Unit",test:sE},{name:"string",test:uE},{name:"Chain",test:FE},{name:"Array",test:cE},{name:"Matrix",test:lE},{name:"DenseMatrix",test:pE},{name:"SparseMatrix",test:fE},{name:"Range",test:dE},{name:"Index",test:mE},{name:"boolean",test:gE},{name:"ResultSet",test:yE},{name:"Help",test:vE},{name:"function",test:xE},{name:"Date",test:bE},{name:"RegExp",test:wE},{name:"null",test:ME},{name:"undefined",test:SE},{name:"AccessorNode",test:EE},{name:"ArrayNode",test:NE},{name:"AssignmentNode",test:TE},{name:"BlockNode",test:AE},{name:"ConditionalNode",test:CE},{name:"ConstantNode",test:OE},{name:"FunctionNode",test:PE},{name:"FunctionAssignmentNode",test:RE},{name:"IndexNode",test:LE},{name:"Node",test:IE},{name:"ObjectNode",test:DE},{name:"OperatorNode",test:kE},{name:"ParenthesisNode",test:zE},{name:"RangeNode",test:BE},{name:"SymbolNode",test:UE},{name:"Object",test:_E}],o.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(e||HO(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return n||VO(t),new n(t,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(t){return n||VO(t),new n(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return n||VO(t),new n(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){i||GO(t);var e=new i(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||HO(t);try{return new e(t)}catch(n){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){i||GO(t);try{return new i(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){n||VO(t);try{return new n(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||HO(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return i||GO(t),new i(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return r||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new r(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],o}));function HO(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function VO(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function GO(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}var qO=HN("isInteger",["typed"],(function(t){return(0,t.typed)("isInteger",{number:XE,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":function(t){return FT(t,this)}})})),WO=HN("isNumeric",["typed"],(function(t){return(0,t.typed)("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":function(t){return FT(t,this)}})}));function ZO(t){return t<0}function $O(t){return t>0}function YO(t){return 0===t}function XO(t){return Number.isNaN(t)}ZO.signature="number",$O.signature="number",YO.signature="number",XO.signature="number";var JO=HN("isPositive",["typed"],(function(t){return(0,t.typed)("isPositive",{number:$O,BigNumber:function(t){return!t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s>0&&t.n>0},Unit:function(t){return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),QO=HN("isNaN",["typed"],(function(t){return(0,t.typed)("isNaN",{number:XO,BigNumber:function(t){return t.isNaN()},Fraction:function(t){return!1},Complex:function(t){return t.isNaN()},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":function(t){return FT(t,Number.isNaN)}})}));function KO(t,e,n){if(null==n)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var r=t.minus(e).abs();if(r.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return r.lte(i.times(n))}return!1}var tR=HN("equalScalar",["typed","config"],(function(t){var e=t.config;return(0,t.typed)("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,n){return lN(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.eq(n)||KO(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,n){return function(t,e,n){return lN(t.re,e.re,n)&&lN(t.im,e.im,n)}(t,n,e.epsilon)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)}})})),eR=(HN("equalScalar",["typed","config"],(function(t){var e=t.config;return(0,t.typed)("equalScalar",{"number, number":function(t,n){return lN(t,n,e.epsilon)}})})),HN("number",["typed"],(function(t){var e=(0,t.typed)("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e=Number(t);if(isNaN(e))throw new SyntaxError('String "'+t+'" is no valid number');return e},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return FT(t,this)}});return e.fromJSON=function(t){return parseFloat(t.value)},e}))),nR=HN("boolean",["typed"],(function(t){return(0,t.typed)("boolean",{"":function(){return!1},boolean:function(t){return t},number:function(t){return!!t},null:function(t){return!1},BigNumber:function(t){return!t.isZero()},string:function(t){var e=t.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;var n=Number(t);if(""!==t&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+t+'" to a boolean')},"Array | Matrix":function(t){return FT(t,this)}})})),rR=HN("complex",["typed","Complex"],(function(t){var e=t.Complex;return(0,t.typed)("complex",{"":function(){return e.ZERO},number:function(t){return new e(t,0)},"number, number":function(t,n){return new e(t,n)},"BigNumber, BigNumber":function(t,n){return new e(t.toNumber(),n.toNumber())},Fraction:function(t){return new e(t.valueOf(),0)},Complex:function(t){return t.clone()},string:function(t){return e(t)},null:function(t){return e(0)},Object:function(t){if("re"in t&&"im"in t)return new e(t.re,t.im);if("r"in t&&"phi"in t||"abs"in t&&"arg"in t)return new e(t);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":function(t){return FT(t,this)}})})),iR=HN("splitUnit",["typed"],(function(t){return(0,t.typed)("splitUnit",{"Unit, Array":function(t,e){return t.splitUnit(e)}})}));function oR(t){return Math.abs(t)}function aR(t,e){return t+e}function sR(t,e){return t*e}function uR(t){return-t}function cR(t){return t}function lR(t){return eN(t)}function hR(t){return Math.ceil(t)}function pR(t){return t*t*t}function fR(t){return Math.exp(t)}function dR(t){return nN(t)}function mR(t,e){if(!XE(t)||!XE(e))throw new Error("Parameters in function gcd must be integer numbers");for(var n;0!==e;)n=t%e,t=e,e=n;return t<0?-t:t}function gR(t,e){if(!XE(t)||!XE(e))throw new Error("Parameters in function lcm must be integer numbers");if(0===t||0===e)return 0;for(var n,r=t*e;0!==e;)e=t%(n=e),t=n;return Math.abs(r/t)}function yR(t){return Math.log(t)}function vR(t){return KE(t)}function xR(t){return QE(t)}function bR(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}function wR(t,e){var n=e<0;if(n&&(e=-e),0===e)throw new Error("Root must be non-zero");if(t<0&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0===t)return n?1/0:0;if(!isFinite(t))return n?0:t;var r=Math.pow(Math.abs(t),1/e);return r=t<0?-r:r,n?1/r:r}function _R(t){return JE(t)}function MR(t){return t*t}function SR(t,e){var n,r,i,o=0,a=1,s=1,u=0;if(!XE(t)||!XE(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)i=t-(r=Math.floor(t/e))*e,n=o,o=a-r*o,a=n,n=s,s=u-r*s,u=n,t=e,e=i;return t<0?[-t,-a,-u]:[t,t?a:0,u]}function ER(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function NR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(oN(t,e))}oR.signature="number",aR.signature="number, number",sR.signature="number, number",uR.signature="number",cR.signature="number",lR.signature="number",hR.signature="number",pR.signature="number",fR.signature="number",dR.signature="number",mR.signature="number, number",gR.signature="number, number",yR.signature="number",vR.signature="number",xR.signature="number",bR.signature="number, number",wR.signature="number, number",_R.signature="number",MR.signature="number",SR.signature="number, number",ER.signature="number, number",NR.signature="number, number";var TR=HN("unaryPlus",["typed","config","BigNumber"],(function(t){var e=t.config,n=t.BigNumber;return(0,t.typed)("unaryPlus",{number:cR,Complex:function(t){return t},BigNumber:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":function(t){return FT(t,this,!0)},"boolean | string":function(t){return"BigNumber"===e.number?new n(+t):+t}})})),AR=HN("cube",["typed"],(function(t){return(0,t.typed)("cube",{number:pR,Complex:function(t){return t.mul(t).mul(t)},BigNumber:function(t){return t.times(t).times(t)},Fraction:function(t){return t.pow(3)},"Array | Matrix":function(t){return FT(t,this,!0)},Unit:function(t){return t.pow(3)}})})),CR=HN("expm1",["typed","Complex"],(function(t){var e=t.Complex;return(0,t.typed)("expm1",{number:dR,Complex:function(t){var n=Math.exp(t.re);return new e(n*Math.cos(t.im)-1,n*Math.sin(t.im))},BigNumber:function(t){return t.exp().minus(1)},"Array | Matrix":function(t){return FT(t,this)}})})),OR=HN("log10",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("log10",{number:function(t){return t>=0||e.predictable?vR(t):new n(t,0).log().div(Math.LN10)},Complex:function(t){return new n(t).log().div(Math.LN10)},BigNumber:function(t){return!t.isNegative()||e.predictable?t.log():new n(t.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(t){return FT(t,this)}})})),RR=HN("multiplyScalar",["typed"],(function(t){return(0,t.typed)("multiplyScalar",{"number, number":sR,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var n=e.clone();return n.value=null===n.value?n._normalize(t):this(n.value,t),n},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var n=t.clone();return n.value=null===n.value?n._normalize(e):this(n.value,e),n},"Unit, Unit":function(t,e){return t.multiply(e)}})})),PR=HN("sign",["typed","BigNumber","Fraction","complex"],(function(t){var e=t.BigNumber,n=t.complex,r=t.Fraction;return(0,t.typed)("sign",{number:_R,Complex:function(t){return 0===t.im?n(_R(t.re)):t.sign()},BigNumber:function(t){return new e(t.cmp(0))},Fraction:function(t){return new r(t.s,1)},"Array | Matrix":function(t){return FT(t,this,!0)},Unit:function(t){return this(t.value)}})})),LR=HN("square",["typed"],(function(t){return(0,t.typed)("square",{number:MR,Complex:function(t){return t.mul(t)},BigNumber:function(t){return t.times(t)},Fraction:function(t){return t.mul(t)},"Array | Matrix":function(t){return FT(t,this,!0)},Unit:function(t){return t.pow(2)}})}));function IR(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()===e.isNegative()?t:new n(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t}return zR(t,e,(function(t,e){return t&e}))}function DR(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,n=e.precision;e.config({precision:1e9});var r=t.plus(new e(1));return r.s=-r.s||null,e.config({precision:n}),r}function kR(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);var r=new n(-1);return t.isZero()||e.eq(r)||t.eq(e)?e:e.isZero()||t.eq(r)?t:t.isFinite()&&e.isFinite()?zR(t,e,(function(t,e){return t|e})):!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?r:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t}function zR(t,e,n){var r,i,o,a,s,u=t.constructor,c=+(t.s<0),l=+(e.s<0);if(c){r=BR(DR(t));for(var h=0;h<r.length;++h)r[h]^=1}else r=BR(t);if(l){i=BR(DR(e));for(var p=0;p<i.length;++p)i[p]^=1}else i=BR(e);r.length<=i.length?(o=r,a=i,s=c):(o=i,a=r,s=l);var f=o.length,d=a.length,m=1^n(c,l),g=new u(1^m),y=new u(1),v=new u(2),x=u.precision;for(u.config({precision:1e9});f>0;)n(o[--f],a[--d])===m&&(g=g.plus(y)),y=y.times(v);for(;d>0;)n(s,a[--d])===m&&(g=g.plus(y)),y=y.times(v);return u.config({precision:x}),0===m&&(g.s=-g.s),g}function BR(t){for(var e=t.d,n=e[0]+"",r=1;r<e.length;++r){for(var i=e[r]+"",o=7-i.length;o--;)i="0"+i;n+=i}for(var a=n.length;"0"===n.charAt(a);)a--;var s=t.e,u=n.slice(0,a+1||1),c=u.length;if(s>0)if(++s>c)for(s-=c;s--;)u+="0";else s<c&&(u=u.slice(0,s)+"."+u.slice(s));for(var l=[0],h=0;h<u.length;){for(var p=l.length;p--;)l[p]*=10;l[0]+=parseInt(u.charAt(h++));for(var f=0;f<l.length;++f)l[f]>1&&(null==l[f+1]&&(l[f+1]=0),l[f+1]+=l[f]>>1,l[f]&=1)}return l.reverse()}function UR(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new n(0);var r=new n(-1);return t.eq(r)?DR(e):e.eq(r)?DR(t):t.isFinite()&&e.isFinite()?zR(t,e,(function(t,e){return t^e})):t.isFinite()||e.isFinite()?new n(t.isNegative()===e.isNegative()?1/0:-1/0):r}function FR(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:t.isFinite()||e.isFinite()?e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new n(2).pow(e)):new n(NaN)}function jR(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new n(2).pow(e)).floor():t.isNegative()?new n(-1):t.isFinite()?new n(0):new n(NaN)}var HR="number, number";function VR(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function bitAnd");return t&e}function GR(t){if(!XE(t))throw new Error("Integer expected in function bitNot");return~t}function qR(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function bitOr");return t|e}function WR(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function bitXor");return t^e}function ZR(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function leftShift");return t<<e}function $R(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function rightArithShift");return t>>e}function YR(t,e){if(!XE(t)||!XE(e))throw new Error("Integers expected in function rightLogShift");return t>>>e}VR.signature=HR,GR.signature="number",qR.signature=HR,WR.signature=HR,ZR.signature=HR,$R.signature=HR,YR.signature=HR;var XR=HN("bitNot",["typed"],(function(t){return(0,t.typed)("bitNot",{number:GR,BigNumber:DR,"Array | Matrix":function(t){return FT(t,this)}})})),JR=HN("arg",["typed"],(function(t){return(0,t.typed)("arg",{number:function(t){return Math.atan2(0,t)},BigNumber:function(t){return t.constructor.atan2(0,t)},Complex:function(t){return t.arg()},"Array | Matrix":function(t){return FT(t,this)}})})),QR=HN("im",["typed"],(function(t){return(0,t.typed)("im",{number:function(t){return 0},BigNumber:function(t){return t.mul(0)},Complex:function(t){return t.im},"Array | Matrix":function(t){return FT(t,this)}})}));function KR(t){return!t}function tP(t,e){return!(!t&&!e)}function eP(t,e){return!!t!=!!e}function nP(t,e){return!(!t||!e)}KR.signature="number",tP.signature="number, number",eP.signature="number, number",nP.signature="number, number";var rP=HN("not",["typed"],(function(t){return(0,t.typed)("not",{number:KR,Complex:function(t){return 0===t.re&&0===t.im},BigNumber:function(t){return t.isZero()||t.isNaN()},Unit:function(t){return null===t.value||this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),iP=HN("filter",["typed"],(function(t){return(0,t.typed)("filter",{"Array, function":oP,"Matrix, function":function(t,e){return t.create(oP(t.toArray(),e))},"Array, RegExp":zN,"Matrix, RegExp":function(t,e){return t.create(zN(t.toArray(),e))}})}));function oP(t,e){var n=yA(e);return kN(t,(function(t,r,i){return 1===n?e(t):2===n?e(t,[r]):e(t,[r],i)}))}var aP=HN("forEach",["typed"],(function(t){return(0,t.typed)("forEach",{"Array, function":sP,"Matrix, function":function(t,e){return t.forEach(e)}})}));function sP(t,e){var n=yA(e);!function r(i,o){Array.isArray(i)?DN(i,(function(t,e){r(t,o.concat(e))})):1===n?e(i):2===n?e(i,o):e(i,o,t)}(t,[])}var uP=HN("map",["typed"],(function(t){return(0,t.typed)("map",{"Array, function":cP,"Matrix, function":function(t,e){return t.map(e)}})}));function cP(t,e){var n=yA(e);return function r(i,o){return Array.isArray(i)?i.map((function(t,e){return r(t,o.concat(e))})):1===n?e(i):2===n?e(i,o):e(i,o,t)}(t,[])}var lP=HN("erf",["typed"],(function(t){return(0,t.typed)("name",{number:function(t){var e=Math.abs(t);return e>=mP?JE(t):e<=hP?JE(t)*function(t){var e,n=t*t,r=fP[0][4]*n,i=n;for(e=0;e<3;e+=1)r=(r+fP[0][e])*n,i=(i+dP[0][e])*n;return t*(r+fP[0][3])/(i+dP[0][3])}(e):e<=4?JE(t)*(1-function(t){var e,n=fP[1][8]*t,r=t;for(e=0;e<7;e+=1)n=(n+fP[1][e])*t,r=(r+dP[1][e])*t;var i=(n+fP[1][7])/(r+dP[1][7]),o=parseInt(16*t)/16,a=(t-o)*(t+o);return Math.exp(-o*o)*Math.exp(-a)*i}(e)):JE(t)*(1-function(t){var e,n=1/(t*t),r=fP[2][5]*n,i=n;for(e=0;e<4;e+=1)r=(r+fP[2][e])*n,i=(i+dP[2][e])*n;var o=n*(r+fP[2][4])/(i+dP[2][4]);o=(pP-o)/t;var a=(t-(n=parseInt(16*t)/16))*(t+n);return Math.exp(-n*n)*Math.exp(-a)*o}(e))},"Array | Matrix":function(t){return FT(t,this)}})})),hP=.46875,pP=.5641895835477563,fP=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],dP=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],mP=Math.pow(2,53),gP=HN("format",["typed"],(function(t){return(0,t.typed)("format",{any:bN,"any, Object | function | number":bN})})),yP=HN("isPrime",["typed"],(function(t){return(0,t.typed)("isPrime",{number:function(t){if(0*t!=0)return!1;if(t<=3)return t>1;if(t%2==0||t%3==0)return!1;for(var e=5;e*e<=t;e+=6)if(t%e==0||t%(e+2)==0)return!1;return!0},BigNumber:function(t){if(0*t.toNumber()!=0)return!1;if(t.lte(3))return t.gt(1);if(t.mod(2).eq(0)||t.mod(3).eq(0))return!1;for(var e=5;t.gte(e*e);e+=6)if(t.mod(e).eq(0)||t.mod(e+2).eq(0))return!1;return!0},"Array | Matrix":function(t){return FT(t,this)}})})),vP=HN("acos",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("acos",{number:function(t){return t>=-1&&t<=1||e.predictable?Math.acos(t):new n(t,0).acos()},Complex:function(t){return t.acos()},BigNumber:function(t){return t.acos()},"Array | Matrix":function(t){return FT(t,this)}})}));function xP(t){return hN(t)}function bP(t){return Math.atan(1/t)}function wP(t){return isFinite(t)?(Math.log((t+1)/t)+Math.log(t/(t-1)))/2:0}function _P(t){return Math.asin(1/t)}function MP(t){var e=1/t;return Math.log(e+Math.sqrt(e*e+1))}function SP(t){return Math.acos(1/t)}function EP(t){var e=1/t,n=Math.sqrt(e*e-1);return Math.log(n+e)}function NP(t){return pN(t)}function TP(t){return fN(t)}function AP(t){return 1/Math.tan(t)}function CP(t){var e=Math.exp(2*t);return(e+1)/(e-1)}function OP(t){return 1/Math.sin(t)}function RP(t){return 0===t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*JE(t)}function PP(t){return 1/Math.cos(t)}function LP(t){return 2/(Math.exp(t)+Math.exp(-t))}function IP(t){return mN(t)}xP.signature="number",bP.signature="number",wP.signature="number",_P.signature="number",MP.signature="number",SP.signature="number",EP.signature="number",NP.signature="number",TP.signature="number",AP.signature="number",CP.signature="number",OP.signature="number",RP.signature="number",PP.signature="number",LP.signature="number",IP.signature="number";var DP=HN("acot",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("acot",{number:bP,Complex:function(t){return t.acot()},BigNumber:function(t){return new e(1).div(t).atan()},"Array | Matrix":function(t){return FT(t,this)}})})),kP=HN("acsc",["typed","config","Complex","BigNumber"],(function(t){var e=t.config,n=t.Complex,r=t.BigNumber;return(0,t.typed)("acsc",{number:function(t){return t<=-1||t>=1||e.predictable?_P(t):new n(t,0).acsc()},Complex:function(t){return t.acsc()},BigNumber:function(t){return new r(1).div(t).asin()},"Array | Matrix":function(t){return FT(t,this)}})})),zP=HN("asec",["typed","config","Complex","BigNumber"],(function(t){var e=t.config,n=t.Complex,r=t.BigNumber;return(0,t.typed)("asec",{number:function(t){return t<=-1||t>=1||e.predictable?SP(t):new n(t,0).asec()},Complex:function(t){return t.asec()},BigNumber:function(t){return new r(1).div(t).acos()},"Array | Matrix":function(t){return FT(t,this)}})})),BP=HN("asin",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("asin",{number:function(t){return t>=-1&&t<=1||e.predictable?Math.asin(t):new n(t,0).asin()},Complex:function(t){return t.asin()},BigNumber:function(t){return t.asin()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),UP=HN("atan",["typed"],(function(t){return(0,t.typed)("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),FP=HN("atanh",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("atanh",{number:function(t){return t<=1&&t>=-1||e.predictable?TP(t):new n(t,0).atanh()},Complex:function(t){return t.atanh()},BigNumber:function(t){return t.atanh()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),jP=HN("cosh",["typed"],(function(t){return(0,t.typed)("cosh",{number:dN,Complex:function(t){return t.cosh()},BigNumber:function(t){return t.cosh()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),HP=HN("coth",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("coth",{number:CP,Complex:function(t){return t.coth()},BigNumber:function(t){return new e(1).div(t.tanh())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),VP=HN("csch",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("csch",{number:RP,Complex:function(t){return t.csch()},BigNumber:function(t){return new e(1).div(t.sinh())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),GP=HN("sech",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("sech",{number:LP,Complex:function(t){return t.sech()},BigNumber:function(t){return new e(1).div(t.cosh())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),qP=HN("sinh",["typed"],(function(t){return(0,t.typed)("sinh",{number:IP,Complex:function(t){return t.sinh()},BigNumber:function(t){return t.sinh()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this,!0)}})})),WP=HN("tanh",["typed"],(function(t){return(0,t.typed)("tanh",{number:gN,Complex:function(t){return t.tanh()},BigNumber:function(t){return t.tanh()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this,!0)}})}));function ZP(t,e){if(e<t)return 1;if(e===t)return e;var n=e+t>>1;return ZP(t,n)*ZP(n+1,e)}function $P(t,e){if(!XE(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!XE(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");var n=t-e;return e<n?ZP(n+1,t)/ZP(1,e):ZP(e+1,t)/ZP(1,n)}$P.signature="number, number";var YP=HN("combinations",["typed"],(function(t){return(0,t.typed)("combinations",{"number, number":$P,"BigNumber, BigNumber":function(t,e){var n,r,i=t.constructor,o=t.minus(e),a=new i(1);if(!XP(t)||!XP(e))throw new TypeError("Positive integer value expected in function combinations");if(e.gt(t))throw new TypeError("k must be less than n in function combinations");if(n=a,e.lt(o))for(r=a;r.lte(o);r=r.plus(a))n=n.times(e.plus(r)).dividedBy(r);else for(r=a;r.lte(e);r=r.plus(a))n=n.times(o.plus(r)).dividedBy(r);return n}})}));function XP(t){return t.isInteger()&&t.gte(0)}var JP=n("QNpd"),QP=n.n(JP),KP=QP()();function tL(t){var e,n;return e=null===(n=t)?KP:QP()(String(n)),function(){return e()}}var eL=HN("pickRandom",["typed","config","?on"],(function(t){var e=t.typed,n=t.on,r=tL(t.config.randomSeed);return n&&n("config",(function(t,e){t.randomSeed!==e.randomSeed&&(r=tL(t.randomSeed))})),e({"Array | Matrix":function(t){return i(t)},"Array | Matrix, number":function(t,e){return i(t,e,void 0)},"Array | Matrix, Array":function(t,e){return i(t,void 0,e)},"Array | Matrix, Array | Matrix, number":function(t,e,n){return i(t,n,e)},"Array | Matrix, number, Array | Matrix":function(t,e,n){return i(t,e,n)}});function i(t,e,n){var i=void 0===e;if(i&&(e=1),t=t.valueOf(),n&&(n=n.valueOf()),NN(t).length>1)throw new Error("Only one dimensional vectors supported");var o=0;if(void 0!==n){if(n.length!==t.length)throw new Error("Weights must have the same length as possibles");for(var a=0,s=n.length;a<s;a++){if(!rE(n[a])||n[a]<0)throw new Error("Weights must be an array of positive numbers");o+=n[a]}}var u=t.length;if(0===u)return[];if(e>=u)return e>1?t:t[0];for(var c,l=[];l.length<e;){if(void 0===n)c=t[Math.floor(r()*u)];else for(var h=r()*o,p=0,f=t.length;p<f;p++)if((h-=n[p])<0){c=t[p];break}-1===l.indexOf(c)&&l.push(c)}return i?l[0]:l}}));function nL(t,e){var n=[];if((t=t.slice(0)).length>1)for(var r=0,i=t.shift();r<i;r++)n.push(nL(t,e));else for(var o=0,a=t.shift();o<a;o++)n.push(e());return n}var rL=HN("randomInt",["typed","config","?on"],(function(t){var e=t.typed,n=t.on,r=tL(t.config.randomSeed);return n&&n("config",(function(t,e){t.randomSeed!==e.randomSeed&&(r=tL(t.randomSeed))})),e("randomInt",{"":function(){return o(0,1)},number:function(t){return o(0,t)},"number, number":function(t,e){return o(t,e)},"Array | Matrix":function(t){return i(t,0,1)},"Array | Matrix, number":function(t,e){return i(t,0,e)},"Array | Matrix, number, number":function(t,e,n){return i(t,e,n)}});function i(t,e,n){var r=nL(t.valueOf(),(function(){return o(e,n)}));return lE(t)?t.create(r):r}function o(t,e){return Math.floor(t+r()*(e-t))}})),iL=HN("clone",["typed"],(function(t){return(0,t.typed)("clone",{any:VE})})),oL=HN("hasNumericValue",["typed","isNumeric"],(function(t){var e=t.isNumeric;return(0,t.typed)("hasNumericValue",{string:function(t){return t.trim().length>0&&!isNaN(Number(t))},any:function(t){return e(t)}})})),aL=HN("typeOf",["typed"],(function(t){return(0,t.typed)("typeOf",{any:jE})})),sL=HN("string",["typed"],(function(t){return(0,t.typed)("string",{"":function(){return""},number:rN,null:function(t){return"null"},boolean:function(t){return t+""},string:function(t){return t},"Array | Matrix":function(t){return FT(t,this)},any:function(t){return String(t)}})})),uL=HN("fraction",["typed","Fraction"],(function(t){var e=t.Fraction;return(0,t.typed)("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new e(t)},string:function(t){return new e(t)},"number, number":function(t,n){return new e(t,n)},null:function(t){return new e(0)},BigNumber:function(t){return new e(t.toString())},Fraction:function(t){return t},Object:function(t){return new e(t)},"Array | Matrix":function(t){return FT(t,this)}})})),cL=HN("unaryMinus",["typed"],(function(t){return(0,t.typed)("unaryMinus",{number:uR,Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=this(t.value),e},"Array | Matrix":function(t){return FT(t,this,!0)}})})),lL=HN("addScalar",["typed"],(function(t){return(0,t.typed)("addScalar",{"number, number":aR,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n}})})),hL=HN("exp",["typed"],(function(t){return(0,t.typed)("exp",{number:fR,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()},"Array | Matrix":function(t){return FT(t,this)}})})),pL=HN("log2",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("log2",{number:function(t){return t>=0||e.predictable?xR(t):r(new n(t,0))},Complex:r,BigNumber:function(t){return!t.isNegative()||e.predictable?t.log(2):r(new n(t.toNumber(),0))},"Array | Matrix":function(t){return FT(t,this)}});function r(t){var e=Math.sqrt(t.re*t.re+t.im*t.im);return new n(Math.log2?Math.log2(e):Math.log(e)/Math.LN2,Math.atan2(t.im,t.re)/Math.LN2)}})),fL=HN("sqrt",["config","typed","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("sqrt",{number:r,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():r(t.toNumber())},"Array | Matrix":function(t){return FT(t,this,!0)},Unit:function(t){return t.pow(.5)}});function r(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new n(t,0).sqrt()}})),dL=HN("conj",["typed"],(function(t){return(0,t.typed)("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return FT(t,this)}})})),mL=HN("getMatrixDataType",["typed"],(function(t){return(0,t.typed)("getMatrixDataType",{Array:function(t){return jN(t,jE)},Matrix:function(t){return t.getDataType()}})})),gL=HN("mode",["typed","isNaN","isNumeric"],(function(t){var e=t.isNaN,n=t.isNumeric;return(0,t.typed)("mode",{"Array | Matrix":r,"...":function(t){return r(t)}});function r(t){if(0===(t=LN(t.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var r={},i=[],o=0,a=0;a<t.length;a++){var s=t[a];if(n(s)&&e(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in r||(r[s]=0),r[s]++,r[s]===o?i.push(s):r[s]>o&&(o=r[s],i=[s])}return i}})),yL=HN("print",["typed"],(function(t){return(0,t.typed)("print",{"string, Object | Array":vL,"string, Object | Array, number | Object":vL})}));function vL(t,e,n){return t.replace(/\$([\w.]+)/g,(function(t,r){for(var i=r.split("."),o=e[i.shift()];i.length&&void 0!==o;){var a=i.shift();o=a?o[a]:o+"."}return void 0!==o?uE(o)?o:bN(o,n):t}))}var xL=HN("acosh",["typed","config","Complex"],(function(t){var e=t.config,n=t.Complex;return(0,t.typed)("acosh",{number:function(t){return t>=1||e.predictable?xP(t):t<=-1?new n(Math.log(Math.sqrt(t*t-1)-t),Math.PI):new n(t,0).acosh()},Complex:function(t){return t.acosh()},BigNumber:function(t){return t.acosh()},"Array | Matrix":function(t){return FT(t,this)}})})),bL=HN("acsch",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("acsch",{number:MP,Complex:function(t){return t.acsch()},BigNumber:function(t){return new e(1).div(t).asinh()},"Array | Matrix":function(t){return FT(t,this)}})})),wL=HN("asinh",["typed"],(function(t){return(0,t.typed)("asinh",{number:NP,Complex:function(t){return t.asinh()},BigNumber:function(t){return t.asinh()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),_L=HN("cos",["typed"],(function(t){return(0,t.typed)("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),ML=HN("csc",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("csc",{number:OP,Complex:function(t){return t.csc()},BigNumber:function(t){return new e(1).div(t.sin())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),SL=HN("sin",["typed"],(function(t){return(0,t.typed)("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this,!0)}})})),EL=HN("combinationsWithRep",["typed"],(function(t){return(0,t.typed)("combinationsWithRep",{"number, number":function(t,e){if(!XE(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!XE(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(t<1)throw new TypeError("k must be less than or equal to n + k - 1");return e<t-1?ZP(t,t+e-1)/ZP(1,e):ZP(e+1,t+e-1)/ZP(1,t-1)},"BigNumber, BigNumber":function(t,e){var n,r,i=new(0,t.constructor)(1),o=t.minus(i);if(!NL(t)||!NL(e))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(t.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(n=i,e.lt(o))for(r=i;r.lte(o);r=r.plus(i))n=n.times(e.plus(r)).dividedBy(r);else for(r=i;r.lte(e);r=r.plus(i))n=n.times(o.plus(r)).dividedBy(r);return n}})}));function NL(t){return t.isInteger()&&t.gte(0)}var TL=HN("random",["typed","config","?on"],(function(t){var e=t.typed,n=t.on,r=tL(t.config.randomSeed);return n&&n("config",(function(t,e){t.randomSeed!==e.randomSeed&&(r=tL(t.randomSeed))})),e("random",{"":function(){return o(0,1)},number:function(t){return o(0,t)},"number, number":function(t,e){return o(t,e)},"Array | Matrix":function(t){return i(t,0,1)},"Array | Matrix, number":function(t,e){return i(t,0,e)},"Array | Matrix, number, number":function(t,e,n){return i(t,e,n)}});function i(t,e,n){var r=nL(t.valueOf(),(function(){return o(e,n)}));return lE(t)?t.create(r):r}function o(t,e){return t+r()*(e-t)}})),AL=HN("isNegative",["typed"],(function(t){return(0,t.typed)("isNegative",{number:ZO,BigNumber:function(t){return t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s<0},Unit:function(t){return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),CL=HN("SparseMatrix",["typed","equalScalar","Matrix"],(function(t){var e=t.typed,n=t.equalScalar;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!uE(e))throw new Error("Invalid datatype: "+e);if(lE(t))!function(t,e,n){"SparseMatrix"===e.type?(t._values=e._values?VE(e._values):void 0,t._index=VE(e._index),t._ptr=VE(e._ptr),t._size=VE(e._size),t._datatype=n||e._datatype):i(t,e.valueOf(),n||e._datatype)}(this,t,e);else if(t&&cE(t.index)&&cE(t.ptr)&&cE(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(cE(t))i(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+jE(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function i(t,r,i){t._values=[],t._index=[],t._ptr=[],t._datatype=i;var o=r.length,a=0,s=n,u=0;if(uE(i)&&(s=e.find(n,[i,i])||n,u=e.convert(0,i)),o>0){var c=0;do{t._ptr.push(t._index.length);for(var l=0;l<o;l++){var h=r[l];if(cE(h)){if(0===c&&a<h.length&&(a=h.length),c<h.length){var p=h[c];s(p,u)||(t._values.push(p),t._index.push(l))}}else 0===c&&a<1&&(a=1),s(h,u)||(t._values.push(h),t._index.push(l))}c++}while(c<a)}t._ptr.push(t._index.length),t._size=[o,a]}function o(t,e){if(!mE(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var n,i,o,a,s=e.size();if(s.length!==t._size.length)throw new SN(s.length,t._size.length);var u=e.min(),c=e.max();for(n=0,i=t._size.length;n<i;n++)AN(u[n],t._size[n]),AN(c[n],t._size[n]);var l=t._values,h=t._index,p=t._ptr,f=e.dimension(0),d=e.dimension(1),m=[],g=[];f.forEach((function(t,e){g[t]=e[0],m[t]=!0}));var y=l?[]:void 0,v=[],x=[];return d.forEach((function(t){for(x.push(v.length),o=p[t],a=p[t+1];o<a;o++)!0===m[n=h[o]]&&(v.push(g[n]),y&&y.push(l[o]))})),x.push(v.length),new r({values:y,index:v,ptr:x,size:s,datatype:t._datatype})}function a(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var i,o=e.size(),a=e.isScalar();if(lE(n)?(i=n.size(),n=n.toArray()):i=NN(n),a){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(1!==o.length&&2!==o.length)throw new SN(o.length,t._size.length,"<");if(i.length<o.length){for(var s=0,u=0;1===o[s]&&1===i[s];)s++;for(;1===o[s];)u++,s++;n=PN(n,o.length,u,i)}if(!qE(o,i))throw new SN(o,i,">");for(var c=e.min()[0],l=e.min()[1],h=i[0],p=i[1],f=0;f<h;f++)for(var d=0;d<p;d++)t.set([f+c,d+l],n[f][d],r)}return t}function s(t,e,n,r){if(n-e==0)return n;for(var i=e;i<n;i++)if(r[i]===t)return i;return e}function u(t,e,n,r,i,o,a){i.splice(t,0,r),o.splice(t,0,e);for(var s=n+1;s<a.length;s++)a[s]++}function c(t,r,i,o){var a=o||0,s=n,u=0;uE(t._datatype)&&(s=e.find(n,[t._datatype,t._datatype])||n,u=e.convert(0,t._datatype),a=e.convert(a,t._datatype));var c,l,h,p=!s(a,u),f=t._size[0],d=t._size[1];if(i>d){for(l=d;l<i;l++)if(t._ptr[l]=t._values.length,p)for(c=0;c<f;c++)t._values.push(a),t._index.push(c);t._ptr[i]=t._values.length}else i<d&&(t._ptr.splice(i+1,d-i),t._values.splice(t._ptr[i],t._values.length),t._index.splice(t._ptr[i],t._index.length));if(d=i,r>f){if(p){var m=0;for(l=0;l<d;l++){t._ptr[l]=t._ptr[l]+m,h=t._ptr[l+1]+m;var g=0;for(c=f;c<r;c++,g++)t._values.splice(h+g,0,a),t._index.splice(h+g,0,c),m++}t._ptr[d]=t._values.length}}else if(r<f){var y=0;for(l=0;l<d;l++){t._ptr[l]=t._ptr[l]-y;var v=t._ptr[l+1]-y;for(h=t._ptr[l];h<v;h++)(c=t._index[h])>r-1&&(t._values.splice(h,1),t._index.splice(h,1),y++)}t._ptr[l]=t._values.length}return t._size[0]=r,t._size[1]=i,t}function l(t,e,n,r,i){var o,a,s=r[0],u=r[1],c=[];for(o=0;o<s;o++)for(c[o]=[],a=0;a<u;a++)c[o][a]=0;for(a=0;a<u;a++)for(var l=n[a+1],h=n[a];h<l;h++)c[o=e[h]][a]=t?i?VE(t[h]):t[h]:1;return c}return(r.prototype=new(0,t.Matrix)).createSparseMatrix=function(t,e){return new r(t,e)},r.prototype.type="SparseMatrix",r.prototype.isSparseMatrix=!0,r.prototype.getDataType=function(){return jN(this._values,jE)},r.prototype.storage=function(){return"sparse"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},r.prototype.subset=function(t,e,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,t);case 2:case 3:return a(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){if(!cE(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new SN(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],n=t[1];AN(e,this._size[0]),AN(n,this._size[1]);var r=s(e,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===e?this._values[r]:0},r.prototype.set=function(t,r,i){if(!cE(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new SN(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var o=t[0],a=t[1],l=this._size[0],h=this._size[1],p=n,f=0;uE(this._datatype)&&(p=e.find(n,[this._datatype,this._datatype])||n,f=e.convert(0,this._datatype)),(o>l-1||a>h-1)&&(c(this,Math.max(o+1,l),Math.max(a+1,h),i),l=this._size[0],h=this._size[1]),AN(o,l),AN(a,h);var d=s(o,this._ptr[a],this._ptr[a+1],this._index);return d<this._ptr[a+1]&&this._index[d]===o?p(r,f)?function(t,e,n,r,i){n.splice(t,1),r.splice(t,1);for(var o=e+1;o<i.length;o++)i[o]--}(d,a,this._values,this._index,this._ptr):this._values[d]=r:u(d,o,a,r,this._values,this._index,this._ptr),this},r.prototype.resize=function(t,e,n){if(!hE(t))throw new TypeError("Array or Matrix expected");var r=t.valueOf().map((function(t){return Array.isArray(t)&&1===t.length?t[0]:t}));if(2!==r.length)throw new Error("Only two dimensions matrix are supported");return r.forEach((function(t){if(!rE(t)||!XE(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+bN(r)+")")})),c(n?this.clone():this,r[0],r[1],e)},r.prototype.reshape=function(t,e){if(!cE(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(t.forEach((function(e){if(!rE(e)||!XE(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+bN(t)+")")})),this._size[0]*this._size[1]!=t[0]*t[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return n;for(var r=[],i=0;i<n._ptr.length;i++)for(var o=0;o<n._ptr[i+1]-n._ptr[i];o++)r.push(i);for(var a=n._values.slice(),c=n._index.slice(),l=0;l<n._index.length;l++){var h=c[l]*n._size[1]+r[l];r[l]=h%t[1],c[l]=Math.floor(h/t[1])}n._values.length=0,n._index.length=0,n._ptr.length=t[1]+1,n._size=t.slice();for(var p=0;p<n._ptr.length;p++)n._ptr[p]=0;for(var f=0;f<a.length;f++){var d=c[f],m=r[f],g=a[f];u(s(d,n._ptr[m],n._ptr[m+1],n._index),d,m,g,n._values,n._index,n._ptr)}return n},r.prototype.clone=function(){return new r({values:this._values?VE(this._values):void 0,index:VE(this._index),ptr:VE(this._ptr),size:VE(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(t,i){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var o=this;return function(t,i,o,a,s,u,c){var l=[],h=[],p=[],f=n,d=0;uE(t._datatype)&&(f=e.find(n,[t._datatype,t._datatype])||n,d=e.convert(0,t._datatype));for(var m=function(t,e,n){t=u(t,e,n),f(t,d)||(l.push(t),h.push(e))},g=0;g<=s;g++){p.push(l.length);var y=t._ptr[g],v=t._ptr[g+1];if(c)for(var x=y;x<v;x++){var b=t._index[x];b>=0&&b<=o&&m(t._values[x],b-0,g-0)}else{for(var w={},_=y;_<v;_++)w[t._index[_]]=t._values[_];for(var M=0;M<=o;M++)m(M in w?w[M]:0,M-0,g-0)}}return p.push(l.length),new r({values:l,index:h,ptr:p,size:[o-0+1,s-0+1]})}(this,0,this._size[0]-1,0,this._size[1]-1,(function(e,n,r){return t(e,[n,r],o)}),i)},r.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this._size[0],r=this._size[1],i=0;i<r;i++){var o=this._ptr[i],a=this._ptr[i+1];if(e)for(var s=o;s<a;s++)t(this._values[s],[this._index[s],i],this);else{for(var u={},c=o;c<a;c++)u[this._index[c]]=this._values[c];for(var l=0;l<n;l++)t(l in u?u[l]:0,[l,i],this)}}},r.prototype.toArray=function(){return l(this._values,this._index,this._ptr,this._size,!0)},r.prototype.valueOf=function(){return l(this._values,this._index,this._ptr,this._size,!1)},r.prototype.format=function(t){for(var e=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+bN(e,t)+" x "+bN(n,t)+"] density: "+bN(r,t)+"\n",o=0;o<n;o++)for(var a=this._ptr[o+1],s=this._ptr[o];s<a;s++)i+="\n    ("+bN(this._index[s],t)+", "+bN(o,t)+") ==> "+(this._values?bN(this._values[s],t):"X");return i},r.prototype.toString=function(){return bN(this.toArray())},r.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(iE(t)&&(t=t.toNumber()),!rE(t)||!XE(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,n=t<0?-t:0,i=this._size[1],o=Math.min(this._size[0]-n,i-e),a=[],s=[],u=[];u[0]=0;for(var c=e;c<i&&a.length<o;c++)for(var l=this._ptr[c+1],h=this._ptr[c];h<l;h++){var p=this._index[h];if(p===c-e+n){a.push(this._values[h]),s[a.length-1]=p-n;break}}return u.push(a.length),new r({values:a,index:s,ptr:u,size:[o,1]})},r.fromJSON=function(t){return new r(t)},r.diagonal=function(t,i,o,a,s){if(!cE(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(iE(t)&&(t=t.toNumber()),!rE(t)||!XE(t)||t<1)throw new Error("Size values must be positive integers");return t})),o){if(iE(o)&&(o=o.toNumber()),!rE(o)||!XE(o))throw new TypeError("The parameter k must be an integer number")}else o=0;var u=n,c=0;uE(s)&&(u=e.find(n,[s,s])||n,c=e.convert(0,s));var l,h=o>0?o:0,p=o<0?-o:0,f=t[0],d=t[1],m=Math.min(f-p,d-h);if(cE(i)){if(i.length!==m)throw new Error("Invalid value array length");l=function(t){return i[t]}}else if(lE(i)){var g=i.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");l=function(t){return i.get([t])}}else l=function(){return i};for(var y=[],v=[],x=[],b=0;b<d;b++){x.push(y.length);var w=b-h;if(w>=0&&w<m){var _=l(w);u(_,c)||(v.push(w+p),y.push(_))}}return x.push(y.length),new r({values:y,index:v,ptr:x,size:[f,d]})},r.prototype.swapRows=function(t,e){if(!(rE(t)&&XE(t)&&rE(e)&&XE(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return AN(t,this._size[0]),AN(e,this._size[0]),r._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},r._forEachRow=function(t,e,n,r,i){for(var o=r[t+1],a=r[t];a<o;a++)i(n[a],e[a])},r._swapRows=function(t,e,n,r,i,o){for(var a=0;a<n;a++){var u=o[a],c=o[a+1],l=s(t,u,c,i),h=s(e,u,c,i);if(l<c&&h<c&&i[l]===t&&i[h]===e){if(r){var p=r[l];r[l]=r[h],r[h]=p}}else if(l<c&&i[l]===t&&(h>=c||i[h]!==e)){var f=r?r[l]:void 0;i.splice(h,0,e),r&&r.splice(h,0,f),i.splice(h<=l?l+1:l,1),r&&r.splice(h<=l?l+1:l,1)}else if(h<c&&i[h]===e&&(l>=c||i[l]!==t)){var d=r?r[h]:void 0;i.splice(l,0,t),r&&r.splice(l,0,d),i.splice(l<=h?h+1:h,1),r&&r.splice(l<=h?h+1:h,1)}}},r}),{isClass:!0}),OL=HN("matrix",["typed","Matrix","DenseMatrix","SparseMatrix"],(function(t){var e=t.DenseMatrix,n=t.SparseMatrix;return(0,t.typed)("matrix",{"":function(){return r([])},string:function(t){return r([],t)},"string, string":function(t,e){return r([],t,e)},Array:function(t){return r(t)},Matrix:function(t){return r(t,t.storage())},"Array | Matrix, string":r,"Array | Matrix, string, string":r});function r(t,r,i){if("dense"===r||"default"===r||void 0===r)return new e(t,i);if("sparse"===r)return new n(t,i);throw new TypeError("Unknown matrix type "+JSON.stringify(r)+".")}})),RL=HN("cbrt",["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(function(t){var e=t.config,n=t.isNegative,r=t.unaryMinus,i=t.matrix,o=t.Complex,a=t.BigNumber,s=t.Fraction;return(0,t.typed)("cbrt",{number:lR,Complex:u,"Complex, boolean":u,BigNumber:function(t){return t.cbrt()},Unit:function(t){if(t.value&&oE(t.value)){var e=t.clone();return e.value=1,(e=e.pow(1/3)).value=u(t.value),e}var i,o=n(t.value);o&&(t.value=r(t.value)),i=iE(t.value)?new a(1).div(3):aE(t.value)?new s(1,3):1/3;var c=t.pow(i);return o&&(c.value=r(c.value)),c},"Array | Matrix":function(t){return FT(t,this,!0)}});function u(t,n){var r=t.arg()/3,a=t.abs(),s=new o(lR(a),0).mul(new o(0,r).exp());if(n){var u=[s,new o(lR(a),0).mul(new o(0,r+2*Math.PI/3).exp()),new o(lR(a),0).mul(new o(0,r-2*Math.PI/3).exp())];return"Array"===e.matrix?u:i(u)}return s}})),PL=HN("algorithm01",["typed"],(function(t){var e=t.typed;return function(t,n,r,i){var o=t._data,a=t._size,s=t._datatype,u=n._values,c=n._index,l=n._ptr,h=n._size,p=n._datatype;if(a.length!==h.length)throw new SN(a.length,h.length);if(a[0]!==h[0]||a[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+h+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,d,m=a[0],g=a[1],y="string"==typeof s&&s===p?s:void 0,v=y?e.find(r,[y,y]):r,x=[];for(f=0;f<m;f++)x[f]=[];var b=[],w=[];for(d=0;d<g;d++){for(var _=d+1,M=l[d+1],S=l[d];S<M;S++)b[f=c[S]]=i?v(u[S],o[f][d]):v(o[f][d],u[S]),w[f]=_;for(f=0;f<m;f++)x[f][d]=w[f]===_?b[f]:o[f][d]}return t.createDenseMatrix({data:x,size:[m,g],datatype:y})}})),LL=HN("algorithm04",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i){var o=t._values,a=t._index,s=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,p=r._ptr,f=r._size,d=r._datatype;if(u.length!==f.length)throw new SN(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");var m,g=u[0],y=u[1],v=n,x=0,b=i;"string"==typeof c&&c===d&&(v=e.find(n,[m=c,m]),x=e.convert(0,m),b=e.find(i,[m,m]));var w,_,M,S,E=o&&l?[]:void 0,N=[],T=[],A=o&&l?[]:void 0,C=o&&l?[]:void 0,O=[],R=[];for(_=0;_<y;_++){T[_]=N.length;var P=_+1;for(S=s[_+1],M=s[_];M<S;M++)N.push(w=a[M]),O[w]=P,A&&(A[w]=o[M]);for(S=p[_+1],M=p[_];M<S;M++)if(O[w=h[M]]===P){if(A){var L=b(A[w],l[M]);v(L,x)?O[w]=null:A[w]=L}}else N.push(w),R[w]=P,C&&(C[w]=l[M]);if(A&&C)for(M=T[_];M<N.length;)O[w=N[M]]===P?(E[M]=A[w],M++):R[w]===P?(E[M]=C[w],M++):N.splice(M,1)}return T[y]=N.length,t.createSparseMatrix({values:E,index:N,ptr:T,size:[g,y],datatype:m})}})),IL=HN("algorithm10",["typed","DenseMatrix"],(function(t){var e=t.typed,n=t.DenseMatrix;return function(t,r,i,o){var a=t._values,s=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=c[0],f=c[1],d=i;"string"==typeof l&&(r=e.convert(r,h=l),d=e.find(i,[h,h]));for(var m=[],g=[],y=[],v=0;v<f;v++){for(var x=v+1,b=u[v+1],w=u[v];w<b;w++){var _=s[w];g[_]=a[w],y[_]=x}for(var M=0;M<p;M++)0===v&&(m[M]=[]),m[M][v]=y[M]===x?o?d(r,g[M]):d(g[M],r):r}return new n({data:m,size:[p,f],datatype:h})}})),DL=HN("algorithm13",["typed"],(function(t){var e=t.typed;return function(t,n,r){var i,o=t._data,a=t._size,s=t._datatype,u=n._data,c=n._size,l=n._datatype,h=[];if(a.length!==c.length)throw new SN(a.length,c.length);for(var p=0;p<a.length;p++){if(a[p]!==c[p])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");h[p]=a[p]}var f=r;"string"==typeof s&&s===l&&(f=e.find(r,[i=s,i]));var d=h.length>0?function t(e,n,r,i,o,a){var s=[];if(n===r.length-1)for(var u=0;u<i;u++)s[u]=e(o[u],a[u]);else for(var c=0;c<i;c++)s[c]=t(e,n+1,r,r[n+1],o[c],a[c]);return s}(f,0,h,h[0],o,u):[];return t.createDenseMatrix({data:d,size:h,datatype:i})}})),kL=HN("algorithm14",["typed"],(function(t){var e=t.typed;return function(t,n,r,i){var o,a=t._data,s=t._size,u=t._datatype,c=r;"string"==typeof u&&(n=e.convert(n,o=u),c=e.find(r,[o,o]));var l=s.length>0?function t(e,n,r,i,o,a,s){var u=[];if(n===r.length-1)for(var c=0;c<i;c++)u[c]=s?e(a,o[c]):e(o[c],a);else for(var l=0;l<i;l++)u[l]=t(e,n+1,r,r[n+1],o[l],a,s);return u}(c,0,s,s[0],a,n,i):[];return t.createDenseMatrix({data:l,size:VE(s),datatype:o})}})),zL=HN("gcd",["typed","matrix","equalScalar","BigNumber","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.BigNumber,o=t.DenseMatrix,a=PL({typed:e}),s=LL({typed:e,equalScalar:r}),u=IL({typed:e,DenseMatrix:o}),c=DL({typed:e}),l=kL({typed:e});return e("gcd",{"number, number":mR,"BigNumber, BigNumber":function(t,e){if(!t.isInt()||!e.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var n=new i(0);!e.isZero();){var r=t.mod(e);t=e,e=r}return t.lt(n)?t.neg():t},"Fraction, Fraction":function(t,e){return t.gcd(e)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return u(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return l(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return u(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return l(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return l(n(t),e,this,!1).valueOf()},"number | BigNumber, Array":function(t,e){return l(n(e),t,this,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}})})),BL=HN("algorithm02",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i,o){var a=t._data,s=t._size,u=t._datatype,c=r._values,l=r._index,h=r._ptr,p=r._size,f=r._datatype;if(s.length!==p.length)throw new SN(s.length,p.length);if(s[0]!==p[0]||s[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,m=s[0],g=s[1],y=n,v=0,x=i;"string"==typeof u&&u===f&&(y=e.find(n,[d=u,d]),v=e.convert(0,d),x=e.find(i,[d,d]));for(var b=[],w=[],_=[],M=0;M<g;M++){_[M]=w.length;for(var S=h[M+1],E=h[M];E<S;E++){var N=l[E],T=o?x(c[E],a[N][M]):x(a[N][M],c[E]);y(T,v)||(w.push(N),b.push(T))}}return _[g]=w.length,r.createSparseMatrix({values:b,index:w,ptr:_,size:[m,g],datatype:d})}})),UL=HN("algorithm03",["typed"],(function(t){var e=t.typed;return function(t,n,r,i){var o=t._data,a=t._size,s=t._datatype,u=n._values,c=n._index,l=n._ptr,h=n._size,p=n._datatype;if(a.length!==h.length)throw new SN(a.length,h.length);if(a[0]!==h[0]||a[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+h+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,d=a[0],m=a[1],g=0,y=r;"string"==typeof s&&s===p&&(g=e.convert(0,f=s),y=e.find(r,[f,f]));for(var v=[],x=0;x<d;x++)v[x]=[];for(var b=[],w=[],_=0;_<m;_++){for(var M=_+1,S=l[_+1],E=l[_];E<S;E++){var N=c[E];b[N]=i?y(u[E],o[N][_]):y(o[N][_],u[E]),w[N]=M}for(var T=0;T<d;T++)v[T][_]=w[T]===M?b[T]:i?y(g,o[T][_]):y(o[T][_],g)}return t.createDenseMatrix({data:v,size:[d,m],datatype:f})}})),FL=HN("algorithm05",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i){var o=t._values,a=t._index,s=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,p=r._ptr,f=r._size,d=r._datatype;if(u.length!==f.length)throw new SN(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");var m,g=u[0],y=u[1],v=n,x=0,b=i;"string"==typeof c&&c===d&&(v=e.find(n,[m=c,m]),x=e.convert(0,m),b=e.find(i,[m,m]));var w,_,M,S,E=o&&l?[]:void 0,N=[],T=[],A=E?[]:void 0,C=E?[]:void 0,O=[],R=[];for(_=0;_<y;_++){T[_]=N.length;var P=_+1;for(M=s[_],S=s[_+1];M<S;M++)N.push(w=a[M]),O[w]=P,A&&(A[w]=o[M]);for(M=p[_],S=p[_+1];M<S;M++)O[w=h[M]]!==P&&N.push(w),R[w]=P,C&&(C[w]=l[M]);if(E)for(M=T[_];M<N.length;){var L=O[w=N[M]],I=R[w];if(L===P||I===P){var D=b(L===P?A[w]:x,I===P?C[w]:x);v(D,x)?N.splice(M,1):(E.push(D),M++)}}}return T[y]=N.length,t.createSparseMatrix({values:E,index:N,ptr:T,size:[g,y],datatype:m})}})),jL=HN("algorithm11",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i,o){var a=t._values,s=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=c[0],f=c[1],d=n,m=0,g=i;"string"==typeof l&&(d=e.find(n,[h=l,h]),m=e.convert(0,h),r=e.convert(r,h),g=e.find(i,[h,h]));for(var y=[],v=[],x=[],b=0;b<f;b++){x[b]=v.length;for(var w=u[b+1],_=u[b];_<w;_++){var M=s[_],S=o?g(r,a[_]):g(a[_],r);d(S,m)||(v.push(M),y.push(S))}}return x[f]=v.length,t.createSparseMatrix({values:y,index:v,ptr:x,size:[p,f],datatype:h})}})),HL=HN("algorithm12",["typed","DenseMatrix"],(function(t){var e=t.typed,n=t.DenseMatrix;return function(t,r,i,o){var a=t._values,s=t._index,u=t._ptr,c=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=c[0],f=c[1],d=i;"string"==typeof l&&(r=e.convert(r,h=l),d=e.find(i,[h,h]));for(var m=[],g=[],y=[],v=0;v<f;v++){for(var x=v+1,b=u[v+1],w=u[v];w<b;w++){var _=s[w];g[_]=a[w],y[_]=x}for(var M=0;M<p;M++)0===v&&(m[M]=[]),m[M][v]=y[M]===x?o?d(r,g[M]):d(g[M],r):o?d(r,0):d(0,r)}return new n({data:m,size:[p,f],datatype:h})}})),VL=HN("mod",["typed","matrix","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.DenseMatrix,o=BL({typed:e,equalScalar:r}),a=UL({typed:e}),s=FL({typed:e,equalScalar:r}),u=jL({typed:e,equalScalar:r}),c=HL({typed:e,DenseMatrix:i}),l=DL({typed:e}),h=kL({typed:e});return e("mod",{"number, number":bR,"BigNumber, BigNumber":function(t,e){return e.isZero()?t:t.mod(e)},"Fraction, Fraction":function(t,e){return t.mod(e)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return u(t,e,this,!1)},"DenseMatrix, any":function(t,e){return h(t,e,this,!1)},"any, SparseMatrix":function(t,e){return c(e,t,this,!0)},"any, DenseMatrix":function(t,e){return h(e,t,this,!0)},"Array, any":function(t,e){return h(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return h(n(e),t,this,!0).valueOf()}})})),GL=HN("algorithm06",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i){var o=t._values,a=t._size,s=t._datatype,u=r._values,c=r._size,l=r._datatype;if(a.length!==c.length)throw new SN(a.length,c.length);if(a[0]!==c[0]||a[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");var h,p=a[0],f=a[1],d=n,m=0,g=i;"string"==typeof s&&s===l&&(d=e.find(n,[h=s,h]),m=e.convert(0,h),g=e.find(i,[h,h]));for(var y=o&&u?[]:void 0,v=[],x=[],b=y?[]:void 0,w=[],_=[],M=0;M<f;M++){x[M]=v.length;var S=M+1;if(VT(t,M,w,b,_,S,v,g),VT(r,M,w,b,_,S,v,g),b)for(var E=x[M];E<v.length;){var N=v[E];if(_[N]===S){var T=b[N];d(T,m)?v.splice(E,1):(y.push(T),E++)}else v.splice(E,1)}else for(var A=x[M];A<v.length;)_[v[A]]!==S?v.splice(A,1):A++}return x[f]=v.length,t.createSparseMatrix({values:y,index:v,ptr:x,size:[p,f],datatype:h})}})),qL=HN("nthRoot",["typed","matrix","equalScalar","BigNumber"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.BigNumber,o=PL({typed:e}),a=BL({typed:e,equalScalar:r}),s=GL({typed:e,equalScalar:r}),u=jL({typed:e,equalScalar:r}),c=DL({typed:e}),l=kL({typed:e}),h="Complex number not supported in function nthRoot. Use nthRoots instead.";return e("nthRoot",{number:function(t){return wR(t,2)},"number, number":wR,BigNumber:function(t){return p(t,new i(2))},Complex:function(t){throw new Error(h)},"Complex, number":function(t,e){throw new Error(h)},"BigNumber, BigNumber":p,"Array | Matrix":function(t){return this(t,2)},"SparseMatrix, SparseMatrix":function(t,e){if(1===e.density())return s(t,e,this);throw new Error("Root must be non-zero")},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){if(1===e.density())return o(t,e,this,!1);throw new Error("Root must be non-zero")},"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return u(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return l(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){if(1===e.density())return u(e,t,this,!0);throw new Error("Root must be non-zero")},"number | BigNumber, DenseMatrix":function(t,e){return l(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return this(n(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return this(t,n(e)).valueOf()}});function p(t,e){var n=i.precision,r=i.clone({precision:n+2}),o=new i(0),a=new r(1),s=e.isNegative();if(s&&(e=e.neg()),e.isZero())throw new Error("Root must be non-zero");if(t.isNegative()&&!e.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(t.isZero())return s?new r(1/0):0;if(!t.isFinite())return s?o:t;var u=t.abs().pow(a.div(e));return u=t.isNeg()?u.neg():u,new i((s?a.div(u):u).toPrecision(n))}})),WL=HN("xgcd",["typed","config","matrix","BigNumber"],(function(t){var e=t.config,n=t.matrix,r=t.BigNumber;return(0,t.typed)("xgcd",{"number, number":function(t,r){var i=SR(t,r);return"Array"===e.matrix?i:n(i)},"BigNumber, BigNumber":function(t,i){var o,a,s,u,c=new r(0),l=new r(1),h=c,p=l,f=l,d=c;if(!t.isInt()||!i.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!i.isZero();)a=t.div(i).floor(),s=t.mod(i),o=h,h=p.minus(a.times(h)),p=o,o=f,f=d.minus(a.times(f)),d=o,t=i,i=s;return u=t.lt(c)?[t.neg(),p.neg(),d.neg()]:[t,t.isZero()?0:p,d],"Array"===e.matrix?u:n(u)}})})),ZL=HN("bitAnd",["typed","matrix","equalScalar"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=BL({typed:e,equalScalar:r}),o=GL({typed:e,equalScalar:r}),a=jL({typed:e,equalScalar:r}),s=DL({typed:e}),u=kL({typed:e});return e("bitAnd",{"number, number":VR,"BigNumber, BigNumber":IR,"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return i(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return i(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return s(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return a(t,e,this,!1)},"DenseMatrix, any":function(t,e){return u(t,e,this,!1)},"any, SparseMatrix":function(t,e){return a(e,t,this,!0)},"any, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, any":function(t,e){return u(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,this,!0).valueOf()}})})),$L=HN("algorithm07",["typed","DenseMatrix"],(function(t){var e=t.typed,n=t.DenseMatrix;return function(t,i,o){var a=t._size,s=t._datatype,u=i._size,c=i._datatype;if(a.length!==u.length)throw new SN(a.length,u.length);if(a[0]!==u[0]||a[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+u+")");var l,h,p,f=a[0],d=a[1],m=0,g=o;"string"==typeof s&&s===c&&(m=e.convert(0,l=s),g=e.find(o,[l,l]));var y=[];for(h=0;h<f;h++)y[h]=[];var v=[],x=[],b=[],w=[];for(p=0;p<d;p++){var _=p+1;for(r(t,p,b,v,_),r(i,p,w,x,_),h=0;h<f;h++)y[h][p]=g(b[h]===_?v[h]:m,w[h]===_?x[h]:m)}return new n({data:y,size:[f,d],datatype:l})};function r(t,e,n,r,i){for(var o=t._values,a=t._index,s=t._ptr,u=s[e],c=s[e+1];u<c;u++){var l=a[u];n[l]=i,r[l]=o[u]}}})),YL=HN("bitXor",["typed","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.DenseMatrix,i=UL({typed:e}),o=$L({typed:e,DenseMatrix:r}),a=HL({typed:e,DenseMatrix:r}),s=DL({typed:e}),u=kL({typed:e});return e("bitXor",{"number, number":WR,"BigNumber, BigNumber":UR,"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return i(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return i(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return s(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return a(t,e,this,!1)},"DenseMatrix, any":function(t,e){return u(t,e,this,!1)},"any, SparseMatrix":function(t,e){return a(e,t,this,!0)},"any, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, any":function(t,e){return u(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,this,!0).valueOf()}})})),XL=HN("or",["typed","matrix","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.DenseMatrix,o=UL({typed:e}),a=FL({typed:e,equalScalar:r}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("or",{"number, number":tP,"Complex, Complex":function(t,e){return 0!==t.re||0!==t.im||0!==e.re||0!==e.im},"BigNumber, BigNumber":function(t,e){return!t.isZero()&&!t.isNaN()||!e.isZero()&&!e.isNaN()},"Unit, Unit":function(t,e){return this(t.value||0,e.value||0)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(n(e),t,this,!0).valueOf()}})})),JL=HN("diag",["typed","matrix","DenseMatrix","SparseMatrix"],(function(t){var e=t.matrix,n=t.DenseMatrix,r=t.SparseMatrix;return(0,t.typed)("diag",{Array:function(t){return i(t,0,NN(t),null)},"Array, number":function(t,e){return i(t,e,NN(t),null)},"Array, BigNumber":function(t,e){return i(t,e.toNumber(),NN(t),null)},"Array, string":function(t,e){return i(t,0,NN(t),e)},"Array, number, string":function(t,e,n){return i(t,e,NN(t),n)},"Array, BigNumber, string":function(t,e,n){return i(t,e.toNumber(),NN(t),n)},Matrix:function(t){return i(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return i(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return i(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return i(t,0,t.size(),e)},"Matrix, number, string":function(t,e,n){return i(t,e,t.size(),n)},"Matrix, BigNumber, string":function(t,e,n){return i(t,e.toNumber(),t.size(),n)}});function i(t,i,o,a){if(!XE(i))throw new TypeError("Second parameter in function diag must be an integer");var s=i>0?i:0,u=i<0?-i:0;switch(o.length){case 1:return function(t,e,i,o,a,s){var u=[o+a,o+s];if(i&&"sparse"!==i&&"dense"!==i)throw new TypeError("Unknown matrix type ".concat(i,'"'));var c="sparse"===i?r.diagonal(u,t,e):n.diagonal(u,t,e);return null!==i?c:c.valueOf()}(t,i,a,o[0],u,s);case 2:return function(t,n,r,i,o,a){if(lE(t)){var s=t.diagonal(n);return null!==r?r!==s.storage()?e(s,r):s:s.valueOf()}for(var u=Math.min(i[0]-o,i[1]-a),c=[],l=0;l<u;l++)c[l]=t[l+o][l+a];return null!==r?e(c):c}(t,i,a,o,u,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),QL=HN("identity",["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(function(t){var e=t.config,n=t.matrix,r=t.BigNumber,i=t.DenseMatrix,o=t.SparseMatrix;return(0,t.typed)("identity",{"":function(){return"Matrix"===e.matrix?n([]):[]},string:function(t){return n(t)},"number | BigNumber":function(t){return s(t,t,"Matrix"===e.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return s(t,t,e)},"number | BigNumber, number | BigNumber":function(t,n){return s(t,n,"Matrix"===e.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,n){return s(t,e,n)},Array:function(t){return a(t)},"Array, string":function(t,e){return a(t,e)},Matrix:function(t){return a(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return a(t.valueOf(),e)}});function a(t,e){switch(t.length){case 0:return e?n(e):[];case 1:return s(t[0],t[0],e);case 2:return s(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function s(t,e,n){var a=iE(t)||iE(e)?r:null;if(iE(t)&&(t=t.toNumber()),iE(e)&&(e=e.toNumber()),!XE(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!XE(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var s=a?new r(1):1,u=a?new a(0):0,c=[t,e];if(n){if("sparse"===n)return o.diagonal(c,s,0,u);if("dense"===n)return i.diagonal(c,s,0,u);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var l=CN([],c,u),h=t<e?t:e,p=0;p<h;p++)l[p][p]=s;return l}})),KL=HN("ones",["typed","config","matrix","BigNumber"],(function(t){var e=t.config,n=t.matrix,r=t.BigNumber;return(0,t.typed)("ones",{"":function(){return"Array"===e.matrix?i([]):i([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var n=t.pop();return i(t,n)}return"Array"===e.matrix?i(t):i(t,"default")},Array:i,Matrix:function(t){var e=t.storage();return i(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return i(t.valueOf(),e)}});function i(t,e){var i=function(t){var e=!1;return t.forEach((function(t,n,r){iE(t)&&(e=!0,r[n]=t.toNumber())})),e}(t)?new r(1):1;if(function(t){t.forEach((function(t){if("number"!=typeof t||!XE(t)||t<0)throw new Error("Parameters in function ones must be positive integers")}))}(t),e){var o=n(e);return t.length>0?o.resize(t,i):o}var a=[];return t.length>0?CN(a,t,i):a}})),tI=HN("reshape",["typed","isInteger","matrix"],(function(t){var e=t.isInteger,n=t.matrix;return(0,t.typed)("reshape",{"Matrix, Array":function(t,e){return t.reshape?t.reshape(e):n(ON(t.valueOf(),e))},"Array, Array":function(t,n){return n.forEach((function(t){if(!e(t))throw new TypeError("Invalid size for dimension: "+t)})),ON(t,n)}})})),eI=HN("size",["typed","config","?matrix"],(function(t){var e=t.config,n=t.matrix;return(0,t.typed)("size",{Matrix:function(t){return t.create(t.size())},Array:NN,string:function(t){return"Array"===e.matrix?[t.length]:n([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===e.matrix?[]:n?n([]):rA()}})})),nI=HN("zeros",["typed","config","matrix","BigNumber"],(function(t){var e=t.config,n=t.matrix,r=t.BigNumber;return(0,t.typed)("zeros",{"":function(){return"Array"===e.matrix?i([]):i([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var n=t.pop();return i(t,n)}return"Array"===e.matrix?i(t):i(t,"default")},Array:i,Matrix:function(t){var e=t.storage();return i(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return i(t.valueOf(),e)}});function i(t,e){var i=function(t){var e=!1;return t.forEach((function(t,n,r){iE(t)&&(e=!0,r[n]=t.toNumber())})),e}(t)?new r(0):0;if(function(t){t.forEach((function(t){if("number"!=typeof t||!XE(t)||t<0)throw new Error("Parameters in function zeros must be positive integers")}))}(t),e){var o=n(e);return t.length>0?o.resize(t,i):o}var a=[];return t.length>0?CN(a,t,i):a}})),rI=HN("to",["typed","matrix"],(function(t){var e=t.typed,n=t.matrix,r=DL({typed:e}),i=kL({typed:e});return e("to",{"Unit, Unit | string":function(t,e){return t.to(e)},"Matrix, Matrix":function(t,e){return r(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"Matrix, any":function(t,e){return i(t,e,this,!1)},"any, Matrix":function(t,e){return i(e,t,this,!0)},"Array, any":function(t,e){return i(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return i(n(e),t,this,!0).valueOf()}})}));function iI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?iI(Object(n),!0).forEach((function(e){aI(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):iI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function aI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var sI="Number of decimals in function round must be an integer",uI=HN("round",["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.zeros,o=t.BigNumber,a=t.DenseMatrix,s=jL({typed:e,equalScalar:r}),u=HL({typed:e,DenseMatrix:a}),c=kL({typed:e});return e("round",oI(oI({},cI),{},{Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw new TypeError(sI);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(sI);var n=e.toNumber();return t.round(n)},"number, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(sI);return new o(t).toDecimalPlaces(e.toNumber())},BigNumber:function(t){return t.toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(sI);return t.toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw new TypeError(sI);return t.round(e)},"Array | Matrix":function(t){return FT(t,this,!0)},"SparseMatrix, number | BigNumber":function(t,e){return s(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return c(t,e,this,!1)},"number | Complex | BigNumber, SparseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):u(e,t,this,!0)},"number | Complex | BigNumber, DenseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):c(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return c(n(t),e,this,!1).valueOf()},"number | Complex | BigNumber, Array":function(t,e){return c(n(e),t,this,!0).valueOf()}}))})),cI={number:NR,"number, number":function(t,e){if(!XE(e))throw new TypeError(sI);if(e<0||e>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return NR(t,e)}},lI=HN("algorithm08",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i){var o=t._values,a=t._index,s=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,p=r._ptr,f=r._size,d=r._datatype;if(u.length!==f.length)throw new SN(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");if(!o||!l)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var m,g=u[0],y=u[1],v=n,x=0,b=i;"string"==typeof c&&c===d&&(v=e.find(n,[m=c,m]),x=e.convert(0,m),b=e.find(i,[m,m]));for(var w,_,M,S=[],E=[],N=[],T=[],A=[],C=0;C<y;C++){N[C]=E.length;var O=C+1;for(_=s[C+1],w=s[C];w<_;w++)A[M=a[w]]=O,T[M]=o[w],E.push(M);for(_=p[C+1],w=p[C];w<_;w++)A[M=h[w]]===O&&(T[M]=b(T[M],l[w]));for(w=N[C];w<E.length;){var R=T[M=E[w]];v(R,x)?E.splice(w,1):(S.push(R),w++)}}return N[y]=E.length,t.createSparseMatrix({values:S,index:E,ptr:N,size:[g,y],datatype:m})}})),hI=HN("leftShift",["typed","matrix","equalScalar","zeros","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.zeros,o=t.DenseMatrix,a=PL({typed:e}),s=BL({typed:e,equalScalar:r}),u=lI({typed:e,equalScalar:r}),c=IL({typed:e,DenseMatrix:o}),l=jL({typed:e,equalScalar:r}),h=DL({typed:e}),p=kL({typed:e});return e("leftShift",{"number, number":ZR,"BigNumber, BigNumber":FR,"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return s(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():l(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():p(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):c(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):p(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return this(n(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return this(t,n(e)).valueOf()}})})),pI=HN("rightLogShift",["typed","matrix","equalScalar","zeros","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.zeros,o=t.DenseMatrix,a=PL({typed:e}),s=BL({typed:e,equalScalar:r}),u=lI({typed:e,equalScalar:r}),c=IL({typed:e,DenseMatrix:o}),l=jL({typed:e,equalScalar:r}),h=DL({typed:e}),p=kL({typed:e});return e("rightLogShift",{"number, number":YR,"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return s(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():l(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():p(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):c(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):p(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return this(n(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return this(t,n(e)).valueOf()}})})),fI=HN("compare",["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix"],(function(t){var e=t.typed,n=t.config,r=t.equalScalar,i=t.matrix,o=t.BigNumber,a=t.Fraction,s=t.DenseMatrix,u=UL({typed:e}),c=FL({typed:e,equalScalar:r}),l=HL({typed:e,DenseMatrix:s}),h=DL({typed:e}),p=kL({typed:e});return e("compare",{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"number, number":function(t,e){return lN(t,e,n.epsilon)?0:t>e?1:-1},"BigNumber, BigNumber":function(t,e){return KO(t,e,n.epsilon)?new o(0):new o(t.cmp(e))},"Fraction, Fraction":function(t,e){return new a(t.compare(e))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return c(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return u(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(i(t),i(e)).valueOf()},"Array, Matrix":function(t,e){return this(i(t),e)},"Matrix, Array":function(t,e){return this(t,i(e))},"SparseMatrix, any":function(t,e){return l(t,e,this,!1)},"DenseMatrix, any":function(t,e){return p(t,e,this,!1)},"any, SparseMatrix":function(t,e){return l(e,t,this,!0)},"any, DenseMatrix":function(t,e){return p(e,t,this,!0)},"Array, any":function(t,e){return p(i(t),e,this,!1).valueOf()},"any, Array":function(t,e){return p(i(e),t,this,!0).valueOf()}})})),dI=HN("compareText",["typed","matrix"],(function(t){var e=t.typed,n=t.matrix,r=DL({typed:e}),i=kL({typed:e});return e("compareText",{"any, any":MN,"DenseMatrix, DenseMatrix":function(t,e){return r(t,e,MN)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"DenseMatrix, any":function(t,e){return i(t,e,MN,!1)},"any, DenseMatrix":function(t,e){return i(e,t,MN,!0)},"Array, any":function(t,e){return i(n(t),e,MN,!1).valueOf()},"any, Array":function(t,e){return i(n(e),t,MN,!0).valueOf()}})})),mI=HN("smaller",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.config,r=t.matrix,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("smaller",{"boolean, boolean":function(t,e){return t<e},"number, number":function(t,e){return t<e&&!lN(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!KO(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})})),gI=HN("larger",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.config,r=t.matrix,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,e){return t>e&&!lN(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!KO(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})})),yI=HN("unequal",["typed","config","equalScalar","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.equalScalar,r=t.matrix,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("unequal",{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:l(t,e)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,l)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,l,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,l,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,l)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,l,!1)},"DenseMatrix, any":function(t,e){return c(t,e,l,!1)},"any, SparseMatrix":function(t,e){return s(e,t,l,!0)},"any, DenseMatrix":function(t,e){return c(e,t,l,!0)},"Array, any":function(t,e){return c(r(t),e,l,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,l,!0).valueOf()}});function l(t,e){return!n(t,e)}})),vI=(HN("unequal",["typed","equalScalar"],(function(t){var e=t.equalScalar;return(0,t.typed)("unequal",{"any, any":function(t,n){return null===t?null!==n:null===n?null!==t:void 0===t?void 0!==n:void 0===n?void 0!==t:!e(t,n)}})})),HN("ImmutableDenseMatrix",["smaller","DenseMatrix"],(function(t){var e=t.smaller,n=t.DenseMatrix;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!uE(e))throw new Error("Invalid datatype: "+e);if(lE(t)||cE(t)){var i=new n(t,e);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(t&&cE(t.data)&&cE(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=void 0!==t.min?t.min:null,this._max=void 0!==t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+jE(t)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}return(r.prototype=new n).type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(t){switch(arguments.length){case 1:var e=n.prototype.subset.call(this,t);return lE(e)?new r({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:VE(this._data),size:VE(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(null===this._min){var t=null;this.forEach((function(n){(null===t||e(n,t))&&(t=n)})),this._min=null!==t?t:void 0}return this._min},r.prototype.max=function(){if(null===this._max){var t=null;this.forEach((function(n){(null===t||e(t,n))&&(t=n)})),this._max=null!==t?t:void 0}return this._max},r}),{isClass:!0})),xI=HN("FibonacciHeap",["smaller","larger"],(function(t){var e=t.smaller,n=t.larger,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function o(t,e,n){e.left.right=e.right,e.right.left=e.left,n.degree--,n.child===e&&(n.child=e.right),0===n.degree&&(n.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(t,n){var r={key:t,value:n,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,e(t,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var i=this._minimum,o=t.degree,s=t.child;o>0;){var u=s.right;s.left.right=s.right,s.right.left=s.left,s.left=i,s.right=i.right,i.right=s,s.right.left=s,s.parent=null,s=u,o--}return t.left.right=t.right,t.right.left=t.left,i=t===t.right?null:function(t,i){var o,s=Math.floor(Math.log(i)*r)+1,u=new Array(s),c=0,l=t;if(l)for(c++,l=l.right;l!==t;)c++,l=l.right;for(;c>0;){for(var h=l.degree,p=l.right;o=u[h];){if(n(l.key,o.key)){var f=o;o=l,l=f}a(o,l),u[h]=null,h++}u[h]=l,l=p,c--}t=null;for(var d=0;d<s;d++)(o=u[d])&&(t?(o.left.right=o.right,o.right.left=o.left,o.left=t,o.right=t.right,t.right=o,o.right.left=o,e(o.key,t.key)&&(t=o)):t=o);return t}(i=t.right,this._size),this._size--,this._minimum=i,t},i.prototype.remove=function(t){this._minimum=function(t,n,r){n.key=-1;var i=n.parent;return i&&e(n.key,i.key)&&(o(t,n,i),function t(e,n){var r=n.parent;r&&(n.mark?(o(e,n,r),t(r)):n.mark=!0)}(t,i)),e(n.key,t.key)&&(t=n),t}(this._minimum,t),this.extractMinimum()};var a=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1};return i}),{isClass:!0}),bI=HN("sparse",["typed","SparseMatrix"],(function(t){var e=t.SparseMatrix;return(0,t.typed)("sparse",{"":function(){return new e([])},string:function(t){return new e([],t)},"Array | Matrix":function(t){return new e(t)},"Array | Matrix, string":function(t,n){return new e(t,n)}})})),wI=HN("acoth",["typed","config","Complex","BigNumber"],(function(t){var e=t.config,n=t.Complex,r=t.BigNumber;return(0,t.typed)("acoth",{number:function(t){return t>=1||t<=-1||e.predictable?wP(t):new n(t,0).acoth()},Complex:function(t){return t.acoth()},BigNumber:function(t){return new r(1).div(t).atanh()},"Array | Matrix":function(t){return FT(t,this)}})})),_I=HN("algorithm09",["typed","equalScalar"],(function(t){var e=t.typed,n=t.equalScalar;return function(t,r,i){var o=t._values,a=t._index,s=t._ptr,u=t._size,c=t._datatype,l=r._values,h=r._index,p=r._ptr,f=r._size,d=r._datatype;if(u.length!==f.length)throw new SN(u.length,f.length);if(u[0]!==f[0]||u[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");var m,g=u[0],y=u[1],v=n,x=0,b=i;"string"==typeof c&&c===d&&(v=e.find(n,[m=c,m]),x=e.convert(0,m),b=e.find(i,[m,m]));var w,_,M,S,E=o&&l?[]:void 0,N=[],T=[],A=E?[]:void 0,C=[];for(_=0;_<y;_++){T[_]=N.length;var O=_+1;if(A)for(S=p[_+1],M=p[_];M<S;M++)C[w=h[M]]=O,A[w]=l[M];for(S=s[_+1],M=s[_];M<S;M++)if(w=a[M],A){var R=b(o[M],C[w]===O?A[w]:x);v(R,x)||(N.push(w),E.push(R))}else N.push(w)}return T[y]=N.length,t.createSparseMatrix({values:E,index:N,ptr:T,size:[g,y],datatype:m})}})),MI=HN("atan2",["typed","matrix","equalScalar","BigNumber","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.BigNumber,o=t.DenseMatrix,a=BL({typed:e,equalScalar:r}),s=UL({typed:e}),u=_I({typed:e,equalScalar:r}),c=jL({typed:e,equalScalar:r}),l=HL({typed:e,DenseMatrix:o}),h=DL({typed:e}),p=kL({typed:e});return e("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(t,e){return i.atan2(t,e)},"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return s(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return c(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return p(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return l(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return p(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return p(n(t),e,this,!1).valueOf()},"number | BigNumber, Array":function(t,e){return p(n(e),t,this,!0).valueOf()}})})),SI=HN("sec",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("sec",{number:PP,Complex:function(t){return t.sec()},BigNumber:function(t){return new e(1).div(t.cos())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),EI=HN("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.addScalar,i=t.equalScalar,o=t.DenseMatrix,a=PL({typed:e}),s=LL({typed:e,equalScalar:i}),u=IL({typed:e,DenseMatrix:o}),c=DL({typed:e}),l=kL({typed:e});return e("add",GE({"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,r)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,r,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,r,!0)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,r)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"DenseMatrix, any":function(t,e){return l(t,e,r,!1)},"SparseMatrix, any":function(t,e){return u(t,e,r,!1)},"any, DenseMatrix":function(t,e){return l(e,t,r,!0)},"any, SparseMatrix":function(t,e){return u(e,t,r,!0)},"Array, any":function(t,e){return l(n(t),e,r,!1).valueOf()},"any, Array":function(t,e){return l(n(e),t,r,!0).valueOf()},"any, any":r,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},r.signatures))})),NI=HN("dot",["typed","addScalar","multiplyScalar","conj","size"],(function(t){var e=t.typed,n=t.addScalar,r=t.multiplyScalar,i=t.conj,o=t.size;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,o){var u=a(t,o),c=lE(t)?t._data:t,l=lE(t)?t._datatype:void 0,h=lE(o)?o._data:o,p=lE(o)?o._datatype:void 0,f=2===s(t).length,d=2===s(o).length,m=n,g=r;if(l&&p&&l===p&&"string"==typeof l){var y=l;m=e.find(n,[y,y]),g=e.find(r,[y,y])}if(!f&&!d){for(var v=g(i(c[0]),h[0]),x=1;x<u;x++)v=m(v,g(i(c[x]),h[x]));return v}if(!f&&d){for(var b=g(i(c[0]),h[0][0]),w=1;w<u;w++)b=m(b,g(i(c[w]),h[w][0]));return b}if(f&&!d){for(var _=g(i(c[0][0]),h[0]),M=1;M<u;M++)_=m(_,g(i(c[M][0]),h[M]));return _}if(f&&d){for(var S=g(i(c[0][0]),h[0][0]),E=1;E<u;E++)S=m(S,g(i(c[E][0]),h[E][0]));return S}},"SparseMatrix, SparseMatrix":function(t,e){a(t,e);for(var i=t._index,o=t._values,s=e._index,u=e._values,c=0,l=n,h=r,p=0,f=0;p<i.length&&f<s.length;){var d=i[p],m=s[f];d<m?p++:d>m?f++:d===m&&(c=l(c,h(o[p],u[f])),p++,f++)}return c}});function a(t,e){var n,r,i=s(t),o=s(e);if(1===i.length)n=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");n=i[0]}if(1===o.length)r=o[0];else{if(2!==o.length||1!==o[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+o.join(", ")+")");r=o[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}function s(t){return lE(t)?t.size():o(t)}})),TI=HN("composition",["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(function(t){var e=t.addScalar,n=t.combinations,r=t.isPositive,i=t.isInteger,o=t.larger;return(0,t.typed)("composition",{"number | BigNumber, number | BigNumber":function(t,a){if(!(i(t)&&r(t)&&i(a)&&r(a)))throw new TypeError("Positive integer value expected in function composition");if(o(a,t))throw new TypeError("k must be less than or equal to n in function composition");return n(e(t,-1),e(a,-1))}})})),AI=HN("isZero",["typed"],(function(t){return(0,t.typed)("isZero",{number:YO,BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:function(t){return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),CI=HN("abs",["typed"],(function(t){return(0,t.typed)("abs",{number:oR,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return FT(t,this,!0)},Unit:function(t){return t.abs()}})})),OI=HN("floor",["typed","config","round"],(function(t){var e=t.config,n=t.round;return(0,t.typed)("floor",{number:function(t){return lN(t,n(t),e.epsilon)?n(t):Math.floor(t)},Complex:function(t){return t.floor()},BigNumber:function(t){return KO(t,n(t),e.epsilon)?n(t):t.floor()},Fraction:function(t){return t.floor()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),RI=HN("multiply",["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(function(t){var e=t.typed,n=t.matrix,r=t.addScalar,i=t.multiplyScalar,o=t.equalScalar,a=t.dot,s=jL({typed:e,equalScalar:o}),u=kL({typed:e});function c(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}var l=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,n){var o,a=t._data,s=t._size,u=t._datatype,c=n._data,l=n._datatype,h=s[0],p=s[1],f=r,d=i;u&&l&&u===l&&"string"==typeof u&&(f=e.find(r,[o=u,o]),d=e.find(i,[o,o]));for(var m=[],g=0;g<h;g++){for(var y=a[g],v=d(y[0],c[0]),x=1;x<p;x++)v=f(v,d(y[x],c[x]));m[g]=v}return t.createDenseMatrix({data:m,size:[h],datatype:o})},"SparseMatrix, any":function(t,n){var a=t._values,s=t._index,u=t._ptr,c=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,h=n._data,p=n._datatype,f=t._size[0],d=n._size[0],m=[],g=[],y=[],v=r,x=i,b=o,w=0;c&&p&&c===p&&"string"==typeof c&&(v=e.find(r,[l=c,l]),x=e.find(i,[l,l]),b=e.find(o,[l,l]),w=e.convert(0,l));var _=[],M=[];y[0]=0;for(var S=0;S<d;S++){var E=h[S];if(!b(E,w))for(var N=u[S+1],T=u[S];T<N;T++){var A=s[T];M[A]?_[A]=v(_[A],x(E,a[T])):(M[A]=!0,g.push(A),_[A]=x(E,a[T]))}}for(var C=g.length,O=0;O<C;O++)m[O]=_[g[O]];return y[1]=g.length,t.createSparseMatrix({values:m,index:g,ptr:y,size:[f,1],datatype:l})}}),h=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,n){var o,a=t._data,s=t._size,u=t._datatype,c=n._data,l=n._datatype,h=s[0],p=s[1],f=n._size[1],d=r,m=i;u&&l&&u===l&&"string"==typeof u&&(d=e.find(r,[o=u,o]),m=e.find(i,[o,o]));for(var g=[],y=0;y<h;y++){var v=a[y];g[y]=[];for(var x=0;x<f;x++){for(var b=m(v[0],c[0][x]),w=1;w<p;w++)b=d(b,m(v[w],c[w][x]));g[y][x]=b}}return t.createDenseMatrix({data:g,size:[h,f],datatype:o})},"DenseMatrix, SparseMatrix":function(t,n){var a=t._data,s=t._size,u=t._datatype,c=n._values,l=n._index,h=n._ptr,p=n._size,f=n._datatype;if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var d,m=s[0],g=p[1],y=r,v=i,x=o,b=0;u&&f&&u===f&&"string"==typeof u&&(y=e.find(r,[d=u,d]),v=e.find(i,[d,d]),x=e.find(o,[d,d]),b=e.convert(0,d));for(var w=[],_=[],M=[],S=n.createSparseMatrix({values:w,index:_,ptr:M,size:[m,g],datatype:d}),E=0;E<g;E++){M[E]=_.length;var N=h[E],T=h[E+1];if(T>N)for(var A=0,C=0;C<m;C++){for(var O=C+1,R=void 0,P=N;P<T;P++){var L=l[P];A!==O?(R=v(a[C][L],c[P]),A=O):R=y(R,v(a[C][L],c[P]))}A!==O||x(R,b)||(_.push(C),w.push(R))}}return M[g]=_.length,S},"SparseMatrix, DenseMatrix":function(t,n){var a=t._values,s=t._index,u=t._ptr,c=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,h=n._data,p=n._datatype,f=t._size[0],d=n._size[0],m=n._size[1],g=r,y=i,v=o,x=0;c&&p&&c===p&&"string"==typeof c&&(g=e.find(r,[l=c,l]),y=e.find(i,[l,l]),v=e.find(o,[l,l]),x=e.convert(0,l));for(var b=[],w=[],_=[],M=t.createSparseMatrix({values:b,index:w,ptr:_,size:[f,m],datatype:l}),S=[],E=[],N=0;N<m;N++){_[N]=w.length;for(var T=N+1,A=0;A<d;A++){var C=h[A][N];if(!v(C,x))for(var O=u[A+1],R=u[A];R<O;R++){var P=s[R];E[P]!==T?(E[P]=T,w.push(P),S[P]=y(C,a[R])):S[P]=g(S[P],y(C,a[R]))}}for(var L=w.length,I=_[N];I<L;I++)b[I]=S[w[I]]}return _[m]=w.length,M},"SparseMatrix, SparseMatrix":function(t,n){var o,a=t._values,s=t._index,u=t._ptr,c=t._datatype,l=n._values,h=n._index,p=n._ptr,f=n._datatype,d=t._size[0],m=n._size[1],g=a&&l,y=r,v=i;c&&f&&c===f&&"string"==typeof c&&(y=e.find(r,[o=c,o]),v=e.find(i,[o,o]));for(var x,b,w,_,M,S,E=g?[]:void 0,N=[],T=[],A=t.createSparseMatrix({values:E,index:N,ptr:T,size:[d,m],datatype:o}),C=g?[]:void 0,O=[],R=0;R<m;R++){T[R]=N.length;var P=R+1;for(_=p[R+1],w=p[R];w<_;w++)if(S=h[w],g)for(b=u[S+1],x=u[S];x<b;x++)O[M=s[x]]!==P?(O[M]=P,N.push(M),C[M]=v(l[w],a[x])):C[M]=y(C[M],v(l[w],a[x]));else for(b=u[S+1],x=u[S];x<b;x++)O[M=s[x]]!==P&&(O[M]=P,N.push(M));if(g)for(var L=N.length,I=T[R];I<L;I++)E[I]=C[N[I]]}return T[m]=N.length,A}});return e("multiply",GE({"Array, Array":function(t,e){c(NN(t),NN(e));var r=this(n(t),n(e));return lE(r)?r.valueOf():r},"Matrix, Matrix":function(t,n){var o=t.size(),s=n.size();return c(o,s),1===o.length?1===s.length?function(t,e,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return a(t,e)}(t,n,o[0]):function(t,n){if("dense"!==n.storage())throw new Error("Support for SparseMatrix not implemented");return function(t,n){var o,a=t._data,s=t._datatype,u=n._data,c=n._datatype,l=t._size[0],h=n._size[1],p=r,f=i;s&&c&&s===c&&"string"==typeof s&&(p=e.find(r,[o=s,o]),f=e.find(i,[o,o]));for(var d=[],m=0;m<h;m++){for(var g=f(a[0],u[0][m]),y=1;y<l;y++)g=p(g,f(a[y],u[y][m]));d[m]=g}return t.createDenseMatrix({data:d,size:[h],datatype:o})}(t,n)}(t,n):1===s.length?l(t,n):h(t,n)},"Matrix, Array":function(t,e){return this(t,n(e))},"Array, Matrix":function(t,e){return this(n(t,e.storage()),e)},"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return u(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return u(e,t,i,!0)},"Array, any":function(t,e){return u(n(t),e,i,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}},i.signatures))})),PI=HN("dotMultiply",["typed","matrix","equalScalar","multiplyScalar"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.multiplyScalar,o=BL({typed:e,equalScalar:r}),a=_I({typed:e,equalScalar:r}),s=jL({typed:e,equalScalar:r}),u=DL({typed:e}),c=kL({typed:e});return e("dotMultiply",{"any, any":i,"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,i,!1)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,i,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,i,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,i)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return s(t,e,i,!1)},"DenseMatrix, any":function(t,e){return c(t,e,i,!1)},"any, SparseMatrix":function(t,e){return s(e,t,i,!0)},"any, DenseMatrix":function(t,e){return c(e,t,i,!0)},"Array, any":function(t,e){return c(n(t),e,i,!1).valueOf()},"any, Array":function(t,e){return c(n(e),t,i,!0).valueOf()}})})),LI=HN("re",["typed"],(function(t){return(0,t.typed)("re",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.re},"Array | Matrix":function(t){return FT(t,this)}})})),II=HN("flatten",["typed","matrix"],(function(t){var e=t.matrix;return(0,t.typed)("flatten",{Array:function(t){return LN(VE(t))},Matrix:function(t){var n=LN(VE(t.toArray()));return e(n)}})}));function DI(t,e,n,r){if(!(this instanceof DI))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+n+(null!=r?"-"+r:"")+" expected)",this.stack=(new Error).stack}(DI.prototype=new Error).constructor=Error,DI.prototype.name="ArgumentsError",DI.prototype.isArgumentsError=!0;var kI=HN("resize",["config","matrix"],(function(t){var e=t.config,n=t.matrix;return function(t,i,o){if(2!==arguments.length&&3!==arguments.length)throw new DI("resize",arguments.length,2,3);if(lE(i)&&(i=i.valueOf()),iE(i[0])&&(i=i.map((function(t){return iE(t)?t.toNumber():t}))),lE(t))return t.resize(i,o,!0);if("string"==typeof t)return r(t,i,o);var a=!Array.isArray(t)&&"Array"!==e.matrix;if(0===i.length){for(;Array.isArray(t);)t=t[0];return VE(t)}Array.isArray(t)||(t=[t]);var s=CN(t=VE(t),i,o);return a?n(s):s};function r(t,e,n){if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==e.length)throw new SN(e.length,1);var r=e[0];if("number"!=typeof r||!XE(r))throw new TypeError("Invalid size, must contain positive integers (size: "+bN(e)+")");if(t.length>r)return t.substring(0,r);if(t.length<r){for(var i=t,o=0,a=r-t.length;o<a;o++)i+=n;return i}return t}})),zI=HN("squeeze",["typed","matrix"],(function(t){var e=t.matrix;return(0,t.typed)("squeeze",{Array:function(t){return RN(VE(t))},Matrix:function(t){var n=RN(t.toArray());return Array.isArray(n)?e(n):n},any:function(t){return VE(t)}})})),BI=HN("pow",["typed","config","identity","multiply","matrix","fraction","number","Complex"],(function(t){var e=t.config,n=t.identity,r=t.multiply,i=t.matrix,o=t.number,a=t.fraction,s=t.Complex;return(0,t.typed)("pow",{"number, number":u,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(t,n){return n.isInteger()||t>=0||e.predictable?t.pow(n):new s(t.toNumber(),0).pow(n.toNumber(),0)},"Fraction, Fraction":function(t,n){if(1!==n.d){if(e.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return u(t.valueOf(),n.valueOf())}return t.pow(n)},"Array, number":c,"Array, BigNumber":function(t,e){return c(t,e.toNumber())},"Matrix, number":l,"Matrix, BigNumber":function(t,e){return l(t,e.toNumber())},"Unit, number | BigNumber":function(t,e){return t.pow(e)}});function u(t,n){if(e.predictable&&!XE(n)&&t<0)try{var r=a(n),i=o(r);if((n===i||Math.abs((n-i)/n)<1e-14)&&r.d%2==1)return(r.n%2==0?1:-1)*Math.pow(-t,n)}catch(u){}return e.predictable&&(t<-1&&n===1/0||t>-1&&t<0&&n===-1/0)?NaN:XE(n)||t>=0||e.predictable?ER(t,n):t*t<1&&n===1/0||t*t>1&&n===-1/0?0:new s(t,0).pow(n,0)}function c(t,e){if(!XE(e)||e<0)throw new TypeError("For A^b, b must be a positive integer (value is "+e+")");var i=NN(t);if(2!==i.length)throw new Error("For A^b, A must be 2 dimensional (A has "+i.length+" dimensions)");if(i[0]!==i[1])throw new Error("For A^b, A must be square (size is "+i[0]+"x"+i[1]+")");for(var o=n(i[0]).valueOf(),a=t;e>=1;)1==(1&e)&&(o=r(a,o)),e>>=1,a=r(a,a);return o}function l(t,e){return i(c(t.valueOf(),e))}})),UI=HN("dotPow",["typed","equalScalar","matrix","pow","DenseMatrix"],(function(t){var e=t.typed,n=t.equalScalar,r=t.matrix,i=t.pow,o=t.DenseMatrix,a=UL({typed:e}),s=$L({typed:e,DenseMatrix:o}),u=jL({typed:e,equalScalar:n}),c=HL({typed:e,DenseMatrix:o}),l=DL({typed:e}),h=kL({typed:e});return e("dotPow",{"any, any":i,"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,i,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,i,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,i,!1)},"DenseMatrix, DenseMatrix":function(t,e){return l(t,e,i)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return u(t,e,this,!1)},"DenseMatrix, any":function(t,e){return h(t,e,this,!1)},"any, SparseMatrix":function(t,e){return c(e,t,this,!0)},"any, DenseMatrix":function(t,e){return h(e,t,this,!0)},"Array, any":function(t,e){return h(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return h(r(e),t,this,!0).valueOf()}})})),FI=HN("rightArithShift",["typed","matrix","equalScalar","zeros","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.zeros,o=t.DenseMatrix,a=PL({typed:e}),s=BL({typed:e,equalScalar:r}),u=lI({typed:e,equalScalar:r}),c=IL({typed:e,DenseMatrix:o}),l=jL({typed:e,equalScalar:r}),h=DL({typed:e}),p=kL({typed:e});return e("rightArithShift",{"number, number":$R,"BigNumber, BigNumber":jR,"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return s(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():l(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return r(e,0)?t.clone():p(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):c(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return r(t,0)?i(e.size(),e.storage()):p(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return this(n(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return this(t,n(e)).valueOf()}})})),jI=n("P2RJ"),HI=n.n(jI),VI=HN("compareNatural",["typed","compare"],(function(t){var e=t.compare,n=e.signatures["boolean,boolean"];return(0,t.typed)("compareNatural",{"any, any":function(t,i){var o,a=jE(t),s=jE(i);if(!("number"!==a&&"BigNumber"!==a&&"Fraction"!==a||"number"!==s&&"BigNumber"!==s&&"Fraction"!==s))return"0"!==(o=e(t,i)).toString()?o>0?1:-1:HI()(a,s);if("Array"===a||"Matrix"===a||"Array"===s||"Matrix"===s)return 0!==(o=function t(e,n,i){return fE(n)&&fE(i)?r(e,n.toJSON().values,i.toJSON().values):fE(n)?t(e,n.toArray(),i):fE(i)?t(e,n,i.toArray()):pE(n)?t(e,n.toJSON().data,i):pE(i)?t(e,n,i.toJSON().data):Array.isArray(n)?Array.isArray(i)?r(e,n,i):t(e,n,[i]):t(e,[n],i)}(this,t,i))?o:HI()(a,s);if(a!==s)return HI()(a,s);if("Complex"===a)return function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0}(t,i);if("Unit"===a)return t.equalBase(i)?this(t.value,i.value):r(this,t.formatUnits(),i.formatUnits());if("boolean"===a)return n(t,i);if("string"===a)return HI()(t,i);if("Object"===a)return function(t,e,n){var i=Object.keys(e),o=Object.keys(n);i.sort(HI.a),o.sort(HI.a);var a=r(t,i,o);if(0!==a)return a;for(var s=0;s<i.length;s++){var u=t(e[i[s]],n[o[s]]);if(0!==u)return u}return 0}(this,t,i);if("null"===a)return 0;if("undefined"===a)return 0;throw new TypeError('Unsupported type of value "'+a+'"')}});function r(t,e,n){for(var r=0,i=Math.min(e.length,n.length);r<i;r++){var o=t(e[r],n[r]);if(0!==o)return o}return e.length>n.length?1:e.length<n.length?-1:0}})),GI=HN("equalText",["typed","compareText","isZero"],(function(t){var e=t.compareText,n=t.isZero;return(0,t.typed)("equalText",{"any, any":function(t,r){return n(e(t,r))}})})),qI=HN("largerEq",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.config,r=t.matrix,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("largerEq",{"boolean, boolean":function(t,e){return t>=e},"number, number":function(t,e){return t>=e||lN(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.gte(e)||KO(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return-1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})})),WI=HN("partitionSelect",["typed","isNumeric","isNaN","compare"],(function(t){var e=t.isNumeric,n=t.isNaN,r=t.compare,i=r,o=function(t,e){return-r(t,e)};return(0,t.typed)("partitionSelect",{"Array | Matrix, number":function(t,e){return a(t,e,i)},"Array | Matrix, number, string":function(t,e,n){if("asc"===n)return a(t,e,i);if("desc"===n)return a(t,e,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":a});function a(t,e,n){if(!XE(e)||e<0)throw new Error("k must be a non-negative integer");if(lE(t)){if(t.size().length>1)throw new Error("Only one dimensional matrices supported");return s(t.valueOf(),e,n)}if(Array.isArray(t))return s(t,e,n)}function s(t,r,i){if(r>=t.length)throw new Error("k out of bounds");for(var o=0;o<t.length;o++)if(e(t[o])&&n(t[o]))return t[o];for(var a=0,s=t.length-1;a<s;){for(var u=a,c=s,l=t[Math.floor(Math.random()*(s-a+1))+a];u<c;)if(i(t[u],l)>=0){var h=t[c];t[c]=t[u],t[u]=h,--c}else++u;i(t[u],l)>0&&--u,r<=u?s=u:a=u+1}return t[r]}})),ZI=HN("Index",["ImmutableDenseMatrix"],(function(t){var e=t.ImmutableDenseMatrix;function n(t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var e=0,i=arguments.length;e<i;e++){var o=arguments[e];if(dE(o))this._dimensions.push(o),this._isScalar=!1;else if(Array.isArray(o)||lE(o)){var a=r(o.valueOf());this._dimensions.push(a);var s=a.size();1===s.length&&1===s[0]||(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(r([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}}}function r(t){for(var n=0,r=t.length;n<r;n++)if("number"!=typeof t[n]||!XE(t[n]))throw new TypeError("Index parameters must be positive integer numbers");return new e(t)}return n.prototype.type="Index",n.prototype.isIndex=!0,n.prototype.clone=function(){var t=new n;return t._dimensions=VE(this._dimensions),t._isScalar=this._isScalar,t},n.create=function(t){var e=new n;return n.apply(e,t),e},n.prototype.size=function(){for(var t=[],e=0,n=this._dimensions.length;e<n;e++){var r=this._dimensions[e];t[e]="string"==typeof r?1:r.size()[0]}return t},n.prototype.max=function(){for(var t=[],e=0,n=this._dimensions.length;e<n;e++){var r=this._dimensions[e];t[e]="string"==typeof r?r:r.max()}return t},n.prototype.min=function(){for(var t=[],e=0,n=this._dimensions.length;e<n;e++){var r=this._dimensions[e];t[e]="string"==typeof r?r:r.min()}return t},n.prototype.forEach=function(t){for(var e=0,n=this._dimensions.length;e<n;e++)t(this._dimensions[e],e,this)},n.prototype.dimension=function(t){return this._dimensions[t]||null},n.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.valueOf=n.prototype.toArray=function(){for(var t=[],e=0,n=this._dimensions.length;e<n;e++){var r=this._dimensions[e];t.push("string"==typeof r?r:r.toArray())}return t},n.prototype.toString=function(){for(var t=[],e=0,n=this._dimensions.length;e<n;e++){var r=this._dimensions[e];t.push("string"==typeof r?JSON.stringify(r):r.toString())}return"["+t.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(t){return n.create(t.dimensions)},n}),{isClass:!0}),$I=HN("asech",["typed","config","Complex","BigNumber"],(function(t){var e=t.config,n=t.Complex,r=t.BigNumber;return(0,t.typed)("asech",{number:function(t){if(t<=1&&t>=-1||e.predictable){var r=1/t;if(r>0||e.predictable)return EP(t);var i=Math.sqrt(r*r-1);return new n(Math.log(i-r),Math.PI)}return new n(t,0).asech()},Complex:function(t){return t.asech()},BigNumber:function(t){return new r(1).div(t).acosh()},"Array | Matrix":function(t){return FT(t,this)}})})),YI=HN("tan",["typed"],(function(t){return(0,t.typed)("tan",{number:Math.tan,Complex:function(t){return t.tan()},BigNumber:function(t){return t.tan()},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this,!0)}})})),XI=HN("setDifference",["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index,o=t.DenseMatrix;return(0,t.typed)("setDifference",{"Array | Matrix, Array | Matrix":function(t,a){var s;if(0===n(e(t),new i(0)))s=[];else{if(0===n(e(a),new i(0)))return LN(t.toArray());var u,c=UN(LN(Array.isArray(t)?t:t.toArray()).sort(r)),l=UN(LN(Array.isArray(a)?a:a.toArray()).sort(r));s=[];for(var h=0;h<c.length;h++){u=!1;for(var p=0;p<l.length;p++)if(0===r(c[h].value,l[p].value)&&c[h].identifier===l[p].identifier){u=!0;break}u||s.push(c[h])}}return Array.isArray(t)&&Array.isArray(a)?FN(s):new o(FN(s))}})})),JI=HN("setIntersect",["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index,o=t.DenseMatrix;return(0,t.typed)("setIntersect",{"Array | Matrix, Array | Matrix":function(t,a){var s;if(0===n(e(t),new i(0))||0===n(e(a),new i(0)))s=[];else{var u=UN(LN(Array.isArray(t)?t:t.toArray()).sort(r)),c=UN(LN(Array.isArray(a)?a:a.toArray()).sort(r));s=[];for(var l=0;l<u.length;l++)for(var h=0;h<c.length;h++)if(0===r(u[l].value,c[h].value)&&u[l].identifier===c[h].identifier){s.push(u[l]);break}}return Array.isArray(t)&&Array.isArray(a)?FN(s):new o(FN(s))}})})),QI=HN("setMultiplicity",["typed","size","subset","compareNatural","Index"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index;return(0,t.typed)("setMultiplicity",{"number | BigNumber | Fraction | Complex, Array | Matrix":function(t,o){if(0===n(e(o),new i(0)))return 0;for(var a=LN(Array.isArray(o)?o:o.toArray()),s=0,u=0;u<a.length;u++)0===r(a[u],t)&&s++;return s}})})),KI=HN("setSize",["typed","compareNatural"],(function(t){var e=t.compareNatural;return(0,t.typed)("setSize",{"Array | Matrix":function(t){return Array.isArray(t)?LN(t).length:LN(t.toArray()).length},"Array | Matrix, boolean":function(t,n){if(!1===n||0===t.length)return Array.isArray(t)?LN(t).length:LN(t.toArray()).length;for(var r=LN(Array.isArray(t)?t:t.toArray()).sort(e),i=1,o=1;o<r.length;o++)0!==e(r[o],r[o-1])&&i++;return i}})})),tD=HN("norm",["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix"],(function(t){var e=t.abs,n=t.add,r=t.pow,i=t.conj,o=t.sqrt,a=t.multiply,s=t.equalScalar,u=t.larger,c=t.smaller,l=t.matrix;return(0,t.typed)("norm",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},boolean:function(t){return Math.abs(t)},Array:function(t){return h(l(t),2)},Matrix:function(t){return h(t,2)},"number | Complex | BigNumber | boolean, number | BigNumber | string":function(t){return this(t)},"Array, number | BigNumber | string":function(t,e){return h(l(t),e)},"Matrix, number | BigNumber | string":function(t,e){return h(t,e)}});function h(t,l){var p=t.size();if(1===p.length){if(l===Number.POSITIVE_INFINITY||"inf"===l){var f=0;return t.forEach((function(t){var n=e(t);u(n,f)&&(f=n)}),!0),f}var d;if(l===Number.NEGATIVE_INFINITY||"-inf"===l)return t.forEach((function(t){var n=e(t);d&&!c(n,d)||(d=n)}),!0),d||0;if("fro"===l)return h(t,2);if("number"==typeof l&&!isNaN(l)){if(!s(l,0)){var m=0;return t.forEach((function(t){m=n(r(e(t),l),m)}),!0),r(m,1/l)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2===p.length){if(1===l){var g=[],y=0;return t.forEach((function(t,r){var i=r[1],o=n(g[i]||0,e(t));u(o,y)&&(y=o),g[i]=o}),!0),y}if(l===Number.POSITIVE_INFINITY||"inf"===l){var v=[],x=0;return t.forEach((function(t,r){var i=r[0],o=n(v[i]||0,e(t));u(o,x)&&(x=o),v[i]=o}),!0),x}if("fro"===l){var b=0;return t.forEach((function(t,e){b=n(b,a(t,i(t)))})),e(o(b))}if(2===l)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}})),eD=HN("index",["typed","Index"],(function(t){var e=t.Index;return(0,t.typed)("index",{"...number | string | BigNumber | Range | Array | Matrix":function(t){var n=t.map((function(t){return iE(t)?t.toNumber():Array.isArray(t)||lE(t)?t.map((function(t){return iE(t)?t.toNumber():t})):t})),r=new e;return e.apply(r,n),r}})})),nD=HN("quantileSeq",["typed","add","multiply","partitionSelect","compare"],(function(t){var e=t.add,n=t.multiply,r=t.partitionSelect,i=t.compare;function o(t,o,s){var u=LN(t),c=u.length;if(0===c)throw new Error("Cannot calculate quantile of an empty sequence");if(rE(o)){var l=o*(c-1),h=l%1;if(0===h){var p=s?u[l]:r(u,l);return a(p),p}var f,d,m=Math.floor(l);if(s)f=u[m],d=u[m+1];else{d=r(u,m+1),f=u[m];for(var g=0;g<m;++g)i(u[g],f)>0&&(f=u[g])}return a(f),a(d),e(n(f,1-h),n(d,h))}var y=o.times(c-1);if(y.isInteger()){y=y.toNumber();var v=s?u[y]:r(u,y);return a(v),v}var x,b,w=y.floor(),_=y.minus(w),M=w.toNumber();if(s)x=u[M],b=u[M+1];else{b=r(u,M+1),x=u[M];for(var S=0;S<M;++S)i(u[S],x)>0&&(x=u[S])}a(x),a(b);var E=new _.constructor(1);return e(n(x,E.minus(_)),n(b,_))}var a=(0,t.typed)({"number | BigNumber | Unit":function(t){return t}});return function(t,e,n){var r,i,a;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(hE(t)){if("boolean"==typeof(n=n||!1)){if(i=t.valueOf(),rE(e)){if(e<0)throw new Error("N/prob must be non-negative");if(e<=1)return o(i,e,n);if(e>1){if(!XE(e))throw new Error("N must be a positive integer");var s=e+1;r=new Array(e);for(var u=0;u<e;)r[u]=o(i,++u/s,n);return r}}if(iE(e)){var c=e.constructor;if(e.isNegative())throw new Error("N/prob must be non-negative");if(a=new c(1),e.lte(a))return new c(o(i,e,n));if(e.gt(a)){if(!e.isInteger())throw new Error("N must be a positive integer");var l=e.toNumber();if(l>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var h=new c(l+1);r=new Array(l);for(var p=0;p<l;)r[p]=new c(o(i,new c(++p).div(h),n));return r}}if(Array.isArray(e)){r=new Array(e.length);for(var f=0;f<r.length;++f){var d=e[f];if(rE(d)){if(d<0||d>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!iE(d))throw new TypeError("Unexpected type of argument in function quantileSeq");if(a=new d.constructor(1),d.isNegative()||d.gt(a))throw new Error("Probability must be between 0 and 1, inclusive")}r[f]=o(i,d,n)}return r}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}}));function rD(t){var e;if(XE(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:ZP(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*rD(1-t));if(t>=171.35)return 1/0;if(t>85){var n=t*t,r=n*t,i=r*t,o=i*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*n)-139/(51840*r)-571/(2488320*i)+163879/(209018880*o)+5246819/(75246796800*o*t))}--t,e=oD[0];for(var a=1;a<oD.length;++a)e+=oD[a]/(t+a);var s=t+iD+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,t+.5)*Math.exp(-s)*e}rD.signature="number";var iD=4.7421875,oD=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],aD=HN("gamma",["typed","config","multiplyScalar","pow","BigNumber","Complex"],(function(t){var e=t.config,n=t.multiplyScalar,r=t.pow,i=t.BigNumber,o=t.Complex;return(0,t.typed)("gamma",{number:rD,Complex:function(t){if(0===t.im)return this(t.re);t=new o(t.re-1,t.im);for(var e=new o(oD[0],0),i=1;i<oD.length;++i){var a=t.re+i,s=a*a+t.im*t.im;0!==s?(e.re+=oD[i]*a/s,e.im+=-oD[i]*t.im/s):e.re=oD[i]<0?-1/0:1/0}var u=new o(t.re+iD+.5,t.im),c=Math.sqrt(2*Math.PI);t.re+=.5;var l=r(u,t);0===l.im?l.re*=c:(0===l.re||(l.re*=c),l.im*=c);var h=Math.exp(-u.re);return u.re=h*Math.cos(-u.im),u.im=h*Math.sin(-u.im),n(n(l,u),e)},BigNumber:function(t){if(t.isInteger())return t.isNegative()||t.isZero()?new i(1/0):function t(n){if(n<8)return new i([1,1,2,6,24,120,720,5040][n]);var r=e.precision+(0|Math.log(n.toNumber())),o=i.clone({precision:r});if(n%2==1)return n.times(t(new i(n-1)));for(var a=n,s=new o(n),u=n.toNumber();a>2;)s=s.times(u+=a-=2);return new i(s.toPrecision(i.precision))}(t.minus(1));if(!t.isFinite())return new i(t.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(t){return FT(t,this)}})})),sD=HN("bignumber",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("bignumber",{"":function(){return new e(0)},number:function(t){return new e(t+"")},string:function(t){return new e(t)},BigNumber:function(t){return t},Fraction:function(t){return new e(t.n).div(t.d).times(t.s)},null:function(t){return new e(0)},"Array | Matrix":function(t){return FT(t,this)}})})),uD=HN("lcm",["typed","matrix","equalScalar"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=BL({typed:e,equalScalar:r}),o=GL({typed:e,equalScalar:r}),a=jL({typed:e,equalScalar:r}),s=DL({typed:e}),u=kL({typed:e});return e("lcm",{"number, number":gR,"BigNumber, BigNumber":function(t,e){if(!t.isInt()||!e.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(t.isZero())return t;if(e.isZero())return e;for(var n=t.times(e);!e.isZero();){var r=e;e=t.mod(r),t=r}return n.div(t).abs()},"Fraction, Fraction":function(t,e){return t.lcm(e)},"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return i(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return i(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return s(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, number | BigNumber":function(t,e){return a(t,e,this,!1)},"DenseMatrix, number | BigNumber":function(t,e){return u(t,e,this,!1)},"number | BigNumber, SparseMatrix":function(t,e){return a(e,t,this,!0)},"number | BigNumber, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, number | BigNumber":function(t,e){return u(n(t),e,this,!1).valueOf()},"number | BigNumber, Array":function(t,e){return u(n(e),t,this,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,n){for(var r=this(t,e),i=0;i<n.length;i++)r=this(r,n[i]);return r}})})),cD=HN("bitOr",["typed","matrix","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.DenseMatrix,o=PL({typed:e}),a=LL({typed:e,equalScalar:r}),s=IL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("bitOr",{"number, number":qR,"BigNumber, BigNumber":kR,"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(n(e),t,this,!0).valueOf()}})})),lD=HN("kron",["typed","matrix","multiplyScalar"],(function(t){var e=t.matrix,n=t.multiplyScalar;return(0,t.typed)("kron",{"Matrix, Matrix":function(t,n){return e(r(t.toArray(),n.toArray()))},"Matrix, Array":function(t,n){return e(r(t.toArray(),n))},"Array, Matrix":function(t,n){return e(r(t,n.toArray()))},"Array, Array":r});function r(t,e){if(1===NN(t).length&&(t=[t]),1===NN(e).length&&(e=[e]),NN(t).length>2||NN(e).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(t.length)+", y = "+JSON.stringify(e.length)+")");var r=[],i=[];return t.map((function(t){return e.map((function(e){return r.push(i=[]),t.map((function(t){return e.map((function(e){return i.push(n(t,e))}))}))}))}))&&r}})),hD=HN("transpose",["typed","matrix"],(function(t){var e=t.matrix;return(0,t.typed)("transpose",{Array:function(t){return this(e(t)).valueOf()},Matrix:function(t){var e,n=t.size();switch(n.length){case 1:e=t.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+bN(n)+")");switch(t.storage()){case"dense":e=function(t,e,n){for(var r,i=t._data,o=[],a=0;a<n;a++){r=o[a]=[];for(var s=0;s<e;s++)r[s]=VE(i[s][a])}return t.createDenseMatrix({data:o,size:[n,e],datatype:t._datatype})}(t,r,i);break;case"sparse":e=function(t,e,n){for(var r,i,o,a=t._values,s=t._index,u=t._ptr,c=a?[]:void 0,l=[],h=[],p=[],f=0;f<e;f++)p[f]=0;for(r=0,i=s.length;r<i;r++)p[s[r]]++;for(var d=0,m=0;m<e;m++)h.push(d),d+=p[m],p[m]=h[m];for(h.push(d),o=0;o<n;o++)for(var g=u[o+1],y=u[o];y<g;y++){var v=p[s[y]]++;l[v]=o,a&&(c[v]=VE(a[y]))}return t.createSparseMatrix({values:c,index:l,ptr:h,size:[n,e],datatype:t._datatype})}(t,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+bN(this._size)+")")}return e},any:function(t){return VE(t)}})})),pD=HN("numeric",["number","?bignumber","?fraction"],(function(t){var e=t.number,n=t.bignumber,r=t.fraction,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:function(t){return e(t)},BigNumber:n?function(t){return n(t)}:eA,Fraction:r?function(t){return r(t)}:nA};return function(t,e){var n=jE(t);if(!(n in i))throw new TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in o))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(o).join(", "));return e===n?t:o[e](t)}})),fD=HN("and",["typed","matrix","equalScalar","zeros","not"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.zeros,o=t.not,a=BL({typed:e,equalScalar:r}),s=GL({typed:e,equalScalar:r}),u=jL({typed:e,equalScalar:r}),c=DL({typed:e}),l=kL({typed:e});return e("and",{"number, number":nP,"Complex, Complex":function(t,e){return!(0===t.re&&0===t.im||0===e.re&&0===e.im)},"BigNumber, BigNumber":function(t,e){return!(t.isZero()||e.isZero()||t.isNaN()||e.isNaN())},"Unit, Unit":function(t,e){return this(t.value||0,e.value||0)},"SparseMatrix, SparseMatrix":function(t,e){return s(t,e,this,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return a(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return c(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return o(e)?i(t.size(),t.storage()):u(t,e,this,!1)},"DenseMatrix, any":function(t,e){return o(e)?i(t.size(),t.storage()):l(t,e,this,!1)},"any, SparseMatrix":function(t,e){return o(t)?i(t.size(),t.storage()):u(e,t,this,!0)},"any, DenseMatrix":function(t,e){return o(t)?i(t.size(),t.storage()):l(e,t,this,!0)},"Array, any":function(t,e){return this(n(t),e).valueOf()},"any, Array":function(t,e){return this(t,n(e)).valueOf()}})})),dD=HN("smallerEq",["typed","config","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.config,r=t.matrix,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("smallerEq",{"boolean, boolean":function(t,e){return t<=e},"number, number":function(t,e){return t<=e||lN(t,e,n.epsilon)},"BigNumber, BigNumber":function(t,e){return t.lte(e)||KO(t,e,n.epsilon)},"Fraction, Fraction":function(t,e){return 1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return this(t.value,e.value)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,this)},"Array, Array":function(t,e){return this(r(t),r(e)).valueOf()},"Array, Matrix":function(t,e){return this(r(t),e)},"Matrix, Array":function(t,e){return this(t,r(e))},"SparseMatrix, any":function(t,e){return s(t,e,this,!1)},"DenseMatrix, any":function(t,e){return c(t,e,this,!1)},"any, SparseMatrix":function(t,e){return s(e,t,this,!0)},"any, DenseMatrix":function(t,e){return c(e,t,this,!0)},"Array, any":function(t,e){return c(r(t),e,this,!1).valueOf()},"any, Array":function(t,e){return c(r(e),t,this,!0).valueOf()}})})),mD=HN("sort",["typed","matrix","compare","compareNatural"],(function(t){var e=t.matrix,n=t.compare,r=t.compareNatural,i=n,o=function(t,e){return-n(t,e)};return(0,t.typed)("sort",{Array:function(t){return s(t),t.sort(i)},Matrix:function(t){return u(t),e(t.toArray().sort(i),t.storage())},"Array, function":function(t,e){return s(t),t.sort(e)},"Matrix, function":function(t,n){return u(t),e(t.toArray().sort(n),t.storage())},"Array, string":function(t,e){return s(t),t.sort(a(e))},"Matrix, string":function(t,n){return u(t),e(t.toArray().sort(a(n)),t.storage())}});function a(t){if("asc"===t)return i;if("desc"===t)return o;if("natural"===t)return r;throw new Error('String "asc", "desc", or "natural" expected')}function s(t){if(1!==NN(t).length)throw new Error("One dimensional array expected")}function u(t){if(1!==t.size().length)throw new Error("One dimensional matrix expected")}})),gD=HN("cot",["typed","BigNumber"],(function(t){var e=t.BigNumber;return(0,t.typed)("cot",{number:AP,Complex:function(t){return t.cot()},BigNumber:function(t){return new e(1).div(t.tan())},Unit:function(t){if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return this(t.value)},"Array | Matrix":function(t){return FT(t,this)}})})),yD=HN("setDistinct",["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index,o=t.DenseMatrix;return(0,t.typed)("setDistinct",{"Array | Matrix":function(t){var a;if(0===n(e(t),new i(0)))a=[];else{var s=LN(Array.isArray(t)?t:t.toArray()).sort(r);(a=[]).push(s[0]);for(var u=1;u<s.length;u++)0!==r(s[u],s[u-1])&&a.push(s[u])}return Array.isArray(t)?a:new o(a)}})})),vD=HN("setPowerset",["typed","size","subset","compareNatural","Index"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index;return(0,t.typed)("setPowerset",{"Array | Matrix":function(t){if(0===n(e(t),new i(0)))return[];for(var a=LN(Array.isArray(t)?t:t.toArray()).sort(r),s=[],u=0;u.toString(2).length<=a.length;)s.push(o(a,u.toString(2).split("").reverse())),u++;return function(t){for(var e=[],n=t.length-1;n>0;n--)for(var r=0;r<n;r++)t[r].length>t[r+1].length&&(e=t[r],t[r]=t[r+1],t[r+1]=e);return t}(s)}});function o(t,e){for(var n=[],r=0;r<e.length;r++)"1"===e[r]&&n.push(t[r]);return n}})),xD=HN("trace",["typed","matrix","add"],(function(t){var e=t.matrix,n=t.add;return(0,t.typed)("trace",{Array:function(t){return r(e(t))},SparseMatrix:function(t){var e=t._values,r=t._index,i=t._ptr,o=t._size,a=o[1];if(o[0]===a){var s=0;if(e.length>0)for(var u=0;u<a;u++)for(var c=i[u+1],l=i[u];l<c;l++){var h=r[l];if(h===u){s=n(s,e[l]);break}if(h>u)break}return s}throw new RangeError("Matrix must be square (size: "+bN(o)+")")},DenseMatrix:r,any:VE});function r(t){var e=t._size,r=t._data;switch(e.length){case 1:if(1===e[0])return VE(r[0]);throw new RangeError("Matrix must be square (size: "+bN(e)+")");case 2:var i=e[0];if(i===e[1]){for(var o=0,a=0;a<i;a++)o=n(o,r[a][a]);return o}throw new RangeError("Matrix must be square (size: "+bN(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+bN(e)+")")}}})),bD=HN("factorial",["typed","gamma"],(function(t){var e=t.gamma;return(0,t.typed)("factorial",{number:function(t){if(t<0)throw new Error("Value must be non-negative");return e(t+1)},BigNumber:function(t){if(t.isNegative())throw new Error("Value must be non-negative");return e(t.plus(1))},"Array | Matrix":function(t){return FT(t,this)}})})),wD=HN("permutations",["typed","factorial"],(function(t){return(0,t.typed)("permutations",{"number | BigNumber":t.factorial,"number, number":function(t,e){if(!XE(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(!XE(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(e>t)throw new TypeError("second argument k must be less than or equal to first argument n");return ZP(t-e+1,t)},"BigNumber, BigNumber":function(t,e){var n,r;if(!_D(t)||!_D(e))throw new TypeError("Positive integer value expected in function permutations");if(e.gt(t))throw new TypeError("second argument k must be less than or equal to first argument n");for(n=t.mul(0).add(1),r=t.minus(e).plus(1);r.lte(t);r=r.plus(1))n=n.times(r);return n}})}));function _D(t){return t.isInteger()&&t.gte(0)}var MD=HN("ceil",["typed","config","round"],(function(t){var e=t.config,n=t.round;return(0,t.typed)("ceil",{number:function(t){return lN(t,n(t),e.epsilon)?n(t):hR(t)},Complex:function(t){return t.ceil()},BigNumber:function(t){return KO(t,n(t),e.epsilon)?n(t):t.ceil()},Fraction:function(t){return t.ceil()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),SD=HN("subtract",["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.addScalar,o=t.unaryMinus,a=t.DenseMatrix,s=PL({typed:e}),u=UL({typed:e}),c=FL({typed:e,equalScalar:r}),l=IL({typed:e,DenseMatrix:a}),h=DL({typed:e}),p=kL({typed:e});return e("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null===t.value)throw new Error("Parameter x contains a unit with undefined value");if(null===e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=this(n.value,e.value),n.fixPrefix=!1,n},"SparseMatrix, SparseMatrix":function(t,e){return ED(t,e),c(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return ED(t,e),u(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return ED(t,e),s(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return ED(t,e),h(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return l(t,o(e),i)},"DenseMatrix, any":function(t,e){return p(t,e,this)},"any, SparseMatrix":function(t,e){return l(e,t,this,!0)},"any, DenseMatrix":function(t,e){return p(e,t,this,!0)},"Array, any":function(t,e){return p(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return p(n(e),t,this,!0).valueOf()}})}));function ED(t,e){var n=t.size(),r=e.size();if(n.length!==r.length)throw new SN(n.length,r.length)}var ND=HN("cross",["typed","matrix","subtract","multiply"],(function(t){var e=t.matrix,n=t.subtract,r=t.multiply;return(0,t.typed)("cross",{"Matrix, Matrix":function(t,n){return e(i(t.toArray(),n.toArray()))},"Matrix, Array":function(t,n){return e(i(t.toArray(),n))},"Array, Matrix":function(t,n){return e(i(t,n.toArray()))},"Array, Array":i});function i(t,e){var i=Math.max(NN(t).length,NN(e).length);t=RN(t),e=RN(e);var o=NN(t),a=NN(e);if(1!==o.length||1!==a.length||3!==o[0]||3!==a[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+o.join(", ")+"], B = ["+a.join(", ")+"])");var s=[n(r(t[1],e[2]),r(t[2],e[1])),n(r(t[2],e[0]),r(t[0],e[2])),n(r(t[0],e[1]),r(t[1],e[0]))];return i>1?[s]:s}})),TD=HN("ctranspose",["typed","transpose","conj"],(function(t){var e=t.transpose,n=t.conj;return(0,t.typed)("ctranspose",{any:function(t){return n(e(t))}})})),AD=HN("divideScalar",["typed","numeric"],(function(t){var e=t.numeric;return(0,t.typed)("divideScalar",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,n){var r=t.clone(),i=e(1,jE(n));return r.value=this(null===r.value?r._normalize(i):r.value,n),r},"number | Fraction | BigNumber, Unit":function(t,n){var r=n.clone();r=r.pow(-1);var i=e(1,jE(t));return r.value=this(t,null===n.value?n._normalize(i):n.value),r},"Unit, Unit":function(t,e){return t.divide(e)}})})),CD=HN("nthRoots",["config","typed","divideScalar","Complex"],(function(t){var e=t.Complex,n=[function(t){return new e(t,0)},function(t){return new e(0,t)},function(t){return new e(-t,0)},function(t){return new e(0,-t)}];function r(t,r){if(r<0)throw new Error("Root must be greater than zero");if(0===r)throw new Error("Root must be non-zero");if(r%1!=0)throw new Error("Root must be an integer");if(0===t||0===t.abs())return[new e(0,0)];var i,o="number"==typeof t;(o||0===t.re||0===t.im)&&(i=o?2*+(t<0):0===t.im?2*+(t.re<0):2*+(t.im<0)+1);for(var a=t.arg(),s=t.abs(),u=[],c=Math.pow(s,1/r),l=0;l<r;l++){var h=(i+4*l)/r;h!==Math.round(h)?u.push(new e({r:c,phi:(a+2*Math.PI*l)/r})):u.push(n[h%4](c))}return u}return(0,t.typed)("nthRoots",{Complex:function(t){return r(t,2)},"Complex, number":r})}));function OD(t){var e=t.DenseMatrix;return function(t,n,r){var i=t.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+bN(i)+")");var o,a,s,u=i[0];if(u!==i[1])throw new RangeError("Matrix must be square (size: "+bN(i)+")");if(lE(n)){var c=n.size();if(1===c.length){if(c[0]!==u)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(o=[],s=n._data,a=0;a<u;a++)o[a]=[s[a]];return new e({data:o,size:[u,1],datatype:n._datatype})}if(2===c.length){if(c[0]!==u||1!==c[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(pE(n)){if(r){for(o=[],s=n._data,a=0;a<u;a++)o[a]=[s[a][0]];return new e({data:o,size:[u,1],datatype:n._datatype})}return n}for(o=[],a=0;a<u;a++)o[a]=[0];for(var l=n._values,h=n._index,p=n._ptr,f=p[1],d=p[0];d<f;d++)o[a=h[d]][0]=l[d];return new e({data:o,size:[u,1],datatype:n._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}if(cE(n)){var m=NN(n);if(1===m.length){if(m[0]!==u)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(o=[],a=0;a<u;a++)o[a]=[n[a]];return new e({data:o,size:[u,1]})}if(2===m.length){if(m[0]!==u||1!==m[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(o=[],a=0;a<u;a++)o[a]=[n[a][0]];return new e({data:o,size:[u,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}}}var RD=HN("lsolve",["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.divideScalar,i=t.multiplyScalar,o=t.subtract,a=t.equalScalar,s=t.DenseMatrix,u=OD({DenseMatrix:s});return e("lsolve",{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var n,c,l=(e=u(t,e,!0))._data,h=t._size[0],p=t._size[1],f=t._values,d=t._index,m=t._ptr,g=[],y=0;y<p;y++){var v=l[y][0]||0;if(a(v,0))g[y]=[0];else{var x=0,b=[],w=[],_=m[y+1];for(c=m[y];c<_;c++)(n=d[c])===y?x=f[c]:n>y&&(b.push(f[c]),w.push(n));if(a(x,0))throw new Error("Linear system cannot be solved since matrix is singular");var M=r(v,x);for(c=0,_=w.length;c<_;c++)l[n=w[c]]=[o(l[n][0]||0,i(M,b[c]))];g[y]=[M]}}return new s({data:g,size:[h,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return c(t,e)},"Array, Array | Matrix":function(t,e){return c(n(t),e).valueOf()}});function c(t,e){for(var n=(e=u(t,e,!0))._data,c=t._size[0],l=t._size[1],h=[],p=t._data,f=0;f<l;f++){var d=n[f][0]||0,m=void 0;if(a(d,0))m=0;else{var g=p[f][f];if(a(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=r(d,g);for(var y=f+1;y<c;y++)n[y]=[o(n[y][0]||0,i(m,p[y][f]))]}h[f]=[m]}return new s({data:h,size:[c,1]})}})),PD=HN("equal",["typed","matrix","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.DenseMatrix,o=UL({typed:e}),a=$L({typed:e,DenseMatrix:i}),s=HL({typed:e,DenseMatrix:i}),u=DL({typed:e}),c=kL({typed:e});return e("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)},"SparseMatrix, SparseMatrix":function(t,e){return a(t,e,r)},"SparseMatrix, DenseMatrix":function(t,e){return o(e,t,r,!0)},"DenseMatrix, SparseMatrix":function(t,e){return o(t,e,r,!1)},"DenseMatrix, DenseMatrix":function(t,e){return u(t,e,r)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return s(t,e,r,!1)},"DenseMatrix, any":function(t,e){return c(t,e,r,!1)},"any, SparseMatrix":function(t,e){return s(e,t,r,!0)},"any, DenseMatrix":function(t,e){return c(e,t,r,!0)},"Array, any":function(t,e){return c(n(t),e,r,!1).valueOf()},"any, Array":function(t,e){return c(n(e),t,r,!0).valueOf()}})})),LD=(HN("equal",["typed","equalScalar"],(function(t){var e=t.equalScalar;return(0,t.typed)("equal",{"any, any":function(t,n){return null===t?null===n:null===n?null===t:void 0===t?void 0===n:void 0===n?void 0===t:e(t,n)}})})),HN("setCartesian",["typed","size","subset","compareNatural","Index","DenseMatrix"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index,o=t.DenseMatrix;return(0,t.typed)("setCartesian",{"Array | Matrix, Array | Matrix":function(t,a){var s=[];if(0!==n(e(t),new i(0))&&0!==n(e(a),new i(0))){var u=LN(Array.isArray(t)?t:t.toArray()).sort(r),c=LN(Array.isArray(a)?a:a.toArray()).sort(r);s=[];for(var l=0;l<u.length;l++)for(var h=0;h<c.length;h++)s.push([u[l],c[h]])}return Array.isArray(t)&&Array.isArray(a)?s:new o(s)}})}))),ID=HN("setSymDifference",["typed","size","concat","subset","setDifference","Index"],(function(t){var e=t.size,n=t.concat,r=t.subset,i=t.setDifference,o=t.Index;return(0,t.typed)("setSymDifference",{"Array | Matrix, Array | Matrix":function(t,a){if(0===r(e(t),new o(0)))return LN(a);if(0===r(e(a),new o(0)))return LN(t);var s=LN(t),u=LN(a);return n(i(s,u),i(u,s))}})})),DD=HN("hypot",["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(function(t){var e=t.abs,n=t.addScalar,r=t.divideScalar,i=t.multiplyScalar,o=t.sqrt,a=t.smaller,s=t.isPositive;return(0,t.typed)("hypot",{"... number | BigNumber":function(t){for(var u=0,c=0,l=0;l<t.length;l++){var h=e(t[l]);a(c,h)?(u=i(u,i(r(c,h),r(c,h))),u=n(u,1),c=h):u=n(u,s(h)?i(r(h,c),r(h,c)):h)}return i(c,o(u))},Array:function(t){return this.apply(this,LN(t))},Matrix:function(t){return this.apply(this,LN(t.toArray()))}})}));function kD(){return(kD=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var zD=HN("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtract","complex"],(function(t){var e=t.matrix,n=t.zeros,r=t.identity,i=t.isZero,o=t.equal,a=t.sign,s=t.sqrt,u=t.conj,c=t.unaryMinus,l=t.addScalar,h=t.divideScalar,p=t.multiplyScalar,f=t.subtract,d=t.complex;return kD((0,t.typed)("qr",{DenseMatrix:function(t){return g(t)},SparseMatrix:function(t){return function(t){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(t){var n=g(e(t));return{Q:n.Q.valueOf(),R:n.R.valueOf()}}}),{_denseQRimpl:m});function m(t){var e,d,m,g=t._size[0],y=t._size[1],v=r([g],"dense"),x=v._data,b=t.clone(),w=b._data,_=n([g],"");for(m=0;m<Math.min(y,g);++m){var M=w[m][m],S=c(o(M,0)?1:a(M)),E=u(S),N=0;for(e=m;e<g;e++)N=l(N,p(w[e][m],u(w[e][m])));var T=p(S,s(N));if(!i(T)){var A=f(M,T);for(_[m]=1,e=m+1;e<g;e++)_[e]=h(w[e][m],A);var C=c(u(h(A,T))),O=void 0;for(d=m;d<y;d++){for(O=0,e=m;e<g;e++)O=l(O,p(u(_[e]),w[e][d]));for(O=p(O,C),e=m;e<g;e++)w[e][d]=p(f(w[e][d],p(_[e],O)),E)}for(e=0;e<g;e++){for(O=0,d=m;d<g;d++)O=l(O,p(x[e][d],_[d]));for(O=p(O,C),d=m;d<g;++d)x[e][d]=h(f(x[e][d],p(O,u(_[d]))),E)}}}return{Q:v,R:b,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function g(t){var e=m(t),n=e.R._data;if(t._data.length>0)for(var r="Complex"===n[0][0].type?d(0):0,i=0;i<n.length;++i)for(var o=0;o<i&&o<(n[0]||[]).length;++o)n[i][o]=r;return e}})),BD=HN("distance",["typed","addScalar","subtract","divideScalar","multiplyScalar","unaryMinus","sqrt","abs"],(function(t){var e=t.addScalar,n=t.subtract,r=t.multiplyScalar,i=t.divideScalar,o=t.unaryMinus,a=t.sqrt,s=t.abs;return(0,t.typed)("distance",{"Array, Array, Array":function(t,e,a){if(2===t.length&&2===e.length&&2===a.length){if(!c(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(a))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");var s=i(n(a[1],a[0]),n(e[1],e[0])),u=r(r(s,s),e[0]),l=o(r(s,e[0]));return d(t[0],t[1],u,l,t[1])}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(t,e,a){if(2===Object.keys(t).length&&2===Object.keys(e).length&&2===Object.keys(a).length){if(!c(t))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(a))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if("pointX"in t&&"pointY"in t&&"lineOnePtX"in e&&"lineOnePtY"in e&&"lineTwoPtX"in a&&"lineTwoPtY"in a){var s=i(n(a.lineTwoPtY,a.lineTwoPtX),n(e.lineOnePtY,e.lineOnePtX)),u=r(r(s,s),e.lineOnePtX),l=o(r(s,e.lineOnePtX));return d(t.pointX,t.pointY,u,l,t.pointX)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(t,e){if(2===t.length&&3===e.length){if(!c(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!l(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return d(t[0],t[1],e[0],e[1],e[2])}if(3===t.length&&6===e.length){if(!l(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!p(e))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return m(t[0],t[1],t[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(t.length===e.length&&t.length>0){if(!h(t))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!h(e))throw new TypeError("All values of an array should be numbers or BigNumbers");return g(t,e)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(t,e){if(2===Object.keys(t).length&&3===Object.keys(e).length){if(!c(t))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!l(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in t&&"pointY"in t&&"xCoeffLine"in e&&"yCoeffLine"in e&&"constant"in e)return d(t.pointX,t.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(t).length&&6===Object.keys(e).length){if(!l(t))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!p(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in t&&"pointY"in t&&"x0"in e&&"y0"in e&&"z0"in e&&"a"in e&&"b"in e&&"c"in e)return m(t.pointX,t.pointY,t.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2===Object.keys(t).length&&2===Object.keys(e).length){if(!c(t))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in t&&"pointOneY"in t&&"pointTwoX"in e&&"pointTwoY"in e)return g([t.pointOneX,t.pointOneY],[e.pointTwoX,e.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(t).length&&3===Object.keys(e).length){if(!l(t))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!l(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in t&&"pointOneY"in t&&"pointOneZ"in t&&"pointTwoX"in e&&"pointTwoY"in e&&"pointTwoZ"in e)return g([t.pointOneX,t.pointOneY,t.pointOneZ],[e.pointTwoX,e.pointTwoY,e.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(t){if(!function(t){if(2===t[0].length&&u(t[0][0])&&u(t[0][1])){if(t.some((function(t){return 2!==t.length||!u(t[0])||!u(t[1])})))return!1}else{if(!(3===t[0].length&&u(t[0][0])&&u(t[0][1])&&u(t[0][2])))return!1;if(t.some((function(t){return 3!==t.length||!u(t[0])||!u(t[1])||!u(t[2])})))return!1}return!0}(t))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(t){for(var e=[],n=[],r=[],i=0;i<t.length-1;i++)for(var o=i+1;o<t.length;o++)2===t[0].length?(n=[t[i][0],t[i][1]],r=[t[o][0],t[o][1]]):3===t[0].length&&(n=[t[i][0],t[i][1],t[i][2]],r=[t[o][0],t[o][1],t[o][2]]),e.push(g(n,r));return e}(t)}});function u(t){return"number"==typeof t||iE(t)}function c(t){return t.constructor!==Array&&(t=f(t)),u(t[0])&&u(t[1])}function l(t){return t.constructor!==Array&&(t=f(t)),u(t[0])&&u(t[1])&&u(t[2])}function h(t){return Array.isArray(t)||(t=f(t)),t.every(u)}function p(t){return t.constructor!==Array&&(t=f(t)),u(t[0])&&u(t[1])&&u(t[2])&&u(t[3])&&u(t[4])&&u(t[5])}function f(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n}function d(t,n,o,u,c){var l=s(e(e(r(o,t),r(u,n)),c)),h=a(e(r(o,o),r(u,u)));return i(l,h)}function m(t,o,s,u,c,l,h,p,f){var d=[n(r(n(c,o),f),r(n(l,s),p)),n(r(n(l,s),h),r(n(u,t),f)),n(r(n(u,t),p),r(n(c,o),h))];d=a(e(e(r(d[0],d[0]),r(d[1],d[1])),r(d[2],d[2])));var m=a(e(e(r(h,h),r(p,p)),r(f,f)));return i(d,m)}function g(t,i){for(var o=t.length,s=0,u=0,c=0;c<o;c++)u=n(t[c],i[c]),s=e(r(u,u),s);return a(s)}})),UD=HN("stirlingS2",["typed","addScalar","subtract","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","larger"],(function(t){var e=t.addScalar,n=t.subtract,r=t.multiplyScalar,i=t.divideScalar,o=t.pow,a=t.factorial,s=t.combinations,u=t.isNegative,c=t.isInteger,l=t.larger;return(0,t.typed)("stirlingS2",{"number | BigNumber, number | BigNumber":function(t,h){if(!c(t)||u(t)||!c(h)||u(h))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(l(h,t))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var p=a(h),f=0,d=0;d<=h;d++){var m=o(-1,n(h,d)),g=s(h,d),y=o(d,t);f=e(f,r(r(g,y),m))}return i(f,p)}})})),FD=HN("catalan",["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(function(t){var e=t.addScalar,n=t.divideScalar,r=t.multiplyScalar,i=t.combinations,o=t.isNegative,a=t.isInteger;return(0,t.typed)("catalan",{"number | BigNumber":function(t){if(!a(t)||o(t))throw new TypeError("Non-negative integer value expected in function catalan");return n(i(r(t,2),t),e(t,1))}})})),jD=HN("fix",["typed","Complex","ceil","floor"],(function(t){var e=t.Complex,n=t.ceil,r=t.floor;return(0,t.typed)("fix",{number:function(t){return t>0?r(t):n(t)},Complex:function(t){return new e(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im))},BigNumber:function(t){return t.isNegative()?n(t):r(t)},Fraction:function(t){return t.s<0?t.ceil():t.floor()},"Array | Matrix":function(t){return FT(t,this,!0)}})})),HD=HN("prod",["typed","config","multiplyScalar","numeric"],(function(t){var e=t.config,n=t.multiplyScalar,r=t.numeric;return(0,t.typed)("prod",{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(t){return i(t)}});function i(t){var i;if(UT(t,(function(t){try{i=void 0===i?t:n(i,t)}catch(e){throw IA(e,"prod",t)}})),"string"==typeof i&&(i=r(i,e.number)),void 0===i)throw new Error("Cannot calculate prod of an empty array");return i}})),VD=HN("dotDivide",["typed","matrix","equalScalar","divideScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.equalScalar,i=t.divideScalar,o=t.DenseMatrix,a=BL({typed:e,equalScalar:r}),s=UL({typed:e}),u=$L({typed:e,DenseMatrix:o}),c=jL({typed:e,equalScalar:r}),l=HL({typed:e,DenseMatrix:o}),h=DL({typed:e}),p=kL({typed:e});return e("dotDivide",{"any, any":i,"SparseMatrix, SparseMatrix":function(t,e){return u(t,e,i,!1)},"SparseMatrix, DenseMatrix":function(t,e){return a(e,t,i,!0)},"DenseMatrix, SparseMatrix":function(t,e){return s(t,e,i,!1)},"DenseMatrix, DenseMatrix":function(t,e){return h(t,e,i)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return c(t,e,i,!1)},"DenseMatrix, any":function(t,e){return p(t,e,i,!1)},"any, SparseMatrix":function(t,e){return l(e,t,i,!0)},"any, DenseMatrix":function(t,e){return p(e,t,i,!0)},"Array, any":function(t,e){return p(n(t),e,i,!1).valueOf()},"any, Array":function(t,e){return p(n(e),t,i,!0).valueOf()}})})),GD=HN("deepEqual",["typed","equal"],(function(t){var e=t.equal;return(0,t.typed)("deepEqual",{"any, any":function(t,n){return function t(n,r){if(Array.isArray(n)){if(Array.isArray(r)){var i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;o++)if(!t(n[o],r[o]))return!1;return!0}return!1}return!Array.isArray(r)&&e(n,r)}(t.valueOf(),n.valueOf())}})}));function qD(t){return(qD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function WD(){return(WD=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function ZD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ZD(Object(n),!0).forEach((function(e){YD(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZD(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function YD(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var XD=HN("Unit",["?on","config","addScalar","subtract","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(function(t){var e,n,r,i=t.on,o=t.config,a=t.addScalar,s=t.subtract,u=t.multiplyScalar,c=t.divideScalar,l=t.pow,h=t.abs,p=t.fix,f=t.round,d=t.equal,m=t.isNumeric,g=t.format,y=t.Complex,v=t.BigNumber,x=t.Fraction,b=t.number;function w(t,e){if(!(this instanceof w))throw new Error("Constructor must be called with the new operator");if(null!=t&&!m(t)&&!oE(t))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(void 0!==e&&("string"!=typeof e||""===e))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!==e){var n=w.parse(e);this.units=n.units,this.dimensions=n.dimensions}else{this.units=[{unit:D,prefix:R.NONE,power:0}],this.dimensions=[];for(var r=0;r<P.length;r++)this.dimensions[r]=0}this.value=null!=t?this._normalize(t):null,this.fixPrefix=!1,this.skipAutomaticSimplification=!0}function _(){for(;" "===r||"\t"===r;)S()}function M(t){return t>="0"&&t<="9"}function S(){n++,r=e.charAt(n)}function E(t){r=e.charAt(n=t)}function N(){var t="",e=n;if("+"===r?S():"-"===r&&(t+=r,S()),!function(t){return t>="0"&&t<="9"||"."===t}(r))return E(e),null;if("."===r){if(t+=r,S(),!M(r))return E(e),null}else{for(;M(r);)t+=r,S();"."===r&&(t+=r,S())}for(;M(r);)t+=r,S();if("E"===r||"e"===r){var i="",o=n;if(i+=r,S(),"+"!==r&&"-"!==r||(i+=r,S()),!M(r))return E(o),t;for(t+=i;M(r);)t+=r,S()}return t}function T(){for(var t="",i=e.charCodeAt(n);i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122;)t+=r,S(),i=e.charCodeAt(n);return((i=t.charCodeAt(0))>=65&&i<=90||i>=97&&i<=122)&&t||null}function A(t){return r===t?(S(),t):null}function C(t){if(WE(k,t)){var e=k[t];return{unit:e,prefix:e.prefixes[""]}}for(var n in k)if(WE(k,n)&&xN(t,n)){var r=k[n],i=t.substring(0,t.length-n.length),o=WE(r.prefixes,i)?r.prefixes[i]:void 0;if(void 0!==o)return{unit:r,prefix:o}}return null}function O(t){return t.equalBase(L.NONE)&&null!==t.value&&!o.predictable?t.value:t}w.prototype.type="Unit",w.prototype.isUnit=!0,w.parse=function(t,i){if(i=i||{},n=-1,r="","string"!=typeof(e=t))throw new TypeError("Invalid argument in Unit.parse, string expected");var a=new w;a.units=[];var s=1,u=!1;S(),_();var c=N(),l=null;if(c){if("BigNumber"===o.number)l=new v(c);else if("Fraction"===o.number)try{l=new x(c)}catch(M){l=parseFloat(c)}else l=parseFloat(c);_(),A("*")?(s=1,u=!0):A("/")&&(s=-1,u=!0)}for(var h=[],p=1;;){for(_();"("===r;)h.push(s),p*=s,s=1,S(),_();var f;if(!r)break;var d=r;if(null===(f=T()))throw new SyntaxError('Unexpected "'+d+'" in "'+e+'" at index '+n.toString());var m=C(f);if(null===m)throw new SyntaxError('Unit "'+f+'" not found.');var g=s*p;if(_(),A("^")){_();var y=N();if(null===y)throw new SyntaxError('In "'+t+'", "^" must be followed by a floating-point number');g*=y}a.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var b=0;b<P.length;b++)a.dimensions[b]+=(m.unit.dimensions[b]||0)*g;for(_();")"===r;){if(0===h.length)throw new SyntaxError('Unmatched ")" in "'+e+'" at index '+n.toString());p/=h.pop(),S(),_()}u=!1,A("*")?(s=1,u=!0):A("/")?(s=-1,u=!0):s=1,m.unit.base&&(U.auto[m.unit.base.key]={unit:m.unit,prefix:m.prefix})}if(_(),r)throw new SyntaxError('Could not parse: "'+t+'"');if(u)throw new SyntaxError('Trailing characters: "'+t+'"');if(0!==h.length)throw new SyntaxError('Unmatched "(" in "'+e+'"');if(0===a.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+t+'" contains no units');return a.value=void 0!==l?a._normalize(l):null,a},w.prototype.clone=function(){var t=new w;t.fixPrefix=this.fixPrefix,t.skipAutomaticSimplification=this.skipAutomaticSimplification,t.value=VE(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++)for(var n in t.units[e]={},this.units[e])WE(this.units[e],n)&&(t.units[e][n]=this.units[e][n]);return t},w.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},w.prototype._normalize=function(t){var e,n,r,i,o;if(null==t||0===this.units.length)return t;if(this._isDerived()){var s=t;o=w._getNumberConverter(jE(t));for(var c=0;c<this.units.length;c++)e=o(this.units[c].unit.value),i=o(this.units[c].prefix.value),r=o(this.units[c].power),s=u(s,l(u(e,i),r));return s}return e=(o=w._getNumberConverter(jE(t)))(this.units[0].unit.value),n=o(this.units[0].unit.offset),i=o(this.units[0].prefix.value),u(a(t,n),u(e,i))},w.prototype._denormalize=function(t,e){var n,r,i,o,a;if(null==t||0===this.units.length)return t;if(this._isDerived()){var h=t;a=w._getNumberConverter(jE(t));for(var p=0;p<this.units.length;p++)n=a(this.units[p].unit.value),o=a(this.units[p].prefix.value),i=a(this.units[p].power),h=c(h,l(u(n,o),i));return h}return n=(a=w._getNumberConverter(jE(t)))(this.units[0].unit.value),o=a(this.units[0].prefix.value),r=a(this.units[0].unit.offset),s(c(c(t,n),null==e?o:e),r)},w.isValuelessUnit=function(t){return null!==C(t)},w.prototype.hasBase=function(t){if("string"==typeof t&&(t=L[t]),!t)return!1;for(var e=0;e<P.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},w.prototype.equalBase=function(t){for(var e=0;e<P.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},w.prototype.equals=function(t){return this.equalBase(t)&&d(this.value,t.value)},w.prototype.multiply=function(t){for(var e=this.clone(),n=0;n<P.length;n++)e.dimensions[n]=(this.dimensions[n]||0)+(t.dimensions[n]||0);for(var r=0;r<t.units.length;r++){var i=$D({},t.units[r]);e.units.push(i)}if(null!==this.value||null!==t.value){var o=null===this.value?this._normalize(1):this.value,a=null===t.value?t._normalize(1):t.value;e.value=u(o,a)}else e.value=null;return e.skipAutomaticSimplification=!1,O(e)},w.prototype.divide=function(t){for(var e=this.clone(),n=0;n<P.length;n++)e.dimensions[n]=(this.dimensions[n]||0)-(t.dimensions[n]||0);for(var r=0;r<t.units.length;r++){var i=$D($D({},t.units[r]),{},{power:-t.units[r].power});e.units.push(i)}if(null!==this.value||null!==t.value){var o=null===this.value?this._normalize(1):this.value,a=null===t.value?t._normalize(1):t.value;e.value=c(o,a)}else e.value=null;return e.skipAutomaticSimplification=!1,O(e)},w.prototype.pow=function(t){for(var e=this.clone(),n=0;n<P.length;n++)e.dimensions[n]=(this.dimensions[n]||0)*t;for(var r=0;r<e.units.length;r++)e.units[r].power*=t;return e.value=null!==e.value?l(e.value,t):null,e.skipAutomaticSimplification=!1,O(e)},w.prototype.abs=function(){var t=this.clone();for(var e in t.value=null!==t.value?h(t.value):null,t.units)"VA"!==t.units[e].unit.name&&"VAR"!==t.units[e].unit.name||(t.units[e].unit=k.W);return t},w.prototype.to=function(t){var e,n=null===this.value?this._normalize(1):this.value;if("string"==typeof t){if(e=w.parse(t),!this.equalBase(e))throw new Error("Units do not match ('".concat(e.toString(),"' != '").concat(this.toString(),"')"));if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return e.value=VE(n),e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e}if(sE(t)){if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");return(e=t.clone()).value=VE(n),e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e}throw new Error("String or Unit expected as parameter")},w.prototype.toNumber=function(t){return b(this.toNumeric(t))},w.prototype.toNumeric=function(t){var e;return(e=t?this.to(t):this.clone())._isDerived()||0===e.units.length?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},w.prototype.toString=function(){return this.format()},w.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},w.fromJSON=function(t){var e=new w(t.value,t.unit);return e.fixPrefix=t.fixPrefix||!1,e},w.prototype.valueOf=w.prototype.toString,w.prototype.simplify=function(){var t,e,n=this.clone(),r=[];for(var i in F)if(WE(F,i)&&n.hasBase(L[i])){t=i;break}if("NONE"===t)n.units=[];else if(t&&WE(F,t)&&(e=F[t]),e)n.units=[{unit:e.unit,prefix:e.prefix,power:1}];else{for(var o=!1,a=0;a<P.length;a++){var s=P[a];Math.abs(n.dimensions[a]||0)>1e-12&&(WE(F,s)?r.push({unit:F[s].unit,prefix:F[s].prefix,power:n.dimensions[a]||0}):o=!0)}r.length<n.units.length&&!o&&(n.units=r)}return n},w.prototype.toSI=function(){for(var t=this.clone(),e=[],n=0;n<P.length;n++){var r=P[n];if(Math.abs(t.dimensions[n]||0)>1e-12){if(!WE(U.si,r))throw new Error("Cannot express custom unit "+r+" in SI units");e.push({unit:U.si[r].unit,prefix:U.si[r].prefix,power:t.dimensions[n]||0})}}return t.units=e,t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},w.prototype.formatUnits=function(){for(var t="",e="",n=0,r=0,i=0;i<this.units.length;i++)this.units[i].power>0?(n++,t+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(t+="^"+this.units[i].power)):this.units[i].power<0&&r++;if(r>0)for(var o=0;o<this.units.length;o++)this.units[o].power<0&&(n>0?(e+=" "+this.units[o].prefix.name+this.units[o].unit.name,Math.abs(this.units[o].power+1)>1e-15&&(e+="^"+-this.units[o].power)):(e+=" "+this.units[o].prefix.name+this.units[o].unit.name,e+="^"+this.units[o].power));t=t.substr(1),e=e.substr(1),n>1&&r>0&&(t="("+t+")"),r>1&&n>0&&(e="("+e+")");var a=t;return n>0&&r>0&&(a+=" / "),a+e},w.prototype.format=function(t){var e=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),n=!1;for(var r in null!=e.value&&oE(e.value)&&(n=Math.abs(e.value.re)<1e-14),e.units)WE(e.units,r)&&e.units[r].unit&&("VA"===e.units[r].unit.name&&n?e.units[r].unit=k.VAR:"VAR"!==e.units[r].unit.name||n||(e.units[r].unit=k.VA));1!==e.units.length||e.fixPrefix||Math.abs(e.units[0].power-Math.round(e.units[0].power))<1e-14&&(e.units[0].prefix=e._bestPrefix());var i=e._denormalize(e.value),o=null!==e.value?g(i,t||{}):"",a=e.formatUnits();return e.value&&oE(e.value)&&(o="("+o+")"),a.length>0&&o.length>0&&(o+=" "),o+a},w.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=null!==this.value?h(this.value):0,e=h(this.units[0].unit.value),n=this.units[0].prefix;if(0===t)return n;var r=this.units[0].power,i=Math.log(t/Math.pow(n.value*e,r))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return n;i=Math.abs(i);var o=this.units[0].unit.prefixes;for(var a in o)if(WE(o,a)){var s=o[a];if(s.scientific){var u=Math.abs(Math.log(t/Math.pow(s.value*e,r))/Math.LN10-1.2);(u<i||u===i&&s.name.length<n.name.length)&&(n=s,i=u)}}return n},w.prototype.splitUnit=function(t){for(var e=this.clone(),n=[],r=0;r<t.length&&(e=e.to(t[r]),r!==t.length-1);r++){var i=e.toNumeric(),o=f(i),u=new w(d(o,i)?o:p(e.toNumeric()),t[r].toString());n.push(u),e=s(e,u)}for(var c=0,l=0;l<n.length;l++)c=a(c,n[l].value);return d(c,this.value)&&(e.value=0),n.push(e),n};var R={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};R.SHORTLONG=WD({},R.SHORT,R.LONG),R.BINARY_SHORT=WD({},R.BINARY_SHORT_SI,R.BINARY_SHORT_IEC),R.BINARY_LONG=WD({},R.BINARY_LONG_SI,R.BINARY_LONG_IEC);var P=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],L={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var I in L)WE(L,I)&&(L[I].key=I);var D={name:"",base:{},value:1,offset:0,dimensions:P.map((function(t){return 0}))},k={meter:{name:"meter",base:L.LENGTH,prefixes:R.LONG,value:1,offset:0},inch:{name:"inch",base:L.LENGTH,prefixes:R.NONE,value:.0254,offset:0},foot:{name:"foot",base:L.LENGTH,prefixes:R.NONE,value:.3048,offset:0},yard:{name:"yard",base:L.LENGTH,prefixes:R.NONE,value:.9144,offset:0},mile:{name:"mile",base:L.LENGTH,prefixes:R.NONE,value:1609.344,offset:0},link:{name:"link",base:L.LENGTH,prefixes:R.NONE,value:.201168,offset:0},rod:{name:"rod",base:L.LENGTH,prefixes:R.NONE,value:5.0292,offset:0},chain:{name:"chain",base:L.LENGTH,prefixes:R.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:L.LENGTH,prefixes:R.NONE,value:1e-10,offset:0},m:{name:"m",base:L.LENGTH,prefixes:R.SHORT,value:1,offset:0},in:{name:"in",base:L.LENGTH,prefixes:R.NONE,value:.0254,offset:0},ft:{name:"ft",base:L.LENGTH,prefixes:R.NONE,value:.3048,offset:0},yd:{name:"yd",base:L.LENGTH,prefixes:R.NONE,value:.9144,offset:0},mi:{name:"mi",base:L.LENGTH,prefixes:R.NONE,value:1609.344,offset:0},li:{name:"li",base:L.LENGTH,prefixes:R.NONE,value:.201168,offset:0},rd:{name:"rd",base:L.LENGTH,prefixes:R.NONE,value:5.02921,offset:0},ch:{name:"ch",base:L.LENGTH,prefixes:R.NONE,value:20.1168,offset:0},mil:{name:"mil",base:L.LENGTH,prefixes:R.NONE,value:254e-7,offset:0},m2:{name:"m2",base:L.SURFACE,prefixes:R.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:L.SURFACE,prefixes:R.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:L.SURFACE,prefixes:R.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:L.SURFACE,prefixes:R.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:L.SURFACE,prefixes:R.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:L.SURFACE,prefixes:R.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:L.SURFACE,prefixes:R.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:L.SURFACE,prefixes:R.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:L.SURFACE,prefixes:R.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:L.SURFACE,prefixes:R.NONE,value:1e4,offset:0},m3:{name:"m3",base:L.VOLUME,prefixes:R.CUBIC,value:1,offset:0},L:{name:"L",base:L.VOLUME,prefixes:R.SHORT,value:.001,offset:0},l:{name:"l",base:L.VOLUME,prefixes:R.SHORT,value:.001,offset:0},litre:{name:"litre",base:L.VOLUME,prefixes:R.LONG,value:.001,offset:0},cuin:{name:"cuin",base:L.VOLUME,prefixes:R.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:L.VOLUME,prefixes:R.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:L.VOLUME,prefixes:R.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:L.VOLUME,prefixes:R.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:L.VOLUME,prefixes:R.NONE,value:15e-6,offset:0},drop:{name:"drop",base:L.VOLUME,prefixes:R.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:L.VOLUME,prefixes:R.NONE,value:5e-8,offset:0},minim:{name:"minim",base:L.VOLUME,prefixes:R.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:L.VOLUME,prefixes:R.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:L.VOLUME,prefixes:R.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:L.VOLUME,prefixes:R.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:L.VOLUME,prefixes:R.NONE,value:1e-6,offset:0},cup:{name:"cup",base:L.VOLUME,prefixes:R.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:L.VOLUME,prefixes:R.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:L.VOLUME,prefixes:R.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:L.VOLUME,prefixes:R.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:L.VOLUME,prefixes:R.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:L.VOLUME,prefixes:R.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:L.VOLUME,prefixes:R.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:L.VOLUME,prefixes:R.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:L.VOLUME,prefixes:R.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:L.VOLUME,prefixes:R.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:L.VOLUME,prefixes:R.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:L.VOLUME,prefixes:R.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:L.VOLUME,prefixes:R.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:L.VOLUME,prefixes:R.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:L.VOLUME,prefixes:R.NONE,value:.1173478,offset:0},obl:{name:"obl",base:L.VOLUME,prefixes:R.NONE,value:.1589873,offset:0},g:{name:"g",base:L.MASS,prefixes:R.SHORT,value:.001,offset:0},gram:{name:"gram",base:L.MASS,prefixes:R.LONG,value:.001,offset:0},ton:{name:"ton",base:L.MASS,prefixes:R.SHORT,value:907.18474,offset:0},t:{name:"t",base:L.MASS,prefixes:R.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:L.MASS,prefixes:R.LONG,value:1e3,offset:0},grain:{name:"grain",base:L.MASS,prefixes:R.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:L.MASS,prefixes:R.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:L.MASS,prefixes:R.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:L.MASS,prefixes:R.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:L.MASS,prefixes:R.NONE,value:45.359237,offset:0},stick:{name:"stick",base:L.MASS,prefixes:R.NONE,value:.115,offset:0},stone:{name:"stone",base:L.MASS,prefixes:R.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:L.MASS,prefixes:R.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:L.MASS,prefixes:R.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:L.MASS,prefixes:R.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:L.MASS,prefixes:R.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:L.MASS,prefixes:R.NONE,value:45.359237,offset:0},s:{name:"s",base:L.TIME,prefixes:R.SHORT,value:1,offset:0},min:{name:"min",base:L.TIME,prefixes:R.NONE,value:60,offset:0},h:{name:"h",base:L.TIME,prefixes:R.NONE,value:3600,offset:0},second:{name:"second",base:L.TIME,prefixes:R.LONG,value:1,offset:0},sec:{name:"sec",base:L.TIME,prefixes:R.LONG,value:1,offset:0},minute:{name:"minute",base:L.TIME,prefixes:R.NONE,value:60,offset:0},hour:{name:"hour",base:L.TIME,prefixes:R.NONE,value:3600,offset:0},day:{name:"day",base:L.TIME,prefixes:R.NONE,value:86400,offset:0},week:{name:"week",base:L.TIME,prefixes:R.NONE,value:604800,offset:0},month:{name:"month",base:L.TIME,prefixes:R.NONE,value:2629800,offset:0},year:{name:"year",base:L.TIME,prefixes:R.NONE,value:31557600,offset:0},decade:{name:"decade",base:L.TIME,prefixes:R.NONE,value:315576e3,offset:0},century:{name:"century",base:L.TIME,prefixes:R.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:L.TIME,prefixes:R.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:L.FREQUENCY,prefixes:R.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:L.FREQUENCY,prefixes:R.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:L.ANGLE,prefixes:R.SHORT,value:1,offset:0},radian:{name:"radian",base:L.ANGLE,prefixes:R.LONG,value:1,offset:0},deg:{name:"deg",base:L.ANGLE,prefixes:R.SHORT,value:null,offset:0},degree:{name:"degree",base:L.ANGLE,prefixes:R.LONG,value:null,offset:0},grad:{name:"grad",base:L.ANGLE,prefixes:R.SHORT,value:null,offset:0},gradian:{name:"gradian",base:L.ANGLE,prefixes:R.LONG,value:null,offset:0},cycle:{name:"cycle",base:L.ANGLE,prefixes:R.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:L.ANGLE,prefixes:R.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:L.ANGLE,prefixes:R.NONE,value:null,offset:0},A:{name:"A",base:L.CURRENT,prefixes:R.SHORT,value:1,offset:0},ampere:{name:"ampere",base:L.CURRENT,prefixes:R.LONG,value:1,offset:0},K:{name:"K",base:L.TEMPERATURE,prefixes:R.NONE,value:1,offset:0},degC:{name:"degC",base:L.TEMPERATURE,prefixes:R.NONE,value:1,offset:273.15},degF:{name:"degF",base:L.TEMPERATURE,prefixes:R.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:L.TEMPERATURE,prefixes:R.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:L.TEMPERATURE,prefixes:R.NONE,value:1,offset:0},celsius:{name:"celsius",base:L.TEMPERATURE,prefixes:R.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:L.TEMPERATURE,prefixes:R.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:L.TEMPERATURE,prefixes:R.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:L.AMOUNT_OF_SUBSTANCE,prefixes:R.SHORT,value:1,offset:0},mole:{name:"mole",base:L.AMOUNT_OF_SUBSTANCE,prefixes:R.LONG,value:1,offset:0},cd:{name:"cd",base:L.LUMINOUS_INTENSITY,prefixes:R.SHORT,value:1,offset:0},candela:{name:"candela",base:L.LUMINOUS_INTENSITY,prefixes:R.LONG,value:1,offset:0},N:{name:"N",base:L.FORCE,prefixes:R.SHORT,value:1,offset:0},newton:{name:"newton",base:L.FORCE,prefixes:R.LONG,value:1,offset:0},dyn:{name:"dyn",base:L.FORCE,prefixes:R.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:L.FORCE,prefixes:R.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:L.FORCE,prefixes:R.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:L.FORCE,prefixes:R.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:L.FORCE,prefixes:R.LONG,value:4448.2216,offset:0},J:{name:"J",base:L.ENERGY,prefixes:R.SHORT,value:1,offset:0},joule:{name:"joule",base:L.ENERGY,prefixes:R.SHORT,value:1,offset:0},erg:{name:"erg",base:L.ENERGY,prefixes:R.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:L.ENERGY,prefixes:R.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:L.ENERGY,prefixes:R.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:L.ENERGY,prefixes:R.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:L.ENERGY,prefixes:R.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:L.POWER,prefixes:R.SHORT,value:1,offset:0},watt:{name:"watt",base:L.POWER,prefixes:R.LONG,value:1,offset:0},hp:{name:"hp",base:L.POWER,prefixes:R.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:L.POWER,prefixes:R.SHORT,value:y.I,offset:0},VA:{name:"VA",base:L.POWER,prefixes:R.SHORT,value:1,offset:0},Pa:{name:"Pa",base:L.PRESSURE,prefixes:R.SHORT,value:1,offset:0},psi:{name:"psi",base:L.PRESSURE,prefixes:R.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:L.PRESSURE,prefixes:R.NONE,value:101325,offset:0},bar:{name:"bar",base:L.PRESSURE,prefixes:R.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:L.PRESSURE,prefixes:R.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:L.PRESSURE,prefixes:R.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:L.PRESSURE,prefixes:R.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:L.PRESSURE,prefixes:R.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:L.ELECTRIC_CHARGE,prefixes:R.LONG,value:1,offset:0},C:{name:"C",base:L.ELECTRIC_CHARGE,prefixes:R.SHORT,value:1,offset:0},farad:{name:"farad",base:L.ELECTRIC_CAPACITANCE,prefixes:R.LONG,value:1,offset:0},F:{name:"F",base:L.ELECTRIC_CAPACITANCE,prefixes:R.SHORT,value:1,offset:0},volt:{name:"volt",base:L.ELECTRIC_POTENTIAL,prefixes:R.LONG,value:1,offset:0},V:{name:"V",base:L.ELECTRIC_POTENTIAL,prefixes:R.SHORT,value:1,offset:0},ohm:{name:"ohm",base:L.ELECTRIC_RESISTANCE,prefixes:R.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:L.ELECTRIC_INDUCTANCE,prefixes:R.LONG,value:1,offset:0},H:{name:"H",base:L.ELECTRIC_INDUCTANCE,prefixes:R.SHORT,value:1,offset:0},siemens:{name:"siemens",base:L.ELECTRIC_CONDUCTANCE,prefixes:R.LONG,value:1,offset:0},S:{name:"S",base:L.ELECTRIC_CONDUCTANCE,prefixes:R.SHORT,value:1,offset:0},weber:{name:"weber",base:L.MAGNETIC_FLUX,prefixes:R.LONG,value:1,offset:0},Wb:{name:"Wb",base:L.MAGNETIC_FLUX,prefixes:R.SHORT,value:1,offset:0},tesla:{name:"tesla",base:L.MAGNETIC_FLUX_DENSITY,prefixes:R.LONG,value:1,offset:0},T:{name:"T",base:L.MAGNETIC_FLUX_DENSITY,prefixes:R.SHORT,value:1,offset:0},b:{name:"b",base:L.BIT,prefixes:R.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:L.BIT,prefixes:R.BINARY_LONG,value:1,offset:0},B:{name:"B",base:L.BIT,prefixes:R.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:L.BIT,prefixes:R.BINARY_LONG,value:8,offset:0}},z={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function B(t){if("BigNumber"===t.number){var e=sC(v);k.rad.value=new v(1),k.deg.value=e.div(180),k.grad.value=e.div(200),k.cycle.value=e.times(2),k.arcsec.value=e.div(648e3),k.arcmin.value=e.div(10800)}else k.rad.value=1,k.deg.value=Math.PI/180,k.grad.value=Math.PI/200,k.cycle.value=2*Math.PI,k.arcsec.value=Math.PI/648e3,k.arcmin.value=Math.PI/10800;k.radian.value=k.rad.value,k.degree.value=k.deg.value,k.gradian.value=k.grad.value}B(o),i&&i("config",(function(t,e){t.number!==e.number&&B(t)}));var U={si:{NONE:{unit:D,prefix:R.NONE[""]},LENGTH:{unit:k.m,prefix:R.SHORT[""]},MASS:{unit:k.g,prefix:R.SHORT.k},TIME:{unit:k.s,prefix:R.SHORT[""]},CURRENT:{unit:k.A,prefix:R.SHORT[""]},TEMPERATURE:{unit:k.K,prefix:R.SHORT[""]},LUMINOUS_INTENSITY:{unit:k.cd,prefix:R.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:k.mol,prefix:R.SHORT[""]},ANGLE:{unit:k.rad,prefix:R.SHORT[""]},BIT:{unit:k.bits,prefix:R.SHORT[""]},FORCE:{unit:k.N,prefix:R.SHORT[""]},ENERGY:{unit:k.J,prefix:R.SHORT[""]},POWER:{unit:k.W,prefix:R.SHORT[""]},PRESSURE:{unit:k.Pa,prefix:R.SHORT[""]},ELECTRIC_CHARGE:{unit:k.C,prefix:R.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:k.F,prefix:R.SHORT[""]},ELECTRIC_POTENTIAL:{unit:k.V,prefix:R.SHORT[""]},ELECTRIC_RESISTANCE:{unit:k.ohm,prefix:R.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:k.H,prefix:R.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:k.S,prefix:R.SHORT[""]},MAGNETIC_FLUX:{unit:k.Wb,prefix:R.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:k.T,prefix:R.SHORT[""]},FREQUENCY:{unit:k.Hz,prefix:R.SHORT[""]}}};U.cgs=JSON.parse(JSON.stringify(U.si)),U.cgs.LENGTH={unit:k.m,prefix:R.SHORT.c},U.cgs.MASS={unit:k.g,prefix:R.SHORT[""]},U.cgs.FORCE={unit:k.dyn,prefix:R.SHORT[""]},U.cgs.ENERGY={unit:k.erg,prefix:R.NONE[""]},U.us=JSON.parse(JSON.stringify(U.si)),U.us.LENGTH={unit:k.ft,prefix:R.NONE[""]},U.us.MASS={unit:k.lbm,prefix:R.NONE[""]},U.us.TEMPERATURE={unit:k.degF,prefix:R.NONE[""]},U.us.FORCE={unit:k.lbf,prefix:R.NONE[""]},U.us.ENERGY={unit:k.BTU,prefix:R.BTU[""]},U.us.POWER={unit:k.hp,prefix:R.NONE[""]},U.us.PRESSURE={unit:k.psi,prefix:R.NONE[""]},U.auto=JSON.parse(JSON.stringify(U.si));var F=U.auto;for(var j in w.setUnitSystem=function(t){if(!WE(U,t))throw new Error("Unit system "+t+" does not exist. Choices are: "+Object.keys(U).join(", "));F=U[t]},w.getUnitSystem=function(){for(var t in U)if(WE(U,t)&&U[t]===F)return t},w.typeConverters={BigNumber:function(t){return new v(t+"")},Fraction:function(t){return new x(t)},Complex:function(t){return t},number:function(t){return t}},w._getNumberConverter=function(t){if(!w.typeConverters[t])throw new TypeError('Unsupported type "'+t+'"');return w.typeConverters[t]},k)if(WE(k,j)){var H=k[j];H.dimensions=H.base.dimensions}for(var V in z)if(WE(z,V)){var G=k[z[V]],q={};for(var W in G)WE(G,W)&&(q[W]=G[W]);q.name=V,k[V]=q}return w.createUnit=function(t,e){if("object"!==qD(t))throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override)for(var n in t)if(WE(t,n)&&w.deleteUnit(n),t[n].aliases)for(var r=0;r<t[n].aliases.length;r++)w.deleteUnit(t[n].aliases[r]);var i;for(var o in t)WE(t,o)&&(i=w.createUnitSingle(o,t[o]));return i},w.createUnitSingle=function(t,e,n){if(null==e&&(e={}),"string"!=typeof t)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(WE(k,t))throw new Error('Cannot create unit "'+t+'": a unit with that name already exists');!function(t){for(var e=0;e<t.length;e++){var n=t.charAt(e),r=function(t){return/^[a-zA-Z]$/.test(t)};if(0===e&&!r(n))throw new Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!r(n)&&!function(t){return t>="0"&&t<="9"}(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}(t);var r,i,o,a=null,s=[],u=0;if(e&&"Unit"===e.type)a=e.clone();else if("string"==typeof e)""!==e&&(r=e);else{if("object"!==qD(e))throw new TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');r=e.definition,i=e.prefixes,u=e.offset,o=e.baseName,e.aliases&&(s=e.aliases.valueOf())}if(s)for(var c=0;c<s.length;c++)if(WE(k,s[c]))throw new Error('Cannot create alias "'+s[c]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!a)try{a=w.parse(r,{allowNoUnits:!0})}catch(S){throw S.message='Could not create unit "'+t+'" from "'+r+'": '+S.message,S}else r&&"Unit"===r.type&&(a=r.clone());s=s||[],u=u||0,i=i&&i.toUpperCase&&R[i.toUpperCase()]||R.NONE;var l={};if(a){l={name:t,value:a.value,dimensions:a.dimensions.slice(0),prefixes:i,offset:u};var h=!1;for(var p in L)if(WE(L,p)){for(var f=!0,d=0;d<P.length;d++)if(Math.abs((l.dimensions[d]||0)-(L[p].dimensions[d]||0))>1e-12){f=!1;break}if(f){h=!0,l.base=L[p];break}}if(!h){o=o||t+"_STUFF";var m={dimensions:a.dimensions.slice(0)};m.key=o,L[o]=m,F[o]={unit:l,prefix:R.NONE[""]},l.base=L[o]}}else{if(P.indexOf(o=o||t+"_STUFF")>=0)throw new Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');for(var g in P.push(o),L)WE(L,g)&&(L[g].dimensions[P.length-1]=0);for(var y={dimensions:[]},v=0;v<P.length;v++)y.dimensions[v]=0;y.dimensions[P.length-1]=1,y.key=o,L[o]=y,l={name:t,value:1,dimensions:L[o].dimensions.slice(0),prefixes:i,offset:u,base:L[o]},F[o]={unit:l,prefix:R.NONE[""]}}w.UNITS[t]=l;for(var x=0;x<s.length;x++){var b=s[x],_={};for(var M in l)WE(l,M)&&(_[M]=l[M]);_.name=b,w.UNITS[b]=_}return new w(null,t)},w.deleteUnit=function(t){delete w.UNITS[t]},w.PREFIXES=R,w.BASE_DIMENSIONS=P,w.BASE_UNITS=L,w.UNIT_SYSTEMS=U,w.UNITS=k,w}),{isClass:!0}),JD=HN("createUnit",["typed","Unit"],(function(t){var e=t.Unit;return(0,t.typed)("createUnit",{"Object, Object":function(t,n){return e.createUnit(t,n)},Object:function(t){return e.createUnit(t,{})},"string, Unit | string | Object, Object":function(t,n,r){var i={};return i[t]=n,e.createUnit(i,r)},"string, Unit | string | Object":function(t,n){var r={};return r[t]=n,e.createUnit(r,{})},string:function(t){var n={};return n[t]={},e.createUnit(n,{})}})})),QD=HN("setUnion",["typed","size","concat","subset","setIntersect","setSymDifference","Index"],(function(t){var e=t.size,n=t.concat,r=t.subset,i=t.setIntersect,o=t.setSymDifference,a=t.Index;return(0,t.typed)("setUnion",{"Array | Matrix, Array | Matrix":function(t,s){if(0===r(e(t),new a(0)))return LN(s);if(0===r(e(s),new a(0)))return LN(t);var u=LN(t),c=LN(s);return n(o(u,c),i(u,c))}})}));function KD(t,e,n,r,i,o,a){var s=0;for(n[a]=t;s>=0;){var u=n[a+s],c=n[r+u];-1===c?(s--,o[e++]=u):(n[r+u]=n[i+c],n[a+ ++s]=c)}return e}function tk(t){return-t-2}var ek=HN("csAmd",["add","multiply","transpose"],(function(t){var e=t.add,n=t.multiply,r=t.transpose;return function(t,a){if(!a||t<=0||t>3)return null;var s=a._size,u=s[0],c=s[1],l=0,h=Math.max(16,10*Math.sqrt(c)),p=function(t,i,o,a,s){var u=r(i);if(1===t&&a===o)return e(i,u);if(2===t){for(var c=u._index,l=u._ptr,h=0,p=0;p<o;p++){var f=l[p];if(l[p]=h,!(l[p+1]-f>s))for(var d=l[p+1];f<d;f++)c[h++]=c[f]}return l[o]=h,i=r(u),n(u,i)}return n(u,i)}(t,a,u,c,h=Math.min(c-2,h));!function(t,e,n){for(var r=t._values,i=t._index,o=t._ptr,a=t._size[1],s=0,u=0;u<a;u++){var c=o[u];for(o[u]=s;c<o[u+1];c++)e(i[c],u,r?r[c]:1,null)&&(i[s]=i[c],r&&(r[s]=r[c]),s++)}o[a]=s,i.splice(s,i.length-s),r&&r.splice(s,r.length-s)}(p,o);for(var f,d,m,g,y,v,x,b,w,_,M,S,E,N,T,A,C=p._index,O=p._ptr,R=O[c],P=[],L=[],I=c+1,D=2*(c+1),k=3*(c+1),z=4*(c+1),B=5*(c+1),U=6*(c+1),F=7*(c+1),j=P,H=function(t,e,n,r,o,a,s,u,c,l,h,p){for(var f=0;f<t;f++)n[0+f]=e[f+1]-e[f];n[0+t]=0;for(var d=0;d<=t;d++)n[o+d]=-1,a[d]=-1,n[s+d]=-1,n[u+d]=-1,n[c+d]=1,n[l+d]=1,n[h+d]=0,n[p+d]=n[0+d];var m=i(0,0,n,l,t);return n[h+t]=-2,e[t]=-1,n[l+t]=0,m}(c,O,L,0,k,j,D,F,I,U,z,B),V=function(t,e,n,r,i,o,a,s,u,c,l){for(var h=0,p=0;p<t;p++){var f=n[r+p];if(0===f)n[i+p]=-2,h++,e[p]=-1,n[o+p]=0;else if(f>a)n[s+p]=0,n[i+p]=-1,h++,e[p]=tk(t),n[s+t]++;else{var d=n[u+f];-1!==d&&(c[d]=p),n[l+p]=n[u+f],n[u+f]=p}}return h}(c,O,L,B,z,U,h,I,k,j,D),G=0;V<c;){for(m=-1;G<c&&-1===(m=L[k+G]);G++);-1!==L[D+m]&&(j[L[D+m]]=-1),L[k+G]=L[D+m];var q=L[z+m],W=L[I+m];V+=W;var Z=0;L[I+m]=-W;var $=O[m],Y=0===q?$:R,X=Y;for(g=1;g<=q+1;g++){for(g>q?(v=m,x=$,b=L[0+m]-q):(x=O[v=C[$++]],b=L[0+v]),y=1;y<=b;y++)(w=L[I+(f=C[x++])])<=0||(Z+=w,L[I+f]=-w,C[X++]=f,-1!==L[D+f]&&(j[L[D+f]]=j[f]),-1!==j[f]?L[D+j[f]]=L[D+f]:L[k+L[B+f]]=L[D+f]);v!==m&&(O[v]=tk(m),L[U+v]=0)}for(0!==q&&(R=X),L[B+m]=Z,O[m]=Y,L[0+m]=X-Y,L[z+m]=-2,H=i(H,l,L,U,c),_=Y;_<X;_++)if(!((M=L[z+(f=C[_])])<=0)){var J=H-(w=-L[I+f]);for($=O[f],S=O[f]+M-1;$<=S;$++)L[U+(v=C[$])]>=H?L[U+v]-=w:0!==L[U+v]&&(L[U+v]=L[B+v]+J)}for(_=Y;_<X;_++){for(E=(S=O[f=C[_]])+L[z+f]-1,N=S,T=0,A=0,$=S;$<=E;$++)if(0!==L[U+(v=C[$])]){var Q=L[U+v]-H;Q>0?(A+=Q,C[N++]=v,T+=v):(O[v]=tk(m),L[U+v]=0)}L[z+f]=N-S+1;var K=N,tt=S+L[0+f];for($=E+1;$<tt;$++){var et=L[I+(d=C[$])];et<=0||(A+=et,C[N++]=d,T+=d)}0===A?(O[f]=tk(m),Z-=w=-L[I+f],W+=w,V+=w,L[I+f]=0,L[z+f]=-1):(L[B+f]=Math.min(L[B+f],A),C[N]=C[K],C[K]=C[S],C[S]=m,L[0+f]=N-S+1,L[D+f]=L[F+(T=(T<0?-T:T)%c)],L[F+T]=f,j[f]=T)}for(L[B+m]=Z,H=i(H+(l=Math.max(l,Z)),l,L,U,c),_=Y;_<X;_++)if(!(L[I+(f=C[_])]>=0))for(f=L[F+(T=j[f])],L[F+T]=-1;-1!==f&&-1!==L[D+f];f=L[D+f],H++){for(b=L[0+f],M=L[z+f],$=O[f]+1;$<=O[f]+b-1;$++)L[U+C[$]]=H;var nt=f;for(d=L[D+f];-1!==d;){var rt=L[0+d]===b&&L[z+d]===M;for($=O[d]+1;rt&&$<=O[d]+b-1;$++)L[U+C[$]]!==H&&(rt=0);rt?(O[d]=tk(f),L[I+f]+=L[I+d],L[I+d]=0,L[z+d]=-1,L[D+nt]=d=L[D+d]):(nt=d,d=L[D+d])}}for($=Y,_=Y;_<X;_++)(w=-L[I+(f=C[_])])<=0||(L[I+f]=w,A=L[B+f]+Z-w,-1!==L[k+(A=Math.min(A,c-V-w))]&&(j[L[k+A]]=f),L[D+f]=L[k+A],j[f]=-1,L[k+A]=f,G=Math.min(G,A),L[B+f]=A,C[$++]=f);L[I+m]=W,0==(L[0+m]=$-Y)&&(O[m]=-1,L[U+m]=0),0!==q&&(R=$)}for(f=0;f<c;f++)O[f]=tk(O[f]);for(d=0;d<=c;d++)L[k+d]=-1;for(d=c;d>=0;d--)L[I+d]>0||(L[D+d]=L[k+O[d]],L[k+O[d]]=d);for(v=c;v>=0;v--)L[I+v]<=0||-1!==O[v]&&(L[D+v]=L[k+O[v]],L[k+O[v]]=v);for(m=0,f=0;f<=c;f++)-1===O[f]&&(m=KD(f,m,L,k,D,P,U));return P.splice(P.length-1,1),P};function i(t,e,n,r,i){if(t<2||t+e<0){for(var o=0;o<i;o++)0!==n[r+o]&&(n[r+o]=1);t=2}return t}function o(t,e){return t!==e}}));function nk(t,e,n,r,i,o,a){var s,u,c,l=0;if(t<=e||n[r+e]<=n[i+t])return-1;n[i+t]=n[r+e];var h=n[o+t];if(n[o+t]=e,-1===h)l=1,c=t;else{for(l=2,c=h;c!==n[a+c];c=n[a+c]);for(s=h;s!==c;s=u)u=n[a+s],n[a+s]=c}return{jleaf:l,q:c}}var rk=HN("csCounts",["transpose"],(function(t){var e=t.transpose;return function(t,n,r,i){if(!t||!n||!r)return null;var o,a,s,u,c,l,h=t._size,p=h[0],f=h[1],d=4*f+(i?f+p+1:0),m=[],g=f,y=2*f,v=3*f,x=4*f,b=5*f+1;for(s=0;s<d;s++)m[s]=-1;var w=[],_=e(t),M=_._index,S=_._ptr;for(s=0;s<f;s++)for(w[a=r[s]]=-1===m[v+a]?1:0;-1!==a&&-1===m[v+a];a=n[a])m[v+a]=s;if(i){for(s=0;s<f;s++)m[r[s]]=s;for(o=0;o<p;o++){for(s=f,l=S[o+1],c=S[o];c<l;c++)s=Math.min(s,m[M[c]]);m[b+o]=m[x+s],m[x+s]=o}}for(o=0;o<f;o++)m[0+o]=o;for(s=0;s<f;s++){for(-1!==n[a=r[s]]&&w[n[a]]--,u=i?m[x+s]:a;-1!==u;u=i?m[b+u]:-1)for(c=S[u];c<S[u+1];c++){var E=nk(o=M[c],a,m,v,g,y,0);E.jleaf>=1&&w[a]++,2===E.jleaf&&w[E.q]--}-1!==n[a]&&(m[0+a]=n[a])}for(a=0;a<f;a++)-1!==n[a]&&(w[n[a]]+=w[a]);return w}})),ik=HN("csSqr",["add","multiply","transpose"],(function(t){var e=t.transpose,n=ek({add:t.add,multiply:t.multiply,transpose:e}),r=rk({transpose:e});return function(t,e,i){var o,a=e._ptr,s=e._size[1],u={};if(u.q=n(t,e),t&&!u.q)return null;if(i){var c=t?function(t,e,n,r){for(var i=t._index,o=t._ptr,a=t._size,s=t._datatype,u=a[0],c=a[1],l=[],h=[],p=0,f=0;f<c;f++){h[f]=p;for(var d=n?n[f]:f,m=o[d+1],g=o[d];g<m;g++)l[p]=i[g],p++}return h[c]=p,t.createSparseMatrix({values:null,index:l,ptr:h,size:[u,c],datatype:s})}(e,0,u.q):e;u.parent=function(t,e){if(!t)return null;var n,r,i=t._index,o=t._ptr,a=t._size,s=a[0],u=a[1],c=[],l=[],h=u;for(n=0;n<s;n++)l[h+n]=-1;for(var p=0;p<u;p++){c[p]=-1,l[0+p]=-1;for(var f=o[p+1],d=o[p];d<f;d++){var m=i[d];for(n=l[h+m];-1!==n&&n<p;n=r)r=l[0+n],l[0+n]=p,-1===r&&(c[n]=p);l[h+m]=p}}return c}(c);var l=function(t,e){if(!t)return null;var n,r=0,i=[],o=[],a=e,s=2*e;for(n=0;n<e;n++)o[0+n]=-1;for(n=e-1;n>=0;n--)-1!==t[n]&&(o[a+n]=o[0+t[n]],o[0+t[n]]=n);for(n=0;n<e;n++)-1===t[n]&&(r=KD(n,r,o,0,a,i,s));return i}(u.parent,s);if(u.cp=r(c,u.parent,l,1),c&&u.parent&&u.cp&&function(t,e){var n=t._ptr,r=t._index,i=t._size,o=i[0],a=i[1];e.pinv=[],e.leftmost=[];var s,u,c,l,h=e.parent,p=e.pinv,f=e.leftmost,d=[],m=o,g=o+a,y=o+2*a;for(u=0;u<a;u++)d[m+u]=-1,d[g+u]=-1,d[y+u]=0;for(s=0;s<o;s++)f[s]=-1;for(u=a-1;u>=0;u--)for(l=n[u+1],c=n[u];c<l;c++)f[r[c]]=u;for(s=o-1;s>=0;s--)p[s]=-1,-1!==(u=f[s])&&(0==d[y+u]++&&(d[g+u]=s),d[0+s]=d[m+u],d[m+u]=s);for(e.lnz=0,e.m2=o,u=0;u<a;u++)if(s=d[m+u],e.lnz++,s<0&&(s=e.m2++),p[s]=u,!(--y[u]<=0)){e.lnz+=d[y+u];var v=h[u];-1!==v&&(0===d[y+v]&&(d[g+v]=d[g+u]),d[0+d[g+u]]=d[m+v],d[m+v]=d[0+s],d[y+v]+=d[y+u])}for(s=0;s<o;s++)p[s]<0&&(p[s]=u++);return!0}(c,u))for(u.unz=0,o=0;o<s;o++)u.unz+=u.cp[o]}else u.unz=4*a[s]+s,u.lnz=u.unz;return u}}));function ok(t,e){return t[e]<0}function ak(t,e){t[e]=tk(t[e])}function sk(t){return t<0?tk(t):t}function uk(t,e,n,r,i){var o,a,s,u=e._index,c=e._ptr,l=e._size[1],h=0;for(r[0]=t;h>=0;){t=r[h];var p=i?i[t]:t;ok(c,t)||(ak(c,t),r[l+h]=p<0?0:sk(c[p]));var f=1;for(a=r[l+h],s=p<0?0:sk(c[p+1]);a<s;a++)if(!ok(c,o=u[a])){r[l+h]=a,r[++h]=o,f=0;break}f&&(h--,r[--n]=t)}return n}var ck=HN("csSpsolve",["divideScalar","multiply","subtract"],(function(t){var e=t.divideScalar,n=t.multiply,r=t.subtract;return function(t,i,o,a,s,u,c){var l,h,p,f,d=t._values,m=t._index,g=t._ptr,y=t._size[1],v=i._values,x=i._index,b=i._ptr,w=function(t,e,n,r,i){var o,a,s=t._ptr,u=e._index,c=e._ptr,l=t._size[1],h=l;for(a=c[n+1],o=c[n];o<a;o++){var p=u[o];ok(s,p)||(h=uk(p,t,h,r,i))}for(o=h;o<l;o++)ak(s,r[o]);return h}(t,i,o,a,u);for(l=w;l<y;l++)s[a[l]]=0;for(p=b[o+1],l=h=b[o];l<p;l++)s[x[l]]=v[l];for(var _=w;_<y;_++){var M=a[_],S=u?u[M]:M;if(!(S<0))for(h=g[S],p=g[S+1],s[M]=e(s[M],d[c?h:p-1]),l=c?h+1:h,f=c?p:p-1;l<f;l++){var E=m[l];s[E]=r(s[E],n(d[l],s[M]))}}return w}})),lk=HN("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(function(t){var e=t.abs,n=t.divideScalar,r=t.multiply,i=t.larger,o=t.largerEq,a=t.SparseMatrix,s=ck({divideScalar:n,multiply:r,subtract:t.subtract});return function(t,u,c){if(!t)return null;var l,h=t._size[1],p=100,f=100;u&&(l=u.q,p=u.lnz||p,f=u.unz||f);var d,m,g=[],y=[],v=[],x=new a({values:g,index:y,ptr:v,size:[h,h]}),b=[],w=[],_=[],M=new a({values:b,index:w,ptr:_,size:[h,h]}),S=[],E=[],N=[];for(d=0;d<h;d++)E[d]=0,S[d]=-1,v[d+1]=0;p=0,f=0;for(var T=0;T<h;T++){v[T]=p,_[T]=f;var A=l?l[T]:T,C=s(x,t,A,N,E,S,1),O=-1,R=-1;for(m=C;m<h;m++)if(S[d=N[m]]<0){var P=e(E[d]);i(P,R)&&(R=P,O=d)}else w[f]=S[d],b[f++]=E[d];if(-1===O||R<=0)return null;S[A]<0&&o(e(E[A]),r(R,c))&&(O=A);var L=E[O];for(w[f]=T,b[f++]=L,S[O]=T,y[p]=O,g[p++]=1,m=C;m<h;m++)S[d=N[m]]<0&&(y[p]=d,g[p++]=n(E[d],L)),E[d]=0}for(v[h]=p,_[h]=f,m=0;m<p;m++)y[m]=S[y[m]];return g.splice(p,g.length-p),y.splice(p,y.length-p),b.splice(f,b.length-f),w.splice(f,w.length-f),{L:x,U:M,pinv:S}}})),hk=HN("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(function(t){var e=t.typed,n=t.abs,r=t.multiply,i=t.divideScalar,o=t.subtract,a=t.larger,s=t.largerEq,u=t.SparseMatrix,c=ik({add:t.add,multiply:r,transpose:t.transpose}),l=lk({abs:n,divideScalar:i,multiply:r,subtract:o,larger:a,largerEq:s,SparseMatrix:u});return e("slu",{"SparseMatrix, number, number":function(t,e,n){if(!XE(e)||e<0||e>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(n<0||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=c(e,t,!1),i=l(t,r,n);return{L:i.L,U:i.U,p:i.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})})),pk=HN("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar"],(function(t){var e=t.config,n=t.abs,r=t.add,i=t.addScalar,o=t.matrix,a=t.multiply,s=t.multiplyScalar,u=t.divideScalar,c=t.subtract,l=t.smaller,h=t.equalScalar;return(0,t.typed)("intersect",{"Array, Array, Array":function(t,e,n){if(!d(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!d(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(t){return 4===t.length&&p(t[0])&&p(t[1])&&p(t[2])&&p(t[3])}(n))throw new TypeError("Array with 4 numbers expected as third argument");return function(t,e,n,r,o,a,l,h,p,f){var d=s(t,l),m=s(r,l),g=s(e,h),y=s(o,h),v=s(n,p),x=s(a,p),b=u(c(c(c(f,d),g),v),c(c(c(i(i(m,y),x),d),g),v));return[i(t,s(b,c(r,t))),i(e,s(b,c(o,e))),i(n,s(b,c(a,n)))]}(t[0],t[1],t[2],e[0],e[1],e[2],n[0],n[1],n[2],n[3])},"Array, Array, Array, Array":function(t,o,p,g){if(2===t.length){if(!f(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!f(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!f(p))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!f(g))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(t,o,h,p){var f=t,d=h,m=c(f,o),g=c(d,p),y=c(s(m[0],g[1]),s(g[0],m[1]));if(l(n(y),e.epsilon))return null;var v=s(g[0],f[1]),x=s(g[1],f[0]),b=s(g[0],d[1]),w=s(g[1],d[0]),_=u(i(c(c(v,x),b),w),y);return r(a(m,_),f)}(t,o,p,g)}if(3===t.length){if(!d(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!d(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!d(p))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!d(g))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return b=o[0],w=o[1],_=o[2],C=m(y=t[0],M=p[0],N=g[0],M,v=t[1],S=p[1],T=g[1],S,x=t[2],E=p[2],A=g[2],E),O=m(N,M,b,y,T,S,w,v,A,E,_,x),R=m(y,M,b,y,v,S,w,v,x,E,_,x),P=m(N,M,N,M,T,S,T,S,A,E,A,E),L=m(b,y,b,y,w,v,w,v,_,x,_,x),I=u(c(s(C,O),s(R,P)),c(s(L,P),s(O,O))),D=u(i(C,s(I,O)),P),k=i(y,s(I,c(b,y))),z=i(v,s(I,c(w,v))),B=i(x,s(I,c(_,x))),U=i(M,s(D,c(N,M))),F=i(S,s(D,c(T,S))),j=i(E,s(D,c(A,E))),h(k,U)&&h(z,F)&&h(B,j)?[k,z,B]:null}throw new TypeError("Arrays with two or thee dimensional points expected");var y,v,x,b,w,_,M,S,E,N,T,A,C,O,R,P,L,I,D,k,z,B,U,F,j},"Matrix, Matrix, Matrix":function(t,e,n){return o(this(t.valueOf(),e.valueOf(),n.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(t,e,n,r){return o(this(t.valueOf(),e.valueOf(),n.valueOf(),r.valueOf()))}});function p(t){return"number"==typeof t||iE(t)}function f(t){return 2===t.length&&p(t[0])&&p(t[1])}function d(t){return 3===t.length&&p(t[0])&&p(t[1])&&p(t[2])}function m(t,e,n,r,o,a,u,l,h,p,f,d){var m=s(c(t,e),c(n,r)),g=s(c(o,a),c(u,l)),y=s(c(h,p),c(f,d));return i(i(m,g),y)}})),fk=HN("bellNumbers",["typed","addScalar","isNegative","isInteger","stirlingS2"],(function(t){var e=t.addScalar,n=t.isNegative,r=t.isInteger,i=t.stirlingS2;return(0,t.typed)("bellNumbers",{"number | BigNumber":function(t){if(!r(t)||n(t))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var o=0,a=0;a<=t;a++)o=e(o,i(t,a));return o}})})),dk=HN("xor",["typed","matrix","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.DenseMatrix,i=UL({typed:e}),o=$L({typed:e,DenseMatrix:r}),a=HL({typed:e,DenseMatrix:r}),s=DL({typed:e}),u=kL({typed:e});return e("xor",{"number, number":eP,"Complex, Complex":function(t,e){return(0!==t.re||0!==t.im)!=(0!==e.re||0!==e.im)},"BigNumber, BigNumber":function(t,e){return(!t.isZero()&&!t.isNaN())!=(!e.isZero()&&!e.isNaN())},"Unit, Unit":function(t,e){return this(t.value||0,e.value||0)},"SparseMatrix, SparseMatrix":function(t,e){return o(t,e,this)},"SparseMatrix, DenseMatrix":function(t,e){return i(e,t,this,!0)},"DenseMatrix, SparseMatrix":function(t,e){return i(t,e,this,!1)},"DenseMatrix, DenseMatrix":function(t,e){return s(t,e,this)},"Array, Array":function(t,e){return this(n(t),n(e)).valueOf()},"Array, Matrix":function(t,e){return this(n(t),e)},"Matrix, Array":function(t,e){return this(t,n(e))},"SparseMatrix, any":function(t,e){return a(t,e,this,!1)},"DenseMatrix, any":function(t,e){return u(t,e,this,!1)},"any, SparseMatrix":function(t,e){return a(e,t,this,!0)},"any, DenseMatrix":function(t,e){return u(e,t,this,!0)},"Array, any":function(t,e){return u(n(t),e,this,!1).valueOf()},"any, Array":function(t,e){return u(n(e),t,this,!0).valueOf()}})})),mk=HN("usolve",["typed","matrix","divideScalar","multiplyScalar","subtract","equalScalar","DenseMatrix"],(function(t){var e=t.typed,n=t.matrix,r=t.divideScalar,i=t.multiplyScalar,o=t.subtract,a=t.equalScalar,s=t.DenseMatrix,u=OD({DenseMatrix:s});return e("usolve",{"SparseMatrix, Array | Matrix":function(t,e){return function(t,e){for(var n,c,l=(e=u(t,e,!0))._data,h=t._size[0],p=t._values,f=t._index,d=t._ptr,m=[],g=t._size[1]-1;g>=0;g--){var y=l[g][0]||0;if(a(y,0))m[g]=[0];else{var v=0,x=[],b=[],w=d[g],_=d[g+1];for(c=_-1;c>=w;c--)(n=f[c])===g?v=p[c]:n<g&&(x.push(p[c]),b.push(n));if(a(v,0))throw new Error("Linear system cannot be solved since matrix is singular");var M=r(y,v);for(c=0,_=b.length;c<_;c++)l[n=b[c]]=[o(l[n][0],i(M,x[c]))];m[g]=[M]}}return new s({data:m,size:[h,1]})}(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return c(t,e)},"Array, Array | Matrix":function(t,e){return c(n(t),e).valueOf()}});function c(t,e){for(var n=(e=u(t,e,!0))._data,c=t._size[0],l=[],h=t._data,p=t._size[1]-1;p>=0;p--){var f=n[p][0]||0,d=void 0;if(a(f,0))d=0;else{var m=h[p][p];if(a(m,0))throw new Error("Linear system cannot be solved since matrix is singular");d=r(f,m);for(var g=p-1;g>=0;g--)n[g]=[o(n[g][0]||0,i(d,h[g][p]))]}l[p]=[d]}return new s({data:l,size:[c,1]})}})),gk=HN("unit",["typed","Unit"],(function(t){var e=t.Unit;return(0,t.typed)("unit",{Unit:function(t){return t.clone()},string:function(t){return e.isValuelessUnit(t)?new e(null,t):e.parse(t,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string":function(t,n){return new e(t,n)},"Array | Matrix":function(t){return FT(t,this)}})})),yk=HN("Spa",["addScalar","equalScalar","FibonacciHeap"],(function(t){var e=t.addScalar,n=t.equalScalar,r=t.FibonacciHeap;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var n=this._heap.insert(t,e);this._values[t]=n}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,n){var r=this._values[t];r?r.value=e(r.value,n):(r=this._heap.insert(t,n),this._values[t]=r)},i.prototype.forEach=function(t,e,r){var i=this._heap,o=this._values,a=[],s=i.extractMinimum();for(s&&a.push(s);s&&s.key<=e;)s.key>=t&&(n(s.value,0)||r(s.key,s.value,this)),(s=i.extractMinimum())&&a.push(s);for(var u=0;u<a.length;u++){var c=a[u];o[(s=i.insert(c.key,c.value)).key]=s}},i.prototype.swap=function(t,e){var n=this._values[t],r=this._values[e];if(!n&&r)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(n&&!r)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i}),{isClass:!0}),vk=HN("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(function(t){var e=t.matrix,n=t.abs,r=t.addScalar,i=t.divideScalar,o=t.multiplyScalar,a=t.subtract,s=t.larger,u=t.equalScalar,c=t.unaryMinus,l=t.DenseMatrix,h=t.SparseMatrix,p=t.Spa;return(0,t.typed)("lup",{DenseMatrix:function(t){return f(t)},SparseMatrix:function(t){return function(t){var e,r,a,l=t._size[0],f=t._size[1],d=Math.min(l,f),m=t._values,g=t._index,y=t._ptr,v=[],x=[],b=[],w=[l,d],_=[],M=[],S=[],E=[d,f],N=[],T=[];for(e=0;e<l;e++)N[e]=e,T[e]=e;var A=function(){var t=new p;r<l&&(b.push(v.length),v.push(1),x.push(r)),S.push(_.length);var f=y[r+1];for(a=y[r];a<f;a++)t.set(N[e=g[a]],m[a]);r>0&&t.forEach(0,r-1,(function(e,n){h._forEachRow(e,v,x,b,(function(r,i){r>e&&t.accumulate(r,c(o(i,n)))}))}));var d,A,C,O,R=r,P=t.get(r),L=n(P);t.forEach(r+1,l-1,(function(t,e){var r=n(e);s(r,L)&&(R=t,L=r,P=e)})),r!==R&&(h._swapRows(r,R,w[1],v,x,b),h._swapRows(r,R,E[1],_,M,S),t.swap(r,R),O=T[A=R],N[C=T[d=r]]=A,N[O]=d,T[d]=O,T[A]=C),t.forEach(0,l-1,(function(t,e){t<=r?(_.push(e),M.push(t)):(e=i(e,P),u(e,0)||(v.push(e),x.push(t)))}))};for(r=0;r<f;r++)A();return S.push(_.length),b.push(v.length),{L:new h({values:v,index:x,ptr:b,size:w}),U:new h({values:_,index:M,ptr:S,size:E}),p:N,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(t)},Array:function(t){var n=f(e(t));return{L:n.L.valueOf(),U:n.U.valueOf(),p:n.p}}});function f(t){var e,c,h,p=t._size[0],f=t._size[1],d=Math.min(p,f),m=VE(t._data),g=[],y=[p,d],v=[],x=[d,f],b=[];for(e=0;e<p;e++)b[e]=e;for(c=0;c<f;c++){if(c>0)for(e=0;e<p;e++){var w=Math.min(e,c),_=0;for(h=0;h<w;h++)_=r(_,o(m[e][h],m[h][c]));m[e][c]=a(m[e][c],_)}var M=c,S=0,E=0;for(e=c;e<p;e++){var N=m[e][c],T=n(N);s(T,S)&&(M=e,S=T,E=N)}if(c!==M&&(b[c]=[b[M],b[M]=b[c]][0],l._swapRows(c,M,m)),c<p)for(e=c+1;e<p;e++)u(m[e][c],0)||(m[e][c]=i(m[e][c],E))}for(c=0;c<f;c++)for(e=0;e<p;e++)0===c&&(e<f&&(v[e]=[]),g[e]=[]),e<c?(e<f&&(v[e][c]=m[e][c]),c<p&&(g[e][c]=0)):e!==c?(e<f&&(v[e][c]=0),c<p&&(g[e][c]=m[e][c])):(e<f&&(v[e][c]=m[e][c]),c<p&&(g[e][c]=1));var A=new l({data:g,size:y}),C=new l({data:v,size:x}),O=[];for(e=0,d=b.length;e<d;e++)O[b[e]]=e;return{L:A,U:C,p:O,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),xk=HN("det",["typed","matrix","subtract","multiply","unaryMinus","lup"],(function(t){var e=t.matrix,n=t.subtract,r=t.multiply,i=t.unaryMinus,o=t.lup;return(0,t.typed)("det",{any:function(t){return VE(t)},"Array | Matrix":function(t){var a;switch((a=lE(t)?t.size():Array.isArray(t)?(t=e(t)).size():[]).length){case 0:return VE(t);case 1:if(1===a[0])return VE(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+bN(a)+")");case 2:var s=a[0];if(s===a[1])return function(t,e,a){if(1===e)return VE(t[0][0]);if(2===e)return n(r(t[0][0],t[1][1]),r(t[1][0],t[0][1]));for(var s=o(t),u=s.U[0][0],c=1;c<e;c++)u=r(u,s.U[c][c]);for(var l=0,h=0,p=[];;){for(;p[h];)h++;if(h>=e)break;for(var f=h,d=0;!p[s.p[f]];)p[s.p[f]]=!0,f=s.p[f],d++;d%2==0&&l++}return l%2==0?u:i(u)}(t.clone().valueOf(),s);throw new RangeError("Matrix must be square (size: "+bN(a)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+bN(a)+")")}}})})),bk=HN("log",["config","typed","divideScalar","Complex"],(function(t){var e=t.config,n=t.divideScalar,r=t.Complex;return(0,t.typed)("log",{number:function(t){return t>=0||e.predictable?yR(t):new r(t,0).log()},Complex:function(t){return t.log()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.ln():new r(t.toNumber(),0).log()},"Array | Matrix":function(t){return FT(t,this)},"any, any":function(t,e){return n(this(t),this(e))}})})),wk=HN("setIsSubset",["typed","size","subset","compareNatural","Index"],(function(t){var e=t.size,n=t.subset,r=t.compareNatural,i=t.Index;return(0,t.typed)("setIsSubset",{"Array | Matrix, Array | Matrix":function(t,o){if(0===n(e(t),new i(0)))return!0;if(0===n(e(o),new i(0)))return!1;for(var a,s=UN(LN(Array.isArray(t)?t:t.toArray()).sort(r)),u=UN(LN(Array.isArray(o)?o:o.toArray()).sort(r)),c=0;c<s.length;c++){a=!1;for(var l=0;l<u.length;l++)if(0===r(s[c].value,u[l].value)&&s[c].identifier===u[l].identifier){a=!0;break}if(!1===a)return!1}return!0}})}));function _k(t,e){var n,r=e.length,i=[];if(t)for(n=0;n<r;n++)i[t[n]]=e[n];else for(n=0;n<r;n++)i[n]=e[n];return i}var Mk=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],Sk=HN("lusolve",Mk,(function(t){var e=t.typed,n=t.matrix,r=t.lup,i=t.slu,o=t.usolve,a=t.lsolve,s=OD({DenseMatrix:t.DenseMatrix});return e("lusolve",{"Array, Array | Matrix":function(t,e){t=n(t);var i=r(t);return c(i.L,i.U,i.p,null,e).valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var n=r(t);return c(n.L,n.U,n.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var n=r(t);return c(n.L,n.U,n.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,n,r){var o=i(t,n,r);return c(o.L,o.U,o.p,o.q,e)},"Object, Array | Matrix":function(t,e){return c(t.L,t.U,t.p,t.q,e)}});function u(t){if(lE(t))return t;if(cE(t))return n(t);throw new TypeError("Invalid Matrix LU decomposition")}function c(t,e,n,r,i){t=u(t),e=u(e),i=s(t,i,!1),n&&(i._data=_k(n,i._data));var c=a(t,i),l=o(e,c);return r&&(l._data=_k(r,l._data)),l}})),Ek=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],Nk=HN("inv",Ek,(function(t){var e=t.matrix,n=t.divideScalar,r=t.addScalar,i=t.multiply,o=t.unaryMinus,a=t.det,s=t.identity,u=t.abs;return(0,t.typed)("inv",{"Array | Matrix":function(t){var r=lE(t)?t.size():NN(t);switch(r.length){case 1:if(1===r[0])return lE(t)?e([n(1,t.valueOf()[0])]):[n(1,t[0])];throw new RangeError("Matrix must be square (size: "+bN(r)+")");case 2:var i=r[0],o=r[1];if(i===o)return lE(t)?e(c(t.valueOf(),i,o),t.storage()):c(t,i,o);throw new RangeError("Matrix must be square (size: "+bN(r)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+bN(r)+")")}},any:function(t){return n(1,t)}});function c(t,e,c){var l,h,p,f,d;if(1===e){if(0===(f=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,f)]]}if(2===e){var m=a(t);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[n(t[1][1],m),n(o(t[0][1]),m)],[n(o(t[1][0]),m),n(t[0][0],m)]]}var g=t.concat();for(l=0;l<e;l++)g[l]=g[l].concat();for(var y=s(e).valueOf(),v=0;v<c;v++){var x=u(g[v][v]),b=v;for(l=v+1;l<e;)u(g[l][v])>x&&(x=u(g[l][v]),b=l),l++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(l=b)!==v&&(d=g[v],g[v]=g[l],g[l]=d,d=y[v],y[v]=y[l],y[l]=d);var w=g[v],_=y[v];for(l=0;l<e;l++){var M=g[l],S=y[l];if(l!==v){if(0!==M[v]){for(p=n(o(M[v]),w[v]),h=v;h<c;h++)M[h]=r(M[h],i(p,w[h]));for(h=0;h<c;h++)S[h]=r(S[h],i(p,_[h]))}}else{for(p=w[v],h=v;h<c;h++)M[h]=n(M[h],p);for(h=0;h<c;h++)S[h]=n(S[h],p)}}}return y}})),Tk=["typed","abs","add","identity","inv","multiply"],Ak=HN("expm",Tk,(function(t){var e=t.abs,n=t.add,r=t.identity,i=t.inv,o=t.multiply;return(0,t.typed)("expm",{Matrix:function(t){var s=t.size();if(2!==s.length||s[0]!==s[1])throw new RangeError("Matrix must be square (size: "+bN(s)+")");for(var u=s[0],c=function(t,e){for(var n=0;n<30;n++)for(var r=0;r<=n;r++){var i=n-r;if(a(t,r,i)<1e-15)return{q:r,j:i}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(function(t){for(var n=t.size()[0],r=0,i=0;i<n;i++){for(var o=0,a=0;a<n;a++)o+=e(t.get([i,a]));r=Math.max(o,r)}return r}(t)),l=c.q,h=c.j,p=o(t,Math.pow(2,-h)),f=r(u),d=r(u),m=1,g=p,y=-1,v=1;v<=l;v++)v>1&&(g=o(g,p),y=-y),f=n(f,o(m=m*(l-v+1)/((2*l-v+1)*v),g)),d=n(d,o(m*y,g));for(var x=o(i(d),f),b=0;b<h;b++)x=o(x,x);return fE(t)?t.createSparseMatrix(x):x}});function a(t,e,n){for(var r=1,i=2;i<=e;i++)r*=i;for(var o=r,a=e+1;a<=2*e;a++)o*=a;var s=o*(2*e+1);return 8*Math.pow(t/Math.pow(2,n),2*e)*r*r/(o*s)}})),Ck=["typed","matrix","multiply","equalScalar","divideScalar","inv"],Ok=HN("divide",Ck,(function(t){var e=t.typed,n=t.matrix,r=t.multiply,i=t.divideScalar,o=t.inv,a=jL({typed:e,equalScalar:t.equalScalar}),s=kL({typed:e});return e("divide",GE({"Array | Matrix, Array | Matrix":function(t,e){return r(t,o(e))},"DenseMatrix, any":function(t,e){return s(t,e,i,!1)},"SparseMatrix, any":function(t,e){return a(t,e,i,!1)},"Array, any":function(t,e){return s(n(t),e,i,!1).valueOf()},"any, Array | Matrix":function(t,e){return r(t,o(e))}},i.signatures))})),Rk=["typed","add","divide","compare","partitionSelect"],Pk=HN("median",Rk,(function(t){var e=t.typed,n=t.add,r=t.divide,i=t.compare,o=t.partitionSelect;function a(t){try{var e=(t=LN(t.valueOf())).length;if(0===e)throw new Error("Cannot calculate median of an empty array");if(e%2==0){for(var n=e/2-1,r=o(t,n+1),a=t[n],c=0;c<n;++c)i(t[c],a)>0&&(a=t[c]);return u(a,r)}var l=o(t,(e-1)/2);return s(l)}catch(h){throw IA(h,"median")}}var s=e({"number | BigNumber | Complex | Unit":function(t){return t}}),u=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(t,e){return r(n(t,e),2)}});return e("median",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("median(A, dim) is not yet supported")},"...":function(t){if(BT(t))throw new TypeError("Scalar values expected in function median");return a(t)}})})),Lk=["typed","matrix","divide","sum","multiply","dotDivide","log","isNumeric"],Ik=HN("kldivergence",Lk,(function(t){var e=t.matrix,n=t.divide,r=t.sum,i=t.multiply,o=t.dotDivide,a=t.log,s=t.isNumeric;return(0,t.typed)("kldivergence",{"Array, Array":function(t,n){return u(e(t),e(n))},"Matrix, Array":function(t,n){return u(t,e(n))},"Array, Matrix":function(t,n){return u(e(t),n)},"Matrix, Matrix":function(t,e){return u(t,e)}});function u(t,e){var u=e.size().length,c=t.size().length;if(u>1)throw new Error("first object must be one dimensional");if(c>1)throw new Error("second object must be one dimensional");if(u!==c)throw new Error("Length of two vectors must be equal");if(0===r(t))throw new Error("Sum of elements in first object must be non zero");if(0===r(e))throw new Error("Sum of elements in second object must be non zero");var l=n(t,r(t)),h=n(e,r(e)),p=r(i(l,a(o(l,h))));return s(p)?p:Number.NaN}})),Dk=["typed","config","divideScalar","log","Complex"],kk=HN("log1p",Dk,(function(t){var e=t.config,n=t.divideScalar,r=t.log,i=t.Complex;return(0,t.typed)("log1p",{number:function(t){return t>=-1||e.predictable?tN(t):o(new i(t,0))},Complex:o,BigNumber:function(t){var n=t.plus(1);return!n.isNegative()||e.predictable?n.ln():o(new i(t.toNumber(),0))},"Array | Matrix":function(t){return FT(t,this)},"any, any":function(t,e){return n(this(t),r(e))}});function o(t){var e=t.re+1;return new i(Math.log(Math.sqrt(e*e+t.im*t.im)),Math.atan2(t.im,e))}})),zk=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","inv","bignumber","multiply","add"],Bk=HN("eigs",zk,(function(t){var e=t.config,n=t.matrix,r=t.addScalar,i=t.subtract,o=t.equal,a=t.abs,s=t.atan,u=t.cos,c=t.sin,l=t.multiplyScalar,h=t.inv,p=t.bignumber,f=t.multiply,d=t.add;return(0,t.typed)("eigs",{Array:function(t){var e=n(t),r=e.size();if(2!==r.length||r[0]!==r[1])throw new RangeError("Matrix must be square (size: "+bN(r)+")");var i=m(e,r[0]);return{values:i[0],vectors:i[1]}},Matrix:function(t){var e=t.size();if(2!==e.length||e[0]!==e[1])throw new RangeError("Matrix must be square (size: "+bN(e)+")");var r=m(t,e[0]);return{values:n(r[0]),vectors:n(r[1])}}});function m(t,n){var r=t.datatype();if(void 0===r&&(r=t.getDataType()),"number"!==r&&"BigNumber"!==r&&"Fraction"!==r)throw"mixed"===r?new TypeError("Mixed matrix element type is not supported"):new TypeError("Matrix element type not supported ("+r+")");if(function(t,e){for(var n=0;n<e;n++)for(var r=n;r<e;r++)if(!o(t[n][r],t[r][n]))throw new TypeError("Input matrix is not symmetric")}(t.toArray(),n),"number"===r)return g(t.toArray());if("Fraction"===r){for(var u=t.toArray(),c=0;c<n;c++)for(var d=c;d<n;d++)u[c][d]=u[c][d].valueOf(),u[d][c]=u[c][d];return g(t.toArray())}return"BigNumber"===r?function(t){for(var n,r=t.length,o=a(e.epsilon/r),u=new Array(r),c=0;c<r;c++)u[c]=S(r,0),u[c][c]=1;for(var d,m,g=_(t);a(g[1])>=a(o);){var y=g[0][0],b=g[0][1];d=t[y][b],void 0,m=i(t[b][b],t[y][y]),t=x(t,n=a(m)<=e.epsilon?p(-1).acos().div(4):l(.5,s(f(2,d,h(m)))),y,b),u=v(u,n,y,b),g=_(t)}for(var w=S(r,0),E=0;E<r;E++)w[E]=t[E][E];return M(VE(w),VE(u))}(t.toArray()):void 0}function g(t){for(var n,r=t.length,i=Math.abs(e.epsilon/r),o=new Array(r),a=0;a<r;a++)o[a]=S(r,0),o[a][a]=1;for(var s=w(t);Math.abs(s[1])>=Math.abs(i);){var u=s[0][0],c=s[0][1];t=b(t,(l=t[u][u],h=t[c][c],p=t[u][c],n=Math.abs(h-l)<=e.epsilon?Math.PI/4:.5*Math.atan(2*p/(h-l))),u,c),o=y(o,n,u,c),s=w(t)}for(var l,h,p,f=S(r,0),d=0;d<r;d++)f[d]=t[d][d];return M(VE(f),VE(o))}function y(t,e,n,r){for(var i=t.length,o=Math.cos(e),a=Math.sin(e),s=S(i,0),u=S(i,0),c=0;c<i;c++)s[c]=o*t[c][n]-a*t[c][r],u[c]=a*t[c][n]+o*t[c][r];for(var l=0;l<i;l++)t[l][n]=s[l],t[l][r]=u[l];return t}function v(t,e,n,o){for(var a=t.length,s=u(e),h=c(e),f=S(a,p(0)),d=S(a,p(0)),m=0;m<a;m++)f[m]=i(l(s,t[m][n]),l(h,t[m][o])),d[m]=r(l(h,t[m][n]),l(s,t[m][o]));for(var g=0;g<a;g++)t[g][n]=f[g],t[g][o]=d[g];return t}function x(t,e,n,o){for(var a=t.length,s=p(u(e)),h=p(c(e)),m=l(s,s),g=l(h,h),y=S(a,p(0)),v=S(a,p(0)),x=f(p(2),s,h,t[n][o]),b=r(i(l(m,t[n][n]),x),l(g,t[o][o])),w=d(l(g,t[n][n]),x,l(m,t[o][o])),_=0;_<a;_++)y[_]=i(l(s,t[n][_]),l(h,t[o][_])),v[_]=r(l(h,t[n][_]),l(s,t[o][_]));t[n][n]=b,t[o][o]=w,t[n][o]=p(0),t[o][n]=p(0);for(var M=0;M<a;M++)M!==n&&M!==o&&(t[n][M]=y[M],t[M][n]=y[M],t[o][M]=v[M],t[M][o]=v[M]);return t}function b(t,e,n,r){for(var i=t.length,o=Math.cos(e),a=Math.sin(e),s=o*o,u=a*a,c=S(i,0),l=S(i,0),h=s*t[n][n]-2*o*a*t[n][r]+u*t[r][r],p=u*t[n][n]+2*o*a*t[n][r]+s*t[r][r],f=0;f<i;f++)c[f]=o*t[n][f]-a*t[r][f],l[f]=a*t[n][f]+o*t[r][f];t[n][n]=h,t[r][r]=p,t[n][r]=0,t[r][n]=0;for(var d=0;d<i;d++)d!==n&&d!==r&&(t[n][d]=c[d],t[d][n]=c[d],t[r][d]=l[d],t[d][r]=l[d]);return t}function w(t){for(var e=t.length,n=0,r=[0,1],i=0;i<e;i++)for(var o=i+1;o<e;o++)Math.abs(n)<Math.abs(t[i][o])&&(n=Math.abs(t[i][o]),r=[i,o]);return[r,n]}function _(t){for(var e=t.length,n=0,r=[0,1],i=0;i<e;i++)for(var o=i+1;o<e;o++)a(n)<a(t[i][o])&&(n=a(t[i][o]),r=[i,o]);return[r,n]}function M(t,e){for(var n=t.length,r=Array(n),i=Array(n),o=0;o<n;o++)i[o]=Array(n);for(var a=0;a<n;a++){for(var s=0,u=t[0],c=0;c<t.length;c++)t[c]<u&&(u=t[s=c]);r[a]=t.splice(s,1)[0];for(var l=0;l<n;l++)i[l][a]=e[l][s],e[l].splice(s,1)}return[VE(r),VE(i)]}function S(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e;return n}})),Uk=["typed","abs","add","multiply","sqrt","subtract","inv","size","max","identity"],Fk=HN("sqrtm",Uk,(function(t){var e=t.abs,n=t.add,r=t.multiply,i=t.sqrt,o=t.subtract,a=t.inv,s=t.size,u=t.max,c=t.identity;function l(t){var i,l=0,h=t,p=c(s(t));do{var f=h;if(h=r(.5,n(f,a(p))),p=r(.5,n(p,a(f))),(i=u(e(o(h,f))))>1e-6&&++l>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(i>1e-6);return h}return(0,t.typed)("sqrtm",{"Array | Matrix":function(t){var e=lE(t)?t.size():NN(t);switch(e.length){case 1:if(1===e[0])return i(t);throw new RangeError("Matrix must be square (size: "+bN(e)+")");case 2:if(e[0]===e[1])return l(t);throw new RangeError("Matrix must be square (size: "+bN(e)+")")}}})})),jk=["typed","add","divide","multiply","factorial","isInteger","isPositive"],Hk=HN("multinomial",jk,(function(t){var e=t.add,n=t.divide,r=t.multiply,i=t.factorial,o=t.isInteger,a=t.isPositive;return(0,t.typed)("multinomial",{"Array | Matrix":function(t){var s=0,u=1;return UT(t,(function(t){if(!o(t)||!a(t))throw new TypeError("Positive integer value expected in function multinomial");s=e(s,t),u=r(u,i(t))})),n(i(s),u)}})})),Vk=["typed","abs","map","median","subtract"],Gk=HN("mad",Vk,(function(t){var e=t.abs,n=t.map,r=t.median,i=t.subtract;return(0,t.typed)("mad",{"Array | Matrix":o,"...":function(t){return o(t)}});function o(t){if(0===(t=LN(t.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var o=r(t);return r(n(t,(function(t){return e(i(t,o))})))}catch(a){throw a instanceof TypeError&&-1!==a.message.indexOf("median")?new TypeError(a.message.replace("median","mad")):IA(a,"mad")}}})),qk=KA({}),Wk=rC({}),Zk=iC({}),$k=dC({}),Yk=mC({}),Xk=fC({}),Jk=LC({config:$E}),Qk=IC({}),Kk=DC({}),tz=AC({Complex:Wk}),ez=MC({BigNumber:Jk,config:$E}),nz=EC({BigNumber:Jk,config:$E}),rz=yC({BigNumber:Jk,config:$E}),iz=vC({BigNumber:Jk,config:$E}),oz=NC({BigNumber:Jk,config:$E}),az=xC({BigNumber:Jk,config:$E}),sz=lO({BigNumber:Jk,config:$E}),uz=eO({BigNumber:Jk,config:$E}),cz=bO({BigNumber:Jk,config:$E}),lz=cO({BigNumber:Jk,config:$E}),hz=kO({}),pz=bC({BigNumber:Jk,config:$E}),fz=gC({BigNumber:Jk,config:$E}),dz=SC({BigNumber:Jk,config:$E}),mz=CC({}),gz=zO({Matrix:Qk}),yz=wC({BigNumber:Jk,config:$E}),vz=jO({BigNumber:Jk,Complex:Wk,DenseMatrix:gz,Fraction:hz}),xz=qO({typed:vz}),bz=WO({typed:vz}),wz=JO({typed:vz}),_z=QO({typed:vz}),Mz=tR({config:$E,typed:vz}),Sz=eR({typed:vz}),Ez=nR({typed:vz}),Nz=rR({Complex:Wk,typed:vz}),Tz=iR({typed:vz}),Az=TR({BigNumber:Jk,config:$E,typed:vz}),Cz=pA({isInteger:xz,typed:vz}),Oz=AR({typed:vz}),Rz=CR({Complex:Wk,typed:vz}),Pz=OR({Complex:Wk,config:$E,typed:vz}),Lz=RR({typed:vz}),Iz=PR({BigNumber:Jk,Fraction:hz,complex:Nz,typed:vz}),Dz=LR({typed:vz}),kz=XR({typed:vz}),zz=JR({typed:vz}),Bz=QR({typed:vz}),Uz=rP({typed:vz}),Fz=iP({typed:vz}),jz=aP({typed:vz}),Hz=uP({typed:vz}),Vz=lP({typed:vz}),Gz=gP({typed:vz}),qz=yP({typed:vz}),Wz=vP({Complex:Wk,config:$E,typed:vz}),Zz=DP({BigNumber:Jk,typed:vz}),$z=kP({BigNumber:Jk,Complex:Wk,config:$E,typed:vz}),Yz=zP({BigNumber:Jk,Complex:Wk,config:$E,typed:vz}),Xz=BP({Complex:Wk,config:$E,typed:vz}),Jz=UP({typed:vz}),Qz=FP({Complex:Wk,config:$E,typed:vz}),Kz=jP({typed:vz}),tB=HP({BigNumber:Jk,typed:vz}),eB=VP({BigNumber:Jk,typed:vz}),nB=GP({BigNumber:Jk,typed:vz}),rB=qP({typed:vz}),iB=WP({typed:vz}),oB=YP({typed:vz}),aB=eL({config:$E,typed:vz}),sB=rL({config:$E,typed:vz}),uB=_C({BigNumber:Jk,config:$E}),cB=iL({typed:vz}),lB=oL({isNumeric:bz,typed:vz}),hB=aL({typed:vz}),pB=sL({typed:vz}),fB=uL({Fraction:hz,typed:vz}),dB=cL({typed:vz}),mB=lL({typed:vz}),gB=hL({typed:vz}),yB=pL({Complex:Wk,config:$E,typed:vz}),vB=fL({Complex:Wk,config:$E,typed:vz}),xB=dL({typed:vz}),bB=mL({typed:vz}),wB=gL({isNaN:_z,isNumeric:bz,typed:vz}),_B=yL({typed:vz}),MB=xL({Complex:Wk,config:$E,typed:vz}),SB=bL({BigNumber:Jk,typed:vz}),EB=wL({typed:vz}),NB=_L({typed:vz}),TB=ML({BigNumber:Jk,typed:vz}),AB=SL({typed:vz}),CB=EL({typed:vz}),OB=TL({config:$E,typed:vz}),RB=TC({BigNumber:Jk,config:$E}),PB=AL({typed:vz}),LB=CL({Matrix:Qk,equalScalar:Mz,typed:vz}),IB=OL({DenseMatrix:gz,Matrix:Qk,SparseMatrix:LB,typed:vz}),DB=RL({BigNumber:Jk,Complex:Wk,Fraction:hz,config:$E,isNegative:PB,matrix:IB,typed:vz,unaryMinus:dB}),kB=zL({BigNumber:Jk,DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),zB=VL({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),BB=qL({BigNumber:Jk,equalScalar:Mz,matrix:IB,typed:vz}),UB=WL({BigNumber:Jk,config:$E,matrix:IB,typed:vz}),FB=ZL({equalScalar:Mz,matrix:IB,typed:vz}),jB=YL({DenseMatrix:gz,matrix:IB,typed:vz}),HB=XL({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),VB=RA({isInteger:xz,matrix:IB,typed:vz}),GB=JL({DenseMatrix:gz,SparseMatrix:LB,matrix:IB,typed:vz}),qB=QL({BigNumber:Jk,DenseMatrix:gz,SparseMatrix:LB,config:$E,matrix:IB,typed:vz}),WB=KL({BigNumber:Jk,config:$E,matrix:IB,typed:vz}),ZB=tI({isInteger:xz,matrix:IB,typed:vz}),$B=eI({matrix:IB,config:$E,typed:vz}),YB=SA({matrix:IB,typed:vz}),XB=nI({BigNumber:Jk,config:$E,matrix:IB,typed:vz}),JB=rI({matrix:IB,typed:vz}),QB=uI({BigNumber:Jk,DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz,zeros:XB}),KB=hI({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz,zeros:XB}),tU=pI({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz,zeros:XB}),eU=fI({BigNumber:Jk,DenseMatrix:gz,Fraction:hz,config:$E,equalScalar:Mz,matrix:IB,typed:vz}),nU=dI({matrix:IB,typed:vz}),rU=mI({DenseMatrix:gz,config:$E,matrix:IB,typed:vz}),iU=gI({DenseMatrix:gz,config:$E,matrix:IB,typed:vz}),oU=yI({DenseMatrix:gz,config:$E,equalScalar:Mz,matrix:IB,typed:vz}),aU=vI({DenseMatrix:gz,smaller:rU}),sU=xI({larger:iU,smaller:rU}),uU=bI({SparseMatrix:LB,typed:vz}),cU=wI({BigNumber:Jk,Complex:Wk,config:$E,typed:vz}),lU=MI({BigNumber:Jk,DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),hU=SI({BigNumber:Jk,typed:vz}),pU=EI({DenseMatrix:gz,SparseMatrix:LB,addScalar:mB,equalScalar:Mz,matrix:IB,typed:vz}),fU=NI({addScalar:mB,conj:xB,multiplyScalar:Lz,size:$B,typed:vz}),dU=TI({addScalar:mB,combinations:oB,isInteger:xz,isNegative:PB,isPositive:wz,larger:iU,typed:vz}),mU=AI({typed:vz}),gU=CI({typed:vz}),yU=OI({config:$E,round:QB,typed:vz}),vU=RI({addScalar:mB,dot:fU,equalScalar:Mz,matrix:IB,multiplyScalar:Lz,typed:vz}),xU=PI({equalScalar:Mz,matrix:IB,multiplyScalar:Lz,typed:vz}),bU=LI({typed:vz}),wU=II({matrix:IB,typed:vz}),_U=kI({config:$E,matrix:IB}),MU=zI({matrix:IB,typed:vz}),SU=BI({Complex:Wk,config:$E,fraction:fB,identity:qB,matrix:IB,multiply:vU,number:Sz,typed:vz}),EU=UI({DenseMatrix:gz,equalScalar:Mz,matrix:IB,pow:SU,typed:vz}),NU=FI({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz,zeros:XB}),TU=VI({compare:eU,typed:vz}),AU=GI({compareText:nU,isZero:mU,typed:vz}),CU=qI({DenseMatrix:gz,config:$E,matrix:IB,typed:vz}),OU=WI({compare:eU,isNaN:_z,isNumeric:bz,typed:vz}),RU=ZI({ImmutableDenseMatrix:aU}),PU=$I({BigNumber:Jk,Complex:Wk,config:$E,typed:vz}),LU=YI({typed:vz}),IU=XI({DenseMatrix:gz,Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),DU=JI({DenseMatrix:gz,Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),kU=QI({Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),zU=KI({compareNatural:TU,typed:vz}),BU=tD({abs:gU,add:pU,conj:xB,equalScalar:Mz,larger:iU,matrix:IB,multiply:vU,pow:SU,smaller:rU,sqrt:vB,typed:vz}),UU=eD({Index:RU,typed:vz}),FU=nD({add:pU,compare:eU,multiply:vU,partitionSelect:OU,typed:vz}),jU=aD({BigNumber:Jk,Complex:Wk,config:$E,multiplyScalar:Lz,pow:SU,typed:vz}),HU=sD({BigNumber:Jk,typed:vz}),VU=uD({equalScalar:Mz,matrix:IB,typed:vz}),GU=cD({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),qU=lD({matrix:IB,multiplyScalar:Lz,typed:vz}),WU=hD({matrix:IB,typed:vz}),ZU=pD({bignumber:HU,fraction:fB,number:Sz}),$U=fD({equalScalar:Mz,matrix:IB,not:Uz,typed:vz,zeros:XB}),YU=dD({DenseMatrix:gz,config:$E,matrix:IB,typed:vz}),XU=mD({compare:eU,compareNatural:TU,matrix:IB,typed:vz}),JU=zA({config:$E,numeric:ZU,smaller:rU,typed:vz}),QU=gD({BigNumber:Jk,typed:vz}),KU=yD({DenseMatrix:gz,Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),tF=vD({Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),eF=xD({add:pU,matrix:IB,typed:vz}),nF=UA({add:pU,config:$E,numeric:ZU,typed:vz}),rF=bD({gamma:jU,typed:vz}),iF=wD({factorial:rF,typed:vz}),oF=MD({config:$E,round:QB,typed:vz}),aF=SD({DenseMatrix:gz,addScalar:mB,equalScalar:Mz,matrix:IB,typed:vz,unaryMinus:dB}),sF=ND({matrix:IB,multiply:vU,subtract:aF,typed:vz}),uF=TD({conj:xB,transpose:WU,typed:vz}),cF=AD({numeric:ZU,typed:vz}),lF=CD({Complex:Wk,config:$E,divideScalar:cF,typed:vz}),hF=RD({DenseMatrix:gz,divideScalar:cF,equalScalar:Mz,matrix:IB,multiplyScalar:Lz,subtract:aF,typed:vz}),pF=PD({DenseMatrix:gz,equalScalar:Mz,matrix:IB,typed:vz}),fF=DA({config:$E,larger:iU,numeric:ZU,typed:vz}),dF=LD({DenseMatrix:gz,Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),mF=ID({Index:RU,concat:VB,setDifference:IU,size:$B,subset:YB,typed:vz}),gF=DD({abs:gU,addScalar:mB,divideScalar:cF,isPositive:wz,multiplyScalar:Lz,smaller:rU,sqrt:vB,typed:vz}),yF=zD({addScalar:mB,complex:Nz,conj:xB,divideScalar:cF,equal:pF,identity:qB,isZero:mU,matrix:IB,multiplyScalar:Lz,sign:Iz,sqrt:vB,subtract:aF,typed:vz,unaryMinus:dB,zeros:XB}),vF=BD({abs:gU,addScalar:mB,divideScalar:cF,multiplyScalar:Lz,sqrt:vB,subtract:aF,typed:vz,unaryMinus:dB}),xF=UD({addScalar:mB,combinations:oB,divideScalar:cF,factorial:rF,isInteger:xz,isNegative:PB,larger:iU,multiplyScalar:Lz,pow:SU,subtract:aF,typed:vz}),bF=FD({addScalar:mB,combinations:oB,divideScalar:cF,isInteger:xz,isNegative:PB,multiplyScalar:Lz,typed:vz}),wF=jD({Complex:Wk,ceil:oF,floor:yU,typed:vz}),_F=jA({bignumber:HU,matrix:IB,config:$E,larger:iU,largerEq:CU,smaller:rU,smallerEq:YU,typed:vz}),MF=HD({config:$E,multiplyScalar:Lz,numeric:ZU,typed:vz}),SF=VD({DenseMatrix:gz,divideScalar:cF,equalScalar:Mz,matrix:IB,typed:vz}),EF=GD({equal:pF,typed:vz}),NF=XD({BigNumber:Jk,Complex:Wk,Fraction:hz,abs:gU,addScalar:mB,config:$E,divideScalar:cF,equal:pF,fix:wF,format:Gz,isNumeric:bz,multiplyScalar:Lz,number:Sz,pow:SU,round:QB,subtract:aF}),TF=JD({Unit:NF,typed:vz}),AF=QD({Index:RU,concat:VB,setIntersect:DU,setSymDifference:mF,size:$B,subset:YB,typed:vz}),CF=hk({SparseMatrix:LB,abs:gU,add:pU,divideScalar:cF,larger:iU,largerEq:CU,multiply:vU,subtract:aF,transpose:WU,typed:vz}),OF=pk({abs:gU,add:pU,addScalar:mB,config:$E,divideScalar:cF,equalScalar:Mz,matrix:IB,multiply:vU,multiplyScalar:Lz,smaller:rU,subtract:aF,typed:vz}),RF=fk({addScalar:mB,isInteger:xz,isNegative:PB,stirlingS2:xF,typed:vz}),PF=hO({BigNumber:Jk,Unit:NF,config:$E}),LF=qC({BigNumber:Jk,Unit:NF,config:$E}),IF=fO({BigNumber:Jk,Unit:NF,config:$E}),DF=WC({BigNumber:Jk,Unit:NF,config:$E}),kF=iO({BigNumber:Jk,Unit:NF,config:$E}),zF=KC({BigNumber:Jk,Unit:NF,config:$E}),BF=dO({BigNumber:Jk,Unit:NF,config:$E}),UF=mO({BigNumber:Jk,Unit:NF,config:$E}),FF=zC({BigNumber:Jk,Unit:NF,config:$E}),jF=nO({BigNumber:Jk,Unit:NF,config:$E}),HF=XC({BigNumber:Jk,Unit:NF,config:$E}),VF=FC({BigNumber:Jk,Unit:NF,config:$E}),GF=SO({BigNumber:Jk,Unit:NF,config:$E}),qF=vO({BigNumber:Jk,Unit:NF,config:$E}),WF=oO({BigNumber:Jk,Unit:NF,config:$E}),ZF=OO({BigNumber:Jk,Unit:NF,config:$E}),$F=TO({BigNumber:Jk,Unit:NF,config:$E}),YF=RO({BigNumber:Jk,Unit:NF,config:$E}),XF=rO({BigNumber:Jk,Unit:NF,config:$E}),JF=UC({BigNumber:Jk,Unit:NF,config:$E}),QF=wO({BigNumber:Jk,Unit:NF,config:$E}),KF=_O({BigNumber:Jk,Unit:NF,config:$E}),tj=HC({BigNumber:Jk,Unit:NF,config:$E}),ej=dk({DenseMatrix:gz,matrix:IB,typed:vz}),nj=qA({Index:RU,matrix:IB,range:_F,typed:vz}),rj=mk({DenseMatrix:gz,divideScalar:cF,equalScalar:Mz,matrix:IB,multiplyScalar:Lz,subtract:aF,typed:vz}),ij=gk({Unit:NF,typed:vz}),oj=pO({BigNumber:Jk,Unit:NF,config:$E}),aj=QC({BigNumber:Jk,Unit:NF,config:$E}),sj=jC({BigNumber:Jk,Unit:NF,config:$E}),uj=tO({BigNumber:Jk,Unit:NF,config:$E}),cj=NO({BigNumber:Jk,Unit:NF,config:$E}),lj=gO({BigNumber:Jk,Unit:NF,config:$E}),hj=EO({BigNumber:Jk,Unit:NF,config:$E}),pj=YC({BigNumber:Jk,Unit:NF,config:$E}),fj=AO({BigNumber:Jk,Unit:NF,config:$E}),dj=aO({BigNumber:Jk,Unit:NF,config:$E}),mj=kC({BigNumber:Jk,Unit:NF,config:$E}),gj=MO({BigNumber:Jk,Unit:NF,config:$E}),yj=VA({Index:RU,matrix:IB,range:_F,typed:vz}),vj=yk({FibonacciHeap:sU,addScalar:mB,equalScalar:Mz}),xj=vk({DenseMatrix:gz,Spa:vj,SparseMatrix:LB,abs:gU,addScalar:mB,divideScalar:cF,equalScalar:Mz,larger:iU,matrix:IB,multiplyScalar:Lz,subtract:aF,typed:vz,unaryMinus:dB}),bj=xk({lup:xj,matrix:IB,multiply:vU,subtract:aF,typed:vz,unaryMinus:dB}),wj=JC({BigNumber:Jk,Unit:NF,config:$E}),_j=GC({BigNumber:Jk,Unit:NF,config:$E}),Mj=ZC({BigNumber:Jk,Unit:NF,config:$E}),Sj=xO({BigNumber:Jk,Unit:NF,config:$E}),Ej=CO({BigNumber:Jk,Unit:NF,config:$E}),Nj=uO({BigNumber:Jk,Unit:NF,config:$E}),Tj=bk({Complex:Wk,config:$E,divideScalar:cF,typed:vz}),Aj=wk({Index:RU,compareNatural:TU,size:$B,subset:YB,typed:vz}),Cj=Sk({DenseMatrix:gz,lsolve:hF,lup:xj,matrix:IB,slu:CF,typed:vz,usolve:rj}),Oj=Nk({abs:gU,addScalar:mB,det:bj,divideScalar:cF,identity:qB,matrix:IB,multiply:vU,typed:vz,unaryMinus:dB}),Rj=Ak({abs:gU,add:pU,identity:qB,inv:Oj,multiply:vU,typed:vz}),Pj=Ok({divideScalar:cF,equalScalar:Mz,inv:Oj,matrix:IB,multiply:vU,typed:vz}),Lj=Pk({add:pU,compare:eU,divide:Pj,partitionSelect:OU,typed:vz}),Ij=JA({add:pU,apply:Cz,divide:Pj,isNaN:_z,multiply:vU,subtract:aF,typed:vz}),Dj=Ik({divide:Pj,dotDivide:SF,isNumeric:bz,log:Tj,matrix:IB,multiply:vU,sum:nF,typed:vz}),kj=VC({BigNumber:Jk,Unit:NF,config:$E}),zj=$C({BigNumber:Jk,Unit:NF,config:$E}),Bj=sO({BigNumber:Jk,Unit:NF,config:$E}),Uj=kk({Complex:Wk,config:$E,divideScalar:cF,log:Tj,typed:vz}),Fj=Bk({abs:gU,add:pU,addScalar:mB,atan:Jz,bignumber:HU,config:$E,cos:NB,equal:pF,inv:Oj,matrix:IB,multiply:vU,multiplyScalar:Lz,sin:AB,subtract:aF,typed:vz}),jj=YA({add:pU,divide:Pj,typed:vz}),Hj=ZA({sqrt:vB,typed:vz,variance:Ij}),Vj=yO({BigNumber:Jk,Unit:NF,config:$E}),Gj=Fk({abs:gU,add:pU,identity:qB,inv:Oj,max:fF,multiply:vU,size:$B,sqrt:vB,subtract:aF,typed:vz}),qj=Hk({add:pU,divide:Pj,factorial:rF,isInteger:xz,isPositive:wz,multiply:vU,typed:vz}),Wj=BC({BigNumber:Jk,Unit:NF,config:$E}),Zj=Gk({abs:gU,map:Hz,median:Lj,subtract:aF,typed:vz});function $j(){return($j=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var Yj={},Xj={},Jj={},Qj=qN({mathWithTransform:Xj}),Kj=WN({Node:Qj}),tH=ZN({Node:Qj,ResultSet:qk}),eH=nT({Node:Qj}),nH=pT({Node:Qj}),rH=fT({Node:Qj}),iH=vT({Node:Qj}),oH=xT({math:Yj}),aH=bT({classes:Jj}),sH=wT({Node:Qj}),uH=_T({Node:Qj}),cH=MT({Node:Qj}),lH=ST({Node:Qj,typed:vz}),hH=ET({Chain:oH,typed:vz}),pH=CT({Node:Qj,subset:YB}),fH=RT({Node:Qj,Range:Zk,size:$B}),dH=PT({Unit:NF,Node:Qj,math:Yj}),mH=IT({matrix:IB,Node:Qj,subset:YB}),gH=zT({Node:Qj,SymbolNode:dH,math:Yj}),yH=qT({AccessorNode:pH,ArrayNode:Kj,AssignmentNode:mH,BlockNode:tH,ConditionalNode:sH,ConstantNode:eH,FunctionAssignmentNode:lH,FunctionNode:gH,IndexNode:fH,ObjectNode:nH,OperatorNode:uH,ParenthesisNode:rH,RangeNode:cH,RelationalNode:iH,SymbolNode:dH,config:$E,numeric:ZU,typed:vz}),vH=WT({parse:yH,typed:vz}),xH=ZT({parse:yH}),bH=$T({parse:yH,typed:vz}),wH=QT({Help:xH,mathWithTransform:Xj,typed:vz}),_H=sA({bignumber:HU,fraction:fB,ConstantNode:eH,FunctionNode:gH,OperatorNode:uH,ParenthesisNode:rH,SymbolNode:dH,add:pU,config:$E,divide:Pj,equal:pF,isZero:mU,mathWithTransform:Xj,multiply:vU,parse:yH,pow:SU,subtract:aF,typed:vz}),MH=uA({bignumber:HU,fraction:fB,ConstantNode:eH,FunctionNode:gH,OperatorNode:uH,ParenthesisNode:rH,SymbolNode:dH,add:pU,config:$E,divide:Pj,equal:pF,isZero:mU,mathWithTransform:Xj,multiply:vU,parse:yH,pow:SU,simplify:_H,subtract:aF,typed:vz}),SH=cA({parse:yH}),EH=lA({Parser:SH,typed:vz}),NH=hA({ConstantNode:eH,FunctionNode:gH,OperatorNode:uH,ParenthesisNode:rH,SymbolNode:dH,config:$E,equal:pF,isZero:mU,numeric:ZU,parse:yH,simplify:_H,typed:vz});$j(Yj,{reviver:aH,false:$k,null:Yk,true:Xk,replacer:Kk,i:tz,LN10:ez,LOG10E:nz,NaN:rz,pi:iz,SQRT1_2:oz,tau:az,efimovFactor:sz,fineStructure:uz,sackurTetrode:cz,weakMixingAngle:lz,e:pz,Infinity:fz,LOG2E:dz,PI:iz,version:mz,E:pz,phi:yz,typed:vz,isInteger:xz,isNumeric:bz,isPositive:wz,isNaN:_z,equalScalar:Mz,number:Sz,boolean:Ez,complex:Nz,splitUnit:Tz,unaryPlus:Az,apply:Cz,cube:Oz,expm1:Rz,log10:Pz,multiplyScalar:Lz,sign:Iz,square:Dz,bitNot:kz,arg:zz,im:Bz,not:Uz,filter:Fz,forEach:jz,map:Hz,erf:Vz,format:Gz,isPrime:qz,acos:Wz,acot:Zz,acsc:$z,asec:Yz,asin:Xz,atan:Jz,atanh:Qz,cosh:Kz,coth:tB,csch:eB,sech:nB,sinh:rB,tanh:iB,chain:hH,combinations:oB,pickRandom:aB,randomInt:sB,LN2:uB,clone:cB,hasNumericValue:lB,typeOf:hB,string:pB,fraction:fB,unaryMinus:dB,addScalar:mB,exp:gB,log2:yB,sqrt:vB,conj:xB,getMatrixDataType:bB,mode:wB,print:_B,acosh:MB,acsch:SB,asinh:EB,cos:NB,csc:TB,sin:AB,combinationsWithRep:CB,random:OB,SQRT2:RB,isNegative:PB,matrix:IB,cbrt:DB,gcd:kB,mod:zB,nthRoot:BB,xgcd:UB,bitAnd:FB,bitXor:jB,or:HB,concat:VB,diag:GB,identity:qB,ones:WB,reshape:ZB,size:$B,subset:YB,zeros:XB,to:JB,round:QB,leftShift:KB,rightLogShift:tU,compare:eU,compareText:nU,smaller:rU,larger:iU,unequal:oU,sparse:uU,acoth:cU,atan2:lU,sec:hU,add:pU,dot:fU,composition:dU,isZero:mU,abs:gU,floor:yU,multiply:vU,dotMultiply:xU,re:bU,flatten:wU,resize:_U,squeeze:MU,pow:SU,dotPow:EU,rightArithShift:NU,compareNatural:TU,equalText:AU,largerEq:CU,partitionSelect:OU,asech:PU,tan:LU,setDifference:IU,setIntersect:DU,setMultiplicity:kU,setSize:zU,norm:BU,index:UU,quantileSeq:FU,gamma:jU,bignumber:HU,lcm:VU,bitOr:GU,kron:qU,transpose:WU,numeric:ZU,and:$U,smallerEq:YU,sort:XU,min:JU,cot:QU,setDistinct:KU,setPowerset:tF,trace:eF,sum:nF,factorial:rF,permutations:iF,ceil:oF,subtract:aF,cross:sF,ctranspose:uF,divideScalar:cF,nthRoots:lF,lsolve:hF,equal:pF,max:fF,setCartesian:dF,setSymDifference:mF,hypot:gF,qr:yF,distance:vF,stirlingS2:xF,catalan:bF,fix:wF,range:_F,prod:MF,dotDivide:SF,deepEqual:EF,createUnit:TF,setUnion:AF,slu:CF,intersect:OF,bellNumbers:RF,atomicMass:PF,bohrMagneton:LF,boltzmann:IF,conductanceQuantum:DF,deuteronMass:kF,electronMass:zF,faraday:BF,firstRadiation:UF,gravitationConstant:FF,hartreeEnergy:jF,klitzing:HF,magneticConstant:VF,molarMass:GF,molarPlanckConstant:qF,neutronMass:WF,planckCharge:ZF,planckLength:$F,planckTemperature:YF,protonMass:XF,reducedPlanckConstant:JF,secondRadiation:QF,stefanBoltzmann:KF,vacuumImpedance:tj,xor:ej,row:nj,usolve:rj,unit:ij,avogadro:oj,classicalElectronRadius:aj,electricConstant:sj,fermiCoupling:uj,gravity:cj,loschmidt:lj,molarMassC12:hj,nuclearMagneton:pj,planckMass:fj,quantumOfCirculation:dj,speedOfLight:mj,wienDisplacement:gj,column:yj,lup:xj,det:bj,bohrRadius:wj,elementaryCharge:_j,inverseConductanceQuantum:Mj,molarVolume:Sj,planckTime:Ej,thomsonCrossSection:Nj,log:Tj,setIsSubset:Aj,lusolve:Cj,inv:Oj,expm:Rj,divide:Pj,median:Lj,variance:Ij,kldivergence:Dj,coulomb:kj,magneticFluxQuantum:zj,rydberg:Bj,log1p:Uj,eigs:Fj,mean:jj,std:Hj,gasConstant:Vj,parse:yH,evaluate:vH,sqrtm:Gj,multinomial:qj,planckConstant:Wj,compile:bH,help:wH,simplify:_H,rationalize:MH,mad:Zj,parser:EH,derivative:NH,config:$E}),$j(Xj,Yj,{apply:dA({isInteger:xz,typed:vz}),filter:xA({typed:vz}),map:wA({typed:vz}),forEach:MA({typed:vz}),subset:CA({matrix:IB,typed:vz}),index:OA({Index:RU}),concat:LA({isInteger:xz,matrix:IB,typed:vz}),max:kA({config:$E,larger:iU,numeric:ZU,typed:vz}),min:BA({config:$E,numeric:ZU,smaller:rU,typed:vz}),sum:FA({add:pU,config:$E,numeric:ZU,typed:vz}),range:HA({bignumber:HU,matrix:IB,config:$E,larger:iU,largerEq:CU,smaller:rU,smallerEq:YU,typed:vz}),column:GA({Index:RU,matrix:IB,range:_F,typed:vz}),row:WA({Index:RU,matrix:IB,range:_F,typed:vz}),std:$A({sqrt:vB,typed:vz,variance:Ij}),mean:XA({add:pU,divide:Pj,typed:vz}),variance:QA({add:pU,apply:Cz,divide:Pj,isNaN:_z,multiply:vU,subtract:aF,typed:vz})}),$j(Jj,{ResultSet:qk,Complex:Wk,Range:Zk,Node:Qj,ArrayNode:Kj,BlockNode:tH,ConstantNode:eH,ObjectNode:nH,ParenthesisNode:rH,RelationalNode:iH,Chain:oH,BigNumber:Jk,Matrix:Qk,ConditionalNode:sH,OperatorNode:uH,Fraction:hz,RangeNode:cH,DenseMatrix:gz,FunctionAssignmentNode:lH,SparseMatrix:LB,ImmutableDenseMatrix:aU,FibonacciHeap:sU,AccessorNode:pH,IndexNode:fH,Index:RU,Unit:NF,SymbolNode:dH,AssignmentNode:mH,Spa:vj,FunctionNode:gH,Help:xH,Parser:SH}),oH.createProxy(Yj);class TH{constructor(t){this.expression=yH(t),this.compiled=bH(t)}add(t){return new TH(_H("("+this.expression+") + ("+t.expression+")").toString())}sub(t){return new TH(_H("("+this.expression+") - ("+t.expression+")").toString())}multiply(t){return new TH(_H("("+this.expression+") * ("+t.expression+")").toString())}divide(t){return new TH(_H("("+this.expression+") / ("+t.expression+")").toString())}derivative(t){return new TH(NH(this.expression,t).toString())}evaluate(t){return this.compiled.evaluate(t)}}let AH=0;class CH{constructor(t,e){this.position=t,this.charge=e,this.name="point_"+AH,AH++}E(){let t=this.charge;Number.isFinite(this.charge)||(t=0);let e="((x-"+this.position.x()+")^2 + (y- "+this.position.y()+")^2 + (z-"+this.position.z()+")^2)",n=" ("+t+" * (x- "+this.position.x()+") )  / ("+e+")^(3/2)",r=" ("+t+" * (y- "+this.position.y()+") )  / ("+e+")^(3/2)",i=" ("+t+" * (z- "+this.position.z()+") )  / ("+e+")^(3/2)";return new tE(new TH(n),new TH(r),new TH(i))}}class OH{constructor(){this.points=[],this.isDirty=!0}addPoint(t,e){this.points.push(new CH(t,e)),this.isDirty=!0}E(){if(!this.isDirty)return this.previousE;this.isDirty=!1;let t=new tE(new TH("0"),new TH("0"),new TH("0"));for(let e of this.points)t=t.add(e.E());return this.previousE=t,t}}class RH{constructor(t,e,n,r){this.name=t,this.description=e,this.visualization=n,this.sim=r}}let PH=(()=>{class t{constructor(){this.scenes=[new RH("blank","A blank canvas.",null,null),new RH("dipole","A static positive and negative charge.",null,null)]}loadScene(t,e){return"dipole"==t?this.loadDipoleScene(e):("blank"==t||(console.error("Not a valid scene name",t),alert("not a valid scene name")),this.loadBlankScene(e))}loadBlankScene(t){let e=new OH,n=new KS(t,e);return new RH("blank","An empty canvas.",n,e)}loadDipoleScene(t){var e=new OH;let n=new KS(t,e);var r=new QS(-5,5,0),i=new QS(5,5,0);return e.addPoint(r,10),e.addPoint(i,-10),n.drawTestPoints(),new RH("dipole","A static positive and negative charge.",n,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=st({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),LH=(()=>{class t{constructor(t,e){this.sceneService=t,this.route=e,this.visualization={},this.sim={}}dirty(){this.sim.isDirty=!0}init(){let t=document.getElementById("emmy_canvas");var e=new URLSearchParams(window.location.search).get("scene");""!=e&&e||(e="dipole");let n=this.sceneService.loadScene(e,t);this.visualization=n.visualization,this.sim=n.sim}load(t){let e=document.getElementById("emmy_canvas");this.visualization.destroy();let n=this.sceneService.loadScene(t,e);this.visualization=n.visualization,this.sim=n.sim}}return t.\u0275fac=function(e){return new(e||t)(qt(PH),qt(Rp))},t.\u0275prov=st({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const IH=["emmy_canvas"],DH=["container"];let kH=(()=>{class t{constructor(t){this.stateService=t,this.width=150,this.height=150}ngOnInit(){}ngAfterViewInit(){this.resize(),this.stateService.init(),this.stateService.visualization.resize(this.container.nativeElement.offsetWidth,this.container.nativeElement.offsetHeight)}resize(){let t=this.container.nativeElement.offsetHeight,e=this.container.nativeElement.offsetWidth;document.getElementById("emmy_canvas").style.height=t+"px",document.getElementById("emmy_canvas").style.width=e+"px"}}return t.\u0275fac=function(e){return new(e||t)(Ao(LH))},t.\u0275cmp=ue({type:t,selectors:[["app-editor"]],viewQuery:function(t,e){var n;1&t&&(ys(IH,!0),ys(DH,!0)),2&t&&(gs(n=vs())&&(e.canvas=n.first),gs(n=vs())&&(e.container=n.first))},decls:4,vars:0,consts:[[2,"height","100%"],["container",""],["id","emmy_canvas"],["emmy_canvas",""]],template:function(t,e){1&t&&(Ro(0,"div",0,1),Lo(2,"canvas",2,3),Po())},styles:["canvas[_ngcontent-%COMP%]:focus {outline:none;}"]}),t})();function zH(t,e){if(1&t){const t=Io();Ro(0,"span"),Ro(1,"button",4),zo("click",(function(){Ye(t);const n=e.$implicit;return Fo().currentTab=n})),Xo(2),Po(),Po()}if(2&t){const t=e.$implicit,n=Fo();Pr(1),qo("btn-primary",n.currentTab!=t)("btn-secondary",n.currentTab==t),Pr(1),Qo("",t," ")}}function BH(t,e){if(1&t){const t=Io();Ro(0,"div",6),Xo(1),Lo(2,"br"),Xo(3," Position: "),Ro(4,"div",7),Ro(5,"div",8),Ro(6,"input",9),zo("input",(function(){return Ye(t),Fo(2).dirty()}))("ngModelChange",(function(n){return Ye(t),e.$implicit.position.d[0]=n})),Po(),Po(),Ro(7,"div",8),Ro(8,"input",10),zo("input",(function(){return Ye(t),Fo(2).dirty()}))("ngModelChange",(function(n){return Ye(t),e.$implicit.position.d[1]=n})),Po(),Po(),Ro(9,"div",8),Ro(10,"input",11),zo("input",(function(){return Ye(t),Fo(2).dirty()}))("ngModelChange",(function(n){return Ye(t),e.$implicit.position.d[2]=n})),Po(),Po(),Po(),Xo(11," Charge: "),Ro(12,"input",12),zo("ngModelChange",(function(n){return Ye(t),e.$implicit.charge=n}))("input",(function(){return Ye(t),Fo(2).dirty()})),Po(),Po()}if(2&t){const t=e.$implicit;Pr(1),Qo(" ",t.name,""),Pr(5),Co("ngModel",t.position.d[0]),Pr(2),Co("ngModel",t.position.d[1]),Pr(2),Co("ngModel",t.position.d[2]),Pr(2),Co("ngModel",t.charge)}}function UH(t,e){if(1&t&&(Ro(0,"div"),To(1,BH,13,5,"div",5),Po()),2&t){const t=Fo();Pr(1),Co("ngForOf",t.stateService.sim.points)}}function FH(t,e){1&t&&(Ro(0,"div"),Xo(1," Scene "),Po())}function jH(t,e){1&t&&(Ro(0,"div"),Ro(1,"p"),Xo(2,"Electromagnetism engine."),Po(),Ro(3,"p"),Xo(4,"Source: "),Ro(5,"a",13),Xo(6,"Github"),Po(),Po(),Po())}function HH(t,e){if(1&t&&(Ro(0,"div",15),Ro(1,"h4"),Xo(2),Po(),Ro(3,"a",16),Xo(4,"Launch"),Po(),Ro(5,"p"),Xo(6),Po(),Po()),2&t){const t=e.$implicit;Pr(2),Jo(t.name),Pr(1),jo("href","/?scene=",t.name,"",fr),Pr(3),Jo(t.description)}}function VH(t,e){if(1&t&&(Ro(0,"div"),To(1,HH,7,3,"div",14),Po()),2&t){const t=Fo();Pr(1),Co("ngForOf",t.sceneService.scenes)}}let GH=(()=>{class t{constructor(t,e){this.stateService=t,this.sceneService=e,this.currentTab="Components",this.tabNames=["Components","Scene","About","Examples"]}ngOnInit(){}dirty(){this.stateService.dirty()}}return t.\u0275fac=function(e){return new(e||t)(Ao(LH),Ao(PH))},t.\u0275cmp=ue({type:t,selectors:[["app-toolbox"]],decls:10,vars:5,consts:[[1,"text-light","p-1","m-0"],[4,"ngFor","ngForOf"],[1,"bg-secondary"],[4,"ngIf"],[1,"btn","btn-sm","btn-primary",2,"border-radius","0 !important",3,"click"],["style","border: 1px solid","class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2",2,"border","1px solid"],[1,"row"],[1,"col"],["type","number","placeholder","X",1,"form-control-sm","form-control",3,"ngModel","input","ngModelChange"],["type","number","placeholder","Y",1,"form-control-sm","form-control",3,"ngModel","input","ngModelChange"],["type","number","placeholder","Z",1,"form-control-sm","form-control",3,"ngModel","input","ngModelChange"],["type","number","placeholder","Z",1,"form-control-sm","form-control",3,"ngModel","ngModelChange","input"],["href","https://github.com/c0nrad/emmy"],["class","clearfix pb-2",4,"ngFor","ngForOf"],[1,"clearfix","pb-2"],[1,"btn","btn-sm","btn-primary","float-right",3,"href"]],template:function(t,e){1&t&&(Ro(0,"div",0),Ro(1,"h5"),Xo(2,"Emmy"),Po(),Ro(3,"div"),To(4,zH,3,5,"span",1),Po(),Ro(5,"div",2),To(6,UH,2,1,"div",3),To(7,FH,2,0,"div",3),To(8,jH,7,0,"div",3),To(9,VH,2,1,"div",3),Po(),Po()),2&t&&(Pr(4),Co("ngForOf",e.tabNames),Pr(2),Co("ngIf","Components"==e.currentTab),Pr(1),Co("ngIf","Scene"==e.currentTab),Pr(1),Co("ngIf","About"==e.currentTab),Pr(1),Co("ngIf","Examples"==e.currentTab))},directives:[Fu,Hu,Zc,Ac,Ic,Cl],encapsulation:2}),t})(),qH=(()=>{class t{constructor(){this.title="emmy"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ue({type:t,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container-fluid","m-0","p-0","row","bg-dark",2,"height","100%"],[1,"col-md-9","m-0","p-0",2,"border","1px solid"],[1,"col-md-3","m-0","p-0"]],template:function(t,e){1&t&&(Ro(0,"div",0),Lo(1,"app-editor",1),Lo(2,"app-toolbox",2),Po())},directives:[kH,GH],encapsulation:2}),t})(),WH=(()=>{class t{}return t.\u0275mod=pe({type:t,bootstrap:[qH]}),t.\u0275inj=ut({factory:function(e){return new(e||t)},providers:[],imports:[[wc,ud,Rl]]}),t})();(function(){if(ur)throw new Error("Cannot enable prod mode after platform setup.");sr=!1})(),xc().bootstrapModule(WH).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);